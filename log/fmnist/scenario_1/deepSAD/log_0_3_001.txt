2020-05-29 13:57:25,701 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_0_3_001.txt
2020-05-29 13:57:25,702 - root - INFO - Data path is ../data
2020-05-29 13:57:25,702 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-29 13:57:25,702 - root - INFO - Dataset: fmnist
2020-05-29 13:57:25,702 - root - INFO - Normal class: 0
2020-05-29 13:57:25,702 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-29 13:57:25,702 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-29 13:57:25,704 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-29 13:57:25,704 - root - INFO - Scenario Running: 1
2020-05-29 13:57:25,704 - root - INFO - Train only the network: True
2020-05-29 13:57:25,705 - root - INFO - Output and AE dimensions: 128
2020-05-29 13:57:25,705 - root - INFO - Known anomaly class: 3
2020-05-29 13:57:25,705 - root - INFO - Network: fmnist_LeNet
2020-05-29 13:57:25,705 - root - INFO - Eta-parameter: 1.00
2020-05-29 13:57:25,714 - root - INFO - Set seed to 0.
2020-05-29 13:57:25,837 - root - INFO - Computation device: cuda
2020-05-29 13:57:25,838 - root - INFO - Number of threads: 0
2020-05-29 13:57:25,839 - root - INFO - Number of dataloader workers: 6
2020-05-29 13:57:43,177 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-29 13:57:43,230 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-29 13:57:43,231 - root - INFO - Pretraining: True
2020-05-29 13:57:43,231 - root - INFO - Training optimizer: adam
2020-05-29 13:57:43,231 - root - INFO - Training learning rate: 0.0001
2020-05-29 13:57:43,231 - root - INFO - Training epochs: 150
2020-05-29 13:57:43,231 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-29 13:57:43,231 - root - INFO - Training batch size: 200
2020-05-29 13:57:43,231 - root - INFO - Training weight decay: 5e-07
2020-05-29 13:57:43,234 - root - INFO - Starting training...
2020-05-29 13:57:56,315 - root - INFO - | Epoch: 001/150 | Train Time: 13.080s | Train Loss: 1.899132 |
2020-05-29 13:58:01,313 - root - INFO - | Epoch: 002/150 | Train Time: 4.998s | Train Loss: 0.665482 |
2020-05-29 13:58:05,889 - root - INFO - | Epoch: 003/150 | Train Time: 4.575s | Train Loss: 0.402522 |
2020-05-29 13:58:10,259 - root - INFO - | Epoch: 004/150 | Train Time: 4.370s | Train Loss: 0.316423 |
2020-05-29 13:58:14,863 - root - INFO - | Epoch: 005/150 | Train Time: 4.603s | Train Loss: 0.256724 |
2020-05-29 13:58:19,807 - root - INFO - | Epoch: 006/150 | Train Time: 4.944s | Train Loss: 0.216231 |
2020-05-29 13:58:24,511 - root - INFO - | Epoch: 007/150 | Train Time: 4.703s | Train Loss: 0.194900 |
2020-05-29 13:58:28,775 - root - INFO - | Epoch: 008/150 | Train Time: 4.264s | Train Loss: 0.167474 |
2020-05-29 13:58:33,570 - root - INFO - | Epoch: 009/150 | Train Time: 4.794s | Train Loss: 0.156617 |
2020-05-29 13:58:37,333 - root - INFO - | Epoch: 010/150 | Train Time: 3.762s | Train Loss: 0.144542 |
2020-05-29 13:58:41,453 - root - INFO - | Epoch: 011/150 | Train Time: 4.119s | Train Loss: 0.137086 |
2020-05-29 13:58:45,959 - root - INFO - | Epoch: 012/150 | Train Time: 4.506s | Train Loss: 0.124292 |
2020-05-29 13:58:50,477 - root - INFO - | Epoch: 013/150 | Train Time: 4.517s | Train Loss: 0.116882 |
2020-05-29 13:58:54,582 - root - INFO - | Epoch: 014/150 | Train Time: 4.105s | Train Loss: 0.108401 |
2020-05-29 13:58:58,759 - root - INFO - | Epoch: 015/150 | Train Time: 4.177s | Train Loss: 0.105225 |
2020-05-29 13:59:03,464 - root - INFO - | Epoch: 016/150 | Train Time: 4.704s | Train Loss: 0.101215 |
2020-05-29 13:59:08,015 - root - INFO - | Epoch: 017/150 | Train Time: 4.550s | Train Loss: 0.094122 |
2020-05-29 13:59:12,626 - root - INFO - | Epoch: 018/150 | Train Time: 4.611s | Train Loss: 0.088240 |
2020-05-29 13:59:17,081 - root - INFO - | Epoch: 019/150 | Train Time: 4.454s | Train Loss: 0.084605 |
2020-05-29 13:59:21,801 - root - INFO - | Epoch: 020/150 | Train Time: 4.719s | Train Loss: 0.083857 |
2020-05-29 13:59:26,104 - root - INFO - | Epoch: 021/150 | Train Time: 4.302s | Train Loss: 0.079034 |
2020-05-29 13:59:30,270 - root - INFO - | Epoch: 022/150 | Train Time: 4.166s | Train Loss: 0.077654 |
2020-05-29 13:59:33,936 - root - INFO - | Epoch: 023/150 | Train Time: 3.665s | Train Loss: 0.074764 |
2020-05-29 13:59:37,879 - root - INFO - | Epoch: 024/150 | Train Time: 3.942s | Train Loss: 0.070023 |
2020-05-29 13:59:41,242 - root - INFO - | Epoch: 025/150 | Train Time: 3.362s | Train Loss: 0.071132 |
2020-05-29 13:59:45,052 - root - INFO - | Epoch: 026/150 | Train Time: 3.809s | Train Loss: 0.067785 |
2020-05-29 13:59:48,820 - root - INFO - | Epoch: 027/150 | Train Time: 3.768s | Train Loss: 0.066094 |
2020-05-29 13:59:52,305 - root - INFO - | Epoch: 028/150 | Train Time: 3.484s | Train Loss: 0.061755 |
2020-05-29 13:59:56,790 - root - INFO - | Epoch: 029/150 | Train Time: 4.484s | Train Loss: 0.062903 |
2020-05-29 14:00:01,507 - root - INFO - | Epoch: 030/150 | Train Time: 4.716s | Train Loss: 0.061557 |
2020-05-29 14:00:06,046 - root - INFO - | Epoch: 031/150 | Train Time: 4.539s | Train Loss: 0.061122 |
2020-05-29 14:00:10,481 - root - INFO - | Epoch: 032/150 | Train Time: 4.434s | Train Loss: 0.058181 |
2020-05-29 14:00:14,625 - root - INFO - | Epoch: 033/150 | Train Time: 4.143s | Train Loss: 0.057202 |
2020-05-29 14:00:18,695 - root - INFO - | Epoch: 034/150 | Train Time: 4.070s | Train Loss: 0.055328 |
2020-05-29 14:00:22,214 - root - INFO - | Epoch: 035/150 | Train Time: 3.519s | Train Loss: 0.054963 |
2020-05-29 14:00:25,842 - root - INFO - | Epoch: 036/150 | Train Time: 3.627s | Train Loss: 0.054154 |
2020-05-29 14:00:29,490 - root - INFO - | Epoch: 037/150 | Train Time: 3.647s | Train Loss: 0.053134 |
2020-05-29 14:00:33,536 - root - INFO - | Epoch: 038/150 | Train Time: 4.044s | Train Loss: 0.052233 |
2020-05-29 14:00:37,992 - root - INFO - | Epoch: 039/150 | Train Time: 4.456s | Train Loss: 0.050956 |
2020-05-29 14:00:42,338 - root - INFO - | Epoch: 040/150 | Train Time: 4.346s | Train Loss: 0.050380 |
2020-05-29 14:00:46,817 - root - INFO - | Epoch: 041/150 | Train Time: 4.479s | Train Loss: 0.049031 |
2020-05-29 14:00:51,517 - root - INFO - | Epoch: 042/150 | Train Time: 4.699s | Train Loss: 0.048483 |
2020-05-29 14:00:56,038 - root - INFO - | Epoch: 043/150 | Train Time: 4.520s | Train Loss: 0.047074 |
2020-05-29 14:01:00,074 - root - INFO - | Epoch: 044/150 | Train Time: 4.036s | Train Loss: 0.047385 |
2020-05-29 14:01:03,873 - root - INFO - | Epoch: 045/150 | Train Time: 3.798s | Train Loss: 0.046582 |
2020-05-29 14:01:07,735 - root - INFO - | Epoch: 046/150 | Train Time: 3.862s | Train Loss: 0.044099 |
2020-05-29 14:01:12,103 - root - INFO - | Epoch: 047/150 | Train Time: 4.367s | Train Loss: 0.044090 |
2020-05-29 14:01:16,421 - root - INFO - | Epoch: 048/150 | Train Time: 4.317s | Train Loss: 0.043650 |
2020-05-29 14:01:20,453 - root - INFO - | Epoch: 049/150 | Train Time: 4.031s | Train Loss: 0.044011 |
2020-05-29 14:01:24,796 - root - INFO - | Epoch: 050/150 | Train Time: 4.343s | Train Loss: 0.041054 |
2020-05-29 14:01:24,796 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-29 14:01:29,294 - root - INFO - | Epoch: 051/150 | Train Time: 4.497s | Train Loss: 0.040577 |
2020-05-29 14:01:33,219 - root - INFO - | Epoch: 052/150 | Train Time: 3.925s | Train Loss: 0.041284 |
2020-05-29 14:01:37,320 - root - INFO - | Epoch: 053/150 | Train Time: 4.100s | Train Loss: 0.040817 |
2020-05-29 14:01:41,956 - root - INFO - | Epoch: 054/150 | Train Time: 4.635s | Train Loss: 0.040025 |
2020-05-29 14:01:46,343 - root - INFO - | Epoch: 055/150 | Train Time: 4.387s | Train Loss: 0.041224 |
2020-05-29 14:01:50,989 - root - INFO - | Epoch: 056/150 | Train Time: 4.645s | Train Loss: 0.041169 |
2020-05-29 14:01:55,403 - root - INFO - | Epoch: 057/150 | Train Time: 4.413s | Train Loss: 0.041170 |
2020-05-29 14:01:59,699 - root - INFO - | Epoch: 058/150 | Train Time: 4.295s | Train Loss: 0.039654 |
2020-05-29 14:02:04,089 - root - INFO - | Epoch: 059/150 | Train Time: 4.388s | Train Loss: 0.040148 |
2020-05-29 14:02:08,188 - root - INFO - | Epoch: 060/150 | Train Time: 4.098s | Train Loss: 0.039241 |
2020-05-29 14:02:12,296 - root - INFO - | Epoch: 061/150 | Train Time: 4.108s | Train Loss: 0.040821 |
2020-05-29 14:02:16,807 - root - INFO - | Epoch: 062/150 | Train Time: 4.510s | Train Loss: 0.040098 |
2020-05-29 14:02:20,596 - root - INFO - | Epoch: 063/150 | Train Time: 3.789s | Train Loss: 0.040060 |
2020-05-29 14:02:24,431 - root - INFO - | Epoch: 064/150 | Train Time: 3.835s | Train Loss: 0.040420 |
2020-05-29 14:02:28,335 - root - INFO - | Epoch: 065/150 | Train Time: 3.903s | Train Loss: 0.039352 |
2020-05-29 14:02:32,526 - root - INFO - | Epoch: 066/150 | Train Time: 4.190s | Train Loss: 0.039484 |
2020-05-29 14:02:37,134 - root - INFO - | Epoch: 067/150 | Train Time: 4.607s | Train Loss: 0.039636 |
2020-05-29 14:02:41,297 - root - INFO - | Epoch: 068/150 | Train Time: 4.162s | Train Loss: 0.040793 |
2020-05-29 14:02:45,831 - root - INFO - | Epoch: 069/150 | Train Time: 4.534s | Train Loss: 0.039440 |
2020-05-29 14:02:49,714 - root - INFO - | Epoch: 070/150 | Train Time: 3.883s | Train Loss: 0.039234 |
2020-05-29 14:02:53,504 - root - INFO - | Epoch: 071/150 | Train Time: 3.790s | Train Loss: 0.038814 |
2020-05-29 14:02:57,333 - root - INFO - | Epoch: 072/150 | Train Time: 3.828s | Train Loss: 0.039532 |
2020-05-29 14:03:00,886 - root - INFO - | Epoch: 073/150 | Train Time: 3.553s | Train Loss: 0.038756 |
2020-05-29 14:03:04,771 - root - INFO - | Epoch: 074/150 | Train Time: 3.884s | Train Loss: 0.040097 |
2020-05-29 14:03:08,794 - root - INFO - | Epoch: 075/150 | Train Time: 4.023s | Train Loss: 0.039102 |
2020-05-29 14:03:12,966 - root - INFO - | Epoch: 076/150 | Train Time: 4.172s | Train Loss: 0.039382 |
2020-05-29 14:03:17,211 - root - INFO - | Epoch: 077/150 | Train Time: 4.244s | Train Loss: 0.038685 |
2020-05-29 14:03:20,879 - root - INFO - | Epoch: 078/150 | Train Time: 3.667s | Train Loss: 0.038835 |
2020-05-29 14:03:25,103 - root - INFO - | Epoch: 079/150 | Train Time: 4.224s | Train Loss: 0.038201 |
2020-05-29 14:03:29,032 - root - INFO - | Epoch: 080/150 | Train Time: 3.928s | Train Loss: 0.038248 |
2020-05-29 14:03:33,476 - root - INFO - | Epoch: 081/150 | Train Time: 4.443s | Train Loss: 0.038425 |
2020-05-29 14:03:37,717 - root - INFO - | Epoch: 082/150 | Train Time: 4.241s | Train Loss: 0.039108 |
2020-05-29 14:03:42,573 - root - INFO - | Epoch: 083/150 | Train Time: 4.856s | Train Loss: 0.038392 |
2020-05-29 14:03:47,152 - root - INFO - | Epoch: 084/150 | Train Time: 4.578s | Train Loss: 0.038152 |
2020-05-29 14:03:51,887 - root - INFO - | Epoch: 085/150 | Train Time: 4.734s | Train Loss: 0.038248 |
2020-05-29 14:03:56,338 - root - INFO - | Epoch: 086/150 | Train Time: 4.450s | Train Loss: 0.040091 |
2020-05-29 14:04:01,167 - root - INFO - | Epoch: 087/150 | Train Time: 4.829s | Train Loss: 0.037816 |
2020-05-29 14:04:05,477 - root - INFO - | Epoch: 088/150 | Train Time: 4.308s | Train Loss: 0.038045 |
2020-05-29 14:04:09,988 - root - INFO - | Epoch: 089/150 | Train Time: 4.510s | Train Loss: 0.038413 |
2020-05-29 14:04:15,009 - root - INFO - | Epoch: 090/150 | Train Time: 5.020s | Train Loss: 0.038402 |
2020-05-29 14:04:19,279 - root - INFO - | Epoch: 091/150 | Train Time: 4.269s | Train Loss: 0.038889 |
2020-05-29 14:04:23,587 - root - INFO - | Epoch: 092/150 | Train Time: 4.307s | Train Loss: 0.038710 |
2020-05-29 14:04:28,395 - root - INFO - | Epoch: 093/150 | Train Time: 4.807s | Train Loss: 0.037816 |
2020-05-29 14:04:33,125 - root - INFO - | Epoch: 094/150 | Train Time: 4.730s | Train Loss: 0.037655 |
2020-05-29 14:04:37,587 - root - INFO - | Epoch: 095/150 | Train Time: 4.461s | Train Loss: 0.038349 |
2020-05-29 14:04:42,375 - root - INFO - | Epoch: 096/150 | Train Time: 4.788s | Train Loss: 0.038092 |
2020-05-29 14:04:46,750 - root - INFO - | Epoch: 097/150 | Train Time: 4.375s | Train Loss: 0.037466 |
2020-05-29 14:04:50,912 - root - INFO - | Epoch: 098/150 | Train Time: 4.161s | Train Loss: 0.038254 |
2020-05-29 14:04:54,932 - root - INFO - | Epoch: 099/150 | Train Time: 4.018s | Train Loss: 0.037417 |
2020-05-29 14:04:59,684 - root - INFO - | Epoch: 100/150 | Train Time: 4.751s | Train Loss: 0.038307 |
2020-05-29 14:05:03,652 - root - INFO - | Epoch: 101/150 | Train Time: 3.968s | Train Loss: 0.036962 |
2020-05-29 14:05:08,055 - root - INFO - | Epoch: 102/150 | Train Time: 4.402s | Train Loss: 0.036745 |
2020-05-29 14:05:12,435 - root - INFO - | Epoch: 103/150 | Train Time: 4.379s | Train Loss: 0.036312 |
2020-05-29 14:05:16,514 - root - INFO - | Epoch: 104/150 | Train Time: 4.078s | Train Loss: 0.037457 |
2020-05-29 14:05:20,277 - root - INFO - | Epoch: 105/150 | Train Time: 3.763s | Train Loss: 0.037397 |
2020-05-29 14:05:25,106 - root - INFO - | Epoch: 106/150 | Train Time: 4.827s | Train Loss: 0.036689 |
2020-05-29 14:05:29,590 - root - INFO - | Epoch: 107/150 | Train Time: 4.483s | Train Loss: 0.036722 |
2020-05-29 14:05:34,236 - root - INFO - | Epoch: 108/150 | Train Time: 4.646s | Train Loss: 0.037707 |
2020-05-29 14:05:38,538 - root - INFO - | Epoch: 109/150 | Train Time: 4.301s | Train Loss: 0.036326 |
2020-05-29 14:05:42,712 - root - INFO - | Epoch: 110/150 | Train Time: 4.174s | Train Loss: 0.036208 |
2020-05-29 14:05:47,568 - root - INFO - | Epoch: 111/150 | Train Time: 4.855s | Train Loss: 0.036919 |
2020-05-29 14:05:51,373 - root - INFO - | Epoch: 112/150 | Train Time: 3.805s | Train Loss: 0.035466 |
2020-05-29 14:05:55,334 - root - INFO - | Epoch: 113/150 | Train Time: 3.961s | Train Loss: 0.036241 |
2020-05-29 14:05:59,508 - root - INFO - | Epoch: 114/150 | Train Time: 4.146s | Train Loss: 0.035440 |
2020-05-29 14:06:03,339 - root - INFO - | Epoch: 115/150 | Train Time: 3.831s | Train Loss: 0.035844 |
2020-05-29 14:06:07,888 - root - INFO - | Epoch: 116/150 | Train Time: 4.548s | Train Loss: 0.036994 |
2020-05-29 14:06:12,105 - root - INFO - | Epoch: 117/150 | Train Time: 4.216s | Train Loss: 0.036510 |
2020-05-29 14:06:16,541 - root - INFO - | Epoch: 118/150 | Train Time: 4.435s | Train Loss: 0.036125 |
2020-05-29 14:06:20,839 - root - INFO - | Epoch: 119/150 | Train Time: 4.298s | Train Loss: 0.035901 |
2020-05-29 14:06:25,743 - root - INFO - | Epoch: 120/150 | Train Time: 4.903s | Train Loss: 0.036101 |
2020-05-29 14:06:30,174 - root - INFO - | Epoch: 121/150 | Train Time: 4.429s | Train Loss: 0.036482 |
2020-05-29 14:06:34,222 - root - INFO - | Epoch: 122/150 | Train Time: 4.047s | Train Loss: 0.035735 |
2020-05-29 14:06:38,369 - root - INFO - | Epoch: 123/150 | Train Time: 4.146s | Train Loss: 0.035540 |
2020-05-29 14:06:42,473 - root - INFO - | Epoch: 124/150 | Train Time: 4.104s | Train Loss: 0.035376 |
2020-05-29 14:06:46,767 - root - INFO - | Epoch: 125/150 | Train Time: 4.293s | Train Loss: 0.036415 |
2020-05-29 14:06:50,765 - root - INFO - | Epoch: 126/150 | Train Time: 3.998s | Train Loss: 0.034606 |
2020-05-29 14:06:55,125 - root - INFO - | Epoch: 127/150 | Train Time: 4.358s | Train Loss: 0.035714 |
2020-05-29 14:06:59,606 - root - INFO - | Epoch: 128/150 | Train Time: 4.481s | Train Loss: 0.035434 |
2020-05-29 14:07:03,713 - root - INFO - | Epoch: 129/150 | Train Time: 4.106s | Train Loss: 0.034696 |
2020-05-29 14:07:08,089 - root - INFO - | Epoch: 130/150 | Train Time: 4.375s | Train Loss: 0.033966 |
2020-05-29 14:07:11,824 - root - INFO - | Epoch: 131/150 | Train Time: 3.734s | Train Loss: 0.034466 |
2020-05-29 14:07:15,579 - root - INFO - | Epoch: 132/150 | Train Time: 3.755s | Train Loss: 0.035458 |
2020-05-29 14:07:19,354 - root - INFO - | Epoch: 133/150 | Train Time: 3.729s | Train Loss: 0.034996 |
2020-05-29 14:07:23,390 - root - INFO - | Epoch: 134/150 | Train Time: 4.035s | Train Loss: 0.034858 |
2020-05-29 14:07:26,920 - root - INFO - | Epoch: 135/150 | Train Time: 3.529s | Train Loss: 0.034547 |
2020-05-29 14:07:30,815 - root - INFO - | Epoch: 136/150 | Train Time: 3.894s | Train Loss: 0.035030 |
2020-05-29 14:07:34,477 - root - INFO - | Epoch: 137/150 | Train Time: 3.661s | Train Loss: 0.034836 |
2020-05-29 14:07:38,251 - root - INFO - | Epoch: 138/150 | Train Time: 3.774s | Train Loss: 0.034135 |
2020-05-29 14:07:42,800 - root - INFO - | Epoch: 139/150 | Train Time: 4.548s | Train Loss: 0.034141 |
2020-05-29 14:07:47,798 - root - INFO - | Epoch: 140/150 | Train Time: 4.997s | Train Loss: 0.033539 |
2020-05-29 14:07:51,992 - root - INFO - | Epoch: 141/150 | Train Time: 4.194s | Train Loss: 0.035377 |
2020-05-29 14:07:56,262 - root - INFO - | Epoch: 142/150 | Train Time: 4.269s | Train Loss: 0.032838 |
2020-05-29 14:08:00,928 - root - INFO - | Epoch: 143/150 | Train Time: 4.664s | Train Loss: 0.033846 |
2020-05-29 14:08:05,688 - root - INFO - | Epoch: 144/150 | Train Time: 4.759s | Train Loss: 0.034678 |
2020-05-29 14:08:09,352 - root - INFO - | Epoch: 145/150 | Train Time: 3.662s | Train Loss: 0.034660 |
2020-05-29 14:08:12,643 - root - INFO - | Epoch: 146/150 | Train Time: 3.291s | Train Loss: 0.032729 |
2020-05-29 14:08:16,390 - root - INFO - | Epoch: 147/150 | Train Time: 3.746s | Train Loss: 0.034952 |
2020-05-29 14:08:20,074 - root - INFO - | Epoch: 148/150 | Train Time: 3.683s | Train Loss: 0.033849 |
2020-05-29 14:08:23,757 - root - INFO - | Epoch: 149/150 | Train Time: 3.683s | Train Loss: 0.033889 |
2020-05-29 14:08:27,293 - root - INFO - | Epoch: 150/150 | Train Time: 3.536s | Train Loss: 0.034037 |
2020-05-29 14:08:27,293 - root - INFO - Training Time: 644.059s
2020-05-29 14:08:27,293 - root - INFO - Finished training.
2020-05-29 14:08:27,295 - root - INFO - Starting testing...
2020-05-29 14:08:31,681 - root - INFO - Test Loss: 0.092472
2020-05-29 14:08:31,683 - root - INFO - Test AUC: 62.43%
2020-05-29 14:08:31,683 - root - INFO - Test Time: 4.373s
2020-05-29 14:08:31,683 - root - INFO - Finished testing.
