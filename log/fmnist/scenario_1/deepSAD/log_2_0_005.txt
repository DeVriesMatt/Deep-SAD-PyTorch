2020-05-30 02:52:21,436 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_2_0_005.txt
2020-05-30 02:52:21,437 - root - INFO - Data path is ../data
2020-05-30 02:52:21,437 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 02:52:21,437 - root - INFO - Dataset: fmnist
2020-05-30 02:52:21,437 - root - INFO - Normal class: 2
2020-05-30 02:52:21,437 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 02:52:21,437 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-30 02:52:21,437 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 02:52:21,437 - root - INFO - Scenario Running: 1
2020-05-30 02:52:21,437 - root - INFO - Train only the network: True
2020-05-30 02:52:21,437 - root - INFO - Output and AE dimensions: 128
2020-05-30 02:52:21,437 - root - INFO - Known anomaly class: 0
2020-05-30 02:52:21,437 - root - INFO - Network: fmnist_LeNet
2020-05-30 02:52:21,437 - root - INFO - Eta-parameter: 1.00
2020-05-30 02:52:21,448 - root - INFO - Set seed to 0.
2020-05-30 02:52:21,598 - root - INFO - Computation device: cuda
2020-05-30 02:52:21,599 - root - INFO - Number of threads: 0
2020-05-30 02:52:21,599 - root - INFO - Number of dataloader workers: 6
2020-05-30 02:52:35,163 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 02:52:35,192 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 02:52:35,192 - root - INFO - Pretraining: True
2020-05-30 02:52:35,192 - root - INFO - Training optimizer: adam
2020-05-30 02:52:35,192 - root - INFO - Training learning rate: 0.0001
2020-05-30 02:52:35,192 - root - INFO - Training epochs: 150
2020-05-30 02:52:35,193 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 02:52:35,193 - root - INFO - Training batch size: 200
2020-05-30 02:52:35,193 - root - INFO - Training weight decay: 5e-07
2020-05-30 02:52:35,195 - root - INFO - Starting training...
2020-05-30 02:52:44,086 - root - INFO - | Epoch: 001/150 | Train Time: 8.890s | Train Loss: 1.963830 |
2020-05-30 02:52:47,626 - root - INFO - | Epoch: 002/150 | Train Time: 3.538s | Train Loss: 0.552786 |
2020-05-30 02:52:51,466 - root - INFO - | Epoch: 003/150 | Train Time: 3.840s | Train Loss: 0.348723 |
2020-05-30 02:52:55,820 - root - INFO - | Epoch: 004/150 | Train Time: 4.353s | Train Loss: 0.274344 |
2020-05-30 02:53:00,830 - root - INFO - | Epoch: 005/150 | Train Time: 5.010s | Train Loss: 0.231075 |
2020-05-30 02:53:05,142 - root - INFO - | Epoch: 006/150 | Train Time: 4.311s | Train Loss: 0.207820 |
2020-05-30 02:53:09,352 - root - INFO - | Epoch: 007/150 | Train Time: 4.210s | Train Loss: 0.190222 |
2020-05-30 02:53:13,438 - root - INFO - | Epoch: 008/150 | Train Time: 4.085s | Train Loss: 0.173587 |
2020-05-30 02:53:17,814 - root - INFO - | Epoch: 009/150 | Train Time: 4.376s | Train Loss: 0.162828 |
2020-05-30 02:53:21,716 - root - INFO - | Epoch: 010/150 | Train Time: 3.900s | Train Loss: 0.155232 |
2020-05-30 02:53:25,898 - root - INFO - | Epoch: 011/150 | Train Time: 4.181s | Train Loss: 0.148161 |
2020-05-30 02:53:29,371 - root - INFO - | Epoch: 012/150 | Train Time: 3.472s | Train Loss: 0.143342 |
2020-05-30 02:53:33,171 - root - INFO - | Epoch: 013/150 | Train Time: 3.800s | Train Loss: 0.136632 |
2020-05-30 02:53:36,775 - root - INFO - | Epoch: 014/150 | Train Time: 3.603s | Train Loss: 0.132188 |
2020-05-30 02:53:41,088 - root - INFO - | Epoch: 015/150 | Train Time: 4.313s | Train Loss: 0.128476 |
2020-05-30 02:53:44,711 - root - INFO - | Epoch: 016/150 | Train Time: 3.622s | Train Loss: 0.125112 |
2020-05-30 02:53:48,731 - root - INFO - | Epoch: 017/150 | Train Time: 4.019s | Train Loss: 0.121485 |
2020-05-30 02:53:52,602 - root - INFO - | Epoch: 018/150 | Train Time: 3.870s | Train Loss: 0.119189 |
2020-05-30 02:53:56,623 - root - INFO - | Epoch: 019/150 | Train Time: 4.020s | Train Loss: 0.116484 |
2020-05-30 02:54:00,617 - root - INFO - | Epoch: 020/150 | Train Time: 3.993s | Train Loss: 0.114743 |
2020-05-30 02:54:04,481 - root - INFO - | Epoch: 021/150 | Train Time: 3.864s | Train Loss: 0.113072 |
2020-05-30 02:54:08,311 - root - INFO - | Epoch: 022/150 | Train Time: 3.829s | Train Loss: 0.109475 |
2020-05-30 02:54:11,882 - root - INFO - | Epoch: 023/150 | Train Time: 3.570s | Train Loss: 0.107825 |
2020-05-30 02:54:15,396 - root - INFO - | Epoch: 024/150 | Train Time: 3.514s | Train Loss: 0.106155 |
2020-05-30 02:54:18,942 - root - INFO - | Epoch: 025/150 | Train Time: 3.545s | Train Loss: 0.104705 |
2020-05-30 02:54:22,781 - root - INFO - | Epoch: 026/150 | Train Time: 3.839s | Train Loss: 0.101649 |
2020-05-30 02:54:26,721 - root - INFO - | Epoch: 027/150 | Train Time: 3.939s | Train Loss: 0.100954 |
2020-05-30 02:54:30,659 - root - INFO - | Epoch: 028/150 | Train Time: 3.937s | Train Loss: 0.098999 |
2020-05-30 02:54:34,800 - root - INFO - | Epoch: 029/150 | Train Time: 4.140s | Train Loss: 0.098821 |
2020-05-30 02:54:38,866 - root - INFO - | Epoch: 030/150 | Train Time: 4.066s | Train Loss: 0.096277 |
2020-05-30 02:54:42,952 - root - INFO - | Epoch: 031/150 | Train Time: 4.085s | Train Loss: 0.094715 |
2020-05-30 02:54:46,871 - root - INFO - | Epoch: 032/150 | Train Time: 3.908s | Train Loss: 0.094467 |
2020-05-30 02:54:50,883 - root - INFO - | Epoch: 033/150 | Train Time: 4.011s | Train Loss: 0.094574 |
2020-05-30 02:54:55,295 - root - INFO - | Epoch: 034/150 | Train Time: 4.411s | Train Loss: 0.092993 |
2020-05-30 02:54:59,997 - root - INFO - | Epoch: 035/150 | Train Time: 4.701s | Train Loss: 0.091789 |
2020-05-30 02:55:04,977 - root - INFO - | Epoch: 036/150 | Train Time: 4.980s | Train Loss: 0.092070 |
2020-05-30 02:55:09,388 - root - INFO - | Epoch: 037/150 | Train Time: 4.411s | Train Loss: 0.090855 |
2020-05-30 02:55:14,481 - root - INFO - | Epoch: 038/150 | Train Time: 5.092s | Train Loss: 0.087881 |
2020-05-30 02:55:18,898 - root - INFO - | Epoch: 039/150 | Train Time: 4.417s | Train Loss: 0.087309 |
2020-05-30 02:55:23,300 - root - INFO - | Epoch: 040/150 | Train Time: 4.401s | Train Loss: 0.087348 |
2020-05-30 02:55:27,705 - root - INFO - | Epoch: 041/150 | Train Time: 4.404s | Train Loss: 0.086219 |
2020-05-30 02:55:32,176 - root - INFO - | Epoch: 042/150 | Train Time: 4.469s | Train Loss: 0.085092 |
2020-05-30 02:55:36,119 - root - INFO - | Epoch: 043/150 | Train Time: 3.942s | Train Loss: 0.084519 |
2020-05-30 02:55:40,418 - root - INFO - | Epoch: 044/150 | Train Time: 4.298s | Train Loss: 0.082403 |
2020-05-30 02:55:44,879 - root - INFO - | Epoch: 045/150 | Train Time: 4.460s | Train Loss: 0.083580 |
2020-05-30 02:55:49,448 - root - INFO - | Epoch: 046/150 | Train Time: 4.569s | Train Loss: 0.081994 |
2020-05-30 02:55:53,993 - root - INFO - | Epoch: 047/150 | Train Time: 4.544s | Train Loss: 0.080039 |
2020-05-30 02:55:58,069 - root - INFO - | Epoch: 048/150 | Train Time: 4.075s | Train Loss: 0.080535 |
2020-05-30 02:56:02,078 - root - INFO - | Epoch: 049/150 | Train Time: 4.008s | Train Loss: 0.078816 |
2020-05-30 02:56:05,876 - root - INFO - | Epoch: 050/150 | Train Time: 3.798s | Train Loss: 0.077287 |
2020-05-30 02:56:05,877 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 02:56:10,168 - root - INFO - | Epoch: 051/150 | Train Time: 4.291s | Train Loss: 0.076171 |
2020-05-30 02:56:14,410 - root - INFO - | Epoch: 052/150 | Train Time: 4.242s | Train Loss: 0.075663 |
2020-05-30 02:56:18,425 - root - INFO - | Epoch: 053/150 | Train Time: 4.014s | Train Loss: 0.074996 |
2020-05-30 02:56:22,729 - root - INFO - | Epoch: 054/150 | Train Time: 4.303s | Train Loss: 0.076462 |
2020-05-30 02:56:27,153 - root - INFO - | Epoch: 055/150 | Train Time: 4.414s | Train Loss: 0.075580 |
2020-05-30 02:56:31,764 - root - INFO - | Epoch: 056/150 | Train Time: 4.611s | Train Loss: 0.077102 |
2020-05-30 02:56:36,179 - root - INFO - | Epoch: 057/150 | Train Time: 4.414s | Train Loss: 0.075704 |
2020-05-30 02:56:40,454 - root - INFO - | Epoch: 058/150 | Train Time: 4.274s | Train Loss: 0.076177 |
2020-05-30 02:56:44,662 - root - INFO - | Epoch: 059/150 | Train Time: 4.208s | Train Loss: 0.075391 |
2020-05-30 02:56:48,932 - root - INFO - | Epoch: 060/150 | Train Time: 4.270s | Train Loss: 0.075716 |
2020-05-30 02:56:52,949 - root - INFO - | Epoch: 061/150 | Train Time: 4.016s | Train Loss: 0.075710 |
2020-05-30 02:56:57,333 - root - INFO - | Epoch: 062/150 | Train Time: 4.382s | Train Loss: 0.076900 |
2020-05-30 02:57:01,509 - root - INFO - | Epoch: 063/150 | Train Time: 4.175s | Train Loss: 0.074225 |
2020-05-30 02:57:05,467 - root - INFO - | Epoch: 064/150 | Train Time: 3.958s | Train Loss: 0.076068 |
2020-05-30 02:57:09,335 - root - INFO - | Epoch: 065/150 | Train Time: 3.867s | Train Loss: 0.075548 |
2020-05-30 02:57:12,577 - root - INFO - | Epoch: 066/150 | Train Time: 3.241s | Train Loss: 0.075471 |
2020-05-30 02:57:16,247 - root - INFO - | Epoch: 067/150 | Train Time: 3.669s | Train Loss: 0.074744 |
2020-05-30 02:57:20,299 - root - INFO - | Epoch: 068/150 | Train Time: 4.051s | Train Loss: 0.074136 |
2020-05-30 02:57:23,877 - root - INFO - | Epoch: 069/150 | Train Time: 3.578s | Train Loss: 0.075271 |
2020-05-30 02:57:27,767 - root - INFO - | Epoch: 070/150 | Train Time: 3.889s | Train Loss: 0.074325 |
2020-05-30 02:57:31,881 - root - INFO - | Epoch: 071/150 | Train Time: 4.113s | Train Loss: 0.074047 |
2020-05-30 02:57:36,076 - root - INFO - | Epoch: 072/150 | Train Time: 4.194s | Train Loss: 0.074454 |
2020-05-30 02:57:40,557 - root - INFO - | Epoch: 073/150 | Train Time: 4.481s | Train Loss: 0.074272 |
2020-05-30 02:57:44,411 - root - INFO - | Epoch: 074/150 | Train Time: 3.853s | Train Loss: 0.075460 |
2020-05-30 02:57:47,931 - root - INFO - | Epoch: 075/150 | Train Time: 3.520s | Train Loss: 0.075068 |
2020-05-30 02:57:51,532 - root - INFO - | Epoch: 076/150 | Train Time: 3.599s | Train Loss: 0.073115 |
2020-05-30 02:57:55,653 - root - INFO - | Epoch: 077/150 | Train Time: 4.121s | Train Loss: 0.073681 |
2020-05-30 02:57:59,626 - root - INFO - | Epoch: 078/150 | Train Time: 3.972s | Train Loss: 0.073176 |
2020-05-30 02:58:04,042 - root - INFO - | Epoch: 079/150 | Train Time: 4.415s | Train Loss: 0.073610 |
2020-05-30 02:58:08,424 - root - INFO - | Epoch: 080/150 | Train Time: 4.381s | Train Loss: 0.074017 |
2020-05-30 02:58:13,496 - root - INFO - | Epoch: 081/150 | Train Time: 5.070s | Train Loss: 0.074553 |
2020-05-30 02:58:18,131 - root - INFO - | Epoch: 082/150 | Train Time: 4.634s | Train Loss: 0.073634 |
2020-05-30 02:58:22,503 - root - INFO - | Epoch: 083/150 | Train Time: 4.368s | Train Loss: 0.072666 |
2020-05-30 02:58:26,613 - root - INFO - | Epoch: 084/150 | Train Time: 4.109s | Train Loss: 0.072746 |
2020-05-30 02:58:31,212 - root - INFO - | Epoch: 085/150 | Train Time: 4.598s | Train Loss: 0.072706 |
2020-05-30 02:58:35,047 - root - INFO - | Epoch: 086/150 | Train Time: 3.835s | Train Loss: 0.072772 |
2020-05-30 02:58:38,475 - root - INFO - | Epoch: 087/150 | Train Time: 3.427s | Train Loss: 0.073057 |
2020-05-30 02:58:42,252 - root - INFO - | Epoch: 088/150 | Train Time: 3.777s | Train Loss: 0.073554 |
2020-05-30 02:58:45,623 - root - INFO - | Epoch: 089/150 | Train Time: 3.370s | Train Loss: 0.072913 |
2020-05-30 02:58:49,097 - root - INFO - | Epoch: 090/150 | Train Time: 3.474s | Train Loss: 0.072317 |
2020-05-30 02:58:52,998 - root - INFO - | Epoch: 091/150 | Train Time: 3.899s | Train Loss: 0.073076 |
2020-05-30 02:58:57,206 - root - INFO - | Epoch: 092/150 | Train Time: 4.207s | Train Loss: 0.072200 |
2020-05-30 02:59:00,958 - root - INFO - | Epoch: 093/150 | Train Time: 3.752s | Train Loss: 0.073258 |
2020-05-30 02:59:04,148 - root - INFO - | Epoch: 094/150 | Train Time: 3.189s | Train Loss: 0.072784 |
2020-05-30 02:59:07,220 - root - INFO - | Epoch: 095/150 | Train Time: 3.071s | Train Loss: 0.073089 |
2020-05-30 02:59:11,880 - root - INFO - | Epoch: 096/150 | Train Time: 4.660s | Train Loss: 0.073296 |
2020-05-30 02:59:16,720 - root - INFO - | Epoch: 097/150 | Train Time: 4.840s | Train Loss: 0.071591 |
2020-05-30 02:59:21,363 - root - INFO - | Epoch: 098/150 | Train Time: 4.642s | Train Loss: 0.071763 |
2020-05-30 02:59:25,962 - root - INFO - | Epoch: 099/150 | Train Time: 4.598s | Train Loss: 0.071221 |
2020-05-30 02:59:30,154 - root - INFO - | Epoch: 100/150 | Train Time: 4.192s | Train Loss: 0.072064 |
2020-05-30 02:59:34,484 - root - INFO - | Epoch: 101/150 | Train Time: 4.329s | Train Loss: 0.071435 |
2020-05-30 02:59:38,743 - root - INFO - | Epoch: 102/150 | Train Time: 4.259s | Train Loss: 0.071366 |
2020-05-30 02:59:43,033 - root - INFO - | Epoch: 103/150 | Train Time: 4.290s | Train Loss: 0.070891 |
2020-05-30 02:59:47,659 - root - INFO - | Epoch: 104/150 | Train Time: 4.625s | Train Loss: 0.070332 |
2020-05-30 02:59:51,533 - root - INFO - | Epoch: 105/150 | Train Time: 3.873s | Train Loss: 0.072758 |
2020-05-30 02:59:55,481 - root - INFO - | Epoch: 106/150 | Train Time: 3.948s | Train Loss: 0.071386 |
2020-05-30 02:59:59,906 - root - INFO - | Epoch: 107/150 | Train Time: 4.424s | Train Loss: 0.071507 |
2020-05-30 03:00:04,687 - root - INFO - | Epoch: 108/150 | Train Time: 4.781s | Train Loss: 0.070852 |
2020-05-30 03:00:09,177 - root - INFO - | Epoch: 109/150 | Train Time: 4.489s | Train Loss: 0.070223 |
2020-05-30 03:00:14,333 - root - INFO - | Epoch: 110/150 | Train Time: 5.155s | Train Loss: 0.071470 |
2020-05-30 03:00:19,354 - root - INFO - | Epoch: 111/150 | Train Time: 5.020s | Train Loss: 0.069492 |
2020-05-30 03:00:24,255 - root - INFO - | Epoch: 112/150 | Train Time: 4.901s | Train Loss: 0.069794 |
2020-05-30 03:00:29,261 - root - INFO - | Epoch: 113/150 | Train Time: 5.005s | Train Loss: 0.069327 |
2020-05-30 03:00:34,083 - root - INFO - | Epoch: 114/150 | Train Time: 4.821s | Train Loss: 0.069678 |
2020-05-30 03:00:38,654 - root - INFO - | Epoch: 115/150 | Train Time: 4.571s | Train Loss: 0.069789 |
2020-05-30 03:00:43,617 - root - INFO - | Epoch: 116/150 | Train Time: 4.961s | Train Loss: 0.069531 |
2020-05-30 03:00:48,371 - root - INFO - | Epoch: 117/150 | Train Time: 4.754s | Train Loss: 0.070274 |
2020-05-30 03:00:52,856 - root - INFO - | Epoch: 118/150 | Train Time: 4.485s | Train Loss: 0.069714 |
2020-05-30 03:00:57,083 - root - INFO - | Epoch: 119/150 | Train Time: 4.226s | Train Loss: 0.070755 |
2020-05-30 03:01:01,477 - root - INFO - | Epoch: 120/150 | Train Time: 4.394s | Train Loss: 0.069808 |
2020-05-30 03:01:05,757 - root - INFO - | Epoch: 121/150 | Train Time: 4.279s | Train Loss: 0.069173 |
2020-05-30 03:01:09,689 - root - INFO - | Epoch: 122/150 | Train Time: 3.932s | Train Loss: 0.069846 |
2020-05-30 03:01:14,035 - root - INFO - | Epoch: 123/150 | Train Time: 4.345s | Train Loss: 0.070087 |
2020-05-30 03:01:18,640 - root - INFO - | Epoch: 124/150 | Train Time: 4.604s | Train Loss: 0.069142 |
2020-05-30 03:01:22,356 - root - INFO - | Epoch: 125/150 | Train Time: 3.716s | Train Loss: 0.070485 |
2020-05-30 03:01:26,218 - root - INFO - | Epoch: 126/150 | Train Time: 3.862s | Train Loss: 0.068641 |
2020-05-30 03:01:30,274 - root - INFO - | Epoch: 127/150 | Train Time: 4.055s | Train Loss: 0.068739 |
2020-05-30 03:01:34,439 - root - INFO - | Epoch: 128/150 | Train Time: 4.164s | Train Loss: 0.069092 |
2020-05-30 03:01:38,840 - root - INFO - | Epoch: 129/150 | Train Time: 4.401s | Train Loss: 0.068226 |
2020-05-30 03:01:43,118 - root - INFO - | Epoch: 130/150 | Train Time: 4.277s | Train Loss: 0.068070 |
2020-05-30 03:01:48,014 - root - INFO - | Epoch: 131/150 | Train Time: 4.895s | Train Loss: 0.068686 |
2020-05-30 03:01:52,320 - root - INFO - | Epoch: 132/150 | Train Time: 4.306s | Train Loss: 0.068335 |
2020-05-30 03:01:57,063 - root - INFO - | Epoch: 133/150 | Train Time: 4.742s | Train Loss: 0.067399 |
2020-05-30 03:02:01,427 - root - INFO - | Epoch: 134/150 | Train Time: 4.363s | Train Loss: 0.068498 |
2020-05-30 03:02:05,814 - root - INFO - | Epoch: 135/150 | Train Time: 4.387s | Train Loss: 0.066963 |
2020-05-30 03:02:10,503 - root - INFO - | Epoch: 136/150 | Train Time: 4.689s | Train Loss: 0.068589 |
2020-05-30 03:02:14,648 - root - INFO - | Epoch: 137/150 | Train Time: 4.145s | Train Loss: 0.067909 |
2020-05-30 03:02:18,986 - root - INFO - | Epoch: 138/150 | Train Time: 4.337s | Train Loss: 0.068040 |
2020-05-30 03:02:23,466 - root - INFO - | Epoch: 139/150 | Train Time: 4.479s | Train Loss: 0.067869 |
2020-05-30 03:02:28,363 - root - INFO - | Epoch: 140/150 | Train Time: 4.897s | Train Loss: 0.067017 |
2020-05-30 03:02:33,145 - root - INFO - | Epoch: 141/150 | Train Time: 4.781s | Train Loss: 0.067036 |
2020-05-30 03:02:37,400 - root - INFO - | Epoch: 142/150 | Train Time: 4.254s | Train Loss: 0.067348 |
2020-05-30 03:02:41,758 - root - INFO - | Epoch: 143/150 | Train Time: 4.357s | Train Loss: 0.066337 |
2020-05-30 03:02:46,188 - root - INFO - | Epoch: 144/150 | Train Time: 4.429s | Train Loss: 0.066305 |
2020-05-30 03:02:50,181 - root - INFO - | Epoch: 145/150 | Train Time: 3.992s | Train Loss: 0.066753 |
2020-05-30 03:02:54,848 - root - INFO - | Epoch: 146/150 | Train Time: 4.667s | Train Loss: 0.067206 |
2020-05-30 03:02:59,261 - root - INFO - | Epoch: 147/150 | Train Time: 4.413s | Train Loss: 0.065734 |
2020-05-30 03:03:03,239 - root - INFO - | Epoch: 148/150 | Train Time: 3.977s | Train Loss: 0.065881 |
2020-05-30 03:03:06,842 - root - INFO - | Epoch: 149/150 | Train Time: 3.602s | Train Loss: 0.065752 |
2020-05-30 03:03:10,379 - root - INFO - | Epoch: 150/150 | Train Time: 3.536s | Train Loss: 0.065420 |
2020-05-30 03:03:10,380 - root - INFO - Training Time: 635.184s
2020-05-30 03:03:10,380 - root - INFO - Finished training.
2020-05-30 03:03:10,381 - root - INFO - Starting testing...
2020-05-30 03:03:14,954 - root - INFO - Test Loss: 0.276418
2020-05-30 03:03:14,955 - root - INFO - Test AUC: 82.25%
2020-05-30 03:03:14,955 - root - INFO - Test Time: 4.556s
2020-05-30 03:03:14,955 - root - INFO - Finished testing.
