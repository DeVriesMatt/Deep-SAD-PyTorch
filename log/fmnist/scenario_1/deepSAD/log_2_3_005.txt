2020-05-30 03:58:25,025 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_2_3_005.txt
2020-05-30 03:58:25,025 - root - INFO - Data path is ../data
2020-05-30 03:58:25,026 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 03:58:25,026 - root - INFO - Dataset: fmnist
2020-05-30 03:58:25,026 - root - INFO - Normal class: 2
2020-05-30 03:58:25,026 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 03:58:25,026 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-30 03:58:25,026 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 03:58:25,026 - root - INFO - Scenario Running: 1
2020-05-30 03:58:25,026 - root - INFO - Train only the network: True
2020-05-30 03:58:25,026 - root - INFO - Output and AE dimensions: 128
2020-05-30 03:58:25,026 - root - INFO - Known anomaly class: 3
2020-05-30 03:58:25,026 - root - INFO - Network: fmnist_LeNet
2020-05-30 03:58:25,027 - root - INFO - Eta-parameter: 1.00
2020-05-30 03:58:25,034 - root - INFO - Set seed to 0.
2020-05-30 03:58:25,099 - root - INFO - Computation device: cuda
2020-05-30 03:58:25,100 - root - INFO - Number of threads: 0
2020-05-30 03:58:25,101 - root - INFO - Number of dataloader workers: 6
2020-05-30 03:58:40,060 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 03:58:40,095 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 03:58:40,095 - root - INFO - Pretraining: True
2020-05-30 03:58:40,096 - root - INFO - Training optimizer: adam
2020-05-30 03:58:40,096 - root - INFO - Training learning rate: 0.0001
2020-05-30 03:58:40,097 - root - INFO - Training epochs: 150
2020-05-30 03:58:40,097 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 03:58:40,097 - root - INFO - Training batch size: 200
2020-05-30 03:58:40,097 - root - INFO - Training weight decay: 5e-07
2020-05-30 03:58:40,100 - root - INFO - Starting training...
2020-05-30 03:58:49,590 - root - INFO - | Epoch: 001/150 | Train Time: 9.488s | Train Loss: 1.707739 |
2020-05-30 03:58:53,415 - root - INFO - | Epoch: 002/150 | Train Time: 3.824s | Train Loss: 0.456128 |
2020-05-30 03:58:57,696 - root - INFO - | Epoch: 003/150 | Train Time: 4.280s | Train Loss: 0.300026 |
2020-05-30 03:59:01,211 - root - INFO - | Epoch: 004/150 | Train Time: 3.515s | Train Loss: 0.242420 |
2020-05-30 03:59:04,647 - root - INFO - | Epoch: 005/150 | Train Time: 3.435s | Train Loss: 0.208944 |
2020-05-30 03:59:08,471 - root - INFO - | Epoch: 006/150 | Train Time: 3.824s | Train Loss: 0.189269 |
2020-05-30 03:59:13,461 - root - INFO - | Epoch: 007/150 | Train Time: 4.989s | Train Loss: 0.172390 |
2020-05-30 03:59:17,083 - root - INFO - | Epoch: 008/150 | Train Time: 3.622s | Train Loss: 0.158508 |
2020-05-30 03:59:20,614 - root - INFO - | Epoch: 009/150 | Train Time: 3.531s | Train Loss: 0.149160 |
2020-05-30 03:59:24,005 - root - INFO - | Epoch: 010/150 | Train Time: 3.391s | Train Loss: 0.142751 |
2020-05-30 03:59:27,502 - root - INFO - | Epoch: 011/150 | Train Time: 3.496s | Train Loss: 0.138233 |
2020-05-30 03:59:31,364 - root - INFO - | Epoch: 012/150 | Train Time: 3.862s | Train Loss: 0.130633 |
2020-05-30 03:59:35,679 - root - INFO - | Epoch: 013/150 | Train Time: 4.315s | Train Loss: 0.123094 |
2020-05-30 03:59:39,863 - root - INFO - | Epoch: 014/150 | Train Time: 4.183s | Train Loss: 0.120209 |
2020-05-30 03:59:44,083 - root - INFO - | Epoch: 015/150 | Train Time: 4.220s | Train Loss: 0.120748 |
2020-05-30 03:59:48,689 - root - INFO - | Epoch: 016/150 | Train Time: 4.605s | Train Loss: 0.113832 |
2020-05-30 03:59:52,940 - root - INFO - | Epoch: 017/150 | Train Time: 4.251s | Train Loss: 0.111653 |
2020-05-30 03:59:57,537 - root - INFO - | Epoch: 018/150 | Train Time: 4.596s | Train Loss: 0.109333 |
2020-05-30 04:00:02,038 - root - INFO - | Epoch: 019/150 | Train Time: 4.501s | Train Loss: 0.106217 |
2020-05-30 04:00:06,771 - root - INFO - | Epoch: 020/150 | Train Time: 4.732s | Train Loss: 0.104624 |
2020-05-30 04:00:11,204 - root - INFO - | Epoch: 021/150 | Train Time: 4.432s | Train Loss: 0.101748 |
2020-05-30 04:00:16,194 - root - INFO - | Epoch: 022/150 | Train Time: 4.989s | Train Loss: 0.100773 |
2020-05-30 04:00:20,882 - root - INFO - | Epoch: 023/150 | Train Time: 4.688s | Train Loss: 0.098019 |
2020-05-30 04:00:25,057 - root - INFO - | Epoch: 024/150 | Train Time: 4.174s | Train Loss: 0.098764 |
2020-05-30 04:00:29,156 - root - INFO - | Epoch: 025/150 | Train Time: 4.099s | Train Loss: 0.095140 |
2020-05-30 04:00:32,635 - root - INFO - | Epoch: 026/150 | Train Time: 3.478s | Train Loss: 0.091938 |
2020-05-30 04:00:36,283 - root - INFO - | Epoch: 027/150 | Train Time: 3.647s | Train Loss: 0.093506 |
2020-05-30 04:00:39,677 - root - INFO - | Epoch: 028/150 | Train Time: 3.394s | Train Loss: 0.090112 |
2020-05-30 04:00:44,007 - root - INFO - | Epoch: 029/150 | Train Time: 4.329s | Train Loss: 0.092212 |
2020-05-30 04:00:48,130 - root - INFO - | Epoch: 030/150 | Train Time: 4.122s | Train Loss: 0.088119 |
2020-05-30 04:00:52,135 - root - INFO - | Epoch: 031/150 | Train Time: 4.005s | Train Loss: 0.086657 |
2020-05-30 04:00:55,689 - root - INFO - | Epoch: 032/150 | Train Time: 3.554s | Train Loss: 0.085636 |
2020-05-30 04:00:59,108 - root - INFO - | Epoch: 033/150 | Train Time: 3.418s | Train Loss: 0.087870 |
2020-05-30 04:01:03,148 - root - INFO - | Epoch: 034/150 | Train Time: 4.040s | Train Loss: 0.089507 |
2020-05-30 04:01:07,516 - root - INFO - | Epoch: 035/150 | Train Time: 4.367s | Train Loss: 0.085813 |
2020-05-30 04:01:12,112 - root - INFO - | Epoch: 036/150 | Train Time: 4.595s | Train Loss: 0.083823 |
2020-05-30 04:01:16,903 - root - INFO - | Epoch: 037/150 | Train Time: 4.791s | Train Loss: 0.082787 |
2020-05-30 04:01:21,398 - root - INFO - | Epoch: 038/150 | Train Time: 4.494s | Train Loss: 0.080148 |
2020-05-30 04:01:26,178 - root - INFO - | Epoch: 039/150 | Train Time: 4.779s | Train Loss: 0.079961 |
2020-05-30 04:01:30,921 - root - INFO - | Epoch: 040/150 | Train Time: 4.743s | Train Loss: 0.079715 |
2020-05-30 04:01:35,540 - root - INFO - | Epoch: 041/150 | Train Time: 4.617s | Train Loss: 0.075114 |
2020-05-30 04:01:40,235 - root - INFO - | Epoch: 042/150 | Train Time: 4.694s | Train Loss: 0.077022 |
2020-05-30 04:01:44,667 - root - INFO - | Epoch: 043/150 | Train Time: 4.432s | Train Loss: 0.076135 |
2020-05-30 04:01:49,536 - root - INFO - | Epoch: 044/150 | Train Time: 4.868s | Train Loss: 0.074790 |
2020-05-30 04:01:54,909 - root - INFO - | Epoch: 045/150 | Train Time: 5.372s | Train Loss: 0.076659 |
2020-05-30 04:01:59,693 - root - INFO - | Epoch: 046/150 | Train Time: 4.784s | Train Loss: 0.073369 |
2020-05-30 04:02:04,598 - root - INFO - | Epoch: 047/150 | Train Time: 4.904s | Train Loss: 0.072219 |
2020-05-30 04:02:09,147 - root - INFO - | Epoch: 048/150 | Train Time: 4.549s | Train Loss: 0.072400 |
2020-05-30 04:02:12,730 - root - INFO - | Epoch: 049/150 | Train Time: 3.582s | Train Loss: 0.071749 |
2020-05-30 04:02:16,946 - root - INFO - | Epoch: 050/150 | Train Time: 4.215s | Train Loss: 0.070787 |
2020-05-30 04:02:16,946 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 04:02:21,096 - root - INFO - | Epoch: 051/150 | Train Time: 4.150s | Train Loss: 0.068403 |
2020-05-30 04:02:24,591 - root - INFO - | Epoch: 052/150 | Train Time: 3.494s | Train Loss: 0.066307 |
2020-05-30 04:02:28,928 - root - INFO - | Epoch: 053/150 | Train Time: 4.336s | Train Loss: 0.066502 |
2020-05-30 04:02:33,443 - root - INFO - | Epoch: 054/150 | Train Time: 4.515s | Train Loss: 0.066771 |
2020-05-30 04:02:38,181 - root - INFO - | Epoch: 055/150 | Train Time: 4.737s | Train Loss: 0.066627 |
2020-05-30 04:02:42,576 - root - INFO - | Epoch: 056/150 | Train Time: 4.395s | Train Loss: 0.069178 |
2020-05-30 04:02:47,109 - root - INFO - | Epoch: 057/150 | Train Time: 4.533s | Train Loss: 0.067088 |
2020-05-30 04:02:51,241 - root - INFO - | Epoch: 058/150 | Train Time: 4.131s | Train Loss: 0.067245 |
2020-05-30 04:02:55,281 - root - INFO - | Epoch: 059/150 | Train Time: 4.040s | Train Loss: 0.066333 |
2020-05-30 04:02:59,346 - root - INFO - | Epoch: 060/150 | Train Time: 4.064s | Train Loss: 0.066230 |
2020-05-30 04:03:03,481 - root - INFO - | Epoch: 061/150 | Train Time: 4.135s | Train Loss: 0.066863 |
2020-05-30 04:03:07,333 - root - INFO - | Epoch: 062/150 | Train Time: 3.851s | Train Loss: 0.066351 |
2020-05-30 04:03:10,922 - root - INFO - | Epoch: 063/150 | Train Time: 3.589s | Train Loss: 0.066289 |
2020-05-30 04:03:15,237 - root - INFO - | Epoch: 064/150 | Train Time: 4.315s | Train Loss: 0.066169 |
2020-05-30 04:03:19,028 - root - INFO - | Epoch: 065/150 | Train Time: 3.790s | Train Loss: 0.067211 |
2020-05-30 04:03:22,924 - root - INFO - | Epoch: 066/150 | Train Time: 3.895s | Train Loss: 0.066401 |
2020-05-30 04:03:27,202 - root - INFO - | Epoch: 067/150 | Train Time: 4.277s | Train Loss: 0.066682 |
2020-05-30 04:03:31,433 - root - INFO - | Epoch: 068/150 | Train Time: 4.230s | Train Loss: 0.065660 |
2020-05-30 04:03:35,169 - root - INFO - | Epoch: 069/150 | Train Time: 3.735s | Train Loss: 0.067503 |
2020-05-30 04:03:39,033 - root - INFO - | Epoch: 070/150 | Train Time: 3.864s | Train Loss: 0.065023 |
2020-05-30 04:03:42,493 - root - INFO - | Epoch: 071/150 | Train Time: 3.459s | Train Loss: 0.064799 |
2020-05-30 04:03:45,977 - root - INFO - | Epoch: 072/150 | Train Time: 3.483s | Train Loss: 0.065226 |
2020-05-30 04:03:49,629 - root - INFO - | Epoch: 073/150 | Train Time: 3.651s | Train Loss: 0.066211 |
2020-05-30 04:03:53,557 - root - INFO - | Epoch: 074/150 | Train Time: 3.927s | Train Loss: 0.066529 |
2020-05-30 04:03:57,350 - root - INFO - | Epoch: 075/150 | Train Time: 3.793s | Train Loss: 0.065857 |
2020-05-30 04:04:01,400 - root - INFO - | Epoch: 076/150 | Train Time: 4.049s | Train Loss: 0.064681 |
2020-05-30 04:04:05,313 - root - INFO - | Epoch: 077/150 | Train Time: 3.911s | Train Loss: 0.065188 |
2020-05-30 04:04:08,757 - root - INFO - | Epoch: 078/150 | Train Time: 3.443s | Train Loss: 0.066116 |
2020-05-30 04:04:12,991 - root - INFO - | Epoch: 079/150 | Train Time: 4.234s | Train Loss: 0.064832 |
2020-05-30 04:04:16,706 - root - INFO - | Epoch: 080/150 | Train Time: 3.715s | Train Loss: 0.065400 |
2020-05-30 04:04:20,571 - root - INFO - | Epoch: 081/150 | Train Time: 3.864s | Train Loss: 0.067150 |
2020-05-30 04:04:24,222 - root - INFO - | Epoch: 082/150 | Train Time: 3.651s | Train Loss: 0.064934 |
2020-05-30 04:04:27,957 - root - INFO - | Epoch: 083/150 | Train Time: 3.735s | Train Loss: 0.064601 |
2020-05-30 04:04:31,800 - root - INFO - | Epoch: 084/150 | Train Time: 3.842s | Train Loss: 0.062402 |
2020-05-30 04:04:36,016 - root - INFO - | Epoch: 085/150 | Train Time: 4.215s | Train Loss: 0.063692 |
2020-05-30 04:04:39,504 - root - INFO - | Epoch: 086/150 | Train Time: 3.487s | Train Loss: 0.065433 |
2020-05-30 04:04:43,447 - root - INFO - | Epoch: 087/150 | Train Time: 3.943s | Train Loss: 0.064044 |
2020-05-30 04:04:47,977 - root - INFO - | Epoch: 088/150 | Train Time: 4.530s | Train Loss: 0.064634 |
2020-05-30 04:04:51,685 - root - INFO - | Epoch: 089/150 | Train Time: 3.707s | Train Loss: 0.064745 |
2020-05-30 04:04:56,254 - root - INFO - | Epoch: 090/150 | Train Time: 4.569s | Train Loss: 0.063128 |
2020-05-30 04:05:00,784 - root - INFO - | Epoch: 091/150 | Train Time: 4.529s | Train Loss: 0.064140 |
2020-05-30 04:05:05,151 - root - INFO - | Epoch: 092/150 | Train Time: 4.338s | Train Loss: 0.062919 |
2020-05-30 04:05:09,570 - root - INFO - | Epoch: 093/150 | Train Time: 4.418s | Train Loss: 0.065366 |
2020-05-30 04:05:13,384 - root - INFO - | Epoch: 094/150 | Train Time: 3.814s | Train Loss: 0.063522 |
2020-05-30 04:05:17,185 - root - INFO - | Epoch: 095/150 | Train Time: 3.801s | Train Loss: 0.064773 |
2020-05-30 04:05:21,316 - root - INFO - | Epoch: 096/150 | Train Time: 4.130s | Train Loss: 0.064305 |
2020-05-30 04:05:25,448 - root - INFO - | Epoch: 097/150 | Train Time: 4.132s | Train Loss: 0.062639 |
2020-05-30 04:05:29,637 - root - INFO - | Epoch: 098/150 | Train Time: 4.188s | Train Loss: 0.062377 |
2020-05-30 04:05:33,732 - root - INFO - | Epoch: 099/150 | Train Time: 4.095s | Train Loss: 0.062501 |
2020-05-30 04:05:37,404 - root - INFO - | Epoch: 100/150 | Train Time: 3.671s | Train Loss: 0.064651 |
2020-05-30 04:05:41,243 - root - INFO - | Epoch: 101/150 | Train Time: 3.838s | Train Loss: 0.061537 |
2020-05-30 04:05:45,349 - root - INFO - | Epoch: 102/150 | Train Time: 4.106s | Train Loss: 0.062157 |
2020-05-30 04:05:49,262 - root - INFO - | Epoch: 103/150 | Train Time: 3.912s | Train Loss: 0.061328 |
2020-05-30 04:05:53,271 - root - INFO - | Epoch: 104/150 | Train Time: 4.009s | Train Loss: 0.061413 |
2020-05-30 04:05:57,131 - root - INFO - | Epoch: 105/150 | Train Time: 3.859s | Train Loss: 0.064535 |
2020-05-30 04:06:01,542 - root - INFO - | Epoch: 106/150 | Train Time: 4.411s | Train Loss: 0.061187 |
2020-05-30 04:06:05,655 - root - INFO - | Epoch: 107/150 | Train Time: 4.111s | Train Loss: 0.062995 |
2020-05-30 04:06:09,588 - root - INFO - | Epoch: 108/150 | Train Time: 3.933s | Train Loss: 0.060926 |
2020-05-30 04:06:13,182 - root - INFO - | Epoch: 109/150 | Train Time: 3.593s | Train Loss: 0.061463 |
2020-05-30 04:06:17,174 - root - INFO - | Epoch: 110/150 | Train Time: 3.991s | Train Loss: 0.061969 |
2020-05-30 04:06:21,006 - root - INFO - | Epoch: 111/150 | Train Time: 3.832s | Train Loss: 0.060285 |
2020-05-30 04:06:25,322 - root - INFO - | Epoch: 112/150 | Train Time: 4.315s | Train Loss: 0.059937 |
2020-05-30 04:06:29,097 - root - INFO - | Epoch: 113/150 | Train Time: 3.774s | Train Loss: 0.060717 |
2020-05-30 04:06:32,967 - root - INFO - | Epoch: 114/150 | Train Time: 3.869s | Train Loss: 0.059945 |
2020-05-30 04:06:36,264 - root - INFO - | Epoch: 115/150 | Train Time: 3.296s | Train Loss: 0.060883 |
2020-05-30 04:06:39,756 - root - INFO - | Epoch: 116/150 | Train Time: 3.492s | Train Loss: 0.061013 |
2020-05-30 04:06:43,808 - root - INFO - | Epoch: 117/150 | Train Time: 4.051s | Train Loss: 0.060674 |
2020-05-30 04:06:47,155 - root - INFO - | Epoch: 118/150 | Train Time: 3.347s | Train Loss: 0.059833 |
2020-05-30 04:06:51,533 - root - INFO - | Epoch: 119/150 | Train Time: 4.378s | Train Loss: 0.061111 |
2020-05-30 04:06:55,517 - root - INFO - | Epoch: 120/150 | Train Time: 3.983s | Train Loss: 0.061278 |
2020-05-30 04:06:58,767 - root - INFO - | Epoch: 121/150 | Train Time: 3.250s | Train Loss: 0.059386 |
2020-05-30 04:07:02,760 - root - INFO - | Epoch: 122/150 | Train Time: 3.992s | Train Loss: 0.060529 |
2020-05-30 04:07:07,126 - root - INFO - | Epoch: 123/150 | Train Time: 4.365s | Train Loss: 0.060217 |
2020-05-30 04:07:10,742 - root - INFO - | Epoch: 124/150 | Train Time: 3.616s | Train Loss: 0.059429 |
2020-05-30 04:07:14,701 - root - INFO - | Epoch: 125/150 | Train Time: 3.958s | Train Loss: 0.061483 |
2020-05-30 04:07:18,066 - root - INFO - | Epoch: 126/150 | Train Time: 3.365s | Train Loss: 0.058568 |
2020-05-30 04:07:21,992 - root - INFO - | Epoch: 127/150 | Train Time: 3.926s | Train Loss: 0.059199 |
2020-05-30 04:07:25,730 - root - INFO - | Epoch: 128/150 | Train Time: 3.737s | Train Loss: 0.059926 |
2020-05-30 04:07:30,182 - root - INFO - | Epoch: 129/150 | Train Time: 4.452s | Train Loss: 0.059857 |
2020-05-30 04:07:34,190 - root - INFO - | Epoch: 130/150 | Train Time: 4.007s | Train Loss: 0.057738 |
2020-05-30 04:07:37,913 - root - INFO - | Epoch: 131/150 | Train Time: 3.723s | Train Loss: 0.059399 |
2020-05-30 04:07:42,355 - root - INFO - | Epoch: 132/150 | Train Time: 4.441s | Train Loss: 0.058546 |
2020-05-30 04:07:46,558 - root - INFO - | Epoch: 133/150 | Train Time: 4.203s | Train Loss: 0.057955 |
2020-05-30 04:07:50,430 - root - INFO - | Epoch: 134/150 | Train Time: 3.872s | Train Loss: 0.059392 |
2020-05-30 04:07:55,065 - root - INFO - | Epoch: 135/150 | Train Time: 4.634s | Train Loss: 0.057710 |
2020-05-30 04:07:59,658 - root - INFO - | Epoch: 136/150 | Train Time: 4.592s | Train Loss: 0.058433 |
2020-05-30 04:08:04,241 - root - INFO - | Epoch: 137/150 | Train Time: 4.582s | Train Loss: 0.058180 |
2020-05-30 04:08:09,344 - root - INFO - | Epoch: 138/150 | Train Time: 5.102s | Train Loss: 0.058048 |
2020-05-30 04:08:13,907 - root - INFO - | Epoch: 139/150 | Train Time: 4.563s | Train Loss: 0.058416 |
2020-05-30 04:08:18,811 - root - INFO - | Epoch: 140/150 | Train Time: 4.903s | Train Loss: 0.057897 |
2020-05-30 04:08:23,569 - root - INFO - | Epoch: 141/150 | Train Time: 4.758s | Train Loss: 0.057451 |
2020-05-30 04:08:28,006 - root - INFO - | Epoch: 142/150 | Train Time: 4.436s | Train Loss: 0.058131 |
2020-05-30 04:08:31,655 - root - INFO - | Epoch: 143/150 | Train Time: 3.648s | Train Loss: 0.057016 |
2020-05-30 04:08:35,202 - root - INFO - | Epoch: 144/150 | Train Time: 3.547s | Train Loss: 0.056722 |
2020-05-30 04:08:38,909 - root - INFO - | Epoch: 145/150 | Train Time: 3.707s | Train Loss: 0.056993 |
2020-05-30 04:08:42,956 - root - INFO - | Epoch: 146/150 | Train Time: 4.046s | Train Loss: 0.056605 |
2020-05-30 04:08:47,122 - root - INFO - | Epoch: 147/150 | Train Time: 4.166s | Train Loss: 0.056296 |
2020-05-30 04:08:50,984 - root - INFO - | Epoch: 148/150 | Train Time: 3.861s | Train Loss: 0.056735 |
2020-05-30 04:08:55,035 - root - INFO - | Epoch: 149/150 | Train Time: 4.050s | Train Loss: 0.056178 |
2020-05-30 04:08:59,063 - root - INFO - | Epoch: 150/150 | Train Time: 4.027s | Train Loss: 0.056941 |
2020-05-30 04:08:59,063 - root - INFO - Training Time: 618.961s
2020-05-30 04:08:59,063 - root - INFO - Finished training.
2020-05-30 04:08:59,065 - root - INFO - Starting testing...
2020-05-30 04:09:03,415 - root - INFO - Test Loss: 0.291687
2020-05-30 04:09:03,416 - root - INFO - Test AUC: 82.14%
2020-05-30 04:09:03,416 - root - INFO - Test Time: 4.339s
2020-05-30 04:09:03,416 - root - INFO - Finished testing.
