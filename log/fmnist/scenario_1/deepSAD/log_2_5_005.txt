2020-05-30 05:03:24,926 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_2_5_005.txt
2020-05-30 05:03:24,926 - root - INFO - Data path is ../data
2020-05-30 05:03:24,926 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 05:03:24,926 - root - INFO - Dataset: fmnist
2020-05-30 05:03:24,926 - root - INFO - Normal class: 2
2020-05-30 05:03:24,926 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 05:03:24,926 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-30 05:03:24,926 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 05:03:24,926 - root - INFO - Scenario Running: 1
2020-05-30 05:03:24,926 - root - INFO - Train only the network: True
2020-05-30 05:03:24,926 - root - INFO - Output and AE dimensions: 128
2020-05-30 05:03:24,926 - root - INFO - Known anomaly class: 5
2020-05-30 05:03:24,927 - root - INFO - Network: fmnist_LeNet
2020-05-30 05:03:24,927 - root - INFO - Eta-parameter: 1.00
2020-05-30 05:03:24,945 - root - INFO - Set seed to 0.
2020-05-30 05:03:25,029 - root - INFO - Computation device: cuda
2020-05-30 05:03:25,029 - root - INFO - Number of threads: 0
2020-05-30 05:03:25,030 - root - INFO - Number of dataloader workers: 6
2020-05-30 05:03:40,617 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 05:03:40,646 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 05:03:40,647 - root - INFO - Pretraining: True
2020-05-30 05:03:40,647 - root - INFO - Training optimizer: adam
2020-05-30 05:03:40,647 - root - INFO - Training learning rate: 0.0001
2020-05-30 05:03:40,648 - root - INFO - Training epochs: 150
2020-05-30 05:03:40,648 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 05:03:40,648 - root - INFO - Training batch size: 200
2020-05-30 05:03:40,649 - root - INFO - Training weight decay: 5e-07
2020-05-30 05:03:40,662 - root - INFO - Starting training...
2020-05-30 05:03:52,661 - root - INFO - | Epoch: 001/150 | Train Time: 11.995s | Train Loss: 1.951018 |
2020-05-30 05:03:56,664 - root - INFO - | Epoch: 002/150 | Train Time: 4.003s | Train Loss: 0.517308 |
2020-05-30 05:04:00,571 - root - INFO - | Epoch: 003/150 | Train Time: 3.906s | Train Loss: 0.301313 |
2020-05-30 05:04:03,914 - root - INFO - | Epoch: 004/150 | Train Time: 3.342s | Train Loss: 0.227647 |
2020-05-30 05:04:07,655 - root - INFO - | Epoch: 005/150 | Train Time: 3.741s | Train Loss: 0.192701 |
2020-05-30 05:04:11,512 - root - INFO - | Epoch: 006/150 | Train Time: 3.856s | Train Loss: 0.171140 |
2020-05-30 05:04:15,223 - root - INFO - | Epoch: 007/150 | Train Time: 3.711s | Train Loss: 0.156276 |
2020-05-30 05:04:18,753 - root - INFO - | Epoch: 008/150 | Train Time: 3.529s | Train Loss: 0.141191 |
2020-05-30 05:04:23,202 - root - INFO - | Epoch: 009/150 | Train Time: 4.449s | Train Loss: 0.131879 |
2020-05-30 05:04:27,213 - root - INFO - | Epoch: 010/150 | Train Time: 4.011s | Train Loss: 0.125079 |
2020-05-30 05:04:31,197 - root - INFO - | Epoch: 011/150 | Train Time: 3.983s | Train Loss: 0.118849 |
2020-05-30 05:04:34,688 - root - INFO - | Epoch: 012/150 | Train Time: 3.490s | Train Loss: 0.112682 |
2020-05-30 05:04:38,610 - root - INFO - | Epoch: 013/150 | Train Time: 3.922s | Train Loss: 0.106236 |
2020-05-30 05:04:42,684 - root - INFO - | Epoch: 014/150 | Train Time: 4.073s | Train Loss: 0.103187 |
2020-05-30 05:04:47,008 - root - INFO - | Epoch: 015/150 | Train Time: 4.323s | Train Loss: 0.100967 |
2020-05-30 05:04:52,037 - root - INFO - | Epoch: 016/150 | Train Time: 5.029s | Train Loss: 0.097683 |
2020-05-30 05:04:56,605 - root - INFO - | Epoch: 017/150 | Train Time: 4.567s | Train Loss: 0.094190 |
2020-05-30 05:05:01,177 - root - INFO - | Epoch: 018/150 | Train Time: 4.571s | Train Loss: 0.090995 |
2020-05-30 05:05:05,581 - root - INFO - | Epoch: 019/150 | Train Time: 4.404s | Train Loss: 0.089408 |
2020-05-30 05:05:09,562 - root - INFO - | Epoch: 020/150 | Train Time: 3.980s | Train Loss: 0.087482 |
2020-05-30 05:05:13,964 - root - INFO - | Epoch: 021/150 | Train Time: 4.400s | Train Loss: 0.085348 |
2020-05-30 05:05:18,303 - root - INFO - | Epoch: 022/150 | Train Time: 4.339s | Train Loss: 0.083568 |
2020-05-30 05:05:23,254 - root - INFO - | Epoch: 023/150 | Train Time: 4.950s | Train Loss: 0.080298 |
2020-05-30 05:05:27,958 - root - INFO - | Epoch: 024/150 | Train Time: 4.703s | Train Loss: 0.079836 |
2020-05-30 05:05:32,439 - root - INFO - | Epoch: 025/150 | Train Time: 4.481s | Train Loss: 0.079717 |
2020-05-30 05:05:36,760 - root - INFO - | Epoch: 026/150 | Train Time: 4.211s | Train Loss: 0.075672 |
2020-05-30 05:05:40,428 - root - INFO - | Epoch: 027/150 | Train Time: 3.667s | Train Loss: 0.077257 |
2020-05-30 05:05:44,651 - root - INFO - | Epoch: 028/150 | Train Time: 4.223s | Train Loss: 0.073331 |
2020-05-30 05:05:48,374 - root - INFO - | Epoch: 029/150 | Train Time: 3.722s | Train Loss: 0.074879 |
2020-05-30 05:05:53,236 - root - INFO - | Epoch: 030/150 | Train Time: 4.861s | Train Loss: 0.071575 |
2020-05-30 05:05:57,819 - root - INFO - | Epoch: 031/150 | Train Time: 4.582s | Train Loss: 0.070060 |
2020-05-30 05:06:01,032 - root - INFO - | Epoch: 032/150 | Train Time: 3.213s | Train Loss: 0.069473 |
2020-05-30 05:06:04,208 - root - INFO - | Epoch: 033/150 | Train Time: 3.175s | Train Loss: 0.071232 |
2020-05-30 05:06:07,816 - root - INFO - | Epoch: 034/150 | Train Time: 3.607s | Train Loss: 0.071880 |
2020-05-30 05:06:11,474 - root - INFO - | Epoch: 035/150 | Train Time: 3.658s | Train Loss: 0.068561 |
2020-05-30 05:06:15,150 - root - INFO - | Epoch: 036/150 | Train Time: 3.675s | Train Loss: 0.067906 |
2020-05-30 05:06:18,383 - root - INFO - | Epoch: 037/150 | Train Time: 3.233s | Train Loss: 0.066216 |
2020-05-30 05:06:21,877 - root - INFO - | Epoch: 038/150 | Train Time: 3.493s | Train Loss: 0.063772 |
2020-05-30 05:06:25,093 - root - INFO - | Epoch: 039/150 | Train Time: 3.216s | Train Loss: 0.063416 |
2020-05-30 05:06:28,560 - root - INFO - | Epoch: 040/150 | Train Time: 3.466s | Train Loss: 0.064497 |
2020-05-30 05:06:31,929 - root - INFO - | Epoch: 041/150 | Train Time: 3.368s | Train Loss: 0.060426 |
2020-05-30 05:06:36,399 - root - INFO - | Epoch: 042/150 | Train Time: 4.469s | Train Loss: 0.062090 |
2020-05-30 05:06:40,128 - root - INFO - | Epoch: 043/150 | Train Time: 3.729s | Train Loss: 0.061841 |
2020-05-30 05:06:44,107 - root - INFO - | Epoch: 044/150 | Train Time: 3.979s | Train Loss: 0.059250 |
2020-05-30 05:06:48,254 - root - INFO - | Epoch: 045/150 | Train Time: 4.146s | Train Loss: 0.061786 |
2020-05-30 05:06:52,322 - root - INFO - | Epoch: 046/150 | Train Time: 4.067s | Train Loss: 0.058345 |
2020-05-30 05:06:56,308 - root - INFO - | Epoch: 047/150 | Train Time: 3.985s | Train Loss: 0.058494 |
2020-05-30 05:07:00,551 - root - INFO - | Epoch: 048/150 | Train Time: 4.243s | Train Loss: 0.056662 |
2020-05-30 05:07:04,582 - root - INFO - | Epoch: 049/150 | Train Time: 4.030s | Train Loss: 0.055872 |
2020-05-30 05:07:08,804 - root - INFO - | Epoch: 050/150 | Train Time: 4.222s | Train Loss: 0.056466 |
2020-05-30 05:07:08,804 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 05:07:13,417 - root - INFO - | Epoch: 051/150 | Train Time: 4.612s | Train Loss: 0.053926 |
2020-05-30 05:07:17,801 - root - INFO - | Epoch: 052/150 | Train Time: 4.383s | Train Loss: 0.052612 |
2020-05-30 05:07:21,781 - root - INFO - | Epoch: 053/150 | Train Time: 3.980s | Train Loss: 0.052231 |
2020-05-30 05:07:26,071 - root - INFO - | Epoch: 054/150 | Train Time: 4.290s | Train Loss: 0.052720 |
2020-05-30 05:07:30,467 - root - INFO - | Epoch: 055/150 | Train Time: 4.396s | Train Loss: 0.052499 |
2020-05-30 05:07:35,025 - root - INFO - | Epoch: 056/150 | Train Time: 4.556s | Train Loss: 0.054555 |
2020-05-30 05:07:39,006 - root - INFO - | Epoch: 057/150 | Train Time: 3.981s | Train Loss: 0.052730 |
2020-05-30 05:07:42,800 - root - INFO - | Epoch: 058/150 | Train Time: 3.793s | Train Loss: 0.052733 |
2020-05-30 05:07:46,432 - root - INFO - | Epoch: 059/150 | Train Time: 3.631s | Train Loss: 0.053216 |
2020-05-30 05:07:50,161 - root - INFO - | Epoch: 060/150 | Train Time: 3.729s | Train Loss: 0.052035 |
2020-05-30 05:07:53,922 - root - INFO - | Epoch: 061/150 | Train Time: 3.760s | Train Loss: 0.053630 |
2020-05-30 05:07:58,175 - root - INFO - | Epoch: 062/150 | Train Time: 4.252s | Train Loss: 0.052495 |
2020-05-30 05:08:01,612 - root - INFO - | Epoch: 063/150 | Train Time: 3.436s | Train Loss: 0.052467 |
2020-05-30 05:08:05,578 - root - INFO - | Epoch: 064/150 | Train Time: 3.966s | Train Loss: 0.052633 |
2020-05-30 05:08:09,427 - root - INFO - | Epoch: 065/150 | Train Time: 3.848s | Train Loss: 0.051935 |
2020-05-30 05:08:13,519 - root - INFO - | Epoch: 066/150 | Train Time: 4.091s | Train Loss: 0.053007 |
2020-05-30 05:08:17,898 - root - INFO - | Epoch: 067/150 | Train Time: 4.379s | Train Loss: 0.052212 |
2020-05-30 05:08:22,459 - root - INFO - | Epoch: 068/150 | Train Time: 4.560s | Train Loss: 0.052152 |
2020-05-30 05:08:26,874 - root - INFO - | Epoch: 069/150 | Train Time: 4.415s | Train Loss: 0.054022 |
2020-05-30 05:08:30,907 - root - INFO - | Epoch: 070/150 | Train Time: 4.032s | Train Loss: 0.052098 |
2020-05-30 05:08:34,735 - root - INFO - | Epoch: 071/150 | Train Time: 3.828s | Train Loss: 0.050712 |
2020-05-30 05:08:38,624 - root - INFO - | Epoch: 072/150 | Train Time: 3.888s | Train Loss: 0.051609 |
2020-05-30 05:08:42,015 - root - INFO - | Epoch: 073/150 | Train Time: 3.391s | Train Loss: 0.052251 |
2020-05-30 05:08:46,118 - root - INFO - | Epoch: 074/150 | Train Time: 4.102s | Train Loss: 0.051978 |
2020-05-30 05:08:49,904 - root - INFO - | Epoch: 075/150 | Train Time: 3.786s | Train Loss: 0.052121 |
2020-05-30 05:08:53,906 - root - INFO - | Epoch: 076/150 | Train Time: 4.002s | Train Loss: 0.050447 |
2020-05-30 05:08:57,889 - root - INFO - | Epoch: 077/150 | Train Time: 3.982s | Train Loss: 0.050811 |
2020-05-30 05:09:01,661 - root - INFO - | Epoch: 078/150 | Train Time: 3.772s | Train Loss: 0.051647 |
2020-05-30 05:09:06,177 - root - INFO - | Epoch: 079/150 | Train Time: 4.516s | Train Loss: 0.051119 |
2020-05-30 05:09:09,814 - root - INFO - | Epoch: 080/150 | Train Time: 3.636s | Train Loss: 0.050784 |
2020-05-30 05:09:14,134 - root - INFO - | Epoch: 081/150 | Train Time: 4.320s | Train Loss: 0.052000 |
2020-05-30 05:09:17,754 - root - INFO - | Epoch: 082/150 | Train Time: 3.619s | Train Loss: 0.050795 |
2020-05-30 05:09:22,043 - root - INFO - | Epoch: 083/150 | Train Time: 4.288s | Train Loss: 0.049466 |
2020-05-30 05:09:26,330 - root - INFO - | Epoch: 084/150 | Train Time: 4.287s | Train Loss: 0.048964 |
2020-05-30 05:09:29,922 - root - INFO - | Epoch: 085/150 | Train Time: 3.592s | Train Loss: 0.049495 |
2020-05-30 05:09:33,645 - root - INFO - | Epoch: 086/150 | Train Time: 3.722s | Train Loss: 0.050789 |
2020-05-30 05:09:36,921 - root - INFO - | Epoch: 087/150 | Train Time: 3.276s | Train Loss: 0.049764 |
2020-05-30 05:09:40,376 - root - INFO - | Epoch: 088/150 | Train Time: 3.455s | Train Loss: 0.050442 |
2020-05-30 05:09:43,642 - root - INFO - | Epoch: 089/150 | Train Time: 3.265s | Train Loss: 0.050193 |
2020-05-30 05:09:47,538 - root - INFO - | Epoch: 090/150 | Train Time: 3.892s | Train Loss: 0.049233 |
2020-05-30 05:09:51,523 - root - INFO - | Epoch: 091/150 | Train Time: 3.983s | Train Loss: 0.051061 |
2020-05-30 05:09:54,564 - root - INFO - | Epoch: 092/150 | Train Time: 3.041s | Train Loss: 0.049491 |
2020-05-30 05:09:58,010 - root - INFO - | Epoch: 093/150 | Train Time: 3.446s | Train Loss: 0.050539 |
2020-05-30 05:10:01,451 - root - INFO - | Epoch: 094/150 | Train Time: 3.440s | Train Loss: 0.049890 |
2020-05-30 05:10:04,665 - root - INFO - | Epoch: 095/150 | Train Time: 3.214s | Train Loss: 0.049899 |
2020-05-30 05:10:08,162 - root - INFO - | Epoch: 096/150 | Train Time: 3.496s | Train Loss: 0.049841 |
2020-05-30 05:10:11,860 - root - INFO - | Epoch: 097/150 | Train Time: 3.697s | Train Loss: 0.049145 |
2020-05-30 05:10:15,879 - root - INFO - | Epoch: 098/150 | Train Time: 4.019s | Train Loss: 0.048998 |
2020-05-30 05:10:19,991 - root - INFO - | Epoch: 099/150 | Train Time: 4.111s | Train Loss: 0.048169 |
2020-05-30 05:10:24,057 - root - INFO - | Epoch: 100/150 | Train Time: 4.066s | Train Loss: 0.050634 |
2020-05-30 05:10:28,325 - root - INFO - | Epoch: 101/150 | Train Time: 4.267s | Train Loss: 0.047946 |
2020-05-30 05:10:32,599 - root - INFO - | Epoch: 102/150 | Train Time: 4.273s | Train Loss: 0.048256 |
2020-05-30 05:10:36,752 - root - INFO - | Epoch: 103/150 | Train Time: 4.153s | Train Loss: 0.047462 |
2020-05-30 05:10:40,429 - root - INFO - | Epoch: 104/150 | Train Time: 3.676s | Train Loss: 0.047222 |
2020-05-30 05:10:44,589 - root - INFO - | Epoch: 105/150 | Train Time: 4.159s | Train Loss: 0.050082 |
2020-05-30 05:10:48,592 - root - INFO - | Epoch: 106/150 | Train Time: 4.002s | Train Loss: 0.047401 |
2020-05-30 05:10:52,312 - root - INFO - | Epoch: 107/150 | Train Time: 3.720s | Train Loss: 0.049301 |
2020-05-30 05:10:56,247 - root - INFO - | Epoch: 108/150 | Train Time: 3.934s | Train Loss: 0.047060 |
2020-05-30 05:11:00,623 - root - INFO - | Epoch: 109/150 | Train Time: 4.376s | Train Loss: 0.047512 |
2020-05-30 05:11:04,701 - root - INFO - | Epoch: 110/150 | Train Time: 4.077s | Train Loss: 0.047817 |
2020-05-30 05:11:08,878 - root - INFO - | Epoch: 111/150 | Train Time: 4.177s | Train Loss: 0.046181 |
2020-05-30 05:11:13,168 - root - INFO - | Epoch: 112/150 | Train Time: 4.289s | Train Loss: 0.046062 |
2020-05-30 05:11:17,410 - root - INFO - | Epoch: 113/150 | Train Time: 4.242s | Train Loss: 0.046784 |
2020-05-30 05:11:21,538 - root - INFO - | Epoch: 114/150 | Train Time: 4.127s | Train Loss: 0.045599 |
2020-05-30 05:11:25,698 - root - INFO - | Epoch: 115/150 | Train Time: 4.159s | Train Loss: 0.046696 |
2020-05-30 05:11:29,730 - root - INFO - | Epoch: 116/150 | Train Time: 4.032s | Train Loss: 0.046412 |
2020-05-30 05:11:33,500 - root - INFO - | Epoch: 117/150 | Train Time: 3.770s | Train Loss: 0.046135 |
2020-05-30 05:11:37,063 - root - INFO - | Epoch: 118/150 | Train Time: 3.562s | Train Loss: 0.045901 |
2020-05-30 05:11:41,140 - root - INFO - | Epoch: 119/150 | Train Time: 4.076s | Train Loss: 0.047333 |
2020-05-30 05:11:44,828 - root - INFO - | Epoch: 120/150 | Train Time: 3.688s | Train Loss: 0.047171 |
2020-05-30 05:11:49,156 - root - INFO - | Epoch: 121/150 | Train Time: 4.328s | Train Loss: 0.045801 |
2020-05-30 05:11:52,592 - root - INFO - | Epoch: 122/150 | Train Time: 3.436s | Train Loss: 0.046460 |
2020-05-30 05:11:56,158 - root - INFO - | Epoch: 123/150 | Train Time: 3.565s | Train Loss: 0.046369 |
2020-05-30 05:12:00,582 - root - INFO - | Epoch: 124/150 | Train Time: 4.423s | Train Loss: 0.045077 |
2020-05-30 05:12:04,357 - root - INFO - | Epoch: 125/150 | Train Time: 3.775s | Train Loss: 0.048170 |
2020-05-30 05:12:08,079 - root - INFO - | Epoch: 126/150 | Train Time: 3.721s | Train Loss: 0.045305 |
2020-05-30 05:12:12,202 - root - INFO - | Epoch: 127/150 | Train Time: 4.123s | Train Loss: 0.045014 |
2020-05-30 05:12:16,611 - root - INFO - | Epoch: 128/150 | Train Time: 4.409s | Train Loss: 0.045792 |
2020-05-30 05:12:20,731 - root - INFO - | Epoch: 129/150 | Train Time: 4.120s | Train Loss: 0.045763 |
2020-05-30 05:12:24,346 - root - INFO - | Epoch: 130/150 | Train Time: 3.613s | Train Loss: 0.044310 |
2020-05-30 05:12:27,837 - root - INFO - | Epoch: 131/150 | Train Time: 3.491s | Train Loss: 0.044599 |
2020-05-30 05:12:30,803 - root - INFO - | Epoch: 132/150 | Train Time: 2.965s | Train Loss: 0.044806 |
2020-05-30 05:12:33,887 - root - INFO - | Epoch: 133/150 | Train Time: 3.084s | Train Loss: 0.044208 |
2020-05-30 05:12:36,992 - root - INFO - | Epoch: 134/150 | Train Time: 3.104s | Train Loss: 0.045713 |
2020-05-30 05:12:40,327 - root - INFO - | Epoch: 135/150 | Train Time: 3.335s | Train Loss: 0.043548 |
2020-05-30 05:12:43,836 - root - INFO - | Epoch: 136/150 | Train Time: 3.509s | Train Loss: 0.044404 |
2020-05-30 05:12:47,831 - root - INFO - | Epoch: 137/150 | Train Time: 3.994s | Train Loss: 0.043956 |
2020-05-30 05:12:51,995 - root - INFO - | Epoch: 138/150 | Train Time: 4.164s | Train Loss: 0.044271 |
2020-05-30 05:12:55,940 - root - INFO - | Epoch: 139/150 | Train Time: 3.944s | Train Loss: 0.044463 |
2020-05-30 05:13:00,202 - root - INFO - | Epoch: 140/150 | Train Time: 4.262s | Train Loss: 0.042665 |
2020-05-30 05:13:03,999 - root - INFO - | Epoch: 141/150 | Train Time: 3.796s | Train Loss: 0.042688 |
2020-05-30 05:13:07,843 - root - INFO - | Epoch: 142/150 | Train Time: 3.843s | Train Loss: 0.044075 |
2020-05-30 05:13:11,384 - root - INFO - | Epoch: 143/150 | Train Time: 3.540s | Train Loss: 0.043044 |
2020-05-30 05:13:14,738 - root - INFO - | Epoch: 144/150 | Train Time: 3.353s | Train Loss: 0.042454 |
2020-05-30 05:13:18,404 - root - INFO - | Epoch: 145/150 | Train Time: 3.666s | Train Loss: 0.043298 |
2020-05-30 05:13:22,426 - root - INFO - | Epoch: 146/150 | Train Time: 4.021s | Train Loss: 0.042979 |
2020-05-30 05:13:26,602 - root - INFO - | Epoch: 147/150 | Train Time: 4.176s | Train Loss: 0.041643 |
2020-05-30 05:13:30,580 - root - INFO - | Epoch: 148/150 | Train Time: 3.978s | Train Loss: 0.041998 |
2020-05-30 05:13:34,436 - root - INFO - | Epoch: 149/150 | Train Time: 3.855s | Train Loss: 0.042397 |
2020-05-30 05:13:38,865 - root - INFO - | Epoch: 150/150 | Train Time: 4.428s | Train Loss: 0.042642 |
2020-05-30 05:13:38,865 - root - INFO - Training Time: 598.200s
2020-05-30 05:13:38,865 - root - INFO - Finished training.
2020-05-30 05:13:38,866 - root - INFO - Starting testing...
2020-05-30 05:13:43,226 - root - INFO - Test Loss: 0.326215
2020-05-30 05:13:43,227 - root - INFO - Test AUC: 82.79%
2020-05-30 05:13:43,227 - root - INFO - Test Time: 4.348s
2020-05-30 05:13:43,227 - root - INFO - Finished testing.
