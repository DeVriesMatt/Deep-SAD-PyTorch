2020-05-30 06:19:47,733 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_2_7_01.txt
2020-05-30 06:19:47,733 - root - INFO - Data path is ../data
2020-05-30 06:19:47,733 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 06:19:47,733 - root - INFO - Dataset: fmnist
2020-05-30 06:19:47,733 - root - INFO - Normal class: 2
2020-05-30 06:19:47,733 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 06:19:47,733 - root - INFO - Ratio of labeled anomalous samples: 0.10
2020-05-30 06:19:47,733 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 06:19:47,734 - root - INFO - Scenario Running: 1
2020-05-30 06:19:47,734 - root - INFO - Train only the network: True
2020-05-30 06:19:47,734 - root - INFO - Output and AE dimensions: 128
2020-05-30 06:19:47,734 - root - INFO - Known anomaly class: 7
2020-05-30 06:19:47,734 - root - INFO - Network: fmnist_LeNet
2020-05-30 06:19:47,734 - root - INFO - Eta-parameter: 1.00
2020-05-30 06:19:47,769 - root - INFO - Set seed to 0.
2020-05-30 06:19:47,844 - root - INFO - Computation device: cuda
2020-05-30 06:19:47,845 - root - INFO - Number of threads: 0
2020-05-30 06:19:47,846 - root - INFO - Number of dataloader workers: 6
2020-05-30 06:20:01,820 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 06:20:01,852 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 06:20:01,853 - root - INFO - Pretraining: True
2020-05-30 06:20:01,853 - root - INFO - Training optimizer: adam
2020-05-30 06:20:01,853 - root - INFO - Training learning rate: 0.0001
2020-05-30 06:20:01,853 - root - INFO - Training epochs: 150
2020-05-30 06:20:01,853 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 06:20:01,853 - root - INFO - Training batch size: 200
2020-05-30 06:20:01,853 - root - INFO - Training weight decay: 5e-07
2020-05-30 06:20:01,856 - root - INFO - Starting training...
2020-05-30 06:20:15,384 - root - INFO - | Epoch: 001/150 | Train Time: 13.528s | Train Loss: 1.691818 |
2020-05-30 06:20:19,601 - root - INFO - | Epoch: 002/150 | Train Time: 4.217s | Train Loss: 0.493639 |
2020-05-30 06:20:23,842 - root - INFO - | Epoch: 003/150 | Train Time: 4.240s | Train Loss: 0.330902 |
2020-05-30 06:20:28,240 - root - INFO - | Epoch: 004/150 | Train Time: 4.398s | Train Loss: 0.256329 |
2020-05-30 06:20:32,104 - root - INFO - | Epoch: 005/150 | Train Time: 3.863s | Train Loss: 0.220461 |
2020-05-30 06:20:35,914 - root - INFO - | Epoch: 006/150 | Train Time: 3.810s | Train Loss: 0.187734 |
2020-05-30 06:20:39,943 - root - INFO - | Epoch: 007/150 | Train Time: 4.028s | Train Loss: 0.172530 |
2020-05-30 06:20:43,787 - root - INFO - | Epoch: 008/150 | Train Time: 3.843s | Train Loss: 0.156754 |
2020-05-30 06:20:47,615 - root - INFO - | Epoch: 009/150 | Train Time: 3.828s | Train Loss: 0.149936 |
2020-05-30 06:20:52,115 - root - INFO - | Epoch: 010/150 | Train Time: 4.500s | Train Loss: 0.138805 |
2020-05-30 06:20:56,475 - root - INFO - | Epoch: 011/150 | Train Time: 4.359s | Train Loss: 0.134118 |
2020-05-30 06:21:00,314 - root - INFO - | Epoch: 012/150 | Train Time: 3.838s | Train Loss: 0.128747 |
2020-05-30 06:21:04,198 - root - INFO - | Epoch: 013/150 | Train Time: 3.883s | Train Loss: 0.126872 |
2020-05-30 06:21:07,982 - root - INFO - | Epoch: 014/150 | Train Time: 3.783s | Train Loss: 0.118447 |
2020-05-30 06:21:11,473 - root - INFO - | Epoch: 015/150 | Train Time: 3.491s | Train Loss: 0.116419 |
2020-05-30 06:21:15,053 - root - INFO - | Epoch: 016/150 | Train Time: 3.579s | Train Loss: 0.111958 |
2020-05-30 06:21:18,618 - root - INFO - | Epoch: 017/150 | Train Time: 3.564s | Train Loss: 0.109701 |
2020-05-30 06:21:21,430 - root - INFO - | Epoch: 018/150 | Train Time: 2.811s | Train Loss: 0.107554 |
2020-05-30 06:21:24,810 - root - INFO - | Epoch: 019/150 | Train Time: 3.380s | Train Loss: 0.103049 |
2020-05-30 06:21:28,271 - root - INFO - | Epoch: 020/150 | Train Time: 3.461s | Train Loss: 0.099668 |
2020-05-30 06:21:32,525 - root - INFO - | Epoch: 021/150 | Train Time: 4.253s | Train Loss: 0.102253 |
2020-05-30 06:21:36,201 - root - INFO - | Epoch: 022/150 | Train Time: 3.675s | Train Loss: 0.099145 |
2020-05-30 06:21:39,847 - root - INFO - | Epoch: 023/150 | Train Time: 3.646s | Train Loss: 0.097743 |
2020-05-30 06:21:43,103 - root - INFO - | Epoch: 024/150 | Train Time: 3.255s | Train Loss: 0.095162 |
2020-05-30 06:21:46,378 - root - INFO - | Epoch: 025/150 | Train Time: 3.274s | Train Loss: 0.093809 |
2020-05-30 06:21:49,925 - root - INFO - | Epoch: 026/150 | Train Time: 3.547s | Train Loss: 0.090143 |
2020-05-30 06:21:53,397 - root - INFO - | Epoch: 027/150 | Train Time: 3.471s | Train Loss: 0.088763 |
2020-05-30 06:21:56,532 - root - INFO - | Epoch: 028/150 | Train Time: 3.135s | Train Loss: 0.088908 |
2020-05-30 06:22:00,158 - root - INFO - | Epoch: 029/150 | Train Time: 3.626s | Train Loss: 0.088543 |
2020-05-30 06:22:04,061 - root - INFO - | Epoch: 030/150 | Train Time: 3.902s | Train Loss: 0.086405 |
2020-05-30 06:22:08,147 - root - INFO - | Epoch: 031/150 | Train Time: 4.086s | Train Loss: 0.089525 |
2020-05-30 06:22:12,258 - root - INFO - | Epoch: 032/150 | Train Time: 4.111s | Train Loss: 0.082196 |
2020-05-30 06:22:16,636 - root - INFO - | Epoch: 033/150 | Train Time: 4.378s | Train Loss: 0.081561 |
2020-05-30 06:22:20,831 - root - INFO - | Epoch: 034/150 | Train Time: 4.194s | Train Loss: 0.080679 |
2020-05-30 06:22:25,465 - root - INFO - | Epoch: 035/150 | Train Time: 4.633s | Train Loss: 0.083524 |
2020-05-30 06:22:29,732 - root - INFO - | Epoch: 036/150 | Train Time: 4.266s | Train Loss: 0.080540 |
2020-05-30 06:22:34,149 - root - INFO - | Epoch: 037/150 | Train Time: 4.416s | Train Loss: 0.077413 |
2020-05-30 06:22:38,549 - root - INFO - | Epoch: 038/150 | Train Time: 4.400s | Train Loss: 0.079422 |
2020-05-30 06:22:42,313 - root - INFO - | Epoch: 039/150 | Train Time: 3.763s | Train Loss: 0.073251 |
2020-05-30 06:22:46,637 - root - INFO - | Epoch: 040/150 | Train Time: 4.323s | Train Loss: 0.070671 |
2020-05-30 06:22:50,689 - root - INFO - | Epoch: 041/150 | Train Time: 4.052s | Train Loss: 0.073602 |
2020-05-30 06:22:55,030 - root - INFO - | Epoch: 042/150 | Train Time: 4.341s | Train Loss: 0.071911 |
2020-05-30 06:22:59,250 - root - INFO - | Epoch: 043/150 | Train Time: 4.219s | Train Loss: 0.069858 |
2020-05-30 06:23:04,181 - root - INFO - | Epoch: 044/150 | Train Time: 4.930s | Train Loss: 0.068559 |
2020-05-30 06:23:08,824 - root - INFO - | Epoch: 045/150 | Train Time: 4.642s | Train Loss: 0.064770 |
2020-05-30 06:23:13,570 - root - INFO - | Epoch: 046/150 | Train Time: 4.745s | Train Loss: 0.065255 |
2020-05-30 06:23:18,063 - root - INFO - | Epoch: 047/150 | Train Time: 4.492s | Train Loss: 0.062423 |
2020-05-30 06:23:22,094 - root - INFO - | Epoch: 048/150 | Train Time: 4.030s | Train Loss: 0.060719 |
2020-05-30 06:23:26,441 - root - INFO - | Epoch: 049/150 | Train Time: 4.346s | Train Loss: 0.060289 |
2020-05-30 06:23:30,281 - root - INFO - | Epoch: 050/150 | Train Time: 3.839s | Train Loss: 0.058356 |
2020-05-30 06:23:30,281 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 06:23:34,200 - root - INFO - | Epoch: 051/150 | Train Time: 3.919s | Train Loss: 0.054935 |
2020-05-30 06:23:38,127 - root - INFO - | Epoch: 052/150 | Train Time: 3.926s | Train Loss: 0.055303 |
2020-05-30 06:23:42,073 - root - INFO - | Epoch: 053/150 | Train Time: 3.946s | Train Loss: 0.055591 |
2020-05-30 06:23:46,366 - root - INFO - | Epoch: 054/150 | Train Time: 4.293s | Train Loss: 0.054249 |
2020-05-30 06:23:50,669 - root - INFO - | Epoch: 055/150 | Train Time: 4.301s | Train Loss: 0.054289 |
2020-05-30 06:23:55,039 - root - INFO - | Epoch: 056/150 | Train Time: 4.369s | Train Loss: 0.053700 |
2020-05-30 06:23:59,588 - root - INFO - | Epoch: 057/150 | Train Time: 4.548s | Train Loss: 0.054957 |
2020-05-30 06:24:04,437 - root - INFO - | Epoch: 058/150 | Train Time: 4.849s | Train Loss: 0.054338 |
2020-05-30 06:24:08,479 - root - INFO - | Epoch: 059/150 | Train Time: 4.041s | Train Loss: 0.056060 |
2020-05-30 06:24:12,371 - root - INFO - | Epoch: 060/150 | Train Time: 3.892s | Train Loss: 0.052931 |
2020-05-30 06:24:16,252 - root - INFO - | Epoch: 061/150 | Train Time: 3.880s | Train Loss: 0.054775 |
2020-05-30 06:24:20,177 - root - INFO - | Epoch: 062/150 | Train Time: 3.925s | Train Loss: 0.053736 |
2020-05-30 06:24:24,636 - root - INFO - | Epoch: 063/150 | Train Time: 4.459s | Train Loss: 0.054418 |
2020-05-30 06:24:28,901 - root - INFO - | Epoch: 064/150 | Train Time: 4.264s | Train Loss: 0.054090 |
2020-05-30 06:24:33,285 - root - INFO - | Epoch: 065/150 | Train Time: 4.383s | Train Loss: 0.055991 |
2020-05-30 06:24:37,372 - root - INFO - | Epoch: 066/150 | Train Time: 4.087s | Train Loss: 0.052548 |
2020-05-30 06:24:41,811 - root - INFO - | Epoch: 067/150 | Train Time: 4.438s | Train Loss: 0.053690 |
2020-05-30 06:24:46,134 - root - INFO - | Epoch: 068/150 | Train Time: 4.323s | Train Loss: 0.053784 |
2020-05-30 06:24:50,821 - root - INFO - | Epoch: 069/150 | Train Time: 4.687s | Train Loss: 0.052683 |
2020-05-30 06:24:55,425 - root - INFO - | Epoch: 070/150 | Train Time: 4.603s | Train Loss: 0.053060 |
2020-05-30 06:24:59,530 - root - INFO - | Epoch: 071/150 | Train Time: 4.105s | Train Loss: 0.052802 |
2020-05-30 06:25:03,772 - root - INFO - | Epoch: 072/150 | Train Time: 4.242s | Train Loss: 0.050850 |
2020-05-30 06:25:07,347 - root - INFO - | Epoch: 073/150 | Train Time: 3.574s | Train Loss: 0.053204 |
2020-05-30 06:25:11,495 - root - INFO - | Epoch: 074/150 | Train Time: 4.147s | Train Loss: 0.050446 |
2020-05-30 06:25:15,423 - root - INFO - | Epoch: 075/150 | Train Time: 3.927s | Train Loss: 0.052134 |
2020-05-30 06:25:18,907 - root - INFO - | Epoch: 076/150 | Train Time: 3.484s | Train Loss: 0.049298 |
2020-05-30 06:25:22,844 - root - INFO - | Epoch: 077/150 | Train Time: 3.936s | Train Loss: 0.051029 |
2020-05-30 06:25:26,413 - root - INFO - | Epoch: 078/150 | Train Time: 3.569s | Train Loss: 0.050060 |
2020-05-30 06:25:29,975 - root - INFO - | Epoch: 079/150 | Train Time: 3.561s | Train Loss: 0.049939 |
2020-05-30 06:25:33,131 - root - INFO - | Epoch: 080/150 | Train Time: 3.155s | Train Loss: 0.050934 |
2020-05-30 06:25:36,381 - root - INFO - | Epoch: 081/150 | Train Time: 3.250s | Train Loss: 0.049732 |
2020-05-30 06:25:39,542 - root - INFO - | Epoch: 082/150 | Train Time: 3.161s | Train Loss: 0.051039 |
2020-05-30 06:25:42,767 - root - INFO - | Epoch: 083/150 | Train Time: 3.224s | Train Loss: 0.050252 |
2020-05-30 06:25:45,766 - root - INFO - | Epoch: 084/150 | Train Time: 2.999s | Train Loss: 0.050191 |
2020-05-30 06:25:49,940 - root - INFO - | Epoch: 085/150 | Train Time: 4.173s | Train Loss: 0.051348 |
2020-05-30 06:25:53,474 - root - INFO - | Epoch: 086/150 | Train Time: 3.534s | Train Loss: 0.048112 |
2020-05-30 06:25:56,627 - root - INFO - | Epoch: 087/150 | Train Time: 3.152s | Train Loss: 0.049243 |
2020-05-30 06:26:00,128 - root - INFO - | Epoch: 088/150 | Train Time: 3.500s | Train Loss: 0.050539 |
2020-05-30 06:26:03,697 - root - INFO - | Epoch: 089/150 | Train Time: 3.568s | Train Loss: 0.049925 |
2020-05-30 06:26:07,376 - root - INFO - | Epoch: 090/150 | Train Time: 3.678s | Train Loss: 0.049392 |
2020-05-30 06:26:11,497 - root - INFO - | Epoch: 091/150 | Train Time: 4.121s | Train Loss: 0.048115 |
2020-05-30 06:26:15,544 - root - INFO - | Epoch: 092/150 | Train Time: 4.046s | Train Loss: 0.050654 |
2020-05-30 06:26:19,137 - root - INFO - | Epoch: 093/150 | Train Time: 3.593s | Train Loss: 0.046374 |
2020-05-30 06:26:22,777 - root - INFO - | Epoch: 094/150 | Train Time: 3.640s | Train Loss: 0.046812 |
2020-05-30 06:26:27,013 - root - INFO - | Epoch: 095/150 | Train Time: 4.236s | Train Loss: 0.047610 |
2020-05-30 06:26:30,880 - root - INFO - | Epoch: 096/150 | Train Time: 3.865s | Train Loss: 0.048037 |
2020-05-30 06:26:34,918 - root - INFO - | Epoch: 097/150 | Train Time: 4.038s | Train Loss: 0.047342 |
2020-05-30 06:26:38,702 - root - INFO - | Epoch: 098/150 | Train Time: 3.783s | Train Loss: 0.046586 |
2020-05-30 06:26:42,817 - root - INFO - | Epoch: 099/150 | Train Time: 4.115s | Train Loss: 0.047887 |
2020-05-30 06:26:46,539 - root - INFO - | Epoch: 100/150 | Train Time: 3.721s | Train Loss: 0.047433 |
2020-05-30 06:26:49,944 - root - INFO - | Epoch: 101/150 | Train Time: 3.404s | Train Loss: 0.047199 |
2020-05-30 06:26:53,358 - root - INFO - | Epoch: 102/150 | Train Time: 3.414s | Train Loss: 0.047672 |
2020-05-30 06:26:56,799 - root - INFO - | Epoch: 103/150 | Train Time: 3.440s | Train Loss: 0.046756 |
2020-05-30 06:27:00,313 - root - INFO - | Epoch: 104/150 | Train Time: 3.513s | Train Loss: 0.045072 |
2020-05-30 06:27:04,286 - root - INFO - | Epoch: 105/150 | Train Time: 3.972s | Train Loss: 0.044440 |
2020-05-30 06:27:08,806 - root - INFO - | Epoch: 106/150 | Train Time: 4.520s | Train Loss: 0.044259 |
2020-05-30 06:27:12,619 - root - INFO - | Epoch: 107/150 | Train Time: 3.812s | Train Loss: 0.045224 |
2020-05-30 06:27:16,879 - root - INFO - | Epoch: 108/150 | Train Time: 4.260s | Train Loss: 0.045887 |
2020-05-30 06:27:20,560 - root - INFO - | Epoch: 109/150 | Train Time: 3.681s | Train Loss: 0.045215 |
2020-05-30 06:27:24,263 - root - INFO - | Epoch: 110/150 | Train Time: 3.703s | Train Loss: 0.046117 |
2020-05-30 06:27:27,790 - root - INFO - | Epoch: 111/150 | Train Time: 3.526s | Train Loss: 0.047074 |
2020-05-30 06:27:31,448 - root - INFO - | Epoch: 112/150 | Train Time: 3.658s | Train Loss: 0.045489 |
2020-05-30 06:27:35,567 - root - INFO - | Epoch: 113/150 | Train Time: 4.119s | Train Loss: 0.044655 |
2020-05-30 06:27:39,328 - root - INFO - | Epoch: 114/150 | Train Time: 3.760s | Train Loss: 0.043652 |
2020-05-30 06:27:43,651 - root - INFO - | Epoch: 115/150 | Train Time: 4.323s | Train Loss: 0.046257 |
2020-05-30 06:27:48,105 - root - INFO - | Epoch: 116/150 | Train Time: 4.454s | Train Loss: 0.045349 |
2020-05-30 06:27:52,129 - root - INFO - | Epoch: 117/150 | Train Time: 4.023s | Train Loss: 0.045642 |
2020-05-30 06:27:56,111 - root - INFO - | Epoch: 118/150 | Train Time: 3.982s | Train Loss: 0.043742 |
2020-05-30 06:28:00,295 - root - INFO - | Epoch: 119/150 | Train Time: 4.183s | Train Loss: 0.045183 |
2020-05-30 06:28:04,968 - root - INFO - | Epoch: 120/150 | Train Time: 4.672s | Train Loss: 0.042981 |
2020-05-30 06:28:09,557 - root - INFO - | Epoch: 121/150 | Train Time: 4.588s | Train Loss: 0.043103 |
2020-05-30 06:28:14,168 - root - INFO - | Epoch: 122/150 | Train Time: 4.611s | Train Loss: 0.042709 |
2020-05-30 06:28:18,891 - root - INFO - | Epoch: 123/150 | Train Time: 4.723s | Train Loss: 0.041782 |
2020-05-30 06:28:23,283 - root - INFO - | Epoch: 124/150 | Train Time: 4.391s | Train Loss: 0.041383 |
2020-05-30 06:28:27,899 - root - INFO - | Epoch: 125/150 | Train Time: 4.616s | Train Loss: 0.042450 |
2020-05-30 06:28:32,532 - root - INFO - | Epoch: 126/150 | Train Time: 4.632s | Train Loss: 0.042187 |
2020-05-30 06:28:37,033 - root - INFO - | Epoch: 127/150 | Train Time: 4.500s | Train Loss: 0.040722 |
2020-05-30 06:28:41,563 - root - INFO - | Epoch: 128/150 | Train Time: 4.529s | Train Loss: 0.040299 |
2020-05-30 06:28:46,372 - root - INFO - | Epoch: 129/150 | Train Time: 4.808s | Train Loss: 0.040592 |
2020-05-30 06:28:50,701 - root - INFO - | Epoch: 130/150 | Train Time: 4.328s | Train Loss: 0.042274 |
2020-05-30 06:28:55,194 - root - INFO - | Epoch: 131/150 | Train Time: 4.493s | Train Loss: 0.040328 |
2020-05-30 06:28:59,372 - root - INFO - | Epoch: 132/150 | Train Time: 4.177s | Train Loss: 0.040678 |
2020-05-30 06:29:03,462 - root - INFO - | Epoch: 133/150 | Train Time: 4.089s | Train Loss: 0.041089 |
2020-05-30 06:29:07,197 - root - INFO - | Epoch: 134/150 | Train Time: 3.735s | Train Loss: 0.039326 |
2020-05-30 06:29:11,335 - root - INFO - | Epoch: 135/150 | Train Time: 4.137s | Train Loss: 0.040025 |
2020-05-30 06:29:15,898 - root - INFO - | Epoch: 136/150 | Train Time: 4.562s | Train Loss: 0.040304 |
2020-05-30 06:29:20,178 - root - INFO - | Epoch: 137/150 | Train Time: 4.279s | Train Loss: 0.042661 |
2020-05-30 06:29:24,086 - root - INFO - | Epoch: 138/150 | Train Time: 3.908s | Train Loss: 0.041812 |
2020-05-30 06:29:28,306 - root - INFO - | Epoch: 139/150 | Train Time: 4.219s | Train Loss: 0.039464 |
2020-05-30 06:29:32,537 - root - INFO - | Epoch: 140/150 | Train Time: 4.231s | Train Loss: 0.039012 |
2020-05-30 06:29:36,923 - root - INFO - | Epoch: 141/150 | Train Time: 4.385s | Train Loss: 0.039156 |
2020-05-30 06:29:41,246 - root - INFO - | Epoch: 142/150 | Train Time: 4.322s | Train Loss: 0.038696 |
2020-05-30 06:29:45,920 - root - INFO - | Epoch: 143/150 | Train Time: 4.674s | Train Loss: 0.037299 |
2020-05-30 06:29:50,791 - root - INFO - | Epoch: 144/150 | Train Time: 4.870s | Train Loss: 0.040537 |
2020-05-30 06:29:55,543 - root - INFO - | Epoch: 145/150 | Train Time: 4.751s | Train Loss: 0.039221 |
2020-05-30 06:30:00,604 - root - INFO - | Epoch: 146/150 | Train Time: 5.061s | Train Loss: 0.039584 |
2020-05-30 06:30:04,981 - root - INFO - | Epoch: 147/150 | Train Time: 4.376s | Train Loss: 0.038294 |
2020-05-30 06:30:09,467 - root - INFO - | Epoch: 148/150 | Train Time: 4.486s | Train Loss: 0.038576 |
2020-05-30 06:30:13,860 - root - INFO - | Epoch: 149/150 | Train Time: 4.392s | Train Loss: 0.037815 |
2020-05-30 06:30:18,246 - root - INFO - | Epoch: 150/150 | Train Time: 4.386s | Train Loss: 0.038360 |
2020-05-30 06:30:18,247 - root - INFO - Training Time: 616.391s
2020-05-30 06:30:18,247 - root - INFO - Finished training.
2020-05-30 06:30:18,248 - root - INFO - Starting testing...
2020-05-30 06:30:22,985 - root - INFO - Test Loss: 0.855040
2020-05-30 06:30:22,986 - root - INFO - Test AUC: 80.07%
2020-05-30 06:30:22,986 - root - INFO - Test Time: 4.722s
2020-05-30 06:30:22,986 - root - INFO - Finished testing.
