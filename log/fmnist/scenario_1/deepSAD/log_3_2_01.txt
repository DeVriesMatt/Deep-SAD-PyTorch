2020-05-30 09:05:45,976 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_3_2_01.txt
2020-05-30 09:05:45,976 - root - INFO - Data path is ../data
2020-05-30 09:05:45,976 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 09:05:45,976 - root - INFO - Dataset: fmnist
2020-05-30 09:05:45,976 - root - INFO - Normal class: 3
2020-05-30 09:05:45,976 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 09:05:45,976 - root - INFO - Ratio of labeled anomalous samples: 0.10
2020-05-30 09:05:45,976 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 09:05:45,976 - root - INFO - Scenario Running: 1
2020-05-30 09:05:45,976 - root - INFO - Train only the network: True
2020-05-30 09:05:45,977 - root - INFO - Output and AE dimensions: 128
2020-05-30 09:05:45,977 - root - INFO - Known anomaly class: 2
2020-05-30 09:05:45,977 - root - INFO - Network: fmnist_LeNet
2020-05-30 09:05:45,977 - root - INFO - Eta-parameter: 1.00
2020-05-30 09:05:45,989 - root - INFO - Set seed to 0.
2020-05-30 09:05:46,046 - root - INFO - Computation device: cuda
2020-05-30 09:05:46,047 - root - INFO - Number of threads: 0
2020-05-30 09:05:46,047 - root - INFO - Number of dataloader workers: 6
2020-05-30 09:06:01,811 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 09:06:01,866 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 09:06:01,866 - root - INFO - Pretraining: True
2020-05-30 09:06:01,866 - root - INFO - Training optimizer: adam
2020-05-30 09:06:01,866 - root - INFO - Training learning rate: 0.0001
2020-05-30 09:06:01,866 - root - INFO - Training epochs: 150
2020-05-30 09:06:01,866 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 09:06:01,867 - root - INFO - Training batch size: 200
2020-05-30 09:06:01,867 - root - INFO - Training weight decay: 5e-07
2020-05-30 09:06:01,869 - root - INFO - Starting training...
2020-05-30 09:06:14,242 - root - INFO - | Epoch: 001/150 | Train Time: 12.372s | Train Loss: 1.573769 |
2020-05-30 09:06:18,334 - root - INFO - | Epoch: 002/150 | Train Time: 4.090s | Train Loss: 0.466138 |
2020-05-30 09:06:23,033 - root - INFO - | Epoch: 003/150 | Train Time: 4.699s | Train Loss: 0.343206 |
2020-05-30 09:06:26,766 - root - INFO - | Epoch: 004/150 | Train Time: 3.731s | Train Loss: 0.287670 |
2020-05-30 09:06:30,568 - root - INFO - | Epoch: 005/150 | Train Time: 3.802s | Train Loss: 0.256979 |
2020-05-30 09:06:34,615 - root - INFO - | Epoch: 006/150 | Train Time: 4.046s | Train Loss: 0.232765 |
2020-05-30 09:06:39,125 - root - INFO - | Epoch: 007/150 | Train Time: 4.509s | Train Loss: 0.220502 |
2020-05-30 09:06:43,536 - root - INFO - | Epoch: 008/150 | Train Time: 4.411s | Train Loss: 0.206725 |
2020-05-30 09:06:47,614 - root - INFO - | Epoch: 009/150 | Train Time: 4.076s | Train Loss: 0.196795 |
2020-05-30 09:06:51,678 - root - INFO - | Epoch: 010/150 | Train Time: 4.063s | Train Loss: 0.186441 |
2020-05-30 09:06:55,816 - root - INFO - | Epoch: 011/150 | Train Time: 4.138s | Train Loss: 0.181568 |
2020-05-30 09:07:00,834 - root - INFO - | Epoch: 012/150 | Train Time: 5.017s | Train Loss: 0.174753 |
2020-05-30 09:07:04,297 - root - INFO - | Epoch: 013/150 | Train Time: 3.463s | Train Loss: 0.172509 |
2020-05-30 09:07:07,492 - root - INFO - | Epoch: 014/150 | Train Time: 3.194s | Train Loss: 0.160689 |
2020-05-30 09:07:10,951 - root - INFO - | Epoch: 015/150 | Train Time: 3.459s | Train Loss: 0.159078 |
2020-05-30 09:07:14,397 - root - INFO - | Epoch: 016/150 | Train Time: 3.445s | Train Loss: 0.152946 |
2020-05-30 09:07:18,065 - root - INFO - | Epoch: 017/150 | Train Time: 3.667s | Train Loss: 0.149733 |
2020-05-30 09:07:22,156 - root - INFO - | Epoch: 018/150 | Train Time: 4.090s | Train Loss: 0.143619 |
2020-05-30 09:07:26,051 - root - INFO - | Epoch: 019/150 | Train Time: 3.895s | Train Loss: 0.138922 |
2020-05-30 09:07:29,578 - root - INFO - | Epoch: 020/150 | Train Time: 3.527s | Train Loss: 0.133600 |
2020-05-30 09:07:33,050 - root - INFO - | Epoch: 021/150 | Train Time: 3.471s | Train Loss: 0.135619 |
2020-05-30 09:07:36,973 - root - INFO - | Epoch: 022/150 | Train Time: 3.922s | Train Loss: 0.130407 |
2020-05-30 09:07:41,096 - root - INFO - | Epoch: 023/150 | Train Time: 4.122s | Train Loss: 0.127143 |
2020-05-30 09:07:45,077 - root - INFO - | Epoch: 024/150 | Train Time: 3.981s | Train Loss: 0.125888 |
2020-05-30 09:07:49,289 - root - INFO - | Epoch: 025/150 | Train Time: 4.211s | Train Loss: 0.120980 |
2020-05-30 09:07:52,871 - root - INFO - | Epoch: 026/150 | Train Time: 3.581s | Train Loss: 0.117437 |
2020-05-30 09:07:56,631 - root - INFO - | Epoch: 027/150 | Train Time: 3.760s | Train Loss: 0.116720 |
2020-05-30 09:08:00,738 - root - INFO - | Epoch: 028/150 | Train Time: 4.107s | Train Loss: 0.116607 |
2020-05-30 09:08:05,272 - root - INFO - | Epoch: 029/150 | Train Time: 4.533s | Train Loss: 0.112103 |
2020-05-30 09:08:09,603 - root - INFO - | Epoch: 030/150 | Train Time: 4.331s | Train Loss: 0.111361 |
2020-05-30 09:08:13,770 - root - INFO - | Epoch: 031/150 | Train Time: 4.166s | Train Loss: 0.109425 |
2020-05-30 09:08:18,187 - root - INFO - | Epoch: 032/150 | Train Time: 4.417s | Train Loss: 0.105583 |
2020-05-30 09:08:22,068 - root - INFO - | Epoch: 033/150 | Train Time: 3.880s | Train Loss: 0.104309 |
2020-05-30 09:08:26,089 - root - INFO - | Epoch: 034/150 | Train Time: 4.021s | Train Loss: 0.104874 |
2020-05-30 09:08:29,987 - root - INFO - | Epoch: 035/150 | Train Time: 3.897s | Train Loss: 0.096724 |
2020-05-30 09:08:33,744 - root - INFO - | Epoch: 036/150 | Train Time: 3.756s | Train Loss: 0.097130 |
2020-05-30 09:08:38,093 - root - INFO - | Epoch: 037/150 | Train Time: 4.348s | Train Loss: 0.096645 |
2020-05-30 09:08:42,630 - root - INFO - | Epoch: 038/150 | Train Time: 4.529s | Train Loss: 0.093827 |
2020-05-30 09:08:47,149 - root - INFO - | Epoch: 039/150 | Train Time: 4.519s | Train Loss: 0.088607 |
2020-05-30 09:08:51,395 - root - INFO - | Epoch: 040/150 | Train Time: 4.245s | Train Loss: 0.087665 |
2020-05-30 09:08:55,477 - root - INFO - | Epoch: 041/150 | Train Time: 4.082s | Train Loss: 0.086713 |
2020-05-30 09:09:00,202 - root - INFO - | Epoch: 042/150 | Train Time: 4.724s | Train Loss: 0.085671 |
2020-05-30 09:09:05,035 - root - INFO - | Epoch: 043/150 | Train Time: 4.832s | Train Loss: 0.083580 |
2020-05-30 09:09:10,325 - root - INFO - | Epoch: 044/150 | Train Time: 5.289s | Train Loss: 0.081715 |
2020-05-30 09:09:14,060 - root - INFO - | Epoch: 045/150 | Train Time: 3.735s | Train Loss: 0.078136 |
2020-05-30 09:09:17,600 - root - INFO - | Epoch: 046/150 | Train Time: 3.540s | Train Loss: 0.078207 |
2020-05-30 09:09:20,798 - root - INFO - | Epoch: 047/150 | Train Time: 3.198s | Train Loss: 0.075783 |
2020-05-30 09:09:24,387 - root - INFO - | Epoch: 048/150 | Train Time: 3.589s | Train Loss: 0.073019 |
2020-05-30 09:09:28,007 - root - INFO - | Epoch: 049/150 | Train Time: 3.619s | Train Loss: 0.072436 |
2020-05-30 09:09:31,825 - root - INFO - | Epoch: 050/150 | Train Time: 3.818s | Train Loss: 0.067427 |
2020-05-30 09:09:31,826 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 09:09:35,886 - root - INFO - | Epoch: 051/150 | Train Time: 4.060s | Train Loss: 0.065190 |
2020-05-30 09:09:39,597 - root - INFO - | Epoch: 052/150 | Train Time: 3.710s | Train Loss: 0.065024 |
2020-05-30 09:09:43,359 - root - INFO - | Epoch: 053/150 | Train Time: 3.762s | Train Loss: 0.064920 |
2020-05-30 09:09:47,085 - root - INFO - | Epoch: 054/150 | Train Time: 3.726s | Train Loss: 0.063693 |
2020-05-30 09:09:50,505 - root - INFO - | Epoch: 055/150 | Train Time: 3.419s | Train Loss: 0.064575 |
2020-05-30 09:09:54,137 - root - INFO - | Epoch: 056/150 | Train Time: 3.631s | Train Loss: 0.064945 |
2020-05-30 09:09:57,291 - root - INFO - | Epoch: 057/150 | Train Time: 3.154s | Train Loss: 0.065829 |
2020-05-30 09:10:00,939 - root - INFO - | Epoch: 058/150 | Train Time: 3.647s | Train Loss: 0.064579 |
2020-05-30 09:10:04,542 - root - INFO - | Epoch: 059/150 | Train Time: 3.602s | Train Loss: 0.064848 |
2020-05-30 09:10:08,527 - root - INFO - | Epoch: 060/150 | Train Time: 3.984s | Train Loss: 0.063103 |
2020-05-30 09:10:12,830 - root - INFO - | Epoch: 061/150 | Train Time: 4.302s | Train Loss: 0.064478 |
2020-05-30 09:10:17,154 - root - INFO - | Epoch: 062/150 | Train Time: 4.324s | Train Loss: 0.063216 |
2020-05-30 09:10:21,613 - root - INFO - | Epoch: 063/150 | Train Time: 4.458s | Train Loss: 0.063651 |
2020-05-30 09:10:25,873 - root - INFO - | Epoch: 064/150 | Train Time: 4.260s | Train Loss: 0.064865 |
2020-05-30 09:10:30,162 - root - INFO - | Epoch: 065/150 | Train Time: 4.288s | Train Loss: 0.063173 |
2020-05-30 09:10:34,428 - root - INFO - | Epoch: 066/150 | Train Time: 4.266s | Train Loss: 0.062906 |
2020-05-30 09:10:38,672 - root - INFO - | Epoch: 067/150 | Train Time: 4.243s | Train Loss: 0.062677 |
2020-05-30 09:10:43,677 - root - INFO - | Epoch: 068/150 | Train Time: 5.004s | Train Loss: 0.063530 |
2020-05-30 09:10:48,319 - root - INFO - | Epoch: 069/150 | Train Time: 4.641s | Train Loss: 0.063119 |
2020-05-30 09:10:52,454 - root - INFO - | Epoch: 070/150 | Train Time: 4.134s | Train Loss: 0.063008 |
2020-05-30 09:10:56,757 - root - INFO - | Epoch: 071/150 | Train Time: 4.302s | Train Loss: 0.062321 |
2020-05-30 09:11:00,558 - root - INFO - | Epoch: 072/150 | Train Time: 3.801s | Train Loss: 0.062741 |
2020-05-30 09:11:04,199 - root - INFO - | Epoch: 073/150 | Train Time: 3.641s | Train Loss: 0.062808 |
2020-05-30 09:11:08,245 - root - INFO - | Epoch: 074/150 | Train Time: 4.046s | Train Loss: 0.059381 |
2020-05-30 09:11:11,787 - root - INFO - | Epoch: 075/150 | Train Time: 3.540s | Train Loss: 0.062416 |
2020-05-30 09:11:15,762 - root - INFO - | Epoch: 076/150 | Train Time: 3.974s | Train Loss: 0.060956 |
2020-05-30 09:11:19,639 - root - INFO - | Epoch: 077/150 | Train Time: 3.876s | Train Loss: 0.061669 |
2020-05-30 09:11:23,718 - root - INFO - | Epoch: 078/150 | Train Time: 4.078s | Train Loss: 0.060163 |
2020-05-30 09:11:27,381 - root - INFO - | Epoch: 079/150 | Train Time: 3.663s | Train Loss: 0.060352 |
2020-05-30 09:11:31,064 - root - INFO - | Epoch: 080/150 | Train Time: 3.682s | Train Loss: 0.061593 |
2020-05-30 09:11:34,893 - root - INFO - | Epoch: 081/150 | Train Time: 3.828s | Train Loss: 0.060504 |
2020-05-30 09:11:38,118 - root - INFO - | Epoch: 082/150 | Train Time: 3.225s | Train Loss: 0.060799 |
2020-05-30 09:11:41,428 - root - INFO - | Epoch: 083/150 | Train Time: 3.309s | Train Loss: 0.059982 |
2020-05-30 09:11:44,954 - root - INFO - | Epoch: 084/150 | Train Time: 3.526s | Train Loss: 0.060399 |
2020-05-30 09:11:48,244 - root - INFO - | Epoch: 085/150 | Train Time: 3.289s | Train Loss: 0.061057 |
2020-05-30 09:11:52,038 - root - INFO - | Epoch: 086/150 | Train Time: 3.793s | Train Loss: 0.058254 |
2020-05-30 09:11:55,374 - root - INFO - | Epoch: 087/150 | Train Time: 3.335s | Train Loss: 0.058884 |
2020-05-30 09:11:58,982 - root - INFO - | Epoch: 088/150 | Train Time: 3.608s | Train Loss: 0.059190 |
2020-05-30 09:12:02,996 - root - INFO - | Epoch: 089/150 | Train Time: 4.013s | Train Loss: 0.061132 |
2020-05-30 09:12:07,414 - root - INFO - | Epoch: 090/150 | Train Time: 4.418s | Train Loss: 0.058371 |
2020-05-30 09:12:12,364 - root - INFO - | Epoch: 091/150 | Train Time: 4.949s | Train Loss: 0.058561 |
2020-05-30 09:12:16,740 - root - INFO - | Epoch: 092/150 | Train Time: 4.375s | Train Loss: 0.060663 |
2020-05-30 09:12:20,880 - root - INFO - | Epoch: 093/150 | Train Time: 4.139s | Train Loss: 0.057274 |
2020-05-30 09:12:25,308 - root - INFO - | Epoch: 094/150 | Train Time: 4.428s | Train Loss: 0.056907 |
2020-05-30 09:12:29,659 - root - INFO - | Epoch: 095/150 | Train Time: 4.350s | Train Loss: 0.058194 |
2020-05-30 09:12:33,754 - root - INFO - | Epoch: 096/150 | Train Time: 4.095s | Train Loss: 0.056081 |
2020-05-30 09:12:38,834 - root - INFO - | Epoch: 097/150 | Train Time: 5.080s | Train Loss: 0.057382 |
2020-05-30 09:12:43,587 - root - INFO - | Epoch: 098/150 | Train Time: 4.751s | Train Loss: 0.057092 |
2020-05-30 09:12:48,404 - root - INFO - | Epoch: 099/150 | Train Time: 4.817s | Train Loss: 0.057851 |
2020-05-30 09:12:52,965 - root - INFO - | Epoch: 100/150 | Train Time: 4.560s | Train Loss: 0.057283 |
2020-05-30 09:12:57,135 - root - INFO - | Epoch: 101/150 | Train Time: 4.169s | Train Loss: 0.056988 |
2020-05-30 09:13:01,023 - root - INFO - | Epoch: 102/150 | Train Time: 3.888s | Train Loss: 0.056422 |
2020-05-30 09:13:04,070 - root - INFO - | Epoch: 103/150 | Train Time: 3.047s | Train Loss: 0.057025 |
2020-05-30 09:13:07,506 - root - INFO - | Epoch: 104/150 | Train Time: 3.435s | Train Loss: 0.055095 |
2020-05-30 09:13:10,756 - root - INFO - | Epoch: 105/150 | Train Time: 3.249s | Train Loss: 0.055497 |
2020-05-30 09:13:14,664 - root - INFO - | Epoch: 106/150 | Train Time: 3.907s | Train Loss: 0.055377 |
2020-05-30 09:13:18,163 - root - INFO - | Epoch: 107/150 | Train Time: 3.499s | Train Loss: 0.056523 |
2020-05-30 09:13:22,276 - root - INFO - | Epoch: 108/150 | Train Time: 4.112s | Train Loss: 0.055735 |
2020-05-30 09:13:26,531 - root - INFO - | Epoch: 109/150 | Train Time: 4.254s | Train Loss: 0.055259 |
2020-05-30 09:13:30,659 - root - INFO - | Epoch: 110/150 | Train Time: 4.127s | Train Loss: 0.054523 |
2020-05-30 09:13:34,665 - root - INFO - | Epoch: 111/150 | Train Time: 4.005s | Train Loss: 0.058058 |
2020-05-30 09:13:38,374 - root - INFO - | Epoch: 112/150 | Train Time: 3.709s | Train Loss: 0.054350 |
2020-05-30 09:13:41,740 - root - INFO - | Epoch: 113/150 | Train Time: 3.364s | Train Loss: 0.053790 |
2020-05-30 09:13:45,084 - root - INFO - | Epoch: 114/150 | Train Time: 3.344s | Train Loss: 0.053557 |
2020-05-30 09:13:48,834 - root - INFO - | Epoch: 115/150 | Train Time: 3.750s | Train Loss: 0.055299 |
2020-05-30 09:13:52,492 - root - INFO - | Epoch: 116/150 | Train Time: 3.657s | Train Loss: 0.055052 |
2020-05-30 09:13:56,181 - root - INFO - | Epoch: 117/150 | Train Time: 3.689s | Train Loss: 0.056411 |
2020-05-30 09:14:00,022 - root - INFO - | Epoch: 118/150 | Train Time: 3.840s | Train Loss: 0.052914 |
2020-05-30 09:14:04,038 - root - INFO - | Epoch: 119/150 | Train Time: 4.016s | Train Loss: 0.054696 |
2020-05-30 09:14:07,753 - root - INFO - | Epoch: 120/150 | Train Time: 3.714s | Train Loss: 0.051554 |
2020-05-30 09:14:11,806 - root - INFO - | Epoch: 121/150 | Train Time: 4.052s | Train Loss: 0.054150 |
2020-05-30 09:14:14,995 - root - INFO - | Epoch: 122/150 | Train Time: 3.189s | Train Loss: 0.053303 |
2020-05-30 09:14:18,578 - root - INFO - | Epoch: 123/150 | Train Time: 3.582s | Train Loss: 0.052310 |
2020-05-30 09:14:22,383 - root - INFO - | Epoch: 124/150 | Train Time: 3.804s | Train Loss: 0.052882 |
2020-05-30 09:14:26,912 - root - INFO - | Epoch: 125/150 | Train Time: 4.529s | Train Loss: 0.051708 |
2020-05-30 09:14:31,122 - root - INFO - | Epoch: 126/150 | Train Time: 4.209s | Train Loss: 0.053800 |
2020-05-30 09:14:34,911 - root - INFO - | Epoch: 127/150 | Train Time: 3.788s | Train Loss: 0.050476 |
2020-05-30 09:14:38,930 - root - INFO - | Epoch: 128/150 | Train Time: 4.019s | Train Loss: 0.050721 |
2020-05-30 09:14:42,836 - root - INFO - | Epoch: 129/150 | Train Time: 3.904s | Train Loss: 0.051788 |
2020-05-30 09:14:45,943 - root - INFO - | Epoch: 130/150 | Train Time: 3.106s | Train Loss: 0.052060 |
2020-05-30 09:14:49,373 - root - INFO - | Epoch: 131/150 | Train Time: 3.429s | Train Loss: 0.050309 |
2020-05-30 09:14:53,108 - root - INFO - | Epoch: 132/150 | Train Time: 3.734s | Train Loss: 0.051063 |
2020-05-30 09:14:56,418 - root - INFO - | Epoch: 133/150 | Train Time: 3.310s | Train Loss: 0.051369 |
2020-05-30 09:14:59,714 - root - INFO - | Epoch: 134/150 | Train Time: 3.296s | Train Loss: 0.048428 |
2020-05-30 09:15:03,219 - root - INFO - | Epoch: 135/150 | Train Time: 3.504s | Train Loss: 0.050346 |
2020-05-30 09:15:06,731 - root - INFO - | Epoch: 136/150 | Train Time: 3.512s | Train Loss: 0.050590 |
2020-05-30 09:15:10,001 - root - INFO - | Epoch: 137/150 | Train Time: 3.269s | Train Loss: 0.050363 |
2020-05-30 09:15:13,177 - root - INFO - | Epoch: 138/150 | Train Time: 3.175s | Train Loss: 0.050685 |
2020-05-30 09:15:16,720 - root - INFO - | Epoch: 139/150 | Train Time: 3.543s | Train Loss: 0.049107 |
2020-05-30 09:15:20,146 - root - INFO - | Epoch: 140/150 | Train Time: 3.425s | Train Loss: 0.049742 |
2020-05-30 09:15:24,395 - root - INFO - | Epoch: 141/150 | Train Time: 4.248s | Train Loss: 0.048581 |
2020-05-30 09:15:28,525 - root - INFO - | Epoch: 142/150 | Train Time: 4.130s | Train Loss: 0.049510 |
2020-05-30 09:15:32,074 - root - INFO - | Epoch: 143/150 | Train Time: 3.548s | Train Loss: 0.048404 |
2020-05-30 09:15:35,847 - root - INFO - | Epoch: 144/150 | Train Time: 3.773s | Train Loss: 0.049871 |
2020-05-30 09:15:39,317 - root - INFO - | Epoch: 145/150 | Train Time: 3.469s | Train Loss: 0.048516 |
2020-05-30 09:15:42,752 - root - INFO - | Epoch: 146/150 | Train Time: 3.434s | Train Loss: 0.047996 |
2020-05-30 09:15:45,920 - root - INFO - | Epoch: 147/150 | Train Time: 3.168s | Train Loss: 0.047867 |
2020-05-30 09:15:49,260 - root - INFO - | Epoch: 148/150 | Train Time: 3.339s | Train Loss: 0.048818 |
2020-05-30 09:15:53,212 - root - INFO - | Epoch: 149/150 | Train Time: 3.952s | Train Loss: 0.047371 |
2020-05-30 09:15:57,236 - root - INFO - | Epoch: 150/150 | Train Time: 4.024s | Train Loss: 0.047274 |
2020-05-30 09:15:57,237 - root - INFO - Training Time: 595.367s
2020-05-30 09:15:57,237 - root - INFO - Finished training.
2020-05-30 09:15:57,238 - root - INFO - Starting testing...
2020-05-30 09:16:01,494 - root - INFO - Test Loss: 0.940550
2020-05-30 09:16:01,495 - root - INFO - Test AUC: 77.77%
2020-05-30 09:16:01,495 - root - INFO - Test Time: 4.238s
2020-05-30 09:16:01,495 - root - INFO - Finished testing.
