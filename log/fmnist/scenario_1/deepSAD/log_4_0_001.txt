2020-05-30 15:52:31,803 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_4_0_001.txt
2020-05-30 15:52:31,803 - root - INFO - Data path is ../data
2020-05-30 15:52:31,803 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 15:52:31,803 - root - INFO - Dataset: fmnist
2020-05-30 15:52:31,803 - root - INFO - Normal class: 4
2020-05-30 15:52:31,804 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 15:52:31,804 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-30 15:52:31,804 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 15:52:31,804 - root - INFO - Scenario Running: 1
2020-05-30 15:52:31,804 - root - INFO - Train only the network: True
2020-05-30 15:52:31,804 - root - INFO - Output and AE dimensions: 128
2020-05-30 15:52:31,804 - root - INFO - Known anomaly class: 0
2020-05-30 15:52:31,804 - root - INFO - Network: fmnist_LeNet
2020-05-30 15:52:31,804 - root - INFO - Eta-parameter: 1.00
2020-05-30 15:52:31,823 - root - INFO - Set seed to 0.
2020-05-30 15:52:31,857 - root - INFO - Computation device: cuda
2020-05-30 15:52:31,858 - root - INFO - Number of threads: 0
2020-05-30 15:52:31,858 - root - INFO - Number of dataloader workers: 6
2020-05-30 15:52:42,959 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 15:52:42,971 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 15:52:42,971 - root - INFO - Pretraining: True
2020-05-30 15:52:42,971 - root - INFO - Training optimizer: adam
2020-05-30 15:52:42,971 - root - INFO - Training learning rate: 0.0001
2020-05-30 15:52:42,971 - root - INFO - Training epochs: 150
2020-05-30 15:52:42,972 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 15:52:42,972 - root - INFO - Training batch size: 200
2020-05-30 15:52:42,972 - root - INFO - Training weight decay: 5e-07
2020-05-30 15:52:42,974 - root - INFO - Starting training...
2020-05-30 15:52:52,120 - root - INFO - | Epoch: 001/150 | Train Time: 9.146s | Train Loss: 2.046779 |
2020-05-30 15:52:54,537 - root - INFO - | Epoch: 002/150 | Train Time: 2.415s | Train Loss: 0.511083 |
2020-05-30 15:52:57,328 - root - INFO - | Epoch: 003/150 | Train Time: 2.791s | Train Loss: 0.314974 |
2020-05-30 15:52:59,590 - root - INFO - | Epoch: 004/150 | Train Time: 2.262s | Train Loss: 0.248561 |
2020-05-30 15:53:01,333 - root - INFO - | Epoch: 005/150 | Train Time: 1.743s | Train Loss: 0.199069 |
2020-05-30 15:53:03,670 - root - INFO - | Epoch: 006/150 | Train Time: 2.336s | Train Loss: 0.163429 |
2020-05-30 15:53:06,333 - root - INFO - | Epoch: 007/150 | Train Time: 2.663s | Train Loss: 0.148205 |
2020-05-30 15:53:08,690 - root - INFO - | Epoch: 008/150 | Train Time: 2.357s | Train Loss: 0.131986 |
2020-05-30 15:53:11,527 - root - INFO - | Epoch: 009/150 | Train Time: 2.836s | Train Loss: 0.122173 |
2020-05-30 15:53:14,819 - root - INFO - | Epoch: 010/150 | Train Time: 3.292s | Train Loss: 0.110195 |
2020-05-30 15:53:17,631 - root - INFO - | Epoch: 011/150 | Train Time: 2.801s | Train Loss: 0.102355 |
2020-05-30 15:53:20,397 - root - INFO - | Epoch: 012/150 | Train Time: 2.765s | Train Loss: 0.096176 |
2020-05-30 15:53:23,188 - root - INFO - | Epoch: 013/150 | Train Time: 2.790s | Train Loss: 0.090696 |
2020-05-30 15:53:26,193 - root - INFO - | Epoch: 014/150 | Train Time: 3.004s | Train Loss: 0.086224 |
2020-05-30 15:53:29,130 - root - INFO - | Epoch: 015/150 | Train Time: 2.937s | Train Loss: 0.082386 |
2020-05-30 15:53:32,014 - root - INFO - | Epoch: 016/150 | Train Time: 2.884s | Train Loss: 0.077330 |
2020-05-30 15:53:34,875 - root - INFO - | Epoch: 017/150 | Train Time: 2.861s | Train Loss: 0.073450 |
2020-05-30 15:53:37,339 - root - INFO - | Epoch: 018/150 | Train Time: 2.464s | Train Loss: 0.072486 |
2020-05-30 15:53:40,056 - root - INFO - | Epoch: 019/150 | Train Time: 2.716s | Train Loss: 0.068889 |
2020-05-30 15:53:42,652 - root - INFO - | Epoch: 020/150 | Train Time: 2.595s | Train Loss: 0.067321 |
2020-05-30 15:53:45,448 - root - INFO - | Epoch: 021/150 | Train Time: 2.796s | Train Loss: 0.065512 |
2020-05-30 15:53:47,974 - root - INFO - | Epoch: 022/150 | Train Time: 2.525s | Train Loss: 0.062832 |
2020-05-30 15:53:50,348 - root - INFO - | Epoch: 023/150 | Train Time: 2.374s | Train Loss: 0.059724 |
2020-05-30 15:53:52,985 - root - INFO - | Epoch: 024/150 | Train Time: 2.637s | Train Loss: 0.059183 |
2020-05-30 15:53:55,402 - root - INFO - | Epoch: 025/150 | Train Time: 2.416s | Train Loss: 0.057589 |
2020-05-30 15:53:57,853 - root - INFO - | Epoch: 026/150 | Train Time: 2.450s | Train Loss: 0.057521 |
2020-05-30 15:54:00,283 - root - INFO - | Epoch: 027/150 | Train Time: 2.429s | Train Loss: 0.055693 |
2020-05-30 15:54:02,738 - root - INFO - | Epoch: 028/150 | Train Time: 2.455s | Train Loss: 0.051614 |
2020-05-30 15:54:05,025 - root - INFO - | Epoch: 029/150 | Train Time: 2.287s | Train Loss: 0.053341 |
2020-05-30 15:54:07,611 - root - INFO - | Epoch: 030/150 | Train Time: 2.585s | Train Loss: 0.052720 |
2020-05-30 15:54:10,110 - root - INFO - | Epoch: 031/150 | Train Time: 2.499s | Train Loss: 0.051930 |
2020-05-30 15:54:12,724 - root - INFO - | Epoch: 032/150 | Train Time: 2.613s | Train Loss: 0.048371 |
2020-05-30 15:54:15,815 - root - INFO - | Epoch: 033/150 | Train Time: 3.090s | Train Loss: 0.049147 |
2020-05-30 15:54:18,516 - root - INFO - | Epoch: 034/150 | Train Time: 2.701s | Train Loss: 0.047003 |
2020-05-30 15:54:21,250 - root - INFO - | Epoch: 035/150 | Train Time: 2.733s | Train Loss: 0.047770 |
2020-05-30 15:54:23,659 - root - INFO - | Epoch: 036/150 | Train Time: 2.409s | Train Loss: 0.046203 |
2020-05-30 15:54:26,966 - root - INFO - | Epoch: 037/150 | Train Time: 3.306s | Train Loss: 0.044500 |
2020-05-30 15:54:29,125 - root - INFO - | Epoch: 038/150 | Train Time: 2.158s | Train Loss: 0.046178 |
2020-05-30 15:54:31,704 - root - INFO - | Epoch: 039/150 | Train Time: 2.579s | Train Loss: 0.045030 |
2020-05-30 15:54:34,381 - root - INFO - | Epoch: 040/150 | Train Time: 2.676s | Train Loss: 0.044631 |
2020-05-30 15:54:37,475 - root - INFO - | Epoch: 041/150 | Train Time: 3.094s | Train Loss: 0.042669 |
2020-05-30 15:54:40,473 - root - INFO - | Epoch: 042/150 | Train Time: 2.997s | Train Loss: 0.041912 |
2020-05-30 15:54:43,475 - root - INFO - | Epoch: 043/150 | Train Time: 3.002s | Train Loss: 0.041135 |
2020-05-30 15:54:46,344 - root - INFO - | Epoch: 044/150 | Train Time: 2.868s | Train Loss: 0.041584 |
2020-05-30 15:54:49,103 - root - INFO - | Epoch: 045/150 | Train Time: 2.758s | Train Loss: 0.039630 |
2020-05-30 15:54:52,092 - root - INFO - | Epoch: 046/150 | Train Time: 2.989s | Train Loss: 0.039851 |
2020-05-30 15:54:54,994 - root - INFO - | Epoch: 047/150 | Train Time: 2.901s | Train Loss: 0.038054 |
2020-05-30 15:54:57,767 - root - INFO - | Epoch: 048/150 | Train Time: 2.773s | Train Loss: 0.039387 |
2020-05-30 15:55:01,072 - root - INFO - | Epoch: 049/150 | Train Time: 3.305s | Train Loss: 0.039298 |
2020-05-30 15:55:04,162 - root - INFO - | Epoch: 050/150 | Train Time: 3.089s | Train Loss: 0.036278 |
2020-05-30 15:55:04,162 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 15:55:07,349 - root - INFO - | Epoch: 051/150 | Train Time: 3.187s | Train Loss: 0.035783 |
2020-05-30 15:55:11,054 - root - INFO - | Epoch: 052/150 | Train Time: 3.704s | Train Loss: 0.035944 |
2020-05-30 15:55:14,593 - root - INFO - | Epoch: 053/150 | Train Time: 3.538s | Train Loss: 0.035104 |
2020-05-30 15:55:17,791 - root - INFO - | Epoch: 054/150 | Train Time: 3.198s | Train Loss: 0.035370 |
2020-05-30 15:55:20,863 - root - INFO - | Epoch: 055/150 | Train Time: 3.071s | Train Loss: 0.036236 |
2020-05-30 15:55:23,871 - root - INFO - | Epoch: 056/150 | Train Time: 3.008s | Train Loss: 0.035351 |
2020-05-30 15:55:27,144 - root - INFO - | Epoch: 057/150 | Train Time: 3.273s | Train Loss: 0.035156 |
2020-05-30 15:55:29,766 - root - INFO - | Epoch: 058/150 | Train Time: 2.622s | Train Loss: 0.036484 |
2020-05-30 15:55:32,698 - root - INFO - | Epoch: 059/150 | Train Time: 2.931s | Train Loss: 0.035292 |
2020-05-30 15:55:35,284 - root - INFO - | Epoch: 060/150 | Train Time: 2.585s | Train Loss: 0.034487 |
2020-05-30 15:55:38,150 - root - INFO - | Epoch: 061/150 | Train Time: 2.866s | Train Loss: 0.036240 |
2020-05-30 15:55:41,014 - root - INFO - | Epoch: 062/150 | Train Time: 2.863s | Train Loss: 0.035641 |
2020-05-30 15:55:43,848 - root - INFO - | Epoch: 063/150 | Train Time: 2.834s | Train Loss: 0.034643 |
2020-05-30 15:55:46,531 - root - INFO - | Epoch: 064/150 | Train Time: 2.683s | Train Loss: 0.034620 |
2020-05-30 15:55:49,350 - root - INFO - | Epoch: 065/150 | Train Time: 2.818s | Train Loss: 0.034575 |
2020-05-30 15:55:52,172 - root - INFO - | Epoch: 066/150 | Train Time: 2.822s | Train Loss: 0.034881 |
2020-05-30 15:55:55,082 - root - INFO - | Epoch: 067/150 | Train Time: 2.909s | Train Loss: 0.034086 |
2020-05-30 15:55:58,426 - root - INFO - | Epoch: 068/150 | Train Time: 3.344s | Train Loss: 0.034724 |
2020-05-30 15:56:01,409 - root - INFO - | Epoch: 069/150 | Train Time: 2.982s | Train Loss: 0.035029 |
2020-05-30 15:56:04,405 - root - INFO - | Epoch: 070/150 | Train Time: 2.996s | Train Loss: 0.035257 |
2020-05-30 15:56:07,063 - root - INFO - | Epoch: 071/150 | Train Time: 2.657s | Train Loss: 0.034955 |
2020-05-30 15:56:09,486 - root - INFO - | Epoch: 072/150 | Train Time: 2.422s | Train Loss: 0.036191 |
2020-05-30 15:56:12,109 - root - INFO - | Epoch: 073/150 | Train Time: 2.623s | Train Loss: 0.034163 |
2020-05-30 15:56:15,104 - root - INFO - | Epoch: 074/150 | Train Time: 2.995s | Train Loss: 0.034757 |
2020-05-30 15:56:18,045 - root - INFO - | Epoch: 075/150 | Train Time: 2.941s | Train Loss: 0.034845 |
2020-05-30 15:56:21,135 - root - INFO - | Epoch: 076/150 | Train Time: 3.089s | Train Loss: 0.035353 |
2020-05-30 15:56:24,788 - root - INFO - | Epoch: 077/150 | Train Time: 3.652s | Train Loss: 0.034062 |
2020-05-30 15:56:27,852 - root - INFO - | Epoch: 078/150 | Train Time: 3.064s | Train Loss: 0.034264 |
2020-05-30 15:56:30,661 - root - INFO - | Epoch: 079/150 | Train Time: 2.809s | Train Loss: 0.032961 |
2020-05-30 15:56:33,659 - root - INFO - | Epoch: 080/150 | Train Time: 2.997s | Train Loss: 0.034877 |
2020-05-30 15:56:36,435 - root - INFO - | Epoch: 081/150 | Train Time: 2.776s | Train Loss: 0.033975 |
2020-05-30 15:56:39,411 - root - INFO - | Epoch: 082/150 | Train Time: 2.975s | Train Loss: 0.034852 |
2020-05-30 15:56:42,308 - root - INFO - | Epoch: 083/150 | Train Time: 2.897s | Train Loss: 0.033197 |
2020-05-30 15:56:45,032 - root - INFO - | Epoch: 084/150 | Train Time: 2.723s | Train Loss: 0.034023 |
2020-05-30 15:56:47,513 - root - INFO - | Epoch: 085/150 | Train Time: 2.481s | Train Loss: 0.034594 |
2020-05-30 15:56:50,423 - root - INFO - | Epoch: 086/150 | Train Time: 2.909s | Train Loss: 0.034104 |
2020-05-30 15:56:53,323 - root - INFO - | Epoch: 087/150 | Train Time: 2.900s | Train Loss: 0.033764 |
2020-05-30 15:56:56,517 - root - INFO - | Epoch: 088/150 | Train Time: 3.193s | Train Loss: 0.034138 |
2020-05-30 15:56:59,867 - root - INFO - | Epoch: 089/150 | Train Time: 3.350s | Train Loss: 0.034234 |
2020-05-30 15:57:02,992 - root - INFO - | Epoch: 090/150 | Train Time: 3.124s | Train Loss: 0.032913 |
2020-05-30 15:57:06,227 - root - INFO - | Epoch: 091/150 | Train Time: 3.235s | Train Loss: 0.033143 |
2020-05-30 15:57:09,072 - root - INFO - | Epoch: 092/150 | Train Time: 2.844s | Train Loss: 0.034606 |
2020-05-30 15:57:12,220 - root - INFO - | Epoch: 093/150 | Train Time: 3.147s | Train Loss: 0.034329 |
2020-05-30 15:57:15,358 - root - INFO - | Epoch: 094/150 | Train Time: 3.138s | Train Loss: 0.033509 |
2020-05-30 15:57:18,713 - root - INFO - | Epoch: 095/150 | Train Time: 3.353s | Train Loss: 0.033637 |
2020-05-30 15:57:22,117 - root - INFO - | Epoch: 096/150 | Train Time: 3.404s | Train Loss: 0.032926 |
2020-05-30 15:57:25,591 - root - INFO - | Epoch: 097/150 | Train Time: 3.474s | Train Loss: 0.033123 |
2020-05-30 15:57:28,477 - root - INFO - | Epoch: 098/150 | Train Time: 2.885s | Train Loss: 0.034172 |
2020-05-30 15:57:31,725 - root - INFO - | Epoch: 099/150 | Train Time: 3.247s | Train Loss: 0.033222 |
2020-05-30 15:57:35,312 - root - INFO - | Epoch: 100/150 | Train Time: 3.586s | Train Loss: 0.033323 |
2020-05-30 15:57:38,757 - root - INFO - | Epoch: 101/150 | Train Time: 3.439s | Train Loss: 0.032024 |
2020-05-30 15:57:42,103 - root - INFO - | Epoch: 102/150 | Train Time: 3.346s | Train Loss: 0.033466 |
2020-05-30 15:57:45,484 - root - INFO - | Epoch: 103/150 | Train Time: 3.380s | Train Loss: 0.032159 |
2020-05-30 15:57:48,773 - root - INFO - | Epoch: 104/150 | Train Time: 3.288s | Train Loss: 0.032447 |
2020-05-30 15:57:52,228 - root - INFO - | Epoch: 105/150 | Train Time: 3.455s | Train Loss: 0.032986 |
2020-05-30 15:57:55,420 - root - INFO - | Epoch: 106/150 | Train Time: 3.192s | Train Loss: 0.033198 |
2020-05-30 15:57:58,572 - root - INFO - | Epoch: 107/150 | Train Time: 3.150s | Train Loss: 0.033291 |
2020-05-30 15:58:01,822 - root - INFO - | Epoch: 108/150 | Train Time: 3.250s | Train Loss: 0.033190 |
2020-05-30 15:58:04,936 - root - INFO - | Epoch: 109/150 | Train Time: 3.113s | Train Loss: 0.032654 |
2020-05-30 15:58:08,630 - root - INFO - | Epoch: 110/150 | Train Time: 3.693s | Train Loss: 0.031753 |
2020-05-30 15:58:11,736 - root - INFO - | Epoch: 111/150 | Train Time: 3.106s | Train Loss: 0.032931 |
2020-05-30 15:58:14,958 - root - INFO - | Epoch: 112/150 | Train Time: 3.221s | Train Loss: 0.031591 |
2020-05-30 15:58:18,120 - root - INFO - | Epoch: 113/150 | Train Time: 3.162s | Train Loss: 0.031918 |
2020-05-30 15:58:21,183 - root - INFO - | Epoch: 114/150 | Train Time: 3.063s | Train Loss: 0.032180 |
2020-05-30 15:58:23,834 - root - INFO - | Epoch: 115/150 | Train Time: 2.650s | Train Loss: 0.031763 |
2020-05-30 15:58:26,906 - root - INFO - | Epoch: 116/150 | Train Time: 3.071s | Train Loss: 0.032541 |
2020-05-30 15:58:29,764 - root - INFO - | Epoch: 117/150 | Train Time: 2.858s | Train Loss: 0.031459 |
2020-05-30 15:58:32,144 - root - INFO - | Epoch: 118/150 | Train Time: 2.380s | Train Loss: 0.031951 |
2020-05-30 15:58:34,513 - root - INFO - | Epoch: 119/150 | Train Time: 2.368s | Train Loss: 0.032019 |
2020-05-30 15:58:37,357 - root - INFO - | Epoch: 120/150 | Train Time: 2.843s | Train Loss: 0.031529 |
2020-05-30 15:58:40,424 - root - INFO - | Epoch: 121/150 | Train Time: 3.067s | Train Loss: 0.032018 |
2020-05-30 15:58:43,340 - root - INFO - | Epoch: 122/150 | Train Time: 2.905s | Train Loss: 0.031553 |
2020-05-30 15:58:46,445 - root - INFO - | Epoch: 123/150 | Train Time: 3.104s | Train Loss: 0.032217 |
2020-05-30 15:58:49,208 - root - INFO - | Epoch: 124/150 | Train Time: 2.762s | Train Loss: 0.031344 |
2020-05-30 15:58:51,818 - root - INFO - | Epoch: 125/150 | Train Time: 2.609s | Train Loss: 0.031478 |
2020-05-30 15:58:54,951 - root - INFO - | Epoch: 126/150 | Train Time: 3.133s | Train Loss: 0.031452 |
2020-05-30 15:58:57,820 - root - INFO - | Epoch: 127/150 | Train Time: 2.869s | Train Loss: 0.032372 |
2020-05-30 15:59:00,830 - root - INFO - | Epoch: 128/150 | Train Time: 3.009s | Train Loss: 0.030575 |
2020-05-30 15:59:03,708 - root - INFO - | Epoch: 129/150 | Train Time: 2.878s | Train Loss: 0.031359 |
2020-05-30 15:59:06,415 - root - INFO - | Epoch: 130/150 | Train Time: 2.707s | Train Loss: 0.031145 |
2020-05-30 15:59:09,265 - root - INFO - | Epoch: 131/150 | Train Time: 2.849s | Train Loss: 0.030133 |
2020-05-30 15:59:12,159 - root - INFO - | Epoch: 132/150 | Train Time: 2.893s | Train Loss: 0.030713 |
2020-05-30 15:59:15,368 - root - INFO - | Epoch: 133/150 | Train Time: 3.209s | Train Loss: 0.031208 |
2020-05-30 15:59:18,508 - root - INFO - | Epoch: 134/150 | Train Time: 3.140s | Train Loss: 0.030853 |
2020-05-30 15:59:21,771 - root - INFO - | Epoch: 135/150 | Train Time: 3.262s | Train Loss: 0.031108 |
2020-05-30 15:59:25,255 - root - INFO - | Epoch: 136/150 | Train Time: 3.483s | Train Loss: 0.030984 |
2020-05-30 15:59:28,331 - root - INFO - | Epoch: 137/150 | Train Time: 3.076s | Train Loss: 0.031179 |
2020-05-30 15:59:31,442 - root - INFO - | Epoch: 138/150 | Train Time: 3.110s | Train Loss: 0.030298 |
2020-05-30 15:59:34,600 - root - INFO - | Epoch: 139/150 | Train Time: 3.158s | Train Loss: 0.030493 |
2020-05-30 15:59:37,984 - root - INFO - | Epoch: 140/150 | Train Time: 3.383s | Train Loss: 0.030438 |
2020-05-30 15:59:41,035 - root - INFO - | Epoch: 141/150 | Train Time: 3.050s | Train Loss: 0.030185 |
2020-05-30 15:59:44,714 - root - INFO - | Epoch: 142/150 | Train Time: 3.679s | Train Loss: 0.030722 |
2020-05-30 15:59:47,586 - root - INFO - | Epoch: 143/150 | Train Time: 2.871s | Train Loss: 0.030857 |
2020-05-30 15:59:50,947 - root - INFO - | Epoch: 144/150 | Train Time: 3.361s | Train Loss: 0.030079 |
2020-05-30 15:59:54,474 - root - INFO - | Epoch: 145/150 | Train Time: 3.527s | Train Loss: 0.030115 |
2020-05-30 15:59:58,194 - root - INFO - | Epoch: 146/150 | Train Time: 3.719s | Train Loss: 0.029142 |
2020-05-30 16:00:01,601 - root - INFO - | Epoch: 147/150 | Train Time: 3.407s | Train Loss: 0.029446 |
2020-05-30 16:00:04,916 - root - INFO - | Epoch: 148/150 | Train Time: 3.315s | Train Loss: 0.029221 |
2020-05-30 16:00:08,466 - root - INFO - | Epoch: 149/150 | Train Time: 3.549s | Train Loss: 0.031078 |
2020-05-30 16:00:11,364 - root - INFO - | Epoch: 150/150 | Train Time: 2.897s | Train Loss: 0.030589 |
2020-05-30 16:00:11,364 - root - INFO - Training Time: 448.390s
2020-05-30 16:00:11,364 - root - INFO - Finished training.
2020-05-30 16:00:11,365 - root - INFO - Starting testing...
2020-05-30 16:00:14,482 - root - INFO - Test Loss: 0.105028
2020-05-30 16:00:14,482 - root - INFO - Test AUC: 85.23%
2020-05-30 16:00:14,483 - root - INFO - Test Time: 3.101s
2020-05-30 16:00:14,483 - root - INFO - Finished testing.
