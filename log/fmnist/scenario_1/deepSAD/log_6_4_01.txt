2020-05-30 03:08:27,169 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_6_4_01.txt
2020-05-30 03:08:27,169 - root - INFO - Data path is ../data
2020-05-30 03:08:27,169 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 03:08:27,169 - root - INFO - Dataset: fmnist
2020-05-30 03:08:27,169 - root - INFO - Normal class: 6
2020-05-30 03:08:27,169 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 03:08:27,170 - root - INFO - Ratio of labeled anomalous samples: 0.10
2020-05-30 03:08:27,170 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 03:08:27,170 - root - INFO - Scenario Running: 1
2020-05-30 03:08:27,170 - root - INFO - Train only the network: True
2020-05-30 03:08:27,170 - root - INFO - Output and AE dimensions: 128
2020-05-30 03:08:27,170 - root - INFO - Known anomaly class: 4
2020-05-30 03:08:27,170 - root - INFO - Network: fmnist_LeNet
2020-05-30 03:08:27,170 - root - INFO - Eta-parameter: 1.00
2020-05-30 03:08:27,189 - root - INFO - Set seed to 0.
2020-05-30 03:08:27,279 - root - INFO - Computation device: cuda
2020-05-30 03:08:27,279 - root - INFO - Number of threads: 0
2020-05-30 03:08:27,279 - root - INFO - Number of dataloader workers: 6
2020-05-30 03:08:41,975 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 03:08:41,987 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 03:08:41,987 - root - INFO - Pretraining: True
2020-05-30 03:08:41,987 - root - INFO - Training optimizer: adam
2020-05-30 03:08:41,988 - root - INFO - Training learning rate: 0.0001
2020-05-30 03:08:41,988 - root - INFO - Training epochs: 150
2020-05-30 03:08:41,988 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 03:08:41,988 - root - INFO - Training batch size: 200
2020-05-30 03:08:41,988 - root - INFO - Training weight decay: 5e-07
2020-05-30 03:08:41,991 - root - INFO - Starting training...
2020-05-30 03:08:54,868 - root - INFO - | Epoch: 001/150 | Train Time: 12.877s | Train Loss: 2.123743 |
2020-05-30 03:08:59,345 - root - INFO - | Epoch: 002/150 | Train Time: 4.474s | Train Loss: 0.758513 |
2020-05-30 03:09:03,813 - root - INFO - | Epoch: 003/150 | Train Time: 4.467s | Train Loss: 0.554675 |
2020-05-30 03:09:08,076 - root - INFO - | Epoch: 004/150 | Train Time: 4.263s | Train Loss: 0.469117 |
2020-05-30 03:09:11,800 - root - INFO - | Epoch: 005/150 | Train Time: 3.723s | Train Loss: 0.424264 |
2020-05-30 03:09:16,239 - root - INFO - | Epoch: 006/150 | Train Time: 4.439s | Train Loss: 0.384608 |
2020-05-30 03:09:20,321 - root - INFO - | Epoch: 007/150 | Train Time: 4.081s | Train Loss: 0.362916 |
2020-05-30 03:09:24,779 - root - INFO - | Epoch: 008/150 | Train Time: 4.457s | Train Loss: 0.340598 |
2020-05-30 03:09:29,109 - root - INFO - | Epoch: 009/150 | Train Time: 4.328s | Train Loss: 0.322286 |
2020-05-30 03:09:33,043 - root - INFO - | Epoch: 010/150 | Train Time: 3.933s | Train Loss: 0.304214 |
2020-05-30 03:09:37,221 - root - INFO - | Epoch: 011/150 | Train Time: 4.177s | Train Loss: 0.292817 |
2020-05-30 03:09:41,440 - root - INFO - | Epoch: 012/150 | Train Time: 4.219s | Train Loss: 0.282228 |
2020-05-30 03:09:46,314 - root - INFO - | Epoch: 013/150 | Train Time: 4.873s | Train Loss: 0.271521 |
2020-05-30 03:09:50,388 - root - INFO - | Epoch: 014/150 | Train Time: 4.074s | Train Loss: 0.260862 |
2020-05-30 03:09:54,654 - root - INFO - | Epoch: 015/150 | Train Time: 4.266s | Train Loss: 0.249817 |
2020-05-30 03:09:58,747 - root - INFO - | Epoch: 016/150 | Train Time: 4.091s | Train Loss: 0.243144 |
2020-05-30 03:10:02,651 - root - INFO - | Epoch: 017/150 | Train Time: 3.903s | Train Loss: 0.233944 |
2020-05-30 03:10:06,924 - root - INFO - | Epoch: 018/150 | Train Time: 4.273s | Train Loss: 0.227117 |
2020-05-30 03:10:10,955 - root - INFO - | Epoch: 019/150 | Train Time: 4.029s | Train Loss: 0.221678 |
2020-05-30 03:10:14,403 - root - INFO - | Epoch: 020/150 | Train Time: 3.448s | Train Loss: 0.212909 |
2020-05-30 03:10:18,303 - root - INFO - | Epoch: 021/150 | Train Time: 3.887s | Train Loss: 0.211207 |
2020-05-30 03:10:21,930 - root - INFO - | Epoch: 022/150 | Train Time: 3.626s | Train Loss: 0.204854 |
2020-05-30 03:10:25,595 - root - INFO - | Epoch: 023/150 | Train Time: 3.664s | Train Loss: 0.199310 |
2020-05-30 03:10:29,447 - root - INFO - | Epoch: 024/150 | Train Time: 3.852s | Train Loss: 0.194314 |
2020-05-30 03:10:32,974 - root - INFO - | Epoch: 025/150 | Train Time: 3.524s | Train Loss: 0.191213 |
2020-05-30 03:10:36,671 - root - INFO - | Epoch: 026/150 | Train Time: 3.696s | Train Loss: 0.183990 |
2020-05-30 03:10:40,993 - root - INFO - | Epoch: 027/150 | Train Time: 4.322s | Train Loss: 0.178752 |
2020-05-30 03:10:45,118 - root - INFO - | Epoch: 028/150 | Train Time: 4.125s | Train Loss: 0.177551 |
2020-05-30 03:10:49,022 - root - INFO - | Epoch: 029/150 | Train Time: 3.902s | Train Loss: 0.173404 |
2020-05-30 03:10:53,111 - root - INFO - | Epoch: 030/150 | Train Time: 4.089s | Train Loss: 0.172072 |
2020-05-30 03:10:56,976 - root - INFO - | Epoch: 031/150 | Train Time: 3.865s | Train Loss: 0.176628 |
2020-05-30 03:11:01,158 - root - INFO - | Epoch: 032/150 | Train Time: 4.181s | Train Loss: 0.160721 |
2020-05-30 03:11:04,942 - root - INFO - | Epoch: 033/150 | Train Time: 3.784s | Train Loss: 0.157625 |
2020-05-30 03:11:09,311 - root - INFO - | Epoch: 034/150 | Train Time: 4.368s | Train Loss: 0.154761 |
2020-05-30 03:11:13,676 - root - INFO - | Epoch: 035/150 | Train Time: 4.363s | Train Loss: 0.152138 |
2020-05-30 03:11:17,700 - root - INFO - | Epoch: 036/150 | Train Time: 4.024s | Train Loss: 0.148707 |
2020-05-30 03:11:21,491 - root - INFO - | Epoch: 037/150 | Train Time: 3.790s | Train Loss: 0.144636 |
2020-05-30 03:11:25,286 - root - INFO - | Epoch: 038/150 | Train Time: 3.795s | Train Loss: 0.143945 |
2020-05-30 03:11:29,284 - root - INFO - | Epoch: 039/150 | Train Time: 3.997s | Train Loss: 0.137447 |
2020-05-30 03:11:33,808 - root - INFO - | Epoch: 040/150 | Train Time: 4.522s | Train Loss: 0.139121 |
2020-05-30 03:11:38,378 - root - INFO - | Epoch: 041/150 | Train Time: 4.569s | Train Loss: 0.135408 |
2020-05-30 03:11:42,644 - root - INFO - | Epoch: 042/150 | Train Time: 4.266s | Train Loss: 0.129635 |
2020-05-30 03:11:46,824 - root - INFO - | Epoch: 043/150 | Train Time: 4.179s | Train Loss: 0.128648 |
2020-05-30 03:11:50,469 - root - INFO - | Epoch: 044/150 | Train Time: 3.644s | Train Loss: 0.127175 |
2020-05-30 03:11:54,423 - root - INFO - | Epoch: 045/150 | Train Time: 3.954s | Train Loss: 0.124369 |
2020-05-30 03:11:58,311 - root - INFO - | Epoch: 046/150 | Train Time: 3.886s | Train Loss: 0.121561 |
2020-05-30 03:12:01,167 - root - INFO - | Epoch: 047/150 | Train Time: 2.856s | Train Loss: 0.119446 |
2020-05-30 03:12:05,073 - root - INFO - | Epoch: 048/150 | Train Time: 3.905s | Train Loss: 0.118228 |
2020-05-30 03:12:08,936 - root - INFO - | Epoch: 049/150 | Train Time: 3.862s | Train Loss: 0.113661 |
2020-05-30 03:12:12,621 - root - INFO - | Epoch: 050/150 | Train Time: 3.685s | Train Loss: 0.106652 |
2020-05-30 03:12:12,622 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 03:12:16,827 - root - INFO - | Epoch: 051/150 | Train Time: 4.205s | Train Loss: 0.105832 |
2020-05-30 03:12:20,839 - root - INFO - | Epoch: 052/150 | Train Time: 4.011s | Train Loss: 0.105612 |
2020-05-30 03:12:25,038 - root - INFO - | Epoch: 053/150 | Train Time: 4.198s | Train Loss: 0.105913 |
2020-05-30 03:12:29,448 - root - INFO - | Epoch: 054/150 | Train Time: 4.409s | Train Loss: 0.105990 |
2020-05-30 03:12:33,706 - root - INFO - | Epoch: 055/150 | Train Time: 4.257s | Train Loss: 0.105369 |
2020-05-30 03:12:37,527 - root - INFO - | Epoch: 056/150 | Train Time: 3.820s | Train Loss: 0.104721 |
2020-05-30 03:12:41,460 - root - INFO - | Epoch: 057/150 | Train Time: 3.933s | Train Loss: 0.104645 |
2020-05-30 03:12:45,022 - root - INFO - | Epoch: 058/150 | Train Time: 3.562s | Train Loss: 0.104025 |
2020-05-30 03:12:48,958 - root - INFO - | Epoch: 059/150 | Train Time: 3.935s | Train Loss: 0.105663 |
2020-05-30 03:12:52,992 - root - INFO - | Epoch: 060/150 | Train Time: 4.034s | Train Loss: 0.103624 |
2020-05-30 03:12:57,387 - root - INFO - | Epoch: 061/150 | Train Time: 4.395s | Train Loss: 0.104590 |
2020-05-30 03:13:02,029 - root - INFO - | Epoch: 062/150 | Train Time: 4.641s | Train Loss: 0.103518 |
2020-05-30 03:13:06,569 - root - INFO - | Epoch: 063/150 | Train Time: 4.539s | Train Loss: 0.104722 |
2020-05-30 03:13:10,891 - root - INFO - | Epoch: 064/150 | Train Time: 4.322s | Train Loss: 0.102974 |
2020-05-30 03:13:14,359 - root - INFO - | Epoch: 065/150 | Train Time: 3.467s | Train Loss: 0.104652 |
2020-05-30 03:13:17,967 - root - INFO - | Epoch: 066/150 | Train Time: 3.608s | Train Loss: 0.102883 |
2020-05-30 03:13:21,907 - root - INFO - | Epoch: 067/150 | Train Time: 3.940s | Train Loss: 0.102253 |
2020-05-30 03:13:25,813 - root - INFO - | Epoch: 068/150 | Train Time: 3.906s | Train Loss: 0.102854 |
2020-05-30 03:13:29,649 - root - INFO - | Epoch: 069/150 | Train Time: 3.835s | Train Loss: 0.102635 |
2020-05-30 03:13:33,620 - root - INFO - | Epoch: 070/150 | Train Time: 3.970s | Train Loss: 0.102140 |
2020-05-30 03:13:37,634 - root - INFO - | Epoch: 071/150 | Train Time: 4.013s | Train Loss: 0.102572 |
2020-05-30 03:13:41,837 - root - INFO - | Epoch: 072/150 | Train Time: 4.202s | Train Loss: 0.102389 |
2020-05-30 03:13:45,646 - root - INFO - | Epoch: 073/150 | Train Time: 3.809s | Train Loss: 0.102930 |
2020-05-30 03:13:49,597 - root - INFO - | Epoch: 074/150 | Train Time: 3.950s | Train Loss: 0.099140 |
2020-05-30 03:13:53,663 - root - INFO - | Epoch: 075/150 | Train Time: 4.065s | Train Loss: 0.101318 |
2020-05-30 03:13:57,614 - root - INFO - | Epoch: 076/150 | Train Time: 3.950s | Train Loss: 0.098689 |
2020-05-30 03:14:01,945 - root - INFO - | Epoch: 077/150 | Train Time: 4.331s | Train Loss: 0.100358 |
2020-05-30 03:14:06,377 - root - INFO - | Epoch: 078/150 | Train Time: 4.431s | Train Loss: 0.098415 |
2020-05-30 03:14:10,453 - root - INFO - | Epoch: 079/150 | Train Time: 4.076s | Train Loss: 0.099494 |
2020-05-30 03:14:14,457 - root - INFO - | Epoch: 080/150 | Train Time: 4.002s | Train Loss: 0.099817 |
2020-05-30 03:14:18,326 - root - INFO - | Epoch: 081/150 | Train Time: 3.868s | Train Loss: 0.097940 |
2020-05-30 03:14:21,676 - root - INFO - | Epoch: 082/150 | Train Time: 3.350s | Train Loss: 0.098615 |
2020-05-30 03:14:25,670 - root - INFO - | Epoch: 083/150 | Train Time: 3.993s | Train Loss: 0.098212 |
2020-05-30 03:14:29,747 - root - INFO - | Epoch: 084/150 | Train Time: 4.077s | Train Loss: 0.099179 |
2020-05-30 03:14:33,273 - root - INFO - | Epoch: 085/150 | Train Time: 3.525s | Train Loss: 0.098799 |
2020-05-30 03:14:37,131 - root - INFO - | Epoch: 086/150 | Train Time: 3.857s | Train Loss: 0.097119 |
2020-05-30 03:14:40,610 - root - INFO - | Epoch: 087/150 | Train Time: 3.478s | Train Loss: 0.096855 |
2020-05-30 03:14:44,221 - root - INFO - | Epoch: 088/150 | Train Time: 3.610s | Train Loss: 0.097131 |
2020-05-30 03:14:47,726 - root - INFO - | Epoch: 089/150 | Train Time: 3.504s | Train Loss: 0.098414 |
2020-05-30 03:14:50,834 - root - INFO - | Epoch: 090/150 | Train Time: 3.108s | Train Loss: 0.096050 |
2020-05-30 03:14:54,362 - root - INFO - | Epoch: 091/150 | Train Time: 3.527s | Train Loss: 0.096733 |
2020-05-30 03:14:57,161 - root - INFO - | Epoch: 092/150 | Train Time: 2.798s | Train Loss: 0.097579 |
2020-05-30 03:15:00,109 - root - INFO - | Epoch: 093/150 | Train Time: 2.948s | Train Loss: 0.094254 |
2020-05-30 03:15:03,383 - root - INFO - | Epoch: 094/150 | Train Time: 3.273s | Train Loss: 0.095330 |
2020-05-30 03:15:07,042 - root - INFO - | Epoch: 095/150 | Train Time: 3.658s | Train Loss: 0.096261 |
2020-05-30 03:15:11,262 - root - INFO - | Epoch: 096/150 | Train Time: 4.220s | Train Loss: 0.095593 |
2020-05-30 03:15:14,150 - root - INFO - | Epoch: 097/150 | Train Time: 2.887s | Train Loss: 0.093547 |
2020-05-30 03:15:17,505 - root - INFO - | Epoch: 098/150 | Train Time: 3.354s | Train Loss: 0.094497 |
2020-05-30 03:15:20,810 - root - INFO - | Epoch: 099/150 | Train Time: 3.305s | Train Loss: 0.094895 |
2020-05-30 03:15:25,211 - root - INFO - | Epoch: 100/150 | Train Time: 4.401s | Train Loss: 0.094313 |
2020-05-30 03:15:29,166 - root - INFO - | Epoch: 101/150 | Train Time: 3.948s | Train Loss: 0.093536 |
2020-05-30 03:15:33,092 - root - INFO - | Epoch: 102/150 | Train Time: 3.926s | Train Loss: 0.094640 |
2020-05-30 03:15:36,958 - root - INFO - | Epoch: 103/150 | Train Time: 3.865s | Train Loss: 0.094184 |
2020-05-30 03:15:41,355 - root - INFO - | Epoch: 104/150 | Train Time: 4.396s | Train Loss: 0.091467 |
2020-05-30 03:15:45,489 - root - INFO - | Epoch: 105/150 | Train Time: 4.134s | Train Loss: 0.092361 |
2020-05-30 03:15:49,328 - root - INFO - | Epoch: 106/150 | Train Time: 3.838s | Train Loss: 0.090690 |
2020-05-30 03:15:52,906 - root - INFO - | Epoch: 107/150 | Train Time: 3.577s | Train Loss: 0.092382 |
2020-05-30 03:15:57,104 - root - INFO - | Epoch: 108/150 | Train Time: 4.197s | Train Loss: 0.092628 |
2020-05-30 03:16:01,097 - root - INFO - | Epoch: 109/150 | Train Time: 3.992s | Train Loss: 0.091961 |
2020-05-30 03:16:04,978 - root - INFO - | Epoch: 110/150 | Train Time: 3.880s | Train Loss: 0.092360 |
2020-05-30 03:16:09,110 - root - INFO - | Epoch: 111/150 | Train Time: 4.131s | Train Loss: 0.092331 |
2020-05-30 03:16:13,423 - root - INFO - | Epoch: 112/150 | Train Time: 4.313s | Train Loss: 0.091027 |
2020-05-30 03:16:17,740 - root - INFO - | Epoch: 113/150 | Train Time: 4.317s | Train Loss: 0.090186 |
2020-05-30 03:16:21,974 - root - INFO - | Epoch: 114/150 | Train Time: 4.233s | Train Loss: 0.089407 |
2020-05-30 03:16:25,958 - root - INFO - | Epoch: 115/150 | Train Time: 3.983s | Train Loss: 0.091488 |
2020-05-30 03:16:29,962 - root - INFO - | Epoch: 116/150 | Train Time: 4.003s | Train Loss: 0.091228 |
2020-05-30 03:16:34,386 - root - INFO - | Epoch: 117/150 | Train Time: 4.423s | Train Loss: 0.090725 |
2020-05-30 03:16:38,666 - root - INFO - | Epoch: 118/150 | Train Time: 4.280s | Train Loss: 0.089066 |
2020-05-30 03:16:42,669 - root - INFO - | Epoch: 119/150 | Train Time: 4.002s | Train Loss: 0.090938 |
2020-05-30 03:16:46,878 - root - INFO - | Epoch: 120/150 | Train Time: 4.209s | Train Loss: 0.088549 |
2020-05-30 03:16:50,901 - root - INFO - | Epoch: 121/150 | Train Time: 4.023s | Train Loss: 0.088249 |
2020-05-30 03:16:54,500 - root - INFO - | Epoch: 122/150 | Train Time: 3.599s | Train Loss: 0.089746 |
2020-05-30 03:16:58,599 - root - INFO - | Epoch: 123/150 | Train Time: 4.098s | Train Loss: 0.086922 |
2020-05-30 03:17:03,180 - root - INFO - | Epoch: 124/150 | Train Time: 4.581s | Train Loss: 0.087067 |
2020-05-30 03:17:07,960 - root - INFO - | Epoch: 125/150 | Train Time: 4.779s | Train Loss: 0.086918 |
2020-05-30 03:17:12,517 - root - INFO - | Epoch: 126/150 | Train Time: 4.556s | Train Loss: 0.088221 |
2020-05-30 03:17:16,910 - root - INFO - | Epoch: 127/150 | Train Time: 4.392s | Train Loss: 0.085928 |
2020-05-30 03:17:21,430 - root - INFO - | Epoch: 128/150 | Train Time: 4.520s | Train Loss: 0.085317 |
2020-05-30 03:17:25,902 - root - INFO - | Epoch: 129/150 | Train Time: 4.472s | Train Loss: 0.087028 |
2020-05-30 03:17:30,322 - root - INFO - | Epoch: 130/150 | Train Time: 4.418s | Train Loss: 0.087046 |
2020-05-30 03:17:34,750 - root - INFO - | Epoch: 131/150 | Train Time: 4.427s | Train Loss: 0.086196 |
2020-05-30 03:17:39,304 - root - INFO - | Epoch: 132/150 | Train Time: 4.553s | Train Loss: 0.084913 |
2020-05-30 03:17:43,620 - root - INFO - | Epoch: 133/150 | Train Time: 4.316s | Train Loss: 0.085701 |
2020-05-30 03:17:47,699 - root - INFO - | Epoch: 134/150 | Train Time: 4.079s | Train Loss: 0.083901 |
2020-05-30 03:17:51,837 - root - INFO - | Epoch: 135/150 | Train Time: 4.137s | Train Loss: 0.084341 |
2020-05-30 03:17:55,620 - root - INFO - | Epoch: 136/150 | Train Time: 3.782s | Train Loss: 0.085993 |
2020-05-30 03:17:59,708 - root - INFO - | Epoch: 137/150 | Train Time: 4.087s | Train Loss: 0.085565 |
2020-05-30 03:18:03,879 - root - INFO - | Epoch: 138/150 | Train Time: 4.170s | Train Loss: 0.084408 |
2020-05-30 03:18:07,935 - root - INFO - | Epoch: 139/150 | Train Time: 4.056s | Train Loss: 0.082746 |
2020-05-30 03:18:11,896 - root - INFO - | Epoch: 140/150 | Train Time: 3.960s | Train Loss: 0.083268 |
2020-05-30 03:18:15,697 - root - INFO - | Epoch: 141/150 | Train Time: 3.801s | Train Loss: 0.083302 |
2020-05-30 03:18:19,391 - root - INFO - | Epoch: 142/150 | Train Time: 3.692s | Train Loss: 0.083717 |
2020-05-30 03:18:22,838 - root - INFO - | Epoch: 143/150 | Train Time: 3.446s | Train Loss: 0.082629 |
2020-05-30 03:18:26,572 - root - INFO - | Epoch: 144/150 | Train Time: 3.733s | Train Loss: 0.083814 |
2020-05-30 03:18:29,811 - root - INFO - | Epoch: 145/150 | Train Time: 3.239s | Train Loss: 0.083388 |
2020-05-30 03:18:33,602 - root - INFO - | Epoch: 146/150 | Train Time: 3.790s | Train Loss: 0.084315 |
2020-05-30 03:18:38,013 - root - INFO - | Epoch: 147/150 | Train Time: 4.410s | Train Loss: 0.081432 |
2020-05-30 03:18:42,144 - root - INFO - | Epoch: 148/150 | Train Time: 4.130s | Train Loss: 0.082887 |
2020-05-30 03:18:46,344 - root - INFO - | Epoch: 149/150 | Train Time: 4.199s | Train Loss: 0.080737 |
2020-05-30 03:18:49,789 - root - INFO - | Epoch: 150/150 | Train Time: 3.444s | Train Loss: 0.080242 |
2020-05-30 03:18:49,789 - root - INFO - Training Time: 607.798s
2020-05-30 03:18:49,789 - root - INFO - Finished training.
2020-05-30 03:18:49,790 - root - INFO - Starting testing...
2020-05-30 03:18:54,028 - root - INFO - Test Loss: 0.426085
2020-05-30 03:18:54,028 - root - INFO - Test AUC: 66.89%
2020-05-30 03:18:54,029 - root - INFO - Test Time: 4.223s
2020-05-30 03:18:54,029 - root - INFO - Finished testing.
