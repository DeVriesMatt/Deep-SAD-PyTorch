2020-05-30 04:36:53,428 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_6_8_005.txt
2020-05-30 04:36:53,428 - root - INFO - Data path is ../data
2020-05-30 04:36:53,428 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 04:36:53,428 - root - INFO - Dataset: fmnist
2020-05-30 04:36:53,428 - root - INFO - Normal class: 6
2020-05-30 04:36:53,428 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 04:36:53,428 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-30 04:36:53,428 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 04:36:53,429 - root - INFO - Scenario Running: 1
2020-05-30 04:36:53,429 - root - INFO - Train only the network: True
2020-05-30 04:36:53,429 - root - INFO - Output and AE dimensions: 128
2020-05-30 04:36:53,429 - root - INFO - Known anomaly class: 8
2020-05-30 04:36:53,429 - root - INFO - Network: fmnist_LeNet
2020-05-30 04:36:53,429 - root - INFO - Eta-parameter: 1.00
2020-05-30 04:36:53,436 - root - INFO - Set seed to 0.
2020-05-30 04:36:53,491 - root - INFO - Computation device: cuda
2020-05-30 04:36:53,492 - root - INFO - Number of threads: 0
2020-05-30 04:36:53,492 - root - INFO - Number of dataloader workers: 6
2020-05-30 04:37:06,622 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 04:37:06,662 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 04:37:06,662 - root - INFO - Pretraining: True
2020-05-30 04:37:06,662 - root - INFO - Training optimizer: adam
2020-05-30 04:37:06,663 - root - INFO - Training learning rate: 0.0001
2020-05-30 04:37:06,663 - root - INFO - Training epochs: 150
2020-05-30 04:37:06,663 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 04:37:06,663 - root - INFO - Training batch size: 200
2020-05-30 04:37:06,664 - root - INFO - Training weight decay: 5e-07
2020-05-30 04:37:06,666 - root - INFO - Starting training...
2020-05-30 04:37:17,882 - root - INFO - | Epoch: 001/150 | Train Time: 11.215s | Train Loss: 2.040505 |
2020-05-30 04:37:21,508 - root - INFO - | Epoch: 002/150 | Train Time: 3.625s | Train Loss: 0.589776 |
2020-05-30 04:37:24,881 - root - INFO - | Epoch: 003/150 | Train Time: 3.373s | Train Loss: 0.385150 |
2020-05-30 04:37:28,563 - root - INFO - | Epoch: 004/150 | Train Time: 3.681s | Train Loss: 0.290397 |
2020-05-30 04:37:32,599 - root - INFO - | Epoch: 005/150 | Train Time: 4.036s | Train Loss: 0.240435 |
2020-05-30 04:37:37,205 - root - INFO - | Epoch: 006/150 | Train Time: 4.606s | Train Loss: 0.208892 |
2020-05-30 04:37:40,602 - root - INFO - | Epoch: 007/150 | Train Time: 3.396s | Train Loss: 0.186311 |
2020-05-30 04:37:44,140 - root - INFO - | Epoch: 008/150 | Train Time: 3.538s | Train Loss: 0.170660 |
2020-05-30 04:37:47,850 - root - INFO - | Epoch: 009/150 | Train Time: 3.709s | Train Loss: 0.156549 |
2020-05-30 04:37:51,544 - root - INFO - | Epoch: 010/150 | Train Time: 3.694s | Train Loss: 0.147328 |
2020-05-30 04:37:55,894 - root - INFO - | Epoch: 011/150 | Train Time: 4.349s | Train Loss: 0.139083 |
2020-05-30 04:37:59,899 - root - INFO - | Epoch: 012/150 | Train Time: 4.004s | Train Loss: 0.131562 |
2020-05-30 04:38:04,016 - root - INFO - | Epoch: 013/150 | Train Time: 4.116s | Train Loss: 0.126111 |
2020-05-30 04:38:08,378 - root - INFO - | Epoch: 014/150 | Train Time: 4.361s | Train Loss: 0.120356 |
2020-05-30 04:38:11,873 - root - INFO - | Epoch: 015/150 | Train Time: 3.495s | Train Loss: 0.116458 |
2020-05-30 04:38:15,339 - root - INFO - | Epoch: 016/150 | Train Time: 3.465s | Train Loss: 0.113254 |
2020-05-30 04:38:19,351 - root - INFO - | Epoch: 017/150 | Train Time: 4.012s | Train Loss: 0.108327 |
2020-05-30 04:38:24,354 - root - INFO - | Epoch: 018/150 | Train Time: 5.002s | Train Loss: 0.104444 |
2020-05-30 04:38:28,310 - root - INFO - | Epoch: 019/150 | Train Time: 3.955s | Train Loss: 0.102305 |
2020-05-30 04:38:32,582 - root - INFO - | Epoch: 020/150 | Train Time: 4.271s | Train Loss: 0.098859 |
2020-05-30 04:38:36,618 - root - INFO - | Epoch: 021/150 | Train Time: 4.035s | Train Loss: 0.097893 |
2020-05-30 04:38:40,559 - root - INFO - | Epoch: 022/150 | Train Time: 3.941s | Train Loss: 0.094557 |
2020-05-30 04:38:44,552 - root - INFO - | Epoch: 023/150 | Train Time: 3.993s | Train Loss: 0.092993 |
2020-05-30 04:38:48,537 - root - INFO - | Epoch: 024/150 | Train Time: 3.984s | Train Loss: 0.092037 |
2020-05-30 04:38:52,367 - root - INFO - | Epoch: 025/150 | Train Time: 3.830s | Train Loss: 0.090397 |
2020-05-30 04:38:57,133 - root - INFO - | Epoch: 026/150 | Train Time: 4.766s | Train Loss: 0.088492 |
2020-05-30 04:39:01,370 - root - INFO - | Epoch: 027/150 | Train Time: 4.237s | Train Loss: 0.087228 |
2020-05-30 04:39:05,634 - root - INFO - | Epoch: 028/150 | Train Time: 4.263s | Train Loss: 0.086365 |
2020-05-30 04:39:09,509 - root - INFO - | Epoch: 029/150 | Train Time: 3.874s | Train Loss: 0.083250 |
2020-05-30 04:39:13,136 - root - INFO - | Epoch: 030/150 | Train Time: 3.627s | Train Loss: 0.081222 |
2020-05-30 04:39:16,954 - root - INFO - | Epoch: 031/150 | Train Time: 3.818s | Train Loss: 0.082258 |
2020-05-30 04:39:20,666 - root - INFO - | Epoch: 032/150 | Train Time: 3.711s | Train Loss: 0.080736 |
2020-05-30 04:39:24,776 - root - INFO - | Epoch: 033/150 | Train Time: 4.109s | Train Loss: 0.078948 |
2020-05-30 04:39:29,166 - root - INFO - | Epoch: 034/150 | Train Time: 4.389s | Train Loss: 0.078047 |
2020-05-30 04:39:33,113 - root - INFO - | Epoch: 035/150 | Train Time: 3.947s | Train Loss: 0.076583 |
2020-05-30 04:39:36,599 - root - INFO - | Epoch: 036/150 | Train Time: 3.485s | Train Loss: 0.075624 |
2020-05-30 04:39:40,294 - root - INFO - | Epoch: 037/150 | Train Time: 3.694s | Train Loss: 0.074758 |
2020-05-30 04:39:43,486 - root - INFO - | Epoch: 038/150 | Train Time: 3.191s | Train Loss: 0.074131 |
2020-05-30 04:39:45,974 - root - INFO - | Epoch: 039/150 | Train Time: 2.487s | Train Loss: 0.073187 |
2020-05-30 04:39:48,819 - root - INFO - | Epoch: 040/150 | Train Time: 2.844s | Train Loss: 0.073200 |
2020-05-30 04:39:51,807 - root - INFO - | Epoch: 041/150 | Train Time: 2.988s | Train Loss: 0.071265 |
2020-05-30 04:39:54,945 - root - INFO - | Epoch: 042/150 | Train Time: 3.138s | Train Loss: 0.072379 |
2020-05-30 04:39:58,881 - root - INFO - | Epoch: 043/150 | Train Time: 3.935s | Train Loss: 0.070161 |
2020-05-30 04:40:02,460 - root - INFO - | Epoch: 044/150 | Train Time: 3.578s | Train Loss: 0.069612 |
2020-05-30 04:40:06,128 - root - INFO - | Epoch: 045/150 | Train Time: 3.668s | Train Loss: 0.069255 |
2020-05-30 04:40:10,056 - root - INFO - | Epoch: 046/150 | Train Time: 3.928s | Train Loss: 0.066595 |
2020-05-30 04:40:14,144 - root - INFO - | Epoch: 047/150 | Train Time: 4.087s | Train Loss: 0.067405 |
2020-05-30 04:40:17,372 - root - INFO - | Epoch: 048/150 | Train Time: 3.228s | Train Loss: 0.067776 |
2020-05-30 04:40:20,365 - root - INFO - | Epoch: 049/150 | Train Time: 2.992s | Train Loss: 0.065397 |
2020-05-30 04:40:23,772 - root - INFO - | Epoch: 050/150 | Train Time: 3.407s | Train Loss: 0.063135 |
2020-05-30 04:40:23,772 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 04:40:27,257 - root - INFO - | Epoch: 051/150 | Train Time: 3.484s | Train Loss: 0.062872 |
2020-05-30 04:40:30,732 - root - INFO - | Epoch: 052/150 | Train Time: 3.475s | Train Loss: 0.063028 |
2020-05-30 04:40:33,692 - root - INFO - | Epoch: 053/150 | Train Time: 2.959s | Train Loss: 0.063015 |
2020-05-30 04:40:36,916 - root - INFO - | Epoch: 054/150 | Train Time: 3.224s | Train Loss: 0.062489 |
2020-05-30 04:40:40,894 - root - INFO - | Epoch: 055/150 | Train Time: 3.977s | Train Loss: 0.062124 |
2020-05-30 04:40:44,416 - root - INFO - | Epoch: 056/150 | Train Time: 3.521s | Train Loss: 0.063431 |
2020-05-30 04:40:47,324 - root - INFO - | Epoch: 057/150 | Train Time: 2.908s | Train Loss: 0.062504 |
2020-05-30 04:40:50,786 - root - INFO - | Epoch: 058/150 | Train Time: 3.461s | Train Loss: 0.063122 |
2020-05-30 04:40:53,910 - root - INFO - | Epoch: 059/150 | Train Time: 3.123s | Train Loss: 0.063617 |
2020-05-30 04:40:57,246 - root - INFO - | Epoch: 060/150 | Train Time: 3.336s | Train Loss: 0.062180 |
2020-05-30 04:41:01,585 - root - INFO - | Epoch: 061/150 | Train Time: 4.338s | Train Loss: 0.062548 |
2020-05-30 04:41:05,865 - root - INFO - | Epoch: 062/150 | Train Time: 4.279s | Train Loss: 0.062051 |
2020-05-30 04:41:09,517 - root - INFO - | Epoch: 063/150 | Train Time: 3.651s | Train Loss: 0.061989 |
2020-05-30 04:41:13,046 - root - INFO - | Epoch: 064/150 | Train Time: 3.528s | Train Loss: 0.062375 |
2020-05-30 04:41:17,171 - root - INFO - | Epoch: 065/150 | Train Time: 4.125s | Train Loss: 0.062181 |
2020-05-30 04:41:20,300 - root - INFO - | Epoch: 066/150 | Train Time: 3.128s | Train Loss: 0.063515 |
2020-05-30 04:41:23,761 - root - INFO - | Epoch: 067/150 | Train Time: 3.461s | Train Loss: 0.062140 |
2020-05-30 04:41:26,813 - root - INFO - | Epoch: 068/150 | Train Time: 3.051s | Train Loss: 0.062800 |
2020-05-30 04:41:30,769 - root - INFO - | Epoch: 069/150 | Train Time: 3.955s | Train Loss: 0.061900 |
2020-05-30 04:41:35,392 - root - INFO - | Epoch: 070/150 | Train Time: 4.623s | Train Loss: 0.061168 |
2020-05-30 04:41:39,069 - root - INFO - | Epoch: 071/150 | Train Time: 3.677s | Train Loss: 0.061353 |
2020-05-30 04:41:42,867 - root - INFO - | Epoch: 072/150 | Train Time: 3.797s | Train Loss: 0.061271 |
2020-05-30 04:41:46,887 - root - INFO - | Epoch: 073/150 | Train Time: 4.020s | Train Loss: 0.060563 |
2020-05-30 04:41:51,057 - root - INFO - | Epoch: 074/150 | Train Time: 4.169s | Train Loss: 0.061483 |
2020-05-30 04:41:55,071 - root - INFO - | Epoch: 075/150 | Train Time: 4.013s | Train Loss: 0.061610 |
2020-05-30 04:41:58,875 - root - INFO - | Epoch: 076/150 | Train Time: 3.804s | Train Loss: 0.060957 |
2020-05-30 04:42:02,167 - root - INFO - | Epoch: 077/150 | Train Time: 3.291s | Train Loss: 0.061310 |
2020-05-30 04:42:05,530 - root - INFO - | Epoch: 078/150 | Train Time: 3.362s | Train Loss: 0.060026 |
2020-05-30 04:42:09,166 - root - INFO - | Epoch: 079/150 | Train Time: 3.636s | Train Loss: 0.060559 |
2020-05-30 04:42:13,053 - root - INFO - | Epoch: 080/150 | Train Time: 3.886s | Train Loss: 0.061031 |
2020-05-30 04:42:17,257 - root - INFO - | Epoch: 081/150 | Train Time: 4.204s | Train Loss: 0.061971 |
2020-05-30 04:42:21,934 - root - INFO - | Epoch: 082/150 | Train Time: 4.676s | Train Loss: 0.060492 |
2020-05-30 04:42:26,600 - root - INFO - | Epoch: 083/150 | Train Time: 4.666s | Train Loss: 0.059991 |
2020-05-30 04:42:31,664 - root - INFO - | Epoch: 084/150 | Train Time: 5.063s | Train Loss: 0.059613 |
2020-05-30 04:42:35,685 - root - INFO - | Epoch: 085/150 | Train Time: 4.021s | Train Loss: 0.060189 |
2020-05-30 04:42:40,143 - root - INFO - | Epoch: 086/150 | Train Time: 4.457s | Train Loss: 0.060534 |
2020-05-30 04:42:44,186 - root - INFO - | Epoch: 087/150 | Train Time: 4.043s | Train Loss: 0.060427 |
2020-05-30 04:42:48,613 - root - INFO - | Epoch: 088/150 | Train Time: 4.426s | Train Loss: 0.061013 |
2020-05-30 04:42:53,654 - root - INFO - | Epoch: 089/150 | Train Time: 5.041s | Train Loss: 0.060192 |
2020-05-30 04:42:58,443 - root - INFO - | Epoch: 090/150 | Train Time: 4.788s | Train Loss: 0.060401 |
2020-05-30 04:43:03,492 - root - INFO - | Epoch: 091/150 | Train Time: 5.049s | Train Loss: 0.059912 |
2020-05-30 04:43:08,400 - root - INFO - | Epoch: 092/150 | Train Time: 4.907s | Train Loss: 0.059455 |
2020-05-30 04:43:13,130 - root - INFO - | Epoch: 093/150 | Train Time: 4.729s | Train Loss: 0.059620 |
2020-05-30 04:43:17,567 - root - INFO - | Epoch: 094/150 | Train Time: 4.436s | Train Loss: 0.059943 |
2020-05-30 04:43:21,933 - root - INFO - | Epoch: 095/150 | Train Time: 4.366s | Train Loss: 0.059474 |
2020-05-30 04:43:26,969 - root - INFO - | Epoch: 096/150 | Train Time: 5.035s | Train Loss: 0.059394 |
2020-05-30 04:43:31,444 - root - INFO - | Epoch: 097/150 | Train Time: 4.474s | Train Loss: 0.058432 |
2020-05-30 04:43:35,331 - root - INFO - | Epoch: 098/150 | Train Time: 3.887s | Train Loss: 0.058395 |
2020-05-30 04:43:39,866 - root - INFO - | Epoch: 099/150 | Train Time: 4.535s | Train Loss: 0.058649 |
2020-05-30 04:43:43,662 - root - INFO - | Epoch: 100/150 | Train Time: 3.795s | Train Loss: 0.059688 |
2020-05-30 04:43:48,195 - root - INFO - | Epoch: 101/150 | Train Time: 4.532s | Train Loss: 0.059100 |
2020-05-30 04:43:52,676 - root - INFO - | Epoch: 102/150 | Train Time: 4.480s | Train Loss: 0.059100 |
2020-05-30 04:43:57,063 - root - INFO - | Epoch: 103/150 | Train Time: 4.386s | Train Loss: 0.059058 |
2020-05-30 04:44:01,655 - root - INFO - | Epoch: 104/150 | Train Time: 4.592s | Train Loss: 0.058885 |
2020-05-30 04:44:05,900 - root - INFO - | Epoch: 105/150 | Train Time: 4.244s | Train Loss: 0.058480 |
2020-05-30 04:44:09,445 - root - INFO - | Epoch: 106/150 | Train Time: 3.545s | Train Loss: 0.058124 |
2020-05-30 04:44:13,398 - root - INFO - | Epoch: 107/150 | Train Time: 3.952s | Train Loss: 0.060420 |
2020-05-30 04:44:16,849 - root - INFO - | Epoch: 108/150 | Train Time: 3.450s | Train Loss: 0.057685 |
2020-05-30 04:44:20,457 - root - INFO - | Epoch: 109/150 | Train Time: 3.608s | Train Loss: 0.058374 |
2020-05-30 04:44:24,336 - root - INFO - | Epoch: 110/150 | Train Time: 3.878s | Train Loss: 0.057804 |
2020-05-30 04:44:28,393 - root - INFO - | Epoch: 111/150 | Train Time: 4.056s | Train Loss: 0.057787 |
2020-05-30 04:44:32,307 - root - INFO - | Epoch: 112/150 | Train Time: 3.913s | Train Loss: 0.056881 |
2020-05-30 04:44:35,978 - root - INFO - | Epoch: 113/150 | Train Time: 3.670s | Train Loss: 0.058158 |
2020-05-30 04:44:39,940 - root - INFO - | Epoch: 114/150 | Train Time: 3.962s | Train Loss: 0.058172 |
2020-05-30 04:44:43,671 - root - INFO - | Epoch: 115/150 | Train Time: 3.730s | Train Loss: 0.057715 |
2020-05-30 04:44:47,472 - root - INFO - | Epoch: 116/150 | Train Time: 3.800s | Train Loss: 0.057386 |
2020-05-30 04:44:52,147 - root - INFO - | Epoch: 117/150 | Train Time: 4.675s | Train Loss: 0.057183 |
2020-05-30 04:44:57,082 - root - INFO - | Epoch: 118/150 | Train Time: 4.934s | Train Loss: 0.057238 |
2020-05-30 04:45:01,734 - root - INFO - | Epoch: 119/150 | Train Time: 4.652s | Train Loss: 0.057388 |
2020-05-30 04:45:05,674 - root - INFO - | Epoch: 120/150 | Train Time: 3.939s | Train Loss: 0.057203 |
2020-05-30 04:45:09,493 - root - INFO - | Epoch: 121/150 | Train Time: 3.818s | Train Loss: 0.056834 |
2020-05-30 04:45:13,390 - root - INFO - | Epoch: 122/150 | Train Time: 3.897s | Train Loss: 0.056864 |
2020-05-30 04:45:17,264 - root - INFO - | Epoch: 123/150 | Train Time: 3.873s | Train Loss: 0.057102 |
2020-05-30 04:45:21,537 - root - INFO - | Epoch: 124/150 | Train Time: 4.273s | Train Loss: 0.056231 |
2020-05-30 04:45:25,378 - root - INFO - | Epoch: 125/150 | Train Time: 3.840s | Train Loss: 0.057856 |
2020-05-30 04:45:29,269 - root - INFO - | Epoch: 126/150 | Train Time: 3.891s | Train Loss: 0.056479 |
2020-05-30 04:45:33,521 - root - INFO - | Epoch: 127/150 | Train Time: 4.251s | Train Loss: 0.056256 |
2020-05-30 04:45:37,704 - root - INFO - | Epoch: 128/150 | Train Time: 4.183s | Train Loss: 0.056454 |
2020-05-30 04:45:41,881 - root - INFO - | Epoch: 129/150 | Train Time: 4.177s | Train Loss: 0.056008 |
2020-05-30 04:45:45,986 - root - INFO - | Epoch: 130/150 | Train Time: 4.104s | Train Loss: 0.055894 |
2020-05-30 04:45:49,538 - root - INFO - | Epoch: 131/150 | Train Time: 3.551s | Train Loss: 0.055695 |
2020-05-30 04:45:53,349 - root - INFO - | Epoch: 132/150 | Train Time: 3.811s | Train Loss: 0.055891 |
2020-05-30 04:45:57,230 - root - INFO - | Epoch: 133/150 | Train Time: 3.880s | Train Loss: 0.055880 |
2020-05-30 04:46:00,636 - root - INFO - | Epoch: 134/150 | Train Time: 3.405s | Train Loss: 0.056259 |
2020-05-30 04:46:04,214 - root - INFO - | Epoch: 135/150 | Train Time: 3.578s | Train Loss: 0.055274 |
2020-05-30 04:46:07,886 - root - INFO - | Epoch: 136/150 | Train Time: 3.671s | Train Loss: 0.055730 |
2020-05-30 04:46:11,739 - root - INFO - | Epoch: 137/150 | Train Time: 3.853s | Train Loss: 0.055379 |
2020-05-30 04:46:15,685 - root - INFO - | Epoch: 138/150 | Train Time: 3.945s | Train Loss: 0.055410 |
2020-05-30 04:46:19,362 - root - INFO - | Epoch: 139/150 | Train Time: 3.677s | Train Loss: 0.056796 |
2020-05-30 04:46:23,378 - root - INFO - | Epoch: 140/150 | Train Time: 4.015s | Train Loss: 0.055032 |
2020-05-30 04:46:27,398 - root - INFO - | Epoch: 141/150 | Train Time: 4.019s | Train Loss: 0.055116 |
2020-05-30 04:46:31,454 - root - INFO - | Epoch: 142/150 | Train Time: 4.056s | Train Loss: 0.054721 |
2020-05-30 04:46:35,710 - root - INFO - | Epoch: 143/150 | Train Time: 4.256s | Train Loss: 0.054672 |
2020-05-30 04:46:39,784 - root - INFO - | Epoch: 144/150 | Train Time: 4.074s | Train Loss: 0.054480 |
2020-05-30 04:46:44,252 - root - INFO - | Epoch: 145/150 | Train Time: 4.467s | Train Loss: 0.055003 |
2020-05-30 04:46:48,272 - root - INFO - | Epoch: 146/150 | Train Time: 4.020s | Train Loss: 0.054558 |
2020-05-30 04:46:52,295 - root - INFO - | Epoch: 147/150 | Train Time: 4.022s | Train Loss: 0.053781 |
2020-05-30 04:46:56,403 - root - INFO - | Epoch: 148/150 | Train Time: 4.108s | Train Loss: 0.054003 |
2020-05-30 04:47:00,180 - root - INFO - | Epoch: 149/150 | Train Time: 3.776s | Train Loss: 0.053995 |
2020-05-30 04:47:04,404 - root - INFO - | Epoch: 150/150 | Train Time: 4.213s | Train Loss: 0.054352 |
2020-05-30 04:47:04,404 - root - INFO - Training Time: 597.736s
2020-05-30 04:47:04,404 - root - INFO - Finished training.
2020-05-30 04:47:04,405 - root - INFO - Starting testing...
2020-05-30 04:47:08,805 - root - INFO - Test Loss: 0.267929
2020-05-30 04:47:08,805 - root - INFO - Test AUC: 72.69%
2020-05-30 04:47:08,805 - root - INFO - Test Time: 4.388s
2020-05-30 04:47:08,805 - root - INFO - Finished testing.
