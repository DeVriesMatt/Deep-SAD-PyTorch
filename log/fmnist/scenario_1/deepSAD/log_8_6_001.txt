2020-05-30 16:56:12,840 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_8_6_001.txt
2020-05-30 16:56:12,840 - root - INFO - Data path is ../data
2020-05-30 16:56:12,840 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 16:56:12,840 - root - INFO - Dataset: fmnist
2020-05-30 16:56:12,840 - root - INFO - Normal class: 8
2020-05-30 16:56:12,841 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 16:56:12,841 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-30 16:56:12,841 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 16:56:12,841 - root - INFO - Scenario Running: 1
2020-05-30 16:56:12,841 - root - INFO - Train only the network: True
2020-05-30 16:56:12,841 - root - INFO - Output and AE dimensions: 128
2020-05-30 16:56:12,841 - root - INFO - Known anomaly class: 6
2020-05-30 16:56:12,841 - root - INFO - Network: fmnist_LeNet
2020-05-30 16:56:12,841 - root - INFO - Eta-parameter: 1.00
2020-05-30 16:56:12,852 - root - INFO - Set seed to 0.
2020-05-30 16:56:12,952 - root - INFO - Computation device: cuda
2020-05-30 16:56:12,952 - root - INFO - Number of threads: 0
2020-05-30 16:56:12,952 - root - INFO - Number of dataloader workers: 6
2020-05-30 16:56:22,822 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 16:56:22,840 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 16:56:22,840 - root - INFO - Pretraining: True
2020-05-30 16:56:22,840 - root - INFO - Training optimizer: adam
2020-05-30 16:56:22,841 - root - INFO - Training learning rate: 0.0001
2020-05-30 16:56:22,841 - root - INFO - Training epochs: 150
2020-05-30 16:56:22,841 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 16:56:22,841 - root - INFO - Training batch size: 200
2020-05-30 16:56:22,842 - root - INFO - Training weight decay: 5e-07
2020-05-30 16:56:22,844 - root - INFO - Starting training...
2020-05-30 16:56:30,811 - root - INFO - | Epoch: 001/150 | Train Time: 7.963s | Train Loss: 2.199404 |
2020-05-30 16:56:33,664 - root - INFO - | Epoch: 002/150 | Train Time: 2.851s | Train Loss: 0.686962 |
2020-05-30 16:56:36,784 - root - INFO - | Epoch: 003/150 | Train Time: 3.120s | Train Loss: 0.441161 |
2020-05-30 16:56:40,188 - root - INFO - | Epoch: 004/150 | Train Time: 3.404s | Train Loss: 0.332137 |
2020-05-30 16:56:43,753 - root - INFO - | Epoch: 005/150 | Train Time: 3.564s | Train Loss: 0.263992 |
2020-05-30 16:56:47,041 - root - INFO - | Epoch: 006/150 | Train Time: 3.277s | Train Loss: 0.218144 |
2020-05-30 16:56:50,608 - root - INFO - | Epoch: 007/150 | Train Time: 3.566s | Train Loss: 0.192402 |
2020-05-30 16:56:54,383 - root - INFO - | Epoch: 008/150 | Train Time: 3.775s | Train Loss: 0.172817 |
2020-05-30 16:56:58,074 - root - INFO - | Epoch: 009/150 | Train Time: 3.690s | Train Loss: 0.159058 |
2020-05-30 16:57:01,637 - root - INFO - | Epoch: 010/150 | Train Time: 3.562s | Train Loss: 0.145695 |
2020-05-30 16:57:05,183 - root - INFO - | Epoch: 011/150 | Train Time: 3.546s | Train Loss: 0.136326 |
2020-05-30 16:57:08,833 - root - INFO - | Epoch: 012/150 | Train Time: 3.650s | Train Loss: 0.126975 |
2020-05-30 16:57:12,766 - root - INFO - | Epoch: 013/150 | Train Time: 3.904s | Train Loss: 0.118835 |
2020-05-30 16:57:16,626 - root - INFO - | Epoch: 014/150 | Train Time: 3.860s | Train Loss: 0.111684 |
2020-05-30 16:57:20,068 - root - INFO - | Epoch: 015/150 | Train Time: 3.442s | Train Loss: 0.106546 |
2020-05-30 16:57:23,477 - root - INFO - | Epoch: 016/150 | Train Time: 3.408s | Train Loss: 0.101822 |
2020-05-30 16:57:26,994 - root - INFO - | Epoch: 017/150 | Train Time: 3.516s | Train Loss: 0.100376 |
2020-05-30 16:57:30,562 - root - INFO - | Epoch: 018/150 | Train Time: 3.567s | Train Loss: 0.096700 |
2020-05-30 16:57:33,740 - root - INFO - | Epoch: 019/150 | Train Time: 3.178s | Train Loss: 0.092154 |
2020-05-30 16:57:37,298 - root - INFO - | Epoch: 020/150 | Train Time: 3.557s | Train Loss: 0.087930 |
2020-05-30 16:57:41,157 - root - INFO - | Epoch: 021/150 | Train Time: 3.858s | Train Loss: 0.085421 |
2020-05-30 16:57:44,279 - root - INFO - | Epoch: 022/150 | Train Time: 3.122s | Train Loss: 0.082128 |
2020-05-30 16:57:47,833 - root - INFO - | Epoch: 023/150 | Train Time: 3.553s | Train Loss: 0.079772 |
2020-05-30 16:57:50,977 - root - INFO - | Epoch: 024/150 | Train Time: 3.143s | Train Loss: 0.077119 |
2020-05-30 16:57:54,558 - root - INFO - | Epoch: 025/150 | Train Time: 3.581s | Train Loss: 0.075559 |
2020-05-30 16:57:57,988 - root - INFO - | Epoch: 026/150 | Train Time: 3.430s | Train Loss: 0.073130 |
2020-05-30 16:58:01,828 - root - INFO - | Epoch: 027/150 | Train Time: 3.839s | Train Loss: 0.072242 |
2020-05-30 16:58:05,233 - root - INFO - | Epoch: 028/150 | Train Time: 3.405s | Train Loss: 0.067957 |
2020-05-30 16:58:08,588 - root - INFO - | Epoch: 029/150 | Train Time: 3.354s | Train Loss: 0.068935 |
2020-05-30 16:58:12,349 - root - INFO - | Epoch: 030/150 | Train Time: 3.761s | Train Loss: 0.066122 |
2020-05-30 16:58:16,015 - root - INFO - | Epoch: 031/150 | Train Time: 3.665s | Train Loss: 0.067053 |
2020-05-30 16:58:19,258 - root - INFO - | Epoch: 032/150 | Train Time: 3.243s | Train Loss: 0.063497 |
2020-05-30 16:58:22,219 - root - INFO - | Epoch: 033/150 | Train Time: 2.959s | Train Loss: 0.063890 |
2020-05-30 16:58:25,884 - root - INFO - | Epoch: 034/150 | Train Time: 3.665s | Train Loss: 0.063128 |
2020-05-30 16:58:29,520 - root - INFO - | Epoch: 035/150 | Train Time: 3.635s | Train Loss: 0.059609 |
2020-05-30 16:58:32,773 - root - INFO - | Epoch: 036/150 | Train Time: 3.252s | Train Loss: 0.061141 |
2020-05-30 16:58:35,791 - root - INFO - | Epoch: 037/150 | Train Time: 3.018s | Train Loss: 0.059755 |
2020-05-30 16:58:39,302 - root - INFO - | Epoch: 038/150 | Train Time: 3.510s | Train Loss: 0.059763 |
2020-05-30 16:58:42,345 - root - INFO - | Epoch: 039/150 | Train Time: 3.042s | Train Loss: 0.057027 |
2020-05-30 16:58:45,651 - root - INFO - | Epoch: 040/150 | Train Time: 3.306s | Train Loss: 0.057266 |
2020-05-30 16:58:48,809 - root - INFO - | Epoch: 041/150 | Train Time: 3.157s | Train Loss: 0.054913 |
2020-05-30 16:58:51,868 - root - INFO - | Epoch: 042/150 | Train Time: 3.057s | Train Loss: 0.053490 |
2020-05-30 16:58:55,399 - root - INFO - | Epoch: 043/150 | Train Time: 3.531s | Train Loss: 0.054391 |
2020-05-30 16:58:59,298 - root - INFO - | Epoch: 044/150 | Train Time: 3.899s | Train Loss: 0.054014 |
2020-05-30 16:59:02,944 - root - INFO - | Epoch: 045/150 | Train Time: 3.644s | Train Loss: 0.050568 |
2020-05-30 16:59:06,559 - root - INFO - | Epoch: 046/150 | Train Time: 3.614s | Train Loss: 0.051030 |
2020-05-30 16:59:09,797 - root - INFO - | Epoch: 047/150 | Train Time: 3.238s | Train Loss: 0.050198 |
2020-05-30 16:59:13,282 - root - INFO - | Epoch: 048/150 | Train Time: 3.484s | Train Loss: 0.051366 |
2020-05-30 16:59:16,442 - root - INFO - | Epoch: 049/150 | Train Time: 3.160s | Train Loss: 0.048857 |
2020-05-30 16:59:19,615 - root - INFO - | Epoch: 050/150 | Train Time: 3.172s | Train Loss: 0.047205 |
2020-05-30 16:59:19,616 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 16:59:22,699 - root - INFO - | Epoch: 051/150 | Train Time: 3.083s | Train Loss: 0.046508 |
2020-05-30 16:59:25,724 - root - INFO - | Epoch: 052/150 | Train Time: 3.025s | Train Loss: 0.045888 |
2020-05-30 16:59:28,487 - root - INFO - | Epoch: 053/150 | Train Time: 2.762s | Train Loss: 0.046701 |
2020-05-30 16:59:31,284 - root - INFO - | Epoch: 054/150 | Train Time: 2.796s | Train Loss: 0.045703 |
2020-05-30 16:59:34,027 - root - INFO - | Epoch: 055/150 | Train Time: 2.743s | Train Loss: 0.046052 |
2020-05-30 16:59:37,027 - root - INFO - | Epoch: 056/150 | Train Time: 3.000s | Train Loss: 0.045715 |
2020-05-30 16:59:40,468 - root - INFO - | Epoch: 057/150 | Train Time: 3.440s | Train Loss: 0.046685 |
2020-05-30 16:59:44,020 - root - INFO - | Epoch: 058/150 | Train Time: 3.552s | Train Loss: 0.045850 |
2020-05-30 16:59:47,027 - root - INFO - | Epoch: 059/150 | Train Time: 3.005s | Train Loss: 0.046187 |
2020-05-30 16:59:49,794 - root - INFO - | Epoch: 060/150 | Train Time: 2.766s | Train Loss: 0.046175 |
2020-05-30 16:59:53,142 - root - INFO - | Epoch: 061/150 | Train Time: 3.348s | Train Loss: 0.045741 |
2020-05-30 16:59:56,529 - root - INFO - | Epoch: 062/150 | Train Time: 3.386s | Train Loss: 0.046355 |
2020-05-30 16:59:59,768 - root - INFO - | Epoch: 063/150 | Train Time: 3.239s | Train Loss: 0.044203 |
2020-05-30 17:00:03,305 - root - INFO - | Epoch: 064/150 | Train Time: 3.536s | Train Loss: 0.045285 |
2020-05-30 17:00:06,659 - root - INFO - | Epoch: 065/150 | Train Time: 3.353s | Train Loss: 0.045633 |
2020-05-30 17:00:09,964 - root - INFO - | Epoch: 066/150 | Train Time: 3.305s | Train Loss: 0.045494 |
2020-05-30 17:00:13,697 - root - INFO - | Epoch: 067/150 | Train Time: 3.733s | Train Loss: 0.045010 |
2020-05-30 17:00:16,801 - root - INFO - | Epoch: 068/150 | Train Time: 3.104s | Train Loss: 0.044284 |
2020-05-30 17:00:20,069 - root - INFO - | Epoch: 069/150 | Train Time: 3.267s | Train Loss: 0.044895 |
2020-05-30 17:00:23,041 - root - INFO - | Epoch: 070/150 | Train Time: 2.971s | Train Loss: 0.045002 |
2020-05-30 17:00:26,232 - root - INFO - | Epoch: 071/150 | Train Time: 3.191s | Train Loss: 0.044855 |
2020-05-30 17:00:29,430 - root - INFO - | Epoch: 072/150 | Train Time: 3.197s | Train Loss: 0.046336 |
2020-05-30 17:00:33,164 - root - INFO - | Epoch: 073/150 | Train Time: 3.733s | Train Loss: 0.046380 |
2020-05-30 17:00:36,406 - root - INFO - | Epoch: 074/150 | Train Time: 3.242s | Train Loss: 0.045541 |
2020-05-30 17:00:39,593 - root - INFO - | Epoch: 075/150 | Train Time: 3.187s | Train Loss: 0.044922 |
2020-05-30 17:00:42,783 - root - INFO - | Epoch: 076/150 | Train Time: 3.189s | Train Loss: 0.045445 |
2020-05-30 17:00:46,264 - root - INFO - | Epoch: 077/150 | Train Time: 3.480s | Train Loss: 0.044433 |
2020-05-30 17:00:49,545 - root - INFO - | Epoch: 078/150 | Train Time: 3.280s | Train Loss: 0.044584 |
2020-05-30 17:00:53,062 - root - INFO - | Epoch: 079/150 | Train Time: 3.517s | Train Loss: 0.044760 |
2020-05-30 17:00:56,561 - root - INFO - | Epoch: 080/150 | Train Time: 3.498s | Train Loss: 0.045110 |
2020-05-30 17:00:59,875 - root - INFO - | Epoch: 081/150 | Train Time: 3.313s | Train Loss: 0.044071 |
2020-05-30 17:01:03,276 - root - INFO - | Epoch: 082/150 | Train Time: 3.289s | Train Loss: 0.044516 |
2020-05-30 17:01:06,773 - root - INFO - | Epoch: 083/150 | Train Time: 3.497s | Train Loss: 0.044362 |
2020-05-30 17:01:09,942 - root - INFO - | Epoch: 084/150 | Train Time: 3.168s | Train Loss: 0.044043 |
2020-05-30 17:01:13,032 - root - INFO - | Epoch: 085/150 | Train Time: 3.089s | Train Loss: 0.044390 |
2020-05-30 17:01:16,379 - root - INFO - | Epoch: 086/150 | Train Time: 3.347s | Train Loss: 0.044519 |
2020-05-30 17:01:19,538 - root - INFO - | Epoch: 087/150 | Train Time: 3.159s | Train Loss: 0.043852 |
2020-05-30 17:01:22,766 - root - INFO - | Epoch: 088/150 | Train Time: 3.228s | Train Loss: 0.043882 |
2020-05-30 17:01:25,812 - root - INFO - | Epoch: 089/150 | Train Time: 3.045s | Train Loss: 0.043271 |
2020-05-30 17:01:29,008 - root - INFO - | Epoch: 090/150 | Train Time: 3.196s | Train Loss: 0.044363 |
2020-05-30 17:01:32,433 - root - INFO - | Epoch: 091/150 | Train Time: 3.424s | Train Loss: 0.042717 |
2020-05-30 17:01:35,666 - root - INFO - | Epoch: 092/150 | Train Time: 3.232s | Train Loss: 0.044010 |
2020-05-30 17:01:39,071 - root - INFO - | Epoch: 093/150 | Train Time: 3.404s | Train Loss: 0.041598 |
2020-05-30 17:01:42,171 - root - INFO - | Epoch: 094/150 | Train Time: 3.100s | Train Loss: 0.043780 |
2020-05-30 17:01:45,101 - root - INFO - | Epoch: 095/150 | Train Time: 2.929s | Train Loss: 0.043156 |
2020-05-30 17:01:48,465 - root - INFO - | Epoch: 096/150 | Train Time: 3.364s | Train Loss: 0.042761 |
2020-05-30 17:01:51,555 - root - INFO - | Epoch: 097/150 | Train Time: 3.089s | Train Loss: 0.042080 |
2020-05-30 17:01:54,874 - root - INFO - | Epoch: 098/150 | Train Time: 3.319s | Train Loss: 0.042731 |
2020-05-30 17:01:58,075 - root - INFO - | Epoch: 099/150 | Train Time: 3.200s | Train Loss: 0.043654 |
2020-05-30 17:02:01,294 - root - INFO - | Epoch: 100/150 | Train Time: 3.219s | Train Loss: 0.042212 |
2020-05-30 17:02:04,804 - root - INFO - | Epoch: 101/150 | Train Time: 3.509s | Train Loss: 0.041981 |
2020-05-30 17:02:07,906 - root - INFO - | Epoch: 102/150 | Train Time: 3.102s | Train Loss: 0.041658 |
2020-05-30 17:02:10,899 - root - INFO - | Epoch: 103/150 | Train Time: 2.993s | Train Loss: 0.042769 |
2020-05-30 17:02:14,099 - root - INFO - | Epoch: 104/150 | Train Time: 3.199s | Train Loss: 0.042965 |
2020-05-30 17:02:16,824 - root - INFO - | Epoch: 105/150 | Train Time: 2.724s | Train Loss: 0.041698 |
2020-05-30 17:02:19,787 - root - INFO - | Epoch: 106/150 | Train Time: 2.963s | Train Loss: 0.042512 |
2020-05-30 17:02:23,402 - root - INFO - | Epoch: 107/150 | Train Time: 3.614s | Train Loss: 0.042790 |
2020-05-30 17:02:26,537 - root - INFO - | Epoch: 108/150 | Train Time: 3.134s | Train Loss: 0.041690 |
2020-05-30 17:02:30,140 - root - INFO - | Epoch: 109/150 | Train Time: 3.603s | Train Loss: 0.041262 |
2020-05-30 17:02:33,417 - root - INFO - | Epoch: 110/150 | Train Time: 3.275s | Train Loss: 0.041570 |
2020-05-30 17:02:36,895 - root - INFO - | Epoch: 111/150 | Train Time: 3.477s | Train Loss: 0.041894 |
2020-05-30 17:02:40,298 - root - INFO - | Epoch: 112/150 | Train Time: 3.402s | Train Loss: 0.042047 |
2020-05-30 17:02:43,640 - root - INFO - | Epoch: 113/150 | Train Time: 3.342s | Train Loss: 0.041285 |
2020-05-30 17:02:46,523 - root - INFO - | Epoch: 114/150 | Train Time: 2.882s | Train Loss: 0.041338 |
2020-05-30 17:02:49,648 - root - INFO - | Epoch: 115/150 | Train Time: 3.125s | Train Loss: 0.042186 |
2020-05-30 17:02:52,631 - root - INFO - | Epoch: 116/150 | Train Time: 2.982s | Train Loss: 0.040839 |
2020-05-30 17:02:55,890 - root - INFO - | Epoch: 117/150 | Train Time: 3.259s | Train Loss: 0.041847 |
2020-05-30 17:02:59,838 - root - INFO - | Epoch: 118/150 | Train Time: 3.948s | Train Loss: 0.041449 |
2020-05-30 17:03:02,833 - root - INFO - | Epoch: 119/150 | Train Time: 2.994s | Train Loss: 0.042102 |
2020-05-30 17:03:06,127 - root - INFO - | Epoch: 120/150 | Train Time: 3.293s | Train Loss: 0.041620 |
2020-05-30 17:03:09,216 - root - INFO - | Epoch: 121/150 | Train Time: 3.088s | Train Loss: 0.040788 |
2020-05-30 17:03:12,392 - root - INFO - | Epoch: 122/150 | Train Time: 3.176s | Train Loss: 0.040425 |
2020-05-30 17:03:15,850 - root - INFO - | Epoch: 123/150 | Train Time: 3.458s | Train Loss: 0.040061 |
2020-05-30 17:03:18,959 - root - INFO - | Epoch: 124/150 | Train Time: 3.108s | Train Loss: 0.041263 |
2020-05-30 17:03:22,528 - root - INFO - | Epoch: 125/150 | Train Time: 3.568s | Train Loss: 0.040791 |
2020-05-30 17:03:25,649 - root - INFO - | Epoch: 126/150 | Train Time: 3.121s | Train Loss: 0.040268 |
2020-05-30 17:03:28,713 - root - INFO - | Epoch: 127/150 | Train Time: 3.063s | Train Loss: 0.040779 |
2020-05-30 17:03:31,755 - root - INFO - | Epoch: 128/150 | Train Time: 3.042s | Train Loss: 0.039806 |
2020-05-30 17:03:34,806 - root - INFO - | Epoch: 129/150 | Train Time: 3.051s | Train Loss: 0.041591 |
2020-05-30 17:03:37,826 - root - INFO - | Epoch: 130/150 | Train Time: 3.019s | Train Loss: 0.040124 |
2020-05-30 17:03:40,681 - root - INFO - | Epoch: 131/150 | Train Time: 2.854s | Train Loss: 0.039118 |
2020-05-30 17:03:43,965 - root - INFO - | Epoch: 132/150 | Train Time: 3.283s | Train Loss: 0.039229 |
2020-05-30 17:03:47,088 - root - INFO - | Epoch: 133/150 | Train Time: 3.123s | Train Loss: 0.039790 |
2020-05-30 17:03:50,551 - root - INFO - | Epoch: 134/150 | Train Time: 3.463s | Train Loss: 0.039825 |
2020-05-30 17:03:54,282 - root - INFO - | Epoch: 135/150 | Train Time: 3.730s | Train Loss: 0.040044 |
2020-05-30 17:03:58,364 - root - INFO - | Epoch: 136/150 | Train Time: 4.081s | Train Loss: 0.040190 |
2020-05-30 17:04:02,157 - root - INFO - | Epoch: 137/150 | Train Time: 3.793s | Train Loss: 0.040680 |
2020-05-30 17:04:06,329 - root - INFO - | Epoch: 138/150 | Train Time: 4.171s | Train Loss: 0.039626 |
2020-05-30 17:04:09,721 - root - INFO - | Epoch: 139/150 | Train Time: 3.390s | Train Loss: 0.039567 |
2020-05-30 17:04:13,058 - root - INFO - | Epoch: 140/150 | Train Time: 3.337s | Train Loss: 0.039515 |
2020-05-30 17:04:15,976 - root - INFO - | Epoch: 141/150 | Train Time: 2.917s | Train Loss: 0.039780 |
2020-05-30 17:04:19,002 - root - INFO - | Epoch: 142/150 | Train Time: 3.025s | Train Loss: 0.038487 |
2020-05-30 17:04:22,184 - root - INFO - | Epoch: 143/150 | Train Time: 3.182s | Train Loss: 0.039554 |
2020-05-30 17:04:25,461 - root - INFO - | Epoch: 144/150 | Train Time: 3.277s | Train Loss: 0.039916 |
2020-05-30 17:04:29,223 - root - INFO - | Epoch: 145/150 | Train Time: 3.760s | Train Loss: 0.039543 |
2020-05-30 17:04:32,948 - root - INFO - | Epoch: 146/150 | Train Time: 3.725s | Train Loss: 0.039689 |
2020-05-30 17:04:35,959 - root - INFO - | Epoch: 147/150 | Train Time: 3.010s | Train Loss: 0.038658 |
2020-05-30 17:04:38,732 - root - INFO - | Epoch: 148/150 | Train Time: 2.772s | Train Loss: 0.038726 |
2020-05-30 17:04:41,953 - root - INFO - | Epoch: 149/150 | Train Time: 3.220s | Train Loss: 0.039239 |
2020-05-30 17:04:45,513 - root - INFO - | Epoch: 150/150 | Train Time: 3.560s | Train Loss: 0.038479 |
2020-05-30 17:04:45,515 - root - INFO - Training Time: 502.667s
2020-05-30 17:04:45,515 - root - INFO - Finished training.
2020-05-30 17:04:45,517 - root - INFO - Starting testing...
2020-05-30 17:04:49,184 - root - INFO - Test Loss: 0.107201
2020-05-30 17:04:49,185 - root - INFO - Test AUC: 87.70%
2020-05-30 17:04:49,185 - root - INFO - Test Time: 3.654s
2020-05-30 17:04:49,185 - root - INFO - Finished testing.
