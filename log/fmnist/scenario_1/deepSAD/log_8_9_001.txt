2020-05-30 17:51:28,420 - root - INFO - Log file is ../log/fmnist/scenario_1/deepSAD//log_8_9_001.txt
2020-05-30 17:51:28,420 - root - INFO - Data path is ../data
2020-05-30 17:51:28,420 - root - INFO - Export path is ../log/fmnist/scenario_1/deepSAD/
2020-05-30 17:51:28,420 - root - INFO - Dataset: fmnist
2020-05-30 17:51:28,420 - root - INFO - Normal class: 8
2020-05-30 17:51:28,420 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 17:51:28,420 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-30 17:51:28,420 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 17:51:28,420 - root - INFO - Scenario Running: 1
2020-05-30 17:51:28,421 - root - INFO - Train only the network: True
2020-05-30 17:51:28,421 - root - INFO - Output and AE dimensions: 128
2020-05-30 17:51:28,421 - root - INFO - Known anomaly class: 9
2020-05-30 17:51:28,421 - root - INFO - Network: fmnist_LeNet
2020-05-30 17:51:28,421 - root - INFO - Eta-parameter: 1.00
2020-05-30 17:51:28,457 - root - INFO - Set seed to 0.
2020-05-30 17:51:28,483 - root - INFO - Computation device: cuda
2020-05-30 17:51:28,483 - root - INFO - Number of threads: 0
2020-05-30 17:51:28,484 - root - INFO - Number of dataloader workers: 6
2020-05-30 17:51:40,264 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-30 17:51:40,276 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 17:51:40,276 - root - INFO - Pretraining: True
2020-05-30 17:51:40,276 - root - INFO - Training optimizer: adam
2020-05-30 17:51:40,276 - root - INFO - Training learning rate: 0.0001
2020-05-30 17:51:40,276 - root - INFO - Training epochs: 150
2020-05-30 17:51:40,276 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 17:51:40,277 - root - INFO - Training batch size: 200
2020-05-30 17:51:40,277 - root - INFO - Training weight decay: 5e-07
2020-05-30 17:51:40,279 - root - INFO - Starting training...
2020-05-30 17:51:51,569 - root - INFO - | Epoch: 001/150 | Train Time: 11.290s | Train Loss: 2.214528 |
2020-05-30 17:51:55,302 - root - INFO - | Epoch: 002/150 | Train Time: 3.732s | Train Loss: 0.692493 |
2020-05-30 17:51:59,104 - root - INFO - | Epoch: 003/150 | Train Time: 3.801s | Train Loss: 0.440993 |
2020-05-30 17:52:02,480 - root - INFO - | Epoch: 004/150 | Train Time: 3.376s | Train Loss: 0.327249 |
2020-05-30 17:52:05,665 - root - INFO - | Epoch: 005/150 | Train Time: 3.184s | Train Loss: 0.256032 |
2020-05-30 17:52:09,010 - root - INFO - | Epoch: 006/150 | Train Time: 3.345s | Train Loss: 0.207752 |
2020-05-30 17:52:12,052 - root - INFO - | Epoch: 007/150 | Train Time: 3.041s | Train Loss: 0.180355 |
2020-05-30 17:52:15,202 - root - INFO - | Epoch: 008/150 | Train Time: 3.150s | Train Loss: 0.159362 |
2020-05-30 17:52:19,027 - root - INFO - | Epoch: 009/150 | Train Time: 3.824s | Train Loss: 0.144636 |
2020-05-30 17:52:22,842 - root - INFO - | Epoch: 010/150 | Train Time: 3.815s | Train Loss: 0.130806 |
2020-05-30 17:52:26,691 - root - INFO - | Epoch: 011/150 | Train Time: 3.848s | Train Loss: 0.121622 |
2020-05-30 17:52:30,204 - root - INFO - | Epoch: 012/150 | Train Time: 3.512s | Train Loss: 0.110751 |
2020-05-30 17:52:33,658 - root - INFO - | Epoch: 013/150 | Train Time: 3.453s | Train Loss: 0.101722 |
2020-05-30 17:52:36,971 - root - INFO - | Epoch: 014/150 | Train Time: 3.313s | Train Loss: 0.096149 |
2020-05-30 17:52:40,449 - root - INFO - | Epoch: 015/150 | Train Time: 3.478s | Train Loss: 0.090531 |
2020-05-30 17:52:43,481 - root - INFO - | Epoch: 016/150 | Train Time: 3.031s | Train Loss: 0.086398 |
2020-05-30 17:52:46,539 - root - INFO - | Epoch: 017/150 | Train Time: 3.058s | Train Loss: 0.083815 |
2020-05-30 17:52:49,578 - root - INFO - | Epoch: 018/150 | Train Time: 3.038s | Train Loss: 0.080437 |
2020-05-30 17:52:52,775 - root - INFO - | Epoch: 019/150 | Train Time: 3.197s | Train Loss: 0.075837 |
2020-05-30 17:52:55,831 - root - INFO - | Epoch: 020/150 | Train Time: 3.054s | Train Loss: 0.071385 |
2020-05-30 17:52:58,505 - root - INFO - | Epoch: 021/150 | Train Time: 2.673s | Train Loss: 0.069130 |
2020-05-30 17:53:01,571 - root - INFO - | Epoch: 022/150 | Train Time: 3.066s | Train Loss: 0.066879 |
2020-05-30 17:53:04,697 - root - INFO - | Epoch: 023/150 | Train Time: 3.126s | Train Loss: 0.064016 |
2020-05-30 17:53:07,755 - root - INFO - | Epoch: 024/150 | Train Time: 3.058s | Train Loss: 0.061308 |
2020-05-30 17:53:11,798 - root - INFO - | Epoch: 025/150 | Train Time: 4.042s | Train Loss: 0.060170 |
2020-05-30 17:53:15,359 - root - INFO - | Epoch: 026/150 | Train Time: 3.561s | Train Loss: 0.057790 |
2020-05-30 17:53:18,658 - root - INFO - | Epoch: 027/150 | Train Time: 3.298s | Train Loss: 0.057884 |
2020-05-30 17:53:22,174 - root - INFO - | Epoch: 028/150 | Train Time: 3.516s | Train Loss: 0.054165 |
2020-05-30 17:53:25,788 - root - INFO - | Epoch: 029/150 | Train Time: 3.613s | Train Loss: 0.053921 |
2020-05-30 17:53:28,989 - root - INFO - | Epoch: 030/150 | Train Time: 3.200s | Train Loss: 0.052439 |
2020-05-30 17:53:32,096 - root - INFO - | Epoch: 031/150 | Train Time: 3.107s | Train Loss: 0.052792 |
2020-05-30 17:53:35,276 - root - INFO - | Epoch: 032/150 | Train Time: 3.179s | Train Loss: 0.050835 |
2020-05-30 17:53:38,832 - root - INFO - | Epoch: 033/150 | Train Time: 3.556s | Train Loss: 0.050100 |
2020-05-30 17:53:42,430 - root - INFO - | Epoch: 034/150 | Train Time: 3.597s | Train Loss: 0.049662 |
2020-05-30 17:53:45,813 - root - INFO - | Epoch: 035/150 | Train Time: 3.383s | Train Loss: 0.047235 |
2020-05-30 17:53:49,269 - root - INFO - | Epoch: 036/150 | Train Time: 3.456s | Train Loss: 0.048313 |
2020-05-30 17:53:52,263 - root - INFO - | Epoch: 037/150 | Train Time: 2.993s | Train Loss: 0.046238 |
2020-05-30 17:53:55,764 - root - INFO - | Epoch: 038/150 | Train Time: 3.501s | Train Loss: 0.047229 |
2020-05-30 17:53:59,161 - root - INFO - | Epoch: 039/150 | Train Time: 3.396s | Train Loss: 0.044519 |
2020-05-30 17:54:02,617 - root - INFO - | Epoch: 040/150 | Train Time: 3.456s | Train Loss: 0.047192 |
2020-05-30 17:54:06,173 - root - INFO - | Epoch: 041/150 | Train Time: 3.556s | Train Loss: 0.043866 |
2020-05-30 17:54:09,243 - root - INFO - | Epoch: 042/150 | Train Time: 3.070s | Train Loss: 0.042831 |
2020-05-30 17:54:12,617 - root - INFO - | Epoch: 043/150 | Train Time: 3.374s | Train Loss: 0.042725 |
2020-05-30 17:54:16,469 - root - INFO - | Epoch: 044/150 | Train Time: 3.851s | Train Loss: 0.043073 |
2020-05-30 17:54:19,490 - root - INFO - | Epoch: 045/150 | Train Time: 3.020s | Train Loss: 0.040197 |
2020-05-30 17:54:22,803 - root - INFO - | Epoch: 046/150 | Train Time: 3.312s | Train Loss: 0.040790 |
2020-05-30 17:54:25,972 - root - INFO - | Epoch: 047/150 | Train Time: 3.169s | Train Loss: 0.039471 |
2020-05-30 17:54:30,155 - root - INFO - | Epoch: 048/150 | Train Time: 4.182s | Train Loss: 0.040870 |
2020-05-30 17:54:33,986 - root - INFO - | Epoch: 049/150 | Train Time: 3.830s | Train Loss: 0.038967 |
2020-05-30 17:54:37,655 - root - INFO - | Epoch: 050/150 | Train Time: 3.669s | Train Loss: 0.038552 |
2020-05-30 17:54:37,655 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 17:54:41,417 - root - INFO - | Epoch: 051/150 | Train Time: 3.761s | Train Loss: 0.037042 |
2020-05-30 17:54:44,555 - root - INFO - | Epoch: 052/150 | Train Time: 3.138s | Train Loss: 0.037313 |
2020-05-30 17:54:47,935 - root - INFO - | Epoch: 053/150 | Train Time: 3.380s | Train Loss: 0.037736 |
2020-05-30 17:54:51,293 - root - INFO - | Epoch: 054/150 | Train Time: 3.357s | Train Loss: 0.036651 |
2020-05-30 17:54:54,649 - root - INFO - | Epoch: 055/150 | Train Time: 3.355s | Train Loss: 0.037323 |
2020-05-30 17:54:58,289 - root - INFO - | Epoch: 056/150 | Train Time: 3.639s | Train Loss: 0.037285 |
2020-05-30 17:55:02,003 - root - INFO - | Epoch: 057/150 | Train Time: 3.713s | Train Loss: 0.037586 |
2020-05-30 17:55:05,766 - root - INFO - | Epoch: 058/150 | Train Time: 3.763s | Train Loss: 0.036696 |
2020-05-30 17:55:09,598 - root - INFO - | Epoch: 059/150 | Train Time: 3.831s | Train Loss: 0.037746 |
2020-05-30 17:55:13,620 - root - INFO - | Epoch: 060/150 | Train Time: 4.021s | Train Loss: 0.036923 |
2020-05-30 17:55:16,996 - root - INFO - | Epoch: 061/150 | Train Time: 3.368s | Train Loss: 0.037242 |
2020-05-30 17:55:20,757 - root - INFO - | Epoch: 062/150 | Train Time: 3.760s | Train Loss: 0.037448 |
2020-05-30 17:55:24,251 - root - INFO - | Epoch: 063/150 | Train Time: 3.494s | Train Loss: 0.035667 |
2020-05-30 17:55:28,034 - root - INFO - | Epoch: 064/150 | Train Time: 3.782s | Train Loss: 0.036939 |
2020-05-30 17:55:31,303 - root - INFO - | Epoch: 065/150 | Train Time: 3.267s | Train Loss: 0.036489 |
2020-05-30 17:55:34,621 - root - INFO - | Epoch: 066/150 | Train Time: 3.318s | Train Loss: 0.036616 |
2020-05-30 17:55:38,141 - root - INFO - | Epoch: 067/150 | Train Time: 3.519s | Train Loss: 0.036488 |
2020-05-30 17:55:41,726 - root - INFO - | Epoch: 068/150 | Train Time: 3.584s | Train Loss: 0.035634 |
2020-05-30 17:55:45,487 - root - INFO - | Epoch: 069/150 | Train Time: 3.760s | Train Loss: 0.035776 |
2020-05-30 17:55:49,202 - root - INFO - | Epoch: 070/150 | Train Time: 3.715s | Train Loss: 0.035847 |
2020-05-30 17:55:53,010 - root - INFO - | Epoch: 071/150 | Train Time: 3.807s | Train Loss: 0.036948 |
2020-05-30 17:55:56,178 - root - INFO - | Epoch: 072/150 | Train Time: 3.168s | Train Loss: 0.037455 |
2020-05-30 17:55:59,163 - root - INFO - | Epoch: 073/150 | Train Time: 2.984s | Train Loss: 0.037172 |
2020-05-30 17:56:02,144 - root - INFO - | Epoch: 074/150 | Train Time: 2.980s | Train Loss: 0.036415 |
2020-05-30 17:56:05,235 - root - INFO - | Epoch: 075/150 | Train Time: 3.091s | Train Loss: 0.036287 |
2020-05-30 17:56:08,808 - root - INFO - | Epoch: 076/150 | Train Time: 3.572s | Train Loss: 0.036776 |
2020-05-30 17:56:12,256 - root - INFO - | Epoch: 077/150 | Train Time: 3.448s | Train Loss: 0.035910 |
2020-05-30 17:56:16,173 - root - INFO - | Epoch: 078/150 | Train Time: 3.916s | Train Loss: 0.036090 |
2020-05-30 17:56:20,138 - root - INFO - | Epoch: 079/150 | Train Time: 3.965s | Train Loss: 0.036384 |
2020-05-30 17:56:23,498 - root - INFO - | Epoch: 080/150 | Train Time: 3.360s | Train Loss: 0.036179 |
2020-05-30 17:56:26,785 - root - INFO - | Epoch: 081/150 | Train Time: 3.286s | Train Loss: 0.035934 |
2020-05-30 17:56:29,927 - root - INFO - | Epoch: 082/150 | Train Time: 3.141s | Train Loss: 0.035623 |
2020-05-30 17:56:33,224 - root - INFO - | Epoch: 083/150 | Train Time: 3.297s | Train Loss: 0.035595 |
2020-05-30 17:56:37,344 - root - INFO - | Epoch: 084/150 | Train Time: 4.108s | Train Loss: 0.035600 |
2020-05-30 17:56:41,707 - root - INFO - | Epoch: 085/150 | Train Time: 4.362s | Train Loss: 0.035845 |
2020-05-30 17:56:45,505 - root - INFO - | Epoch: 086/150 | Train Time: 3.798s | Train Loss: 0.035632 |
2020-05-30 17:56:49,489 - root - INFO - | Epoch: 087/150 | Train Time: 3.983s | Train Loss: 0.035359 |
2020-05-30 17:56:53,639 - root - INFO - | Epoch: 088/150 | Train Time: 4.150s | Train Loss: 0.035437 |
2020-05-30 17:56:56,856 - root - INFO - | Epoch: 089/150 | Train Time: 3.216s | Train Loss: 0.034369 |
2020-05-30 17:56:59,720 - root - INFO - | Epoch: 090/150 | Train Time: 2.863s | Train Loss: 0.036229 |
2020-05-30 17:57:02,944 - root - INFO - | Epoch: 091/150 | Train Time: 3.224s | Train Loss: 0.035086 |
2020-05-30 17:57:06,426 - root - INFO - | Epoch: 092/150 | Train Time: 3.481s | Train Loss: 0.035794 |
2020-05-30 17:57:10,057 - root - INFO - | Epoch: 093/150 | Train Time: 3.630s | Train Loss: 0.034225 |
2020-05-30 17:57:13,927 - root - INFO - | Epoch: 094/150 | Train Time: 3.870s | Train Loss: 0.035547 |
2020-05-30 17:57:17,577 - root - INFO - | Epoch: 095/150 | Train Time: 3.648s | Train Loss: 0.035010 |
2020-05-30 17:57:21,087 - root - INFO - | Epoch: 096/150 | Train Time: 3.510s | Train Loss: 0.035328 |
2020-05-30 17:57:24,252 - root - INFO - | Epoch: 097/150 | Train Time: 3.164s | Train Loss: 0.034567 |
2020-05-30 17:57:27,996 - root - INFO - | Epoch: 098/150 | Train Time: 3.744s | Train Loss: 0.034913 |
2020-05-30 17:57:31,467 - root - INFO - | Epoch: 099/150 | Train Time: 3.470s | Train Loss: 0.035358 |
2020-05-30 17:57:34,843 - root - INFO - | Epoch: 100/150 | Train Time: 3.375s | Train Loss: 0.034202 |
2020-05-30 17:57:38,047 - root - INFO - | Epoch: 101/150 | Train Time: 3.203s | Train Loss: 0.033946 |
2020-05-30 17:57:41,343 - root - INFO - | Epoch: 102/150 | Train Time: 3.295s | Train Loss: 0.034065 |
2020-05-30 17:57:44,319 - root - INFO - | Epoch: 103/150 | Train Time: 2.976s | Train Loss: 0.034648 |
2020-05-30 17:57:46,616 - root - INFO - | Epoch: 104/150 | Train Time: 2.296s | Train Loss: 0.034570 |
2020-05-30 17:57:49,000 - root - INFO - | Epoch: 105/150 | Train Time: 2.383s | Train Loss: 0.034010 |
2020-05-30 17:57:51,563 - root - INFO - | Epoch: 106/150 | Train Time: 2.562s | Train Loss: 0.034362 |
2020-05-30 17:57:54,732 - root - INFO - | Epoch: 107/150 | Train Time: 3.168s | Train Loss: 0.033959 |
2020-05-30 17:57:57,323 - root - INFO - | Epoch: 108/150 | Train Time: 2.590s | Train Loss: 0.033883 |
2020-05-30 17:57:59,976 - root - INFO - | Epoch: 109/150 | Train Time: 2.653s | Train Loss: 0.033176 |
2020-05-30 17:58:03,557 - root - INFO - | Epoch: 110/150 | Train Time: 3.580s | Train Loss: 0.034144 |
2020-05-30 17:58:07,394 - root - INFO - | Epoch: 111/150 | Train Time: 3.836s | Train Loss: 0.034210 |
2020-05-30 17:58:10,875 - root - INFO - | Epoch: 112/150 | Train Time: 3.480s | Train Loss: 0.033471 |
2020-05-30 17:58:14,607 - root - INFO - | Epoch: 113/150 | Train Time: 3.732s | Train Loss: 0.033558 |
2020-05-30 17:58:18,509 - root - INFO - | Epoch: 114/150 | Train Time: 3.901s | Train Loss: 0.033248 |
2020-05-30 17:58:22,059 - root - INFO - | Epoch: 115/150 | Train Time: 3.548s | Train Loss: 0.034396 |
2020-05-30 17:58:25,410 - root - INFO - | Epoch: 116/150 | Train Time: 3.350s | Train Loss: 0.033063 |
2020-05-30 17:58:28,631 - root - INFO - | Epoch: 117/150 | Train Time: 3.220s | Train Loss: 0.033612 |
2020-05-30 17:58:31,304 - root - INFO - | Epoch: 118/150 | Train Time: 2.672s | Train Loss: 0.033851 |
2020-05-30 17:58:34,091 - root - INFO - | Epoch: 119/150 | Train Time: 2.787s | Train Loss: 0.034449 |
2020-05-30 17:58:37,224 - root - INFO - | Epoch: 120/150 | Train Time: 3.132s | Train Loss: 0.033385 |
2020-05-30 17:58:40,562 - root - INFO - | Epoch: 121/150 | Train Time: 3.338s | Train Loss: 0.032142 |
2020-05-30 17:58:44,031 - root - INFO - | Epoch: 122/150 | Train Time: 3.468s | Train Loss: 0.033057 |
2020-05-30 17:58:47,597 - root - INFO - | Epoch: 123/150 | Train Time: 3.565s | Train Loss: 0.032646 |
2020-05-30 17:58:50,804 - root - INFO - | Epoch: 124/150 | Train Time: 3.206s | Train Loss: 0.033506 |
2020-05-30 17:58:53,947 - root - INFO - | Epoch: 125/150 | Train Time: 3.143s | Train Loss: 0.033168 |
2020-05-30 17:58:56,854 - root - INFO - | Epoch: 126/150 | Train Time: 2.907s | Train Loss: 0.032389 |
2020-05-30 17:59:00,597 - root - INFO - | Epoch: 127/150 | Train Time: 3.742s | Train Loss: 0.032282 |
2020-05-30 17:59:03,928 - root - INFO - | Epoch: 128/150 | Train Time: 3.331s | Train Loss: 0.032853 |
2020-05-30 17:59:07,213 - root - INFO - | Epoch: 129/150 | Train Time: 3.284s | Train Loss: 0.034238 |
2020-05-30 17:59:10,629 - root - INFO - | Epoch: 130/150 | Train Time: 3.415s | Train Loss: 0.032470 |
2020-05-30 17:59:14,331 - root - INFO - | Epoch: 131/150 | Train Time: 3.701s | Train Loss: 0.031904 |
2020-05-30 17:59:17,722 - root - INFO - | Epoch: 132/150 | Train Time: 3.390s | Train Loss: 0.031938 |
2020-05-30 17:59:21,034 - root - INFO - | Epoch: 133/150 | Train Time: 3.312s | Train Loss: 0.032183 |
2020-05-30 17:59:24,598 - root - INFO - | Epoch: 134/150 | Train Time: 3.564s | Train Loss: 0.032524 |
2020-05-30 17:59:27,936 - root - INFO - | Epoch: 135/150 | Train Time: 3.337s | Train Loss: 0.033471 |
2020-05-30 17:59:31,027 - root - INFO - | Epoch: 136/150 | Train Time: 3.091s | Train Loss: 0.032818 |
2020-05-30 17:59:34,178 - root - INFO - | Epoch: 137/150 | Train Time: 3.151s | Train Loss: 0.032968 |
2020-05-30 17:59:37,496 - root - INFO - | Epoch: 138/150 | Train Time: 3.317s | Train Loss: 0.032200 |
2020-05-30 17:59:41,329 - root - INFO - | Epoch: 139/150 | Train Time: 3.832s | Train Loss: 0.032088 |
2020-05-30 17:59:44,999 - root - INFO - | Epoch: 140/150 | Train Time: 3.669s | Train Loss: 0.032475 |
2020-05-30 17:59:48,649 - root - INFO - | Epoch: 141/150 | Train Time: 3.650s | Train Loss: 0.032131 |
2020-05-30 17:59:52,199 - root - INFO - | Epoch: 142/150 | Train Time: 3.518s | Train Loss: 0.031121 |
2020-05-30 17:59:56,288 - root - INFO - | Epoch: 143/150 | Train Time: 4.088s | Train Loss: 0.032347 |
2020-05-30 17:59:59,503 - root - INFO - | Epoch: 144/150 | Train Time: 3.215s | Train Loss: 0.032350 |
2020-05-30 18:00:02,900 - root - INFO - | Epoch: 145/150 | Train Time: 3.396s | Train Loss: 0.032457 |
2020-05-30 18:00:06,085 - root - INFO - | Epoch: 146/150 | Train Time: 3.185s | Train Loss: 0.032353 |
2020-05-30 18:00:09,494 - root - INFO - | Epoch: 147/150 | Train Time: 3.408s | Train Loss: 0.031457 |
2020-05-30 18:00:12,855 - root - INFO - | Epoch: 148/150 | Train Time: 3.361s | Train Loss: 0.031033 |
2020-05-30 18:00:15,942 - root - INFO - | Epoch: 149/150 | Train Time: 3.086s | Train Loss: 0.031654 |
2020-05-30 18:00:19,362 - root - INFO - | Epoch: 150/150 | Train Time: 3.419s | Train Loss: 0.031153 |
2020-05-30 18:00:19,362 - root - INFO - Training Time: 519.083s
2020-05-30 18:00:19,362 - root - INFO - Finished training.
2020-05-30 18:00:19,363 - root - INFO - Starting testing...
2020-05-30 18:00:23,498 - root - INFO - Test Loss: 0.110660
2020-05-30 18:00:23,498 - root - INFO - Test AUC: 81.31%
2020-05-30 18:00:23,498 - root - INFO - Test Time: 4.115s
2020-05-30 18:00:23,498 - root - INFO - Finished testing.
