2020-05-29 17:25:18,442 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_1_6_001.txt
2020-05-29 17:25:18,442 - root - INFO - Data path is ../data
2020-05-29 17:25:18,442 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-29 17:25:18,442 - root - INFO - Dataset: fmnist
2020-05-29 17:25:18,442 - root - INFO - Normal class: 1
2020-05-29 17:25:18,442 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-29 17:25:18,442 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-29 17:25:18,442 - root - INFO - Pollution ratio of unlabeled train data: 0.01
2020-05-29 17:25:18,442 - root - INFO - Scenario Running: 2
2020-05-29 17:25:18,442 - root - INFO - Train only the network: True
2020-05-29 17:25:18,443 - root - INFO - Output and AE dimensions: 128
2020-05-29 17:25:18,443 - root - INFO - Known anomaly class: 6
2020-05-29 17:25:18,443 - root - INFO - Network: fmnist_LeNet
2020-05-29 17:25:18,443 - root - INFO - Eta-parameter: 1.00
2020-05-29 17:25:18,450 - root - INFO - Set seed to 0.
2020-05-29 17:25:18,508 - root - INFO - Computation device: cuda
2020-05-29 17:25:18,508 - root - INFO - Number of threads: 0
2020-05-29 17:25:18,508 - root - INFO - Number of dataloader workers: 6
2020-05-29 17:25:33,330 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-29 17:25:33,375 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-29 17:25:33,375 - root - INFO - Pretraining: True
2020-05-29 17:25:33,375 - root - INFO - Training optimizer: adam
2020-05-29 17:25:33,376 - root - INFO - Training learning rate: 0.0001
2020-05-29 17:25:33,376 - root - INFO - Training epochs: 150
2020-05-29 17:25:33,376 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-29 17:25:33,376 - root - INFO - Training batch size: 200
2020-05-29 17:25:33,376 - root - INFO - Training weight decay: 5e-07
2020-05-29 17:25:33,378 - root - INFO - Starting training...
2020-05-29 17:25:44,985 - root - INFO - | Epoch: 001/150 | Train Time: 11.606s | Train Loss: 1.374417 |
2020-05-29 17:25:48,268 - root - INFO - | Epoch: 002/150 | Train Time: 3.282s | Train Loss: 0.355196 |
2020-05-29 17:25:52,428 - root - INFO - | Epoch: 003/150 | Train Time: 4.160s | Train Loss: 0.230679 |
2020-05-29 17:25:56,215 - root - INFO - | Epoch: 004/150 | Train Time: 3.786s | Train Loss: 0.183282 |
2020-05-29 17:25:59,208 - root - INFO - | Epoch: 005/150 | Train Time: 2.992s | Train Loss: 0.156286 |
2020-05-29 17:26:02,478 - root - INFO - | Epoch: 006/150 | Train Time: 3.270s | Train Loss: 0.136805 |
2020-05-29 17:26:05,454 - root - INFO - | Epoch: 007/150 | Train Time: 2.975s | Train Loss: 0.120944 |
2020-05-29 17:26:09,118 - root - INFO - | Epoch: 008/150 | Train Time: 3.664s | Train Loss: 0.112231 |
2020-05-29 17:26:12,506 - root - INFO - | Epoch: 009/150 | Train Time: 3.387s | Train Loss: 0.101439 |
2020-05-29 17:26:16,110 - root - INFO - | Epoch: 010/150 | Train Time: 3.604s | Train Loss: 0.096459 |
2020-05-29 17:26:19,200 - root - INFO - | Epoch: 011/150 | Train Time: 3.089s | Train Loss: 0.094154 |
2020-05-29 17:26:22,643 - root - INFO - | Epoch: 012/150 | Train Time: 3.442s | Train Loss: 0.083959 |
2020-05-29 17:26:25,479 - root - INFO - | Epoch: 013/150 | Train Time: 2.836s | Train Loss: 0.081847 |
2020-05-29 17:26:28,323 - root - INFO - | Epoch: 014/150 | Train Time: 2.843s | Train Loss: 0.077706 |
2020-05-29 17:26:30,843 - root - INFO - | Epoch: 015/150 | Train Time: 2.519s | Train Loss: 0.076019 |
2020-05-29 17:26:33,567 - root - INFO - | Epoch: 016/150 | Train Time: 2.724s | Train Loss: 0.074997 |
2020-05-29 17:26:37,309 - root - INFO - | Epoch: 017/150 | Train Time: 3.742s | Train Loss: 0.070915 |
2020-05-29 17:26:40,688 - root - INFO - | Epoch: 018/150 | Train Time: 3.378s | Train Loss: 0.066840 |
2020-05-29 17:26:44,182 - root - INFO - | Epoch: 019/150 | Train Time: 3.493s | Train Loss: 0.063167 |
2020-05-29 17:26:47,799 - root - INFO - | Epoch: 020/150 | Train Time: 3.617s | Train Loss: 0.062878 |
2020-05-29 17:26:51,575 - root - INFO - | Epoch: 021/150 | Train Time: 3.775s | Train Loss: 0.064143 |
2020-05-29 17:26:55,355 - root - INFO - | Epoch: 022/150 | Train Time: 3.780s | Train Loss: 0.063602 |
2020-05-29 17:26:59,188 - root - INFO - | Epoch: 023/150 | Train Time: 3.832s | Train Loss: 0.061923 |
2020-05-29 17:27:02,972 - root - INFO - | Epoch: 024/150 | Train Time: 3.784s | Train Loss: 0.056692 |
2020-05-29 17:27:06,382 - root - INFO - | Epoch: 025/150 | Train Time: 3.409s | Train Loss: 0.058865 |
2020-05-29 17:27:09,926 - root - INFO - | Epoch: 026/150 | Train Time: 3.544s | Train Loss: 0.052449 |
2020-05-29 17:27:13,979 - root - INFO - | Epoch: 027/150 | Train Time: 4.052s | Train Loss: 0.051880 |
2020-05-29 17:27:17,769 - root - INFO - | Epoch: 028/150 | Train Time: 3.790s | Train Loss: 0.054173 |
2020-05-29 17:27:21,695 - root - INFO - | Epoch: 029/150 | Train Time: 3.925s | Train Loss: 0.049288 |
2020-05-29 17:27:26,021 - root - INFO - | Epoch: 030/150 | Train Time: 4.325s | Train Loss: 0.048166 |
2020-05-29 17:27:30,118 - root - INFO - | Epoch: 031/150 | Train Time: 4.097s | Train Loss: 0.048323 |
2020-05-29 17:27:34,778 - root - INFO - | Epoch: 032/150 | Train Time: 4.659s | Train Loss: 0.051616 |
2020-05-29 17:27:38,749 - root - INFO - | Epoch: 033/150 | Train Time: 3.971s | Train Loss: 0.046838 |
2020-05-29 17:27:42,417 - root - INFO - | Epoch: 034/150 | Train Time: 3.667s | Train Loss: 0.045392 |
2020-05-29 17:27:46,765 - root - INFO - | Epoch: 035/150 | Train Time: 4.348s | Train Loss: 0.046749 |
2020-05-29 17:27:50,953 - root - INFO - | Epoch: 036/150 | Train Time: 4.187s | Train Loss: 0.044714 |
2020-05-29 17:27:55,364 - root - INFO - | Epoch: 037/150 | Train Time: 4.411s | Train Loss: 0.043596 |
2020-05-29 17:27:59,323 - root - INFO - | Epoch: 038/150 | Train Time: 3.958s | Train Loss: 0.043758 |
2020-05-29 17:28:03,467 - root - INFO - | Epoch: 039/150 | Train Time: 4.143s | Train Loss: 0.038700 |
2020-05-29 17:28:08,235 - root - INFO - | Epoch: 040/150 | Train Time: 4.768s | Train Loss: 0.042572 |
2020-05-29 17:28:12,882 - root - INFO - | Epoch: 041/150 | Train Time: 4.646s | Train Loss: 0.040157 |
2020-05-29 17:28:17,161 - root - INFO - | Epoch: 042/150 | Train Time: 4.278s | Train Loss: 0.038184 |
2020-05-29 17:28:21,685 - root - INFO - | Epoch: 043/150 | Train Time: 4.523s | Train Loss: 0.043102 |
2020-05-29 17:28:26,067 - root - INFO - | Epoch: 044/150 | Train Time: 4.382s | Train Loss: 0.042463 |
2020-05-29 17:28:30,189 - root - INFO - | Epoch: 045/150 | Train Time: 4.122s | Train Loss: 0.038987 |
2020-05-29 17:28:34,439 - root - INFO - | Epoch: 046/150 | Train Time: 4.249s | Train Loss: 0.038803 |
2020-05-29 17:28:38,887 - root - INFO - | Epoch: 047/150 | Train Time: 4.448s | Train Loss: 0.039831 |
2020-05-29 17:28:43,572 - root - INFO - | Epoch: 048/150 | Train Time: 4.684s | Train Loss: 0.038742 |
2020-05-29 17:28:48,106 - root - INFO - | Epoch: 049/150 | Train Time: 4.534s | Train Loss: 0.036320 |
2020-05-29 17:28:52,174 - root - INFO - | Epoch: 050/150 | Train Time: 4.067s | Train Loss: 0.035474 |
2020-05-29 17:28:52,175 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-29 17:28:56,461 - root - INFO - | Epoch: 051/150 | Train Time: 4.286s | Train Loss: 0.035235 |
2020-05-29 17:29:01,290 - root - INFO - | Epoch: 052/150 | Train Time: 4.828s | Train Loss: 0.035395 |
2020-05-29 17:29:06,005 - root - INFO - | Epoch: 053/150 | Train Time: 4.714s | Train Loss: 0.032487 |
2020-05-29 17:29:10,189 - root - INFO - | Epoch: 054/150 | Train Time: 4.184s | Train Loss: 0.034294 |
2020-05-29 17:29:14,573 - root - INFO - | Epoch: 055/150 | Train Time: 4.384s | Train Loss: 0.031841 |
2020-05-29 17:29:18,993 - root - INFO - | Epoch: 056/150 | Train Time: 4.419s | Train Loss: 0.034684 |
2020-05-29 17:29:23,515 - root - INFO - | Epoch: 057/150 | Train Time: 4.521s | Train Loss: 0.034189 |
2020-05-29 17:29:27,708 - root - INFO - | Epoch: 058/150 | Train Time: 4.193s | Train Loss: 0.033001 |
2020-05-29 17:29:31,677 - root - INFO - | Epoch: 059/150 | Train Time: 3.969s | Train Loss: 0.034223 |
2020-05-29 17:29:36,150 - root - INFO - | Epoch: 060/150 | Train Time: 4.472s | Train Loss: 0.031029 |
2020-05-29 17:29:40,734 - root - INFO - | Epoch: 061/150 | Train Time: 4.583s | Train Loss: 0.029509 |
2020-05-29 17:29:45,375 - root - INFO - | Epoch: 062/150 | Train Time: 4.641s | Train Loss: 0.033897 |
2020-05-29 17:29:49,746 - root - INFO - | Epoch: 063/150 | Train Time: 4.370s | Train Loss: 0.030670 |
2020-05-29 17:29:54,291 - root - INFO - | Epoch: 064/150 | Train Time: 4.545s | Train Loss: 0.033710 |
2020-05-29 17:29:59,160 - root - INFO - | Epoch: 065/150 | Train Time: 4.868s | Train Loss: 0.035596 |
2020-05-29 17:30:03,704 - root - INFO - | Epoch: 066/150 | Train Time: 4.543s | Train Loss: 0.032325 |
2020-05-29 17:30:08,069 - root - INFO - | Epoch: 067/150 | Train Time: 4.364s | Train Loss: 0.029474 |
2020-05-29 17:30:13,040 - root - INFO - | Epoch: 068/150 | Train Time: 4.970s | Train Loss: 0.035892 |
2020-05-29 17:30:17,570 - root - INFO - | Epoch: 069/150 | Train Time: 4.530s | Train Loss: 0.033347 |
2020-05-29 17:30:21,738 - root - INFO - | Epoch: 070/150 | Train Time: 4.168s | Train Loss: 0.033130 |
2020-05-29 17:30:25,967 - root - INFO - | Epoch: 071/150 | Train Time: 4.228s | Train Loss: 0.030106 |
2020-05-29 17:30:30,242 - root - INFO - | Epoch: 072/150 | Train Time: 4.275s | Train Loss: 0.034796 |
2020-05-29 17:30:34,771 - root - INFO - | Epoch: 073/150 | Train Time: 4.528s | Train Loss: 0.030623 |
2020-05-29 17:30:38,870 - root - INFO - | Epoch: 074/150 | Train Time: 4.099s | Train Loss: 0.034195 |
2020-05-29 17:30:43,178 - root - INFO - | Epoch: 075/150 | Train Time: 4.307s | Train Loss: 0.030803 |
2020-05-29 17:30:47,884 - root - INFO - | Epoch: 076/150 | Train Time: 4.705s | Train Loss: 0.033369 |
2020-05-29 17:30:52,460 - root - INFO - | Epoch: 077/150 | Train Time: 4.575s | Train Loss: 0.030344 |
2020-05-29 17:30:57,554 - root - INFO - | Epoch: 078/150 | Train Time: 5.094s | Train Loss: 0.034855 |
2020-05-29 17:31:02,309 - root - INFO - | Epoch: 079/150 | Train Time: 4.754s | Train Loss: 0.032009 |
2020-05-29 17:31:06,465 - root - INFO - | Epoch: 080/150 | Train Time: 4.155s | Train Loss: 0.032987 |
2020-05-29 17:31:10,932 - root - INFO - | Epoch: 081/150 | Train Time: 4.467s | Train Loss: 0.029421 |
2020-05-29 17:31:14,982 - root - INFO - | Epoch: 082/150 | Train Time: 4.049s | Train Loss: 0.031560 |
2020-05-29 17:31:19,731 - root - INFO - | Epoch: 083/150 | Train Time: 4.748s | Train Loss: 0.034325 |
2020-05-29 17:31:23,118 - root - INFO - | Epoch: 084/150 | Train Time: 3.387s | Train Loss: 0.032267 |
2020-05-29 17:31:27,332 - root - INFO - | Epoch: 085/150 | Train Time: 4.213s | Train Loss: 0.028479 |
2020-05-29 17:31:30,695 - root - INFO - | Epoch: 086/150 | Train Time: 3.363s | Train Loss: 0.031470 |
2020-05-29 17:31:34,610 - root - INFO - | Epoch: 087/150 | Train Time: 3.915s | Train Loss: 0.029493 |
2020-05-29 17:31:38,229 - root - INFO - | Epoch: 088/150 | Train Time: 3.618s | Train Loss: 0.032086 |
2020-05-29 17:31:42,190 - root - INFO - | Epoch: 089/150 | Train Time: 3.960s | Train Loss: 0.030985 |
2020-05-29 17:31:46,599 - root - INFO - | Epoch: 090/150 | Train Time: 4.409s | Train Loss: 0.029480 |
2020-05-29 17:31:50,195 - root - INFO - | Epoch: 091/150 | Train Time: 3.595s | Train Loss: 0.030653 |
2020-05-29 17:31:54,224 - root - INFO - | Epoch: 092/150 | Train Time: 4.029s | Train Loss: 0.029093 |
2020-05-29 17:31:58,087 - root - INFO - | Epoch: 093/150 | Train Time: 3.852s | Train Loss: 0.032466 |
2020-05-29 17:32:02,139 - root - INFO - | Epoch: 094/150 | Train Time: 4.051s | Train Loss: 0.028431 |
2020-05-29 17:32:06,252 - root - INFO - | Epoch: 095/150 | Train Time: 4.113s | Train Loss: 0.031530 |
2020-05-29 17:32:10,833 - root - INFO - | Epoch: 096/150 | Train Time: 4.581s | Train Loss: 0.030320 |
2020-05-29 17:32:15,266 - root - INFO - | Epoch: 097/150 | Train Time: 4.432s | Train Loss: 0.029034 |
2020-05-29 17:32:20,092 - root - INFO - | Epoch: 098/150 | Train Time: 4.825s | Train Loss: 0.029354 |
2020-05-29 17:32:25,098 - root - INFO - | Epoch: 099/150 | Train Time: 5.006s | Train Loss: 0.026423 |
2020-05-29 17:32:29,419 - root - INFO - | Epoch: 100/150 | Train Time: 4.320s | Train Loss: 0.030381 |
2020-05-29 17:32:33,796 - root - INFO - | Epoch: 101/150 | Train Time: 4.376s | Train Loss: 0.031837 |
2020-05-29 17:32:37,927 - root - INFO - | Epoch: 102/150 | Train Time: 4.131s | Train Loss: 0.026686 |
2020-05-29 17:32:42,124 - root - INFO - | Epoch: 103/150 | Train Time: 4.196s | Train Loss: 0.025319 |
2020-05-29 17:32:46,039 - root - INFO - | Epoch: 104/150 | Train Time: 3.915s | Train Loss: 0.027540 |
2020-05-29 17:32:50,731 - root - INFO - | Epoch: 105/150 | Train Time: 4.691s | Train Loss: 0.030259 |
2020-05-29 17:32:55,279 - root - INFO - | Epoch: 106/150 | Train Time: 4.548s | Train Loss: 0.025308 |
2020-05-29 17:32:59,441 - root - INFO - | Epoch: 107/150 | Train Time: 4.161s | Train Loss: 0.025909 |
2020-05-29 17:33:03,832 - root - INFO - | Epoch: 108/150 | Train Time: 4.390s | Train Loss: 0.025932 |
2020-05-29 17:33:08,011 - root - INFO - | Epoch: 109/150 | Train Time: 4.178s | Train Loss: 0.027572 |
2020-05-29 17:33:12,510 - root - INFO - | Epoch: 110/150 | Train Time: 4.499s | Train Loss: 0.027288 |
2020-05-29 17:33:16,697 - root - INFO - | Epoch: 111/150 | Train Time: 4.186s | Train Loss: 0.029642 |
2020-05-29 17:33:21,495 - root - INFO - | Epoch: 112/150 | Train Time: 4.798s | Train Loss: 0.026480 |
2020-05-29 17:33:25,892 - root - INFO - | Epoch: 113/150 | Train Time: 4.397s | Train Loss: 0.027355 |
2020-05-29 17:33:30,382 - root - INFO - | Epoch: 114/150 | Train Time: 4.489s | Train Loss: 0.022750 |
2020-05-29 17:33:35,055 - root - INFO - | Epoch: 115/150 | Train Time: 4.672s | Train Loss: 0.027809 |
2020-05-29 17:33:39,873 - root - INFO - | Epoch: 116/150 | Train Time: 4.817s | Train Loss: 0.025910 |
2020-05-29 17:33:44,587 - root - INFO - | Epoch: 117/150 | Train Time: 4.714s | Train Loss: 0.025241 |
2020-05-29 17:33:49,368 - root - INFO - | Epoch: 118/150 | Train Time: 4.781s | Train Loss: 0.026626 |
2020-05-29 17:33:53,927 - root - INFO - | Epoch: 119/150 | Train Time: 4.559s | Train Loss: 0.024457 |
2020-05-29 17:33:59,356 - root - INFO - | Epoch: 120/150 | Train Time: 5.428s | Train Loss: 0.025563 |
2020-05-29 17:34:04,135 - root - INFO - | Epoch: 121/150 | Train Time: 4.779s | Train Loss: 0.024807 |
2020-05-29 17:34:08,457 - root - INFO - | Epoch: 122/150 | Train Time: 4.321s | Train Loss: 0.023055 |
2020-05-29 17:34:12,120 - root - INFO - | Epoch: 123/150 | Train Time: 3.663s | Train Loss: 0.025454 |
2020-05-29 17:34:15,863 - root - INFO - | Epoch: 124/150 | Train Time: 3.742s | Train Loss: 0.022725 |
2020-05-29 17:34:19,642 - root - INFO - | Epoch: 125/150 | Train Time: 3.780s | Train Loss: 0.024767 |
2020-05-29 17:34:23,637 - root - INFO - | Epoch: 126/150 | Train Time: 3.994s | Train Loss: 0.023101 |
2020-05-29 17:34:27,813 - root - INFO - | Epoch: 127/150 | Train Time: 4.176s | Train Loss: 0.024341 |
2020-05-29 17:34:32,296 - root - INFO - | Epoch: 128/150 | Train Time: 4.482s | Train Loss: 0.026123 |
2020-05-29 17:34:36,305 - root - INFO - | Epoch: 129/150 | Train Time: 4.008s | Train Loss: 0.023120 |
2020-05-29 17:34:39,552 - root - INFO - | Epoch: 130/150 | Train Time: 3.246s | Train Loss: 0.025080 |
2020-05-29 17:34:43,027 - root - INFO - | Epoch: 131/150 | Train Time: 3.474s | Train Loss: 0.025134 |
2020-05-29 17:34:46,622 - root - INFO - | Epoch: 132/150 | Train Time: 3.595s | Train Loss: 0.025395 |
2020-05-29 17:34:51,011 - root - INFO - | Epoch: 133/150 | Train Time: 4.389s | Train Loss: 0.022163 |
2020-05-29 17:34:55,168 - root - INFO - | Epoch: 134/150 | Train Time: 4.156s | Train Loss: 0.022146 |
2020-05-29 17:34:59,042 - root - INFO - | Epoch: 135/150 | Train Time: 3.873s | Train Loss: 0.024515 |
2020-05-29 17:35:02,489 - root - INFO - | Epoch: 136/150 | Train Time: 3.446s | Train Loss: 0.023440 |
2020-05-29 17:35:06,356 - root - INFO - | Epoch: 137/150 | Train Time: 3.866s | Train Loss: 0.025738 |
2020-05-29 17:35:10,289 - root - INFO - | Epoch: 138/150 | Train Time: 3.933s | Train Loss: 0.024588 |
2020-05-29 17:35:14,259 - root - INFO - | Epoch: 139/150 | Train Time: 3.969s | Train Loss: 0.021744 |
2020-05-29 17:35:18,413 - root - INFO - | Epoch: 140/150 | Train Time: 4.153s | Train Loss: 0.022207 |
2020-05-29 17:35:22,619 - root - INFO - | Epoch: 141/150 | Train Time: 4.205s | Train Loss: 0.025098 |
2020-05-29 17:35:27,068 - root - INFO - | Epoch: 142/150 | Train Time: 4.449s | Train Loss: 0.026376 |
2020-05-29 17:35:31,428 - root - INFO - | Epoch: 143/150 | Train Time: 4.359s | Train Loss: 0.022302 |
2020-05-29 17:35:36,373 - root - INFO - | Epoch: 144/150 | Train Time: 4.945s | Train Loss: 0.023203 |
2020-05-29 17:35:41,073 - root - INFO - | Epoch: 145/150 | Train Time: 4.699s | Train Loss: 0.023126 |
2020-05-29 17:35:45,187 - root - INFO - | Epoch: 146/150 | Train Time: 4.114s | Train Loss: 0.024324 |
2020-05-29 17:35:48,986 - root - INFO - | Epoch: 147/150 | Train Time: 3.799s | Train Loss: 0.024272 |
2020-05-29 17:35:53,389 - root - INFO - | Epoch: 148/150 | Train Time: 4.402s | Train Loss: 0.026860 |
2020-05-29 17:35:57,562 - root - INFO - | Epoch: 149/150 | Train Time: 4.172s | Train Loss: 0.023020 |
2020-05-29 17:36:01,544 - root - INFO - | Epoch: 150/150 | Train Time: 3.982s | Train Loss: 0.022137 |
2020-05-29 17:36:01,544 - root - INFO - Training Time: 628.166s
2020-05-29 17:36:01,544 - root - INFO - Finished training.
2020-05-29 17:36:01,546 - root - INFO - Starting testing...
2020-05-29 17:36:05,797 - root - INFO - Test Loss: 2.776651
2020-05-29 17:36:05,798 - root - INFO - Test AUC: 96.00%
2020-05-29 17:36:05,798 - root - INFO - Test Time: 4.229s
2020-05-29 17:36:05,798 - root - INFO - Finished testing.
