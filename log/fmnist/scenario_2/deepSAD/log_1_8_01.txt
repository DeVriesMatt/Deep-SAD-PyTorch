2020-05-29 19:49:17,666 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_1_8_01.txt
2020-05-29 19:49:17,667 - root - INFO - Data path is ../data
2020-05-29 19:49:17,667 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-29 19:49:17,667 - root - INFO - Dataset: fmnist
2020-05-29 19:49:17,667 - root - INFO - Normal class: 1
2020-05-29 19:49:17,667 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-29 19:49:17,667 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-29 19:49:17,667 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-29 19:49:17,667 - root - INFO - Scenario Running: 2
2020-05-29 19:49:17,667 - root - INFO - Train only the network: True
2020-05-29 19:49:17,667 - root - INFO - Output and AE dimensions: 128
2020-05-29 19:49:17,667 - root - INFO - Known anomaly class: 8
2020-05-29 19:49:17,668 - root - INFO - Network: fmnist_LeNet
2020-05-29 19:49:17,668 - root - INFO - Eta-parameter: 1.00
2020-05-29 19:49:17,676 - root - INFO - Set seed to 0.
2020-05-29 19:49:17,715 - root - INFO - Computation device: cuda
2020-05-29 19:49:17,751 - root - INFO - Number of threads: 0
2020-05-29 19:49:17,752 - root - INFO - Number of dataloader workers: 6
2020-05-29 19:49:37,541 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-29 19:49:37,552 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-29 19:49:37,552 - root - INFO - Pretraining: True
2020-05-29 19:49:37,552 - root - INFO - Training optimizer: adam
2020-05-29 19:49:37,552 - root - INFO - Training learning rate: 0.0001
2020-05-29 19:49:37,552 - root - INFO - Training epochs: 150
2020-05-29 19:49:37,553 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-29 19:49:37,553 - root - INFO - Training batch size: 200
2020-05-29 19:49:37,553 - root - INFO - Training weight decay: 5e-07
2020-05-29 19:49:37,556 - root - INFO - Starting training...
2020-05-29 19:49:51,174 - root - INFO - | Epoch: 001/150 | Train Time: 13.618s | Train Loss: 1.189428 |
2020-05-29 19:49:55,370 - root - INFO - | Epoch: 002/150 | Train Time: 4.195s | Train Loss: 0.275003 |
2020-05-29 19:49:59,159 - root - INFO - | Epoch: 003/150 | Train Time: 3.788s | Train Loss: 0.181288 |
2020-05-29 19:50:03,682 - root - INFO - | Epoch: 004/150 | Train Time: 4.522s | Train Loss: 0.145883 |
2020-05-29 19:50:08,059 - root - INFO - | Epoch: 005/150 | Train Time: 4.376s | Train Loss: 0.128413 |
2020-05-29 19:50:13,448 - root - INFO - | Epoch: 006/150 | Train Time: 5.389s | Train Loss: 0.116804 |
2020-05-29 19:50:18,534 - root - INFO - | Epoch: 007/150 | Train Time: 5.085s | Train Loss: 0.105983 |
2020-05-29 19:50:23,444 - root - INFO - | Epoch: 008/150 | Train Time: 4.910s | Train Loss: 0.098018 |
2020-05-29 19:50:28,101 - root - INFO - | Epoch: 009/150 | Train Time: 4.656s | Train Loss: 0.094021 |
2020-05-29 19:50:33,301 - root - INFO - | Epoch: 010/150 | Train Time: 5.199s | Train Loss: 0.091875 |
2020-05-29 19:50:38,942 - root - INFO - | Epoch: 011/150 | Train Time: 5.641s | Train Loss: 0.091680 |
2020-05-29 19:50:44,359 - root - INFO - | Epoch: 012/150 | Train Time: 5.416s | Train Loss: 0.085149 |
2020-05-29 19:50:49,152 - root - INFO - | Epoch: 013/150 | Train Time: 4.792s | Train Loss: 0.081973 |
2020-05-29 19:50:53,884 - root - INFO - | Epoch: 014/150 | Train Time: 4.732s | Train Loss: 0.079393 |
2020-05-29 19:50:58,780 - root - INFO - | Epoch: 015/150 | Train Time: 4.895s | Train Loss: 0.078272 |
2020-05-29 19:51:03,484 - root - INFO - | Epoch: 016/150 | Train Time: 4.703s | Train Loss: 0.078956 |
2020-05-29 19:51:08,079 - root - INFO - | Epoch: 017/150 | Train Time: 4.595s | Train Loss: 0.077982 |
2020-05-29 19:51:12,647 - root - INFO - | Epoch: 018/150 | Train Time: 4.567s | Train Loss: 0.073217 |
2020-05-29 19:51:16,843 - root - INFO - | Epoch: 019/150 | Train Time: 4.196s | Train Loss: 0.073895 |
2020-05-29 19:51:20,689 - root - INFO - | Epoch: 020/150 | Train Time: 3.845s | Train Loss: 0.072300 |
2020-05-29 19:51:24,860 - root - INFO - | Epoch: 021/150 | Train Time: 4.170s | Train Loss: 0.071837 |
2020-05-29 19:51:29,172 - root - INFO - | Epoch: 022/150 | Train Time: 4.311s | Train Loss: 0.071174 |
2020-05-29 19:51:33,000 - root - INFO - | Epoch: 023/150 | Train Time: 3.827s | Train Loss: 0.069702 |
2020-05-29 19:51:37,385 - root - INFO - | Epoch: 024/150 | Train Time: 4.384s | Train Loss: 0.068996 |
2020-05-29 19:51:41,234 - root - INFO - | Epoch: 025/150 | Train Time: 3.849s | Train Loss: 0.064815 |
2020-05-29 19:51:45,371 - root - INFO - | Epoch: 026/150 | Train Time: 4.136s | Train Loss: 0.064439 |
2020-05-29 19:51:49,610 - root - INFO - | Epoch: 027/150 | Train Time: 4.238s | Train Loss: 0.066621 |
2020-05-29 19:51:53,679 - root - INFO - | Epoch: 028/150 | Train Time: 4.069s | Train Loss: 0.064883 |
2020-05-29 19:51:58,500 - root - INFO - | Epoch: 029/150 | Train Time: 4.820s | Train Loss: 0.066405 |
2020-05-29 19:52:02,583 - root - INFO - | Epoch: 030/150 | Train Time: 4.083s | Train Loss: 0.060727 |
2020-05-29 19:52:07,699 - root - INFO - | Epoch: 031/150 | Train Time: 5.115s | Train Loss: 0.060716 |
2020-05-29 19:52:12,681 - root - INFO - | Epoch: 032/150 | Train Time: 4.981s | Train Loss: 0.061386 |
2020-05-29 19:52:17,239 - root - INFO - | Epoch: 033/150 | Train Time: 4.558s | Train Loss: 0.063728 |
2020-05-29 19:52:22,321 - root - INFO - | Epoch: 034/150 | Train Time: 5.081s | Train Loss: 0.061708 |
2020-05-29 19:52:27,713 - root - INFO - | Epoch: 035/150 | Train Time: 5.392s | Train Loss: 0.056781 |
2020-05-29 19:52:33,042 - root - INFO - | Epoch: 036/150 | Train Time: 5.328s | Train Loss: 0.058263 |
2020-05-29 19:52:37,898 - root - INFO - | Epoch: 037/150 | Train Time: 4.855s | Train Loss: 0.058834 |
2020-05-29 19:52:42,794 - root - INFO - | Epoch: 038/150 | Train Time: 4.896s | Train Loss: 0.057722 |
2020-05-29 19:52:47,881 - root - INFO - | Epoch: 039/150 | Train Time: 5.086s | Train Loss: 0.055873 |
2020-05-29 19:52:52,528 - root - INFO - | Epoch: 040/150 | Train Time: 4.647s | Train Loss: 0.057954 |
2020-05-29 19:52:57,116 - root - INFO - | Epoch: 041/150 | Train Time: 4.587s | Train Loss: 0.052481 |
2020-05-29 19:53:02,306 - root - INFO - | Epoch: 042/150 | Train Time: 5.190s | Train Loss: 0.055241 |
2020-05-29 19:53:07,278 - root - INFO - | Epoch: 043/150 | Train Time: 4.971s | Train Loss: 0.056414 |
2020-05-29 19:53:12,235 - root - INFO - | Epoch: 044/150 | Train Time: 4.957s | Train Loss: 0.050023 |
2020-05-29 19:53:17,073 - root - INFO - | Epoch: 045/150 | Train Time: 4.837s | Train Loss: 0.054956 |
2020-05-29 19:53:21,407 - root - INFO - | Epoch: 046/150 | Train Time: 4.333s | Train Loss: 0.053840 |
2020-05-29 19:53:25,556 - root - INFO - | Epoch: 047/150 | Train Time: 4.149s | Train Loss: 0.050641 |
2020-05-29 19:53:30,063 - root - INFO - | Epoch: 048/150 | Train Time: 4.505s | Train Loss: 0.049772 |
2020-05-29 19:53:34,958 - root - INFO - | Epoch: 049/150 | Train Time: 4.895s | Train Loss: 0.046339 |
2020-05-29 19:53:40,180 - root - INFO - | Epoch: 050/150 | Train Time: 5.221s | Train Loss: 0.049623 |
2020-05-29 19:53:40,180 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-29 19:53:45,141 - root - INFO - | Epoch: 051/150 | Train Time: 4.960s | Train Loss: 0.044928 |
2020-05-29 19:53:49,834 - root - INFO - | Epoch: 052/150 | Train Time: 4.692s | Train Loss: 0.041851 |
2020-05-29 19:53:55,296 - root - INFO - | Epoch: 053/150 | Train Time: 5.461s | Train Loss: 0.043673 |
2020-05-29 19:54:00,008 - root - INFO - | Epoch: 054/150 | Train Time: 4.701s | Train Loss: 0.041553 |
2020-05-29 19:54:04,969 - root - INFO - | Epoch: 055/150 | Train Time: 4.961s | Train Loss: 0.043231 |
2020-05-29 19:54:10,048 - root - INFO - | Epoch: 056/150 | Train Time: 5.079s | Train Loss: 0.045128 |
2020-05-29 19:54:14,529 - root - INFO - | Epoch: 057/150 | Train Time: 4.481s | Train Loss: 0.042478 |
2020-05-29 19:54:18,908 - root - INFO - | Epoch: 058/150 | Train Time: 4.378s | Train Loss: 0.041603 |
2020-05-29 19:54:23,200 - root - INFO - | Epoch: 059/150 | Train Time: 4.292s | Train Loss: 0.041334 |
2020-05-29 19:54:27,878 - root - INFO - | Epoch: 060/150 | Train Time: 4.677s | Train Loss: 0.041291 |
2020-05-29 19:54:32,562 - root - INFO - | Epoch: 061/150 | Train Time: 4.684s | Train Loss: 0.042267 |
2020-05-29 19:54:37,391 - root - INFO - | Epoch: 062/150 | Train Time: 4.828s | Train Loss: 0.043247 |
2020-05-29 19:54:42,329 - root - INFO - | Epoch: 063/150 | Train Time: 4.937s | Train Loss: 0.041757 |
2020-05-29 19:54:47,486 - root - INFO - | Epoch: 064/150 | Train Time: 5.157s | Train Loss: 0.042221 |
2020-05-29 19:54:50,844 - root - INFO - | Epoch: 065/150 | Train Time: 3.357s | Train Loss: 0.041167 |
2020-05-29 19:54:54,038 - root - INFO - | Epoch: 066/150 | Train Time: 3.193s | Train Loss: 0.041785 |
2020-05-29 19:54:58,226 - root - INFO - | Epoch: 067/150 | Train Time: 4.187s | Train Loss: 0.042644 |
2020-05-29 19:55:01,935 - root - INFO - | Epoch: 068/150 | Train Time: 3.709s | Train Loss: 0.042706 |
2020-05-29 19:55:06,091 - root - INFO - | Epoch: 069/150 | Train Time: 4.155s | Train Loss: 0.044680 |
2020-05-29 19:55:10,641 - root - INFO - | Epoch: 070/150 | Train Time: 4.549s | Train Loss: 0.039701 |
2020-05-29 19:55:15,416 - root - INFO - | Epoch: 071/150 | Train Time: 4.775s | Train Loss: 0.040964 |
2020-05-29 19:55:19,922 - root - INFO - | Epoch: 072/150 | Train Time: 4.505s | Train Loss: 0.040360 |
2020-05-29 19:55:24,692 - root - INFO - | Epoch: 073/150 | Train Time: 4.769s | Train Loss: 0.041546 |
2020-05-29 19:55:29,372 - root - INFO - | Epoch: 074/150 | Train Time: 4.680s | Train Loss: 0.040873 |
2020-05-29 19:55:34,220 - root - INFO - | Epoch: 075/150 | Train Time: 4.848s | Train Loss: 0.043049 |
2020-05-29 19:55:39,004 - root - INFO - | Epoch: 076/150 | Train Time: 4.783s | Train Loss: 0.038041 |
2020-05-29 19:55:43,972 - root - INFO - | Epoch: 077/150 | Train Time: 4.968s | Train Loss: 0.039424 |
2020-05-29 19:55:49,059 - root - INFO - | Epoch: 078/150 | Train Time: 5.086s | Train Loss: 0.042346 |
2020-05-29 19:55:54,282 - root - INFO - | Epoch: 079/150 | Train Time: 5.222s | Train Loss: 0.041117 |
2020-05-29 19:55:59,537 - root - INFO - | Epoch: 080/150 | Train Time: 5.254s | Train Loss: 0.040296 |
2020-05-29 19:56:04,681 - root - INFO - | Epoch: 081/150 | Train Time: 5.144s | Train Loss: 0.041157 |
2020-05-29 19:56:09,967 - root - INFO - | Epoch: 082/150 | Train Time: 5.286s | Train Loss: 0.041381 |
2020-05-29 19:56:14,892 - root - INFO - | Epoch: 083/150 | Train Time: 4.924s | Train Loss: 0.038905 |
2020-05-29 19:56:19,625 - root - INFO - | Epoch: 084/150 | Train Time: 4.732s | Train Loss: 0.038404 |
2020-05-29 19:56:24,925 - root - INFO - | Epoch: 085/150 | Train Time: 5.300s | Train Loss: 0.039470 |
2020-05-29 19:56:29,265 - root - INFO - | Epoch: 086/150 | Train Time: 4.339s | Train Loss: 0.040006 |
2020-05-29 19:56:34,319 - root - INFO - | Epoch: 087/150 | Train Time: 5.054s | Train Loss: 0.039013 |
2020-05-29 19:56:38,745 - root - INFO - | Epoch: 088/150 | Train Time: 4.426s | Train Loss: 0.041942 |
2020-05-29 19:56:43,935 - root - INFO - | Epoch: 089/150 | Train Time: 5.190s | Train Loss: 0.040581 |
2020-05-29 19:56:48,969 - root - INFO - | Epoch: 090/150 | Train Time: 5.033s | Train Loss: 0.039977 |
2020-05-29 19:56:53,465 - root - INFO - | Epoch: 091/150 | Train Time: 4.495s | Train Loss: 0.038757 |
2020-05-29 19:56:57,787 - root - INFO - | Epoch: 092/150 | Train Time: 4.322s | Train Loss: 0.034399 |
2020-05-29 19:57:01,990 - root - INFO - | Epoch: 093/150 | Train Time: 4.203s | Train Loss: 0.036110 |
2020-05-29 19:57:06,443 - root - INFO - | Epoch: 094/150 | Train Time: 4.453s | Train Loss: 0.034168 |
2020-05-29 19:57:10,918 - root - INFO - | Epoch: 095/150 | Train Time: 4.474s | Train Loss: 0.037377 |
2020-05-29 19:57:15,163 - root - INFO - | Epoch: 096/150 | Train Time: 4.244s | Train Loss: 0.035842 |
2020-05-29 19:57:19,923 - root - INFO - | Epoch: 097/150 | Train Time: 4.760s | Train Loss: 0.030318 |
2020-05-29 19:57:24,260 - root - INFO - | Epoch: 098/150 | Train Time: 4.337s | Train Loss: 0.033302 |
2020-05-29 19:57:28,557 - root - INFO - | Epoch: 099/150 | Train Time: 4.296s | Train Loss: 0.030763 |
2020-05-29 19:57:32,846 - root - INFO - | Epoch: 100/150 | Train Time: 4.289s | Train Loss: 0.034106 |
2020-05-29 19:57:37,427 - root - INFO - | Epoch: 101/150 | Train Time: 4.581s | Train Loss: 0.032092 |
2020-05-29 19:57:41,942 - root - INFO - | Epoch: 102/150 | Train Time: 4.515s | Train Loss: 0.030386 |
2020-05-29 19:57:45,950 - root - INFO - | Epoch: 103/150 | Train Time: 4.007s | Train Loss: 0.031139 |
2020-05-29 19:57:50,173 - root - INFO - | Epoch: 104/150 | Train Time: 4.222s | Train Loss: 0.029838 |
2020-05-29 19:57:54,940 - root - INFO - | Epoch: 105/150 | Train Time: 4.767s | Train Loss: 0.034687 |
2020-05-29 19:57:59,905 - root - INFO - | Epoch: 106/150 | Train Time: 4.964s | Train Loss: 0.029836 |
2020-05-29 19:58:05,002 - root - INFO - | Epoch: 107/150 | Train Time: 5.096s | Train Loss: 0.029844 |
2020-05-29 19:58:09,851 - root - INFO - | Epoch: 108/150 | Train Time: 4.848s | Train Loss: 0.030962 |
2020-05-29 19:58:14,690 - root - INFO - | Epoch: 109/150 | Train Time: 4.838s | Train Loss: 0.029792 |
2020-05-29 19:58:19,315 - root - INFO - | Epoch: 110/150 | Train Time: 4.624s | Train Loss: 0.030096 |
2020-05-29 19:58:23,480 - root - INFO - | Epoch: 111/150 | Train Time: 4.165s | Train Loss: 0.029415 |
2020-05-29 19:58:27,393 - root - INFO - | Epoch: 112/150 | Train Time: 3.913s | Train Loss: 0.028503 |
2020-05-29 19:58:31,192 - root - INFO - | Epoch: 113/150 | Train Time: 3.798s | Train Loss: 0.030069 |
2020-05-29 19:58:34,978 - root - INFO - | Epoch: 114/150 | Train Time: 3.785s | Train Loss: 0.030257 |
2020-05-29 19:58:39,321 - root - INFO - | Epoch: 115/150 | Train Time: 4.343s | Train Loss: 0.029578 |
2020-05-29 19:58:43,511 - root - INFO - | Epoch: 116/150 | Train Time: 4.190s | Train Loss: 0.028506 |
2020-05-29 19:58:48,162 - root - INFO - | Epoch: 117/150 | Train Time: 4.651s | Train Loss: 0.027518 |
2020-05-29 19:58:53,043 - root - INFO - | Epoch: 118/150 | Train Time: 4.881s | Train Loss: 0.028361 |
2020-05-29 19:58:57,726 - root - INFO - | Epoch: 119/150 | Train Time: 4.682s | Train Loss: 0.029638 |
2020-05-29 19:59:02,563 - root - INFO - | Epoch: 120/150 | Train Time: 4.837s | Train Loss: 0.029516 |
2020-05-29 19:59:07,122 - root - INFO - | Epoch: 121/150 | Train Time: 4.558s | Train Loss: 0.028360 |
2020-05-29 19:59:11,210 - root - INFO - | Epoch: 122/150 | Train Time: 4.087s | Train Loss: 0.031190 |
2020-05-29 19:59:15,378 - root - INFO - | Epoch: 123/150 | Train Time: 4.167s | Train Loss: 0.027582 |
2020-05-29 19:59:18,812 - root - INFO - | Epoch: 124/150 | Train Time: 3.433s | Train Loss: 0.026327 |
2020-05-29 19:59:21,699 - root - INFO - | Epoch: 125/150 | Train Time: 2.886s | Train Loss: 0.031709 |
2020-05-29 19:59:25,319 - root - INFO - | Epoch: 126/150 | Train Time: 3.619s | Train Loss: 0.026348 |
2020-05-29 19:59:28,529 - root - INFO - | Epoch: 127/150 | Train Time: 3.210s | Train Loss: 0.026474 |
2020-05-29 19:59:32,570 - root - INFO - | Epoch: 128/150 | Train Time: 4.041s | Train Loss: 0.027755 |
2020-05-29 19:59:36,881 - root - INFO - | Epoch: 129/150 | Train Time: 4.311s | Train Loss: 0.028741 |
2020-05-29 19:59:41,077 - root - INFO - | Epoch: 130/150 | Train Time: 4.195s | Train Loss: 0.026443 |
2020-05-29 19:59:44,750 - root - INFO - | Epoch: 131/150 | Train Time: 3.671s | Train Loss: 0.025857 |
2020-05-29 19:59:48,523 - root - INFO - | Epoch: 132/150 | Train Time: 3.773s | Train Loss: 0.027065 |
2020-05-29 19:59:52,361 - root - INFO - | Epoch: 133/150 | Train Time: 3.838s | Train Loss: 0.026222 |
2020-05-29 19:59:56,387 - root - INFO - | Epoch: 134/150 | Train Time: 4.024s | Train Loss: 0.029205 |
2020-05-29 20:00:00,724 - root - INFO - | Epoch: 135/150 | Train Time: 4.327s | Train Loss: 0.025383 |
2020-05-29 20:00:04,921 - root - INFO - | Epoch: 136/150 | Train Time: 4.195s | Train Loss: 0.026694 |
2020-05-29 20:00:09,486 - root - INFO - | Epoch: 137/150 | Train Time: 4.564s | Train Loss: 0.027629 |
2020-05-29 20:00:13,936 - root - INFO - | Epoch: 138/150 | Train Time: 4.450s | Train Loss: 0.026799 |
2020-05-29 20:00:18,317 - root - INFO - | Epoch: 139/150 | Train Time: 4.380s | Train Loss: 0.027508 |
2020-05-29 20:00:22,978 - root - INFO - | Epoch: 140/150 | Train Time: 4.660s | Train Loss: 0.025039 |
2020-05-29 20:00:28,030 - root - INFO - | Epoch: 141/150 | Train Time: 5.052s | Train Loss: 0.024655 |
2020-05-29 20:00:33,237 - root - INFO - | Epoch: 142/150 | Train Time: 5.205s | Train Loss: 0.027091 |
2020-05-29 20:00:38,045 - root - INFO - | Epoch: 143/150 | Train Time: 4.808s | Train Loss: 0.027792 |
2020-05-29 20:00:43,126 - root - INFO - | Epoch: 144/150 | Train Time: 5.080s | Train Loss: 0.025407 |
2020-05-29 20:00:48,193 - root - INFO - | Epoch: 145/150 | Train Time: 5.067s | Train Loss: 0.026628 |
2020-05-29 20:00:53,164 - root - INFO - | Epoch: 146/150 | Train Time: 4.970s | Train Loss: 0.025517 |
2020-05-29 20:00:58,150 - root - INFO - | Epoch: 147/150 | Train Time: 4.986s | Train Loss: 0.022915 |
2020-05-29 20:01:03,544 - root - INFO - | Epoch: 148/150 | Train Time: 5.393s | Train Loss: 0.025826 |
2020-05-29 20:01:08,484 - root - INFO - | Epoch: 149/150 | Train Time: 4.929s | Train Loss: 0.024214 |
2020-05-29 20:01:13,107 - root - INFO - | Epoch: 150/150 | Train Time: 4.622s | Train Loss: 0.025758 |
2020-05-29 20:01:13,107 - root - INFO - Training Time: 695.551s
2020-05-29 20:01:13,107 - root - INFO - Finished training.
2020-05-29 20:01:13,109 - root - INFO - Starting testing...
2020-05-29 20:01:17,871 - root - INFO - Test Loss: 0.614765
2020-05-29 20:01:17,890 - root - INFO - Test AUC: 88.97%
2020-05-29 20:01:17,890 - root - INFO - Test Time: 4.747s
2020-05-29 20:01:17,890 - root - INFO - Finished testing.
