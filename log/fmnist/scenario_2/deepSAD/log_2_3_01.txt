2020-05-24 22:33:10,792 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_2_3_01.txt
2020-05-24 22:33:10,793 - root - INFO - Data path is ../data
2020-05-24 22:33:10,793 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-24 22:33:10,793 - root - INFO - Dataset: fmnist
2020-05-24 22:33:10,793 - root - INFO - Normal class: 2
2020-05-24 22:33:10,793 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-24 22:33:10,793 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-24 22:33:10,793 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-24 22:33:10,793 - root - INFO - Scenario Running: 2
2020-05-24 22:33:10,793 - root - INFO - Train only the network: True
2020-05-24 22:33:10,793 - root - INFO - Output and AE dimensions: 128
2020-05-24 22:33:10,793 - root - INFO - Known anomaly class: 3
2020-05-24 22:33:10,793 - root - INFO - Network: fmnist_LeNet
2020-05-24 22:33:10,793 - root - INFO - Eta-parameter: 1.00
2020-05-24 22:33:10,799 - root - INFO - Set seed to 0.
2020-05-24 22:33:10,817 - root - INFO - Computation device: cuda
2020-05-24 22:33:10,817 - root - INFO - Number of threads: 0
2020-05-24 22:33:10,817 - root - INFO - Number of dataloader workers: 6
2020-05-24 22:33:13,167 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-24 22:33:13,167 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-24 22:33:13,167 - root - INFO - Pretraining: True
2020-05-24 22:33:13,167 - root - INFO - Training optimizer: adam
2020-05-24 22:33:13,167 - root - INFO - Training learning rate: 0.0001
2020-05-24 22:33:13,167 - root - INFO - Training epochs: 150
2020-05-24 22:33:13,167 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-24 22:33:13,167 - root - INFO - Training batch size: 200
2020-05-24 22:33:13,167 - root - INFO - Training weight decay: 5e-07
2020-05-24 22:33:13,170 - root - INFO - Starting training...
2020-05-24 22:33:15,549 - root - INFO - | Epoch: 001/150 | Train Time: 2.379s | Train Loss: 1.707739 |
2020-05-24 22:33:16,405 - root - INFO - | Epoch: 002/150 | Train Time: 0.856s | Train Loss: 0.456128 |
2020-05-24 22:33:17,223 - root - INFO - | Epoch: 003/150 | Train Time: 0.818s | Train Loss: 0.300026 |
2020-05-24 22:33:18,082 - root - INFO - | Epoch: 004/150 | Train Time: 0.858s | Train Loss: 0.242420 |
2020-05-24 22:33:18,980 - root - INFO - | Epoch: 005/150 | Train Time: 0.897s | Train Loss: 0.208944 |
2020-05-24 22:33:19,782 - root - INFO - | Epoch: 006/150 | Train Time: 0.801s | Train Loss: 0.189269 |
2020-05-24 22:33:20,558 - root - INFO - | Epoch: 007/150 | Train Time: 0.776s | Train Loss: 0.172390 |
2020-05-24 22:33:21,524 - root - INFO - | Epoch: 008/150 | Train Time: 0.965s | Train Loss: 0.158508 |
2020-05-24 22:33:22,336 - root - INFO - | Epoch: 009/150 | Train Time: 0.811s | Train Loss: 0.149160 |
2020-05-24 22:33:23,223 - root - INFO - | Epoch: 010/150 | Train Time: 0.887s | Train Loss: 0.142751 |
2020-05-24 22:33:24,031 - root - INFO - | Epoch: 011/150 | Train Time: 0.807s | Train Loss: 0.138233 |
2020-05-24 22:33:24,895 - root - INFO - | Epoch: 012/150 | Train Time: 0.863s | Train Loss: 0.130633 |
2020-05-24 22:33:25,775 - root - INFO - | Epoch: 013/150 | Train Time: 0.880s | Train Loss: 0.123094 |
2020-05-24 22:33:26,630 - root - INFO - | Epoch: 014/150 | Train Time: 0.854s | Train Loss: 0.120209 |
2020-05-24 22:33:27,485 - root - INFO - | Epoch: 015/150 | Train Time: 0.855s | Train Loss: 0.120748 |
2020-05-24 22:33:28,329 - root - INFO - | Epoch: 016/150 | Train Time: 0.843s | Train Loss: 0.113832 |
2020-05-24 22:33:29,181 - root - INFO - | Epoch: 017/150 | Train Time: 0.851s | Train Loss: 0.111653 |
2020-05-24 22:33:30,021 - root - INFO - | Epoch: 018/150 | Train Time: 0.839s | Train Loss: 0.109333 |
2020-05-24 22:33:30,857 - root - INFO - | Epoch: 019/150 | Train Time: 0.836s | Train Loss: 0.106217 |
2020-05-24 22:33:31,708 - root - INFO - | Epoch: 020/150 | Train Time: 0.850s | Train Loss: 0.104624 |
2020-05-24 22:33:32,537 - root - INFO - | Epoch: 021/150 | Train Time: 0.829s | Train Loss: 0.101748 |
2020-05-24 22:33:33,322 - root - INFO - | Epoch: 022/150 | Train Time: 0.784s | Train Loss: 0.100773 |
2020-05-24 22:33:34,246 - root - INFO - | Epoch: 023/150 | Train Time: 0.923s | Train Loss: 0.098019 |
2020-05-24 22:33:35,089 - root - INFO - | Epoch: 024/150 | Train Time: 0.842s | Train Loss: 0.098764 |
2020-05-24 22:33:35,824 - root - INFO - | Epoch: 025/150 | Train Time: 0.735s | Train Loss: 0.095140 |
2020-05-24 22:33:36,640 - root - INFO - | Epoch: 026/150 | Train Time: 0.816s | Train Loss: 0.091938 |
2020-05-24 22:33:37,314 - root - INFO - | Epoch: 027/150 | Train Time: 0.673s | Train Loss: 0.093506 |
2020-05-24 22:33:38,001 - root - INFO - | Epoch: 028/150 | Train Time: 0.687s | Train Loss: 0.090112 |
2020-05-24 22:33:38,836 - root - INFO - | Epoch: 029/150 | Train Time: 0.835s | Train Loss: 0.092212 |
2020-05-24 22:33:39,692 - root - INFO - | Epoch: 030/150 | Train Time: 0.855s | Train Loss: 0.088119 |
2020-05-24 22:33:40,512 - root - INFO - | Epoch: 031/150 | Train Time: 0.819s | Train Loss: 0.086657 |
2020-05-24 22:33:41,309 - root - INFO - | Epoch: 032/150 | Train Time: 0.797s | Train Loss: 0.085636 |
2020-05-24 22:33:42,127 - root - INFO - | Epoch: 033/150 | Train Time: 0.818s | Train Loss: 0.087870 |
2020-05-24 22:33:43,039 - root - INFO - | Epoch: 034/150 | Train Time: 0.911s | Train Loss: 0.089507 |
2020-05-24 22:33:43,859 - root - INFO - | Epoch: 035/150 | Train Time: 0.819s | Train Loss: 0.085813 |
2020-05-24 22:33:44,635 - root - INFO - | Epoch: 036/150 | Train Time: 0.776s | Train Loss: 0.083823 |
2020-05-24 22:33:45,429 - root - INFO - | Epoch: 037/150 | Train Time: 0.793s | Train Loss: 0.082787 |
2020-05-24 22:33:46,163 - root - INFO - | Epoch: 038/150 | Train Time: 0.734s | Train Loss: 0.080148 |
2020-05-24 22:33:46,890 - root - INFO - | Epoch: 039/150 | Train Time: 0.726s | Train Loss: 0.079961 |
2020-05-24 22:33:47,711 - root - INFO - | Epoch: 040/150 | Train Time: 0.821s | Train Loss: 0.079715 |
2020-05-24 22:33:48,453 - root - INFO - | Epoch: 041/150 | Train Time: 0.741s | Train Loss: 0.075114 |
2020-05-24 22:33:49,319 - root - INFO - | Epoch: 042/150 | Train Time: 0.865s | Train Loss: 0.077022 |
2020-05-24 22:33:50,177 - root - INFO - | Epoch: 043/150 | Train Time: 0.857s | Train Loss: 0.076135 |
2020-05-24 22:33:51,084 - root - INFO - | Epoch: 044/150 | Train Time: 0.907s | Train Loss: 0.074790 |
2020-05-24 22:33:51,968 - root - INFO - | Epoch: 045/150 | Train Time: 0.884s | Train Loss: 0.076659 |
2020-05-24 22:33:52,809 - root - INFO - | Epoch: 046/150 | Train Time: 0.840s | Train Loss: 0.073369 |
2020-05-24 22:33:53,643 - root - INFO - | Epoch: 047/150 | Train Time: 0.834s | Train Loss: 0.072219 |
2020-05-24 22:33:54,441 - root - INFO - | Epoch: 048/150 | Train Time: 0.797s | Train Loss: 0.072400 |
2020-05-24 22:33:55,279 - root - INFO - | Epoch: 049/150 | Train Time: 0.838s | Train Loss: 0.071749 |
2020-05-24 22:33:56,162 - root - INFO - | Epoch: 050/150 | Train Time: 0.883s | Train Loss: 0.070787 |
2020-05-24 22:33:56,163 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-24 22:33:56,955 - root - INFO - | Epoch: 051/150 | Train Time: 0.792s | Train Loss: 0.068403 |
2020-05-24 22:33:57,685 - root - INFO - | Epoch: 052/150 | Train Time: 0.730s | Train Loss: 0.066307 |
2020-05-24 22:33:58,435 - root - INFO - | Epoch: 053/150 | Train Time: 0.749s | Train Loss: 0.066502 |
2020-05-24 22:33:59,223 - root - INFO - | Epoch: 054/150 | Train Time: 0.787s | Train Loss: 0.066771 |
2020-05-24 22:33:59,993 - root - INFO - | Epoch: 055/150 | Train Time: 0.769s | Train Loss: 0.066627 |
2020-05-24 22:34:00,775 - root - INFO - | Epoch: 056/150 | Train Time: 0.782s | Train Loss: 0.069178 |
2020-05-24 22:34:01,543 - root - INFO - | Epoch: 057/150 | Train Time: 0.768s | Train Loss: 0.067088 |
2020-05-24 22:34:02,452 - root - INFO - | Epoch: 058/150 | Train Time: 0.907s | Train Loss: 0.067245 |
2020-05-24 22:34:03,292 - root - INFO - | Epoch: 059/150 | Train Time: 0.840s | Train Loss: 0.066333 |
2020-05-24 22:34:04,095 - root - INFO - | Epoch: 060/150 | Train Time: 0.802s | Train Loss: 0.066230 |
2020-05-24 22:34:05,028 - root - INFO - | Epoch: 061/150 | Train Time: 0.933s | Train Loss: 0.066863 |
2020-05-24 22:34:05,809 - root - INFO - | Epoch: 062/150 | Train Time: 0.780s | Train Loss: 0.066351 |
2020-05-24 22:34:06,587 - root - INFO - | Epoch: 063/150 | Train Time: 0.778s | Train Loss: 0.066289 |
2020-05-24 22:34:07,384 - root - INFO - | Epoch: 064/150 | Train Time: 0.796s | Train Loss: 0.066169 |
2020-05-24 22:34:08,133 - root - INFO - | Epoch: 065/150 | Train Time: 0.749s | Train Loss: 0.067211 |
2020-05-24 22:34:08,910 - root - INFO - | Epoch: 066/150 | Train Time: 0.777s | Train Loss: 0.066401 |
2020-05-24 22:34:09,654 - root - INFO - | Epoch: 067/150 | Train Time: 0.743s | Train Loss: 0.066682 |
2020-05-24 22:34:10,641 - root - INFO - | Epoch: 068/150 | Train Time: 0.986s | Train Loss: 0.065660 |
2020-05-24 22:34:11,363 - root - INFO - | Epoch: 069/150 | Train Time: 0.722s | Train Loss: 0.067503 |
2020-05-24 22:34:12,175 - root - INFO - | Epoch: 070/150 | Train Time: 0.810s | Train Loss: 0.065023 |
2020-05-24 22:34:13,010 - root - INFO - | Epoch: 071/150 | Train Time: 0.834s | Train Loss: 0.064799 |
2020-05-24 22:34:13,861 - root - INFO - | Epoch: 072/150 | Train Time: 0.851s | Train Loss: 0.065226 |
2020-05-24 22:34:14,695 - root - INFO - | Epoch: 073/150 | Train Time: 0.833s | Train Loss: 0.066211 |
2020-05-24 22:34:15,563 - root - INFO - | Epoch: 074/150 | Train Time: 0.868s | Train Loss: 0.066529 |
2020-05-24 22:34:16,452 - root - INFO - | Epoch: 075/150 | Train Time: 0.889s | Train Loss: 0.065857 |
2020-05-24 22:34:17,247 - root - INFO - | Epoch: 076/150 | Train Time: 0.795s | Train Loss: 0.064681 |
2020-05-24 22:34:18,226 - root - INFO - | Epoch: 077/150 | Train Time: 0.978s | Train Loss: 0.065188 |
2020-05-24 22:34:19,106 - root - INFO - | Epoch: 078/150 | Train Time: 0.879s | Train Loss: 0.066116 |
2020-05-24 22:34:19,923 - root - INFO - | Epoch: 079/150 | Train Time: 0.817s | Train Loss: 0.064832 |
2020-05-24 22:34:20,719 - root - INFO - | Epoch: 080/150 | Train Time: 0.796s | Train Loss: 0.065400 |
2020-05-24 22:34:21,530 - root - INFO - | Epoch: 081/150 | Train Time: 0.810s | Train Loss: 0.067150 |
2020-05-24 22:34:22,254 - root - INFO - | Epoch: 082/150 | Train Time: 0.724s | Train Loss: 0.064934 |
2020-05-24 22:34:23,097 - root - INFO - | Epoch: 083/150 | Train Time: 0.842s | Train Loss: 0.064601 |
2020-05-24 22:34:23,931 - root - INFO - | Epoch: 084/150 | Train Time: 0.834s | Train Loss: 0.062402 |
2020-05-24 22:34:24,759 - root - INFO - | Epoch: 085/150 | Train Time: 0.827s | Train Loss: 0.063692 |
2020-05-24 22:34:25,586 - root - INFO - | Epoch: 086/150 | Train Time: 0.826s | Train Loss: 0.065433 |
2020-05-24 22:34:26,322 - root - INFO - | Epoch: 087/150 | Train Time: 0.736s | Train Loss: 0.064044 |
2020-05-24 22:34:27,418 - root - INFO - | Epoch: 088/150 | Train Time: 1.096s | Train Loss: 0.064634 |
2020-05-24 22:34:28,236 - root - INFO - | Epoch: 089/150 | Train Time: 0.817s | Train Loss: 0.064745 |
2020-05-24 22:34:29,099 - root - INFO - | Epoch: 090/150 | Train Time: 0.863s | Train Loss: 0.063128 |
2020-05-24 22:34:30,203 - root - INFO - | Epoch: 091/150 | Train Time: 1.103s | Train Loss: 0.064140 |
2020-05-24 22:34:31,475 - root - INFO - | Epoch: 092/150 | Train Time: 1.272s | Train Loss: 0.062919 |
2020-05-24 22:34:32,461 - root - INFO - | Epoch: 093/150 | Train Time: 0.986s | Train Loss: 0.065366 |
2020-05-24 22:34:33,458 - root - INFO - | Epoch: 094/150 | Train Time: 0.996s | Train Loss: 0.063522 |
2020-05-24 22:34:34,380 - root - INFO - | Epoch: 095/150 | Train Time: 0.922s | Train Loss: 0.064773 |
2020-05-24 22:34:35,444 - root - INFO - | Epoch: 096/150 | Train Time: 1.063s | Train Loss: 0.064305 |
2020-05-24 22:34:36,551 - root - INFO - | Epoch: 097/150 | Train Time: 1.107s | Train Loss: 0.062639 |
2020-05-24 22:34:37,439 - root - INFO - | Epoch: 098/150 | Train Time: 0.887s | Train Loss: 0.062377 |
2020-05-24 22:34:38,324 - root - INFO - | Epoch: 099/150 | Train Time: 0.885s | Train Loss: 0.062501 |
2020-05-24 22:34:39,451 - root - INFO - | Epoch: 100/150 | Train Time: 1.127s | Train Loss: 0.064651 |
2020-05-24 22:34:40,662 - root - INFO - | Epoch: 101/150 | Train Time: 1.211s | Train Loss: 0.061537 |
2020-05-24 22:34:42,018 - root - INFO - | Epoch: 102/150 | Train Time: 1.355s | Train Loss: 0.062157 |
2020-05-24 22:34:43,138 - root - INFO - | Epoch: 103/150 | Train Time: 1.119s | Train Loss: 0.061328 |
2020-05-24 22:34:44,119 - root - INFO - | Epoch: 104/150 | Train Time: 0.981s | Train Loss: 0.061413 |
2020-05-24 22:34:45,198 - root - INFO - | Epoch: 105/150 | Train Time: 1.079s | Train Loss: 0.064535 |
2020-05-24 22:34:46,536 - root - INFO - | Epoch: 106/150 | Train Time: 1.337s | Train Loss: 0.061187 |
2020-05-24 22:34:47,756 - root - INFO - | Epoch: 107/150 | Train Time: 1.219s | Train Loss: 0.062995 |
2020-05-24 22:34:48,742 - root - INFO - | Epoch: 108/150 | Train Time: 0.985s | Train Loss: 0.060926 |
2020-05-24 22:34:49,894 - root - INFO - | Epoch: 109/150 | Train Time: 1.152s | Train Loss: 0.061463 |
2020-05-24 22:34:51,196 - root - INFO - | Epoch: 110/150 | Train Time: 1.302s | Train Loss: 0.061969 |
2020-05-24 22:34:52,282 - root - INFO - | Epoch: 111/150 | Train Time: 1.085s | Train Loss: 0.060285 |
2020-05-24 22:34:53,369 - root - INFO - | Epoch: 112/150 | Train Time: 1.087s | Train Loss: 0.059937 |
2020-05-24 22:34:54,504 - root - INFO - | Epoch: 113/150 | Train Time: 1.134s | Train Loss: 0.060717 |
2020-05-24 22:34:55,752 - root - INFO - | Epoch: 114/150 | Train Time: 1.248s | Train Loss: 0.059945 |
2020-05-24 22:34:56,638 - root - INFO - | Epoch: 115/150 | Train Time: 0.886s | Train Loss: 0.060883 |
2020-05-24 22:34:57,542 - root - INFO - | Epoch: 116/150 | Train Time: 0.904s | Train Loss: 0.061013 |
2020-05-24 22:34:58,446 - root - INFO - | Epoch: 117/150 | Train Time: 0.904s | Train Loss: 0.060674 |
2020-05-24 22:34:59,467 - root - INFO - | Epoch: 118/150 | Train Time: 1.020s | Train Loss: 0.059833 |
2020-05-24 22:35:00,396 - root - INFO - | Epoch: 119/150 | Train Time: 0.929s | Train Loss: 0.061111 |
2020-05-24 22:35:01,210 - root - INFO - | Epoch: 120/150 | Train Time: 0.813s | Train Loss: 0.061278 |
2020-05-24 22:35:02,125 - root - INFO - | Epoch: 121/150 | Train Time: 0.915s | Train Loss: 0.059386 |
2020-05-24 22:35:02,988 - root - INFO - | Epoch: 122/150 | Train Time: 0.862s | Train Loss: 0.060529 |
2020-05-24 22:35:03,918 - root - INFO - | Epoch: 123/150 | Train Time: 0.930s | Train Loss: 0.060217 |
2020-05-24 22:35:04,716 - root - INFO - | Epoch: 124/150 | Train Time: 0.797s | Train Loss: 0.059429 |
2020-05-24 22:35:05,472 - root - INFO - | Epoch: 125/150 | Train Time: 0.755s | Train Loss: 0.061483 |
2020-05-24 22:35:06,590 - root - INFO - | Epoch: 126/150 | Train Time: 1.118s | Train Loss: 0.058568 |
2020-05-24 22:35:07,521 - root - INFO - | Epoch: 127/150 | Train Time: 0.930s | Train Loss: 0.059199 |
2020-05-24 22:35:08,472 - root - INFO - | Epoch: 128/150 | Train Time: 0.951s | Train Loss: 0.059926 |
2020-05-24 22:35:09,291 - root - INFO - | Epoch: 129/150 | Train Time: 0.818s | Train Loss: 0.059857 |
2020-05-24 22:35:10,282 - root - INFO - | Epoch: 130/150 | Train Time: 0.990s | Train Loss: 0.057738 |
2020-05-24 22:35:11,523 - root - INFO - | Epoch: 131/150 | Train Time: 1.241s | Train Loss: 0.059399 |
2020-05-24 22:35:12,842 - root - INFO - | Epoch: 132/150 | Train Time: 1.318s | Train Loss: 0.058546 |
2020-05-24 22:35:14,019 - root - INFO - | Epoch: 133/150 | Train Time: 1.177s | Train Loss: 0.057955 |
2020-05-24 22:35:14,997 - root - INFO - | Epoch: 134/150 | Train Time: 0.977s | Train Loss: 0.059392 |
2020-05-24 22:35:15,858 - root - INFO - | Epoch: 135/150 | Train Time: 0.860s | Train Loss: 0.057710 |
2020-05-24 22:35:16,916 - root - INFO - | Epoch: 136/150 | Train Time: 1.057s | Train Loss: 0.058433 |
2020-05-24 22:35:18,043 - root - INFO - | Epoch: 137/150 | Train Time: 1.127s | Train Loss: 0.058180 |
2020-05-24 22:35:19,167 - root - INFO - | Epoch: 138/150 | Train Time: 1.123s | Train Loss: 0.058048 |
2020-05-24 22:35:19,974 - root - INFO - | Epoch: 139/150 | Train Time: 0.807s | Train Loss: 0.058416 |
2020-05-24 22:35:20,811 - root - INFO - | Epoch: 140/150 | Train Time: 0.836s | Train Loss: 0.057897 |
2020-05-24 22:35:21,797 - root - INFO - | Epoch: 141/150 | Train Time: 0.986s | Train Loss: 0.057451 |
2020-05-24 22:35:22,913 - root - INFO - | Epoch: 142/150 | Train Time: 1.115s | Train Loss: 0.058131 |
2020-05-24 22:35:23,800 - root - INFO - | Epoch: 143/150 | Train Time: 0.887s | Train Loss: 0.057016 |
2020-05-24 22:35:24,638 - root - INFO - | Epoch: 144/150 | Train Time: 0.837s | Train Loss: 0.056722 |
2020-05-24 22:35:25,415 - root - INFO - | Epoch: 145/150 | Train Time: 0.777s | Train Loss: 0.056993 |
2020-05-24 22:35:26,258 - root - INFO - | Epoch: 146/150 | Train Time: 0.842s | Train Loss: 0.056605 |
2020-05-24 22:35:27,114 - root - INFO - | Epoch: 147/150 | Train Time: 0.856s | Train Loss: 0.056296 |
2020-05-24 22:35:27,951 - root - INFO - | Epoch: 148/150 | Train Time: 0.835s | Train Loss: 0.056735 |
2020-05-24 22:35:28,906 - root - INFO - | Epoch: 149/150 | Train Time: 0.955s | Train Loss: 0.056178 |
2020-05-24 22:35:29,857 - root - INFO - | Epoch: 150/150 | Train Time: 0.951s | Train Loss: 0.056941 |
2020-05-24 22:35:29,857 - root - INFO - Training Time: 136.687s
2020-05-24 22:35:29,857 - root - INFO - Finished training.
2020-05-24 22:35:29,859 - root - INFO - Starting testing...
2020-05-24 22:35:30,633 - root - INFO - Test Loss: 0.291687
2020-05-24 22:35:30,633 - root - INFO - Test AUC: 82.14%
2020-05-24 22:35:30,633 - root - INFO - Test Time: 0.763s
2020-05-24 22:35:30,634 - root - INFO - Finished testing.
