2020-05-24 22:41:48,008 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_2_4_005.txt
2020-05-24 22:41:48,009 - root - INFO - Data path is ../data
2020-05-24 22:41:48,010 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-24 22:41:48,010 - root - INFO - Dataset: fmnist
2020-05-24 22:41:48,010 - root - INFO - Normal class: 2
2020-05-24 22:41:48,010 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-24 22:41:48,010 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-24 22:41:48,010 - root - INFO - Pollution ratio of unlabeled train data: 0.05
2020-05-24 22:41:48,010 - root - INFO - Scenario Running: 2
2020-05-24 22:41:48,010 - root - INFO - Train only the network: True
2020-05-24 22:41:48,010 - root - INFO - Output and AE dimensions: 128
2020-05-24 22:41:48,010 - root - INFO - Known anomaly class: 4
2020-05-24 22:41:48,010 - root - INFO - Network: fmnist_LeNet
2020-05-24 22:41:48,011 - root - INFO - Eta-parameter: 1.00
2020-05-24 22:41:48,018 - root - INFO - Set seed to 0.
2020-05-24 22:41:48,046 - root - INFO - Computation device: cuda
2020-05-24 22:41:48,046 - root - INFO - Number of threads: 0
2020-05-24 22:41:48,046 - root - INFO - Number of dataloader workers: 6
2020-05-24 22:41:50,501 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-24 22:41:50,501 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-24 22:41:50,501 - root - INFO - Pretraining: True
2020-05-24 22:41:50,501 - root - INFO - Training optimizer: adam
2020-05-24 22:41:50,501 - root - INFO - Training learning rate: 0.0001
2020-05-24 22:41:50,501 - root - INFO - Training epochs: 150
2020-05-24 22:41:50,501 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-24 22:41:50,501 - root - INFO - Training batch size: 200
2020-05-24 22:41:50,501 - root - INFO - Training weight decay: 5e-07
2020-05-24 22:41:50,506 - root - INFO - Starting training...
2020-05-24 22:41:52,556 - root - INFO - | Epoch: 001/150 | Train Time: 2.050s | Train Loss: 2.339918 |
2020-05-24 22:41:53,357 - root - INFO - | Epoch: 002/150 | Train Time: 0.800s | Train Loss: 0.716447 |
2020-05-24 22:41:54,119 - root - INFO - | Epoch: 003/150 | Train Time: 0.761s | Train Loss: 0.472816 |
2020-05-24 22:41:54,888 - root - INFO - | Epoch: 004/150 | Train Time: 0.769s | Train Loss: 0.393108 |
2020-05-24 22:41:55,719 - root - INFO - | Epoch: 005/150 | Train Time: 0.830s | Train Loss: 0.344935 |
2020-05-24 22:41:56,508 - root - INFO - | Epoch: 006/150 | Train Time: 0.789s | Train Loss: 0.314852 |
2020-05-24 22:41:57,274 - root - INFO - | Epoch: 007/150 | Train Time: 0.766s | Train Loss: 0.289394 |
2020-05-24 22:41:57,994 - root - INFO - | Epoch: 008/150 | Train Time: 0.720s | Train Loss: 0.275523 |
2020-05-24 22:41:58,648 - root - INFO - | Epoch: 009/150 | Train Time: 0.653s | Train Loss: 0.259550 |
2020-05-24 22:41:59,357 - root - INFO - | Epoch: 010/150 | Train Time: 0.709s | Train Loss: 0.246082 |
2020-05-24 22:42:00,143 - root - INFO - | Epoch: 011/150 | Train Time: 0.785s | Train Loss: 0.232513 |
2020-05-24 22:42:00,945 - root - INFO - | Epoch: 012/150 | Train Time: 0.801s | Train Loss: 0.225091 |
2020-05-24 22:42:01,685 - root - INFO - | Epoch: 013/150 | Train Time: 0.740s | Train Loss: 0.216488 |
2020-05-24 22:42:02,473 - root - INFO - | Epoch: 014/150 | Train Time: 0.787s | Train Loss: 0.210576 |
2020-05-24 22:42:03,204 - root - INFO - | Epoch: 015/150 | Train Time: 0.731s | Train Loss: 0.203881 |
2020-05-24 22:42:03,884 - root - INFO - | Epoch: 016/150 | Train Time: 0.679s | Train Loss: 0.199389 |
2020-05-24 22:42:04,544 - root - INFO - | Epoch: 017/150 | Train Time: 0.660s | Train Loss: 0.189876 |
2020-05-24 22:42:05,282 - root - INFO - | Epoch: 018/150 | Train Time: 0.737s | Train Loss: 0.185916 |
2020-05-24 22:42:06,016 - root - INFO - | Epoch: 019/150 | Train Time: 0.734s | Train Loss: 0.183739 |
2020-05-24 22:42:06,824 - root - INFO - | Epoch: 020/150 | Train Time: 0.807s | Train Loss: 0.176310 |
2020-05-24 22:42:07,579 - root - INFO - | Epoch: 021/150 | Train Time: 0.755s | Train Loss: 0.173218 |
2020-05-24 22:42:08,275 - root - INFO - | Epoch: 022/150 | Train Time: 0.695s | Train Loss: 0.167094 |
2020-05-24 22:42:09,021 - root - INFO - | Epoch: 023/150 | Train Time: 0.746s | Train Loss: 0.162368 |
2020-05-24 22:42:09,707 - root - INFO - | Epoch: 024/150 | Train Time: 0.685s | Train Loss: 0.159891 |
2020-05-24 22:42:10,453 - root - INFO - | Epoch: 025/150 | Train Time: 0.746s | Train Loss: 0.158417 |
2020-05-24 22:42:11,186 - root - INFO - | Epoch: 026/150 | Train Time: 0.733s | Train Loss: 0.154948 |
2020-05-24 22:42:11,956 - root - INFO - | Epoch: 027/150 | Train Time: 0.769s | Train Loss: 0.150412 |
2020-05-24 22:42:12,684 - root - INFO - | Epoch: 028/150 | Train Time: 0.727s | Train Loss: 0.147457 |
2020-05-24 22:42:13,364 - root - INFO - | Epoch: 029/150 | Train Time: 0.680s | Train Loss: 0.146628 |
2020-05-24 22:42:14,091 - root - INFO - | Epoch: 030/150 | Train Time: 0.726s | Train Loss: 0.143821 |
2020-05-24 22:42:14,808 - root - INFO - | Epoch: 031/150 | Train Time: 0.717s | Train Loss: 0.139420 |
2020-05-24 22:42:15,573 - root - INFO - | Epoch: 032/150 | Train Time: 0.765s | Train Loss: 0.138082 |
2020-05-24 22:42:16,304 - root - INFO - | Epoch: 033/150 | Train Time: 0.730s | Train Loss: 0.131484 |
2020-05-24 22:42:17,122 - root - INFO - | Epoch: 034/150 | Train Time: 0.818s | Train Loss: 0.130661 |
2020-05-24 22:42:17,883 - root - INFO - | Epoch: 035/150 | Train Time: 0.760s | Train Loss: 0.129099 |
2020-05-24 22:42:18,630 - root - INFO - | Epoch: 036/150 | Train Time: 0.747s | Train Loss: 0.124059 |
2020-05-24 22:42:19,348 - root - INFO - | Epoch: 037/150 | Train Time: 0.717s | Train Loss: 0.121749 |
2020-05-24 22:42:20,075 - root - INFO - | Epoch: 038/150 | Train Time: 0.727s | Train Loss: 0.122439 |
2020-05-24 22:42:20,893 - root - INFO - | Epoch: 039/150 | Train Time: 0.818s | Train Loss: 0.116948 |
2020-05-24 22:42:21,653 - root - INFO - | Epoch: 040/150 | Train Time: 0.759s | Train Loss: 0.115629 |
2020-05-24 22:42:22,476 - root - INFO - | Epoch: 041/150 | Train Time: 0.823s | Train Loss: 0.110373 |
2020-05-24 22:42:23,357 - root - INFO - | Epoch: 042/150 | Train Time: 0.880s | Train Loss: 0.107652 |
2020-05-24 22:42:24,157 - root - INFO - | Epoch: 043/150 | Train Time: 0.800s | Train Loss: 0.107320 |
2020-05-24 22:42:24,959 - root - INFO - | Epoch: 044/150 | Train Time: 0.801s | Train Loss: 0.105538 |
2020-05-24 22:42:25,691 - root - INFO - | Epoch: 045/150 | Train Time: 0.731s | Train Loss: 0.100751 |
2020-05-24 22:42:26,400 - root - INFO - | Epoch: 046/150 | Train Time: 0.709s | Train Loss: 0.100580 |
2020-05-24 22:42:27,153 - root - INFO - | Epoch: 047/150 | Train Time: 0.753s | Train Loss: 0.098804 |
2020-05-24 22:42:27,819 - root - INFO - | Epoch: 048/150 | Train Time: 0.665s | Train Loss: 0.096640 |
2020-05-24 22:42:28,578 - root - INFO - | Epoch: 049/150 | Train Time: 0.759s | Train Loss: 0.097007 |
2020-05-24 22:42:29,343 - root - INFO - | Epoch: 050/150 | Train Time: 0.764s | Train Loss: 0.087838 |
2020-05-24 22:42:29,344 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-24 22:42:30,114 - root - INFO - | Epoch: 051/150 | Train Time: 0.770s | Train Loss: 0.086960 |
2020-05-24 22:42:30,827 - root - INFO - | Epoch: 052/150 | Train Time: 0.712s | Train Loss: 0.089539 |
2020-05-24 22:42:31,569 - root - INFO - | Epoch: 053/150 | Train Time: 0.742s | Train Loss: 0.087338 |
2020-05-24 22:42:32,243 - root - INFO - | Epoch: 054/150 | Train Time: 0.674s | Train Loss: 0.086537 |
2020-05-24 22:42:32,943 - root - INFO - | Epoch: 055/150 | Train Time: 0.699s | Train Loss: 0.086314 |
2020-05-24 22:42:33,622 - root - INFO - | Epoch: 056/150 | Train Time: 0.679s | Train Loss: 0.086183 |
2020-05-24 22:42:34,331 - root - INFO - | Epoch: 057/150 | Train Time: 0.709s | Train Loss: 0.085987 |
2020-05-24 22:42:35,023 - root - INFO - | Epoch: 058/150 | Train Time: 0.692s | Train Loss: 0.085618 |
2020-05-24 22:42:35,695 - root - INFO - | Epoch: 059/150 | Train Time: 0.671s | Train Loss: 0.085535 |
2020-05-24 22:42:36,375 - root - INFO - | Epoch: 060/150 | Train Time: 0.679s | Train Loss: 0.085971 |
2020-05-24 22:42:37,050 - root - INFO - | Epoch: 061/150 | Train Time: 0.675s | Train Loss: 0.086662 |
2020-05-24 22:42:37,796 - root - INFO - | Epoch: 062/150 | Train Time: 0.745s | Train Loss: 0.085313 |
2020-05-24 22:42:38,482 - root - INFO - | Epoch: 063/150 | Train Time: 0.686s | Train Loss: 0.086270 |
2020-05-24 22:42:39,158 - root - INFO - | Epoch: 064/150 | Train Time: 0.675s | Train Loss: 0.086347 |
2020-05-24 22:42:39,844 - root - INFO - | Epoch: 065/150 | Train Time: 0.685s | Train Loss: 0.085658 |
2020-05-24 22:42:40,600 - root - INFO - | Epoch: 066/150 | Train Time: 0.756s | Train Loss: 0.083903 |
2020-05-24 22:42:41,312 - root - INFO - | Epoch: 067/150 | Train Time: 0.711s | Train Loss: 0.084351 |
2020-05-24 22:42:41,983 - root - INFO - | Epoch: 068/150 | Train Time: 0.671s | Train Loss: 0.085343 |
2020-05-24 22:42:42,712 - root - INFO - | Epoch: 069/150 | Train Time: 0.729s | Train Loss: 0.084252 |
2020-05-24 22:42:43,397 - root - INFO - | Epoch: 070/150 | Train Time: 0.684s | Train Loss: 0.084004 |
2020-05-24 22:42:44,069 - root - INFO - | Epoch: 071/150 | Train Time: 0.672s | Train Loss: 0.083386 |
2020-05-24 22:42:44,755 - root - INFO - | Epoch: 072/150 | Train Time: 0.686s | Train Loss: 0.083498 |
2020-05-24 22:42:45,507 - root - INFO - | Epoch: 073/150 | Train Time: 0.751s | Train Loss: 0.082311 |
2020-05-24 22:42:46,199 - root - INFO - | Epoch: 074/150 | Train Time: 0.691s | Train Loss: 0.082595 |
2020-05-24 22:42:46,954 - root - INFO - | Epoch: 075/150 | Train Time: 0.755s | Train Loss: 0.083375 |
2020-05-24 22:42:47,597 - root - INFO - | Epoch: 076/150 | Train Time: 0.643s | Train Loss: 0.082040 |
2020-05-24 22:42:48,306 - root - INFO - | Epoch: 077/150 | Train Time: 0.708s | Train Loss: 0.082572 |
2020-05-24 22:42:48,990 - root - INFO - | Epoch: 078/150 | Train Time: 0.684s | Train Loss: 0.081634 |
2020-05-24 22:42:49,657 - root - INFO - | Epoch: 079/150 | Train Time: 0.667s | Train Loss: 0.082437 |
2020-05-24 22:42:50,375 - root - INFO - | Epoch: 080/150 | Train Time: 0.718s | Train Loss: 0.083213 |
2020-05-24 22:42:50,985 - root - INFO - | Epoch: 081/150 | Train Time: 0.610s | Train Loss: 0.082107 |
2020-05-24 22:42:51,644 - root - INFO - | Epoch: 082/150 | Train Time: 0.658s | Train Loss: 0.079581 |
2020-05-24 22:42:52,319 - root - INFO - | Epoch: 083/150 | Train Time: 0.675s | Train Loss: 0.080773 |
2020-05-24 22:42:53,019 - root - INFO - | Epoch: 084/150 | Train Time: 0.699s | Train Loss: 0.081230 |
2020-05-24 22:42:53,693 - root - INFO - | Epoch: 085/150 | Train Time: 0.674s | Train Loss: 0.080837 |
2020-05-24 22:42:54,398 - root - INFO - | Epoch: 086/150 | Train Time: 0.705s | Train Loss: 0.080262 |
2020-05-24 22:42:55,042 - root - INFO - | Epoch: 087/150 | Train Time: 0.643s | Train Loss: 0.080474 |
2020-05-24 22:42:55,676 - root - INFO - | Epoch: 088/150 | Train Time: 0.633s | Train Loss: 0.079398 |
2020-05-24 22:42:56,374 - root - INFO - | Epoch: 089/150 | Train Time: 0.698s | Train Loss: 0.081154 |
2020-05-24 22:42:57,018 - root - INFO - | Epoch: 090/150 | Train Time: 0.644s | Train Loss: 0.080965 |
2020-05-24 22:42:57,727 - root - INFO - | Epoch: 091/150 | Train Time: 0.709s | Train Loss: 0.079424 |
2020-05-24 22:42:58,400 - root - INFO - | Epoch: 092/150 | Train Time: 0.672s | Train Loss: 0.079128 |
2020-05-24 22:42:59,125 - root - INFO - | Epoch: 093/150 | Train Time: 0.724s | Train Loss: 0.082033 |
2020-05-24 22:42:59,841 - root - INFO - | Epoch: 094/150 | Train Time: 0.715s | Train Loss: 0.077999 |
2020-05-24 22:43:00,536 - root - INFO - | Epoch: 095/150 | Train Time: 0.695s | Train Loss: 0.079873 |
2020-05-24 22:43:01,304 - root - INFO - | Epoch: 096/150 | Train Time: 0.767s | Train Loss: 0.076981 |
2020-05-24 22:43:02,044 - root - INFO - | Epoch: 097/150 | Train Time: 0.740s | Train Loss: 0.079756 |
2020-05-24 22:43:02,772 - root - INFO - | Epoch: 098/150 | Train Time: 0.728s | Train Loss: 0.079187 |
2020-05-24 22:43:03,462 - root - INFO - | Epoch: 099/150 | Train Time: 0.689s | Train Loss: 0.078925 |
2020-05-24 22:43:04,115 - root - INFO - | Epoch: 100/150 | Train Time: 0.653s | Train Loss: 0.076953 |
2020-05-24 22:43:04,750 - root - INFO - | Epoch: 101/150 | Train Time: 0.635s | Train Loss: 0.078675 |
2020-05-24 22:43:05,453 - root - INFO - | Epoch: 102/150 | Train Time: 0.702s | Train Loss: 0.077303 |
2020-05-24 22:43:06,118 - root - INFO - | Epoch: 103/150 | Train Time: 0.665s | Train Loss: 0.077105 |
2020-05-24 22:43:06,803 - root - INFO - | Epoch: 104/150 | Train Time: 0.684s | Train Loss: 0.076747 |
2020-05-24 22:43:07,531 - root - INFO - | Epoch: 105/150 | Train Time: 0.728s | Train Loss: 0.078127 |
2020-05-24 22:43:08,246 - root - INFO - | Epoch: 106/150 | Train Time: 0.715s | Train Loss: 0.076142 |
2020-05-24 22:43:09,015 - root - INFO - | Epoch: 107/150 | Train Time: 0.768s | Train Loss: 0.077443 |
2020-05-24 22:43:09,721 - root - INFO - | Epoch: 108/150 | Train Time: 0.705s | Train Loss: 0.077717 |
2020-05-24 22:43:10,365 - root - INFO - | Epoch: 109/150 | Train Time: 0.643s | Train Loss: 0.076796 |
2020-05-24 22:43:11,112 - root - INFO - | Epoch: 110/150 | Train Time: 0.747s | Train Loss: 0.074406 |
2020-05-24 22:43:11,867 - root - INFO - | Epoch: 111/150 | Train Time: 0.754s | Train Loss: 0.075072 |
2020-05-24 22:43:12,611 - root - INFO - | Epoch: 112/150 | Train Time: 0.743s | Train Loss: 0.075133 |
2020-05-24 22:43:13,335 - root - INFO - | Epoch: 113/150 | Train Time: 0.724s | Train Loss: 0.076381 |
2020-05-24 22:43:14,053 - root - INFO - | Epoch: 114/150 | Train Time: 0.717s | Train Loss: 0.074533 |
2020-05-24 22:43:14,751 - root - INFO - | Epoch: 115/150 | Train Time: 0.698s | Train Loss: 0.075589 |
2020-05-24 22:43:15,597 - root - INFO - | Epoch: 116/150 | Train Time: 0.845s | Train Loss: 0.075098 |
2020-05-24 22:43:16,322 - root - INFO - | Epoch: 117/150 | Train Time: 0.724s | Train Loss: 0.074492 |
2020-05-24 22:43:16,972 - root - INFO - | Epoch: 118/150 | Train Time: 0.649s | Train Loss: 0.075016 |
2020-05-24 22:43:17,733 - root - INFO - | Epoch: 119/150 | Train Time: 0.761s | Train Loss: 0.073919 |
2020-05-24 22:43:18,466 - root - INFO - | Epoch: 120/150 | Train Time: 0.732s | Train Loss: 0.073094 |
2020-05-24 22:43:19,399 - root - INFO - | Epoch: 121/150 | Train Time: 0.932s | Train Loss: 0.074830 |
2020-05-24 22:43:20,071 - root - INFO - | Epoch: 122/150 | Train Time: 0.671s | Train Loss: 0.073425 |
2020-05-24 22:43:20,676 - root - INFO - | Epoch: 123/150 | Train Time: 0.605s | Train Loss: 0.073167 |
2020-05-24 22:43:21,398 - root - INFO - | Epoch: 124/150 | Train Time: 0.721s | Train Loss: 0.072190 |
2020-05-24 22:43:22,058 - root - INFO - | Epoch: 125/150 | Train Time: 0.659s | Train Loss: 0.073373 |
2020-05-24 22:43:22,721 - root - INFO - | Epoch: 126/150 | Train Time: 0.663s | Train Loss: 0.072634 |
2020-05-24 22:43:23,437 - root - INFO - | Epoch: 127/150 | Train Time: 0.715s | Train Loss: 0.074056 |
2020-05-24 22:43:24,202 - root - INFO - | Epoch: 128/150 | Train Time: 0.765s | Train Loss: 0.072334 |
2020-05-24 22:43:24,942 - root - INFO - | Epoch: 129/150 | Train Time: 0.739s | Train Loss: 0.072741 |
2020-05-24 22:43:25,620 - root - INFO - | Epoch: 130/150 | Train Time: 0.677s | Train Loss: 0.073160 |
2020-05-24 22:43:26,305 - root - INFO - | Epoch: 131/150 | Train Time: 0.685s | Train Loss: 0.071809 |
2020-05-24 22:43:27,069 - root - INFO - | Epoch: 132/150 | Train Time: 0.763s | Train Loss: 0.073281 |
2020-05-24 22:43:27,759 - root - INFO - | Epoch: 133/150 | Train Time: 0.690s | Train Loss: 0.071610 |
2020-05-24 22:43:28,473 - root - INFO - | Epoch: 134/150 | Train Time: 0.713s | Train Loss: 0.070636 |
2020-05-24 22:43:29,178 - root - INFO - | Epoch: 135/150 | Train Time: 0.705s | Train Loss: 0.072867 |
2020-05-24 22:43:29,860 - root - INFO - | Epoch: 136/150 | Train Time: 0.682s | Train Loss: 0.070781 |
2020-05-24 22:43:30,554 - root - INFO - | Epoch: 137/150 | Train Time: 0.693s | Train Loss: 0.072507 |
2020-05-24 22:43:31,166 - root - INFO - | Epoch: 138/150 | Train Time: 0.612s | Train Loss: 0.070438 |
2020-05-24 22:43:31,817 - root - INFO - | Epoch: 139/150 | Train Time: 0.650s | Train Loss: 0.072446 |
2020-05-24 22:43:32,498 - root - INFO - | Epoch: 140/150 | Train Time: 0.680s | Train Loss: 0.071306 |
2020-05-24 22:43:33,276 - root - INFO - | Epoch: 141/150 | Train Time: 0.777s | Train Loss: 0.069606 |
2020-05-24 22:43:33,955 - root - INFO - | Epoch: 142/150 | Train Time: 0.679s | Train Loss: 0.069499 |
2020-05-24 22:43:34,652 - root - INFO - | Epoch: 143/150 | Train Time: 0.696s | Train Loss: 0.069601 |
2020-05-24 22:43:35,317 - root - INFO - | Epoch: 144/150 | Train Time: 0.665s | Train Loss: 0.069014 |
2020-05-24 22:43:36,061 - root - INFO - | Epoch: 145/150 | Train Time: 0.744s | Train Loss: 0.069301 |
2020-05-24 22:43:36,820 - root - INFO - | Epoch: 146/150 | Train Time: 0.759s | Train Loss: 0.068486 |
2020-05-24 22:43:37,589 - root - INFO - | Epoch: 147/150 | Train Time: 0.768s | Train Loss: 0.071429 |
2020-05-24 22:43:38,367 - root - INFO - | Epoch: 148/150 | Train Time: 0.777s | Train Loss: 0.069091 |
2020-05-24 22:43:39,066 - root - INFO - | Epoch: 149/150 | Train Time: 0.698s | Train Loss: 0.068546 |
2020-05-24 22:43:39,737 - root - INFO - | Epoch: 150/150 | Train Time: 0.672s | Train Loss: 0.069373 |
2020-05-24 22:43:39,738 - root - INFO - Training Time: 109.232s
2020-05-24 22:43:39,738 - root - INFO - Finished training.
2020-05-24 22:43:39,739 - root - INFO - Starting testing...
2020-05-24 22:43:40,470 - root - INFO - Test Loss: 0.242450
2020-05-24 22:43:40,470 - root - INFO - Test AUC: 69.51%
2020-05-24 22:43:40,470 - root - INFO - Test Time: 0.719s
2020-05-24 22:43:40,470 - root - INFO - Finished testing.
