2020-05-27 01:58:34,398 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_3_4_01.txt
2020-05-27 01:58:34,398 - root - INFO - Data path is ../data
2020-05-27 01:58:34,398 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 01:58:34,398 - root - INFO - Dataset: fmnist
2020-05-27 01:58:34,398 - root - INFO - Normal class: 3
2020-05-27 01:58:34,398 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 01:58:34,398 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 01:58:34,398 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-27 01:58:34,398 - root - INFO - Scenario Running: 2
2020-05-27 01:58:34,399 - root - INFO - Train only the network: True
2020-05-27 01:58:34,399 - root - INFO - Output and AE dimensions: 128
2020-05-27 01:58:34,399 - root - INFO - Known anomaly class: 4
2020-05-27 01:58:34,399 - root - INFO - Network: fmnist_LeNet
2020-05-27 01:58:34,399 - root - INFO - Eta-parameter: 1.00
2020-05-27 01:58:34,406 - root - INFO - Set seed to 0.
2020-05-27 01:58:34,440 - root - INFO - Computation device: cuda
2020-05-27 01:58:34,444 - root - INFO - Number of threads: 0
2020-05-27 01:58:34,445 - root - INFO - Number of dataloader workers: 6
2020-05-27 01:58:42,924 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 01:58:42,937 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 01:58:42,937 - root - INFO - Pretraining: True
2020-05-27 01:58:42,937 - root - INFO - Training optimizer: adam
2020-05-27 01:58:42,937 - root - INFO - Training learning rate: 0.0001
2020-05-27 01:58:42,937 - root - INFO - Training epochs: 150
2020-05-27 01:58:42,937 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 01:58:42,937 - root - INFO - Training batch size: 200
2020-05-27 01:58:42,938 - root - INFO - Training weight decay: 5e-07
2020-05-27 01:58:42,957 - root - INFO - Starting training...
2020-05-27 01:58:49,345 - root - INFO - | Epoch: 001/150 | Train Time: 6.388s | Train Loss: 1.772536 |
2020-05-27 01:58:51,898 - root - INFO - | Epoch: 002/150 | Train Time: 2.551s | Train Loss: 0.529185 |
2020-05-27 01:58:53,890 - root - INFO - | Epoch: 003/150 | Train Time: 1.992s | Train Loss: 0.379040 |
2020-05-27 01:58:55,811 - root - INFO - | Epoch: 004/150 | Train Time: 1.920s | Train Loss: 0.308970 |
2020-05-27 01:58:58,420 - root - INFO - | Epoch: 005/150 | Train Time: 2.609s | Train Loss: 0.272343 |
2020-05-27 01:59:00,890 - root - INFO - | Epoch: 006/150 | Train Time: 2.470s | Train Loss: 0.243181 |
2020-05-27 01:59:03,437 - root - INFO - | Epoch: 007/150 | Train Time: 2.546s | Train Loss: 0.224131 |
2020-05-27 01:59:06,412 - root - INFO - | Epoch: 008/150 | Train Time: 2.975s | Train Loss: 0.204848 |
2020-05-27 01:59:10,221 - root - INFO - | Epoch: 009/150 | Train Time: 3.809s | Train Loss: 0.194093 |
2020-05-27 01:59:13,336 - root - INFO - | Epoch: 010/150 | Train Time: 3.114s | Train Loss: 0.188568 |
2020-05-27 01:59:16,910 - root - INFO - | Epoch: 011/150 | Train Time: 3.574s | Train Loss: 0.178525 |
2020-05-27 01:59:20,109 - root - INFO - | Epoch: 012/150 | Train Time: 3.199s | Train Loss: 0.170782 |
2020-05-27 01:59:23,068 - root - INFO - | Epoch: 013/150 | Train Time: 2.958s | Train Loss: 0.162493 |
2020-05-27 01:59:26,368 - root - INFO - | Epoch: 014/150 | Train Time: 3.299s | Train Loss: 0.157694 |
2020-05-27 01:59:29,606 - root - INFO - | Epoch: 015/150 | Train Time: 3.238s | Train Loss: 0.152285 |
2020-05-27 01:59:31,959 - root - INFO - | Epoch: 016/150 | Train Time: 2.352s | Train Loss: 0.147308 |
2020-05-27 01:59:34,614 - root - INFO - | Epoch: 017/150 | Train Time: 2.654s | Train Loss: 0.145452 |
2020-05-27 01:59:37,473 - root - INFO - | Epoch: 018/150 | Train Time: 2.859s | Train Loss: 0.139299 |
2020-05-27 01:59:39,852 - root - INFO - | Epoch: 019/150 | Train Time: 2.379s | Train Loss: 0.137638 |
2020-05-27 01:59:42,570 - root - INFO - | Epoch: 020/150 | Train Time: 2.718s | Train Loss: 0.133116 |
2020-05-27 01:59:45,162 - root - INFO - | Epoch: 021/150 | Train Time: 2.592s | Train Loss: 0.130967 |
2020-05-27 01:59:48,600 - root - INFO - | Epoch: 022/150 | Train Time: 3.437s | Train Loss: 0.127148 |
2020-05-27 01:59:52,124 - root - INFO - | Epoch: 023/150 | Train Time: 3.523s | Train Loss: 0.122017 |
2020-05-27 01:59:55,686 - root - INFO - | Epoch: 024/150 | Train Time: 3.562s | Train Loss: 0.121519 |
2020-05-27 01:59:58,115 - root - INFO - | Epoch: 025/150 | Train Time: 2.428s | Train Loss: 0.118057 |
2020-05-27 02:00:01,224 - root - INFO - | Epoch: 026/150 | Train Time: 3.109s | Train Loss: 0.116340 |
2020-05-27 02:00:03,859 - root - INFO - | Epoch: 027/150 | Train Time: 2.634s | Train Loss: 0.115429 |
2020-05-27 02:00:06,177 - root - INFO - | Epoch: 028/150 | Train Time: 2.317s | Train Loss: 0.114849 |
2020-05-27 02:00:08,922 - root - INFO - | Epoch: 029/150 | Train Time: 2.745s | Train Loss: 0.112578 |
2020-05-27 02:00:11,764 - root - INFO - | Epoch: 030/150 | Train Time: 2.841s | Train Loss: 0.109126 |
2020-05-27 02:00:14,459 - root - INFO - | Epoch: 031/150 | Train Time: 2.695s | Train Loss: 0.106431 |
2020-05-27 02:00:17,052 - root - INFO - | Epoch: 032/150 | Train Time: 2.593s | Train Loss: 0.104577 |
2020-05-27 02:00:19,001 - root - INFO - | Epoch: 033/150 | Train Time: 1.948s | Train Loss: 0.104367 |
2020-05-27 02:00:20,959 - root - INFO - | Epoch: 034/150 | Train Time: 1.958s | Train Loss: 0.106765 |
2020-05-27 02:00:23,032 - root - INFO - | Epoch: 035/150 | Train Time: 2.072s | Train Loss: 0.102218 |
2020-05-27 02:00:25,413 - root - INFO - | Epoch: 036/150 | Train Time: 2.381s | Train Loss: 0.098654 |
2020-05-27 02:00:27,501 - root - INFO - | Epoch: 037/150 | Train Time: 2.088s | Train Loss: 0.099236 |
2020-05-27 02:00:30,209 - root - INFO - | Epoch: 038/150 | Train Time: 2.707s | Train Loss: 0.095485 |
2020-05-27 02:00:32,871 - root - INFO - | Epoch: 039/150 | Train Time: 2.663s | Train Loss: 0.095116 |
2020-05-27 02:00:35,836 - root - INFO - | Epoch: 040/150 | Train Time: 2.964s | Train Loss: 0.098960 |
2020-05-27 02:00:39,189 - root - INFO - | Epoch: 041/150 | Train Time: 3.352s | Train Loss: 0.091125 |
2020-05-27 02:00:41,846 - root - INFO - | Epoch: 042/150 | Train Time: 2.657s | Train Loss: 0.088559 |
2020-05-27 02:00:43,932 - root - INFO - | Epoch: 043/150 | Train Time: 2.085s | Train Loss: 0.090133 |
2020-05-27 02:00:46,101 - root - INFO - | Epoch: 044/150 | Train Time: 2.169s | Train Loss: 0.085888 |
2020-05-27 02:00:48,448 - root - INFO - | Epoch: 045/150 | Train Time: 2.346s | Train Loss: 0.091552 |
2020-05-27 02:00:51,386 - root - INFO - | Epoch: 046/150 | Train Time: 2.938s | Train Loss: 0.085181 |
2020-05-27 02:00:53,836 - root - INFO - | Epoch: 047/150 | Train Time: 2.450s | Train Loss: 0.083817 |
2020-05-27 02:00:57,164 - root - INFO - | Epoch: 048/150 | Train Time: 3.327s | Train Loss: 0.081098 |
2020-05-27 02:01:00,403 - root - INFO - | Epoch: 049/150 | Train Time: 3.239s | Train Loss: 0.079687 |
2020-05-27 02:01:03,063 - root - INFO - | Epoch: 050/150 | Train Time: 2.660s | Train Loss: 0.077808 |
2020-05-27 02:01:03,064 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 02:01:06,396 - root - INFO - | Epoch: 051/150 | Train Time: 3.332s | Train Loss: 0.075479 |
2020-05-27 02:01:09,084 - root - INFO - | Epoch: 052/150 | Train Time: 2.687s | Train Loss: 0.074986 |
2020-05-27 02:01:11,561 - root - INFO - | Epoch: 053/150 | Train Time: 2.477s | Train Loss: 0.075025 |
2020-05-27 02:01:14,074 - root - INFO - | Epoch: 054/150 | Train Time: 2.512s | Train Loss: 0.074765 |
2020-05-27 02:01:16,836 - root - INFO - | Epoch: 055/150 | Train Time: 2.761s | Train Loss: 0.073332 |
2020-05-27 02:01:19,246 - root - INFO - | Epoch: 056/150 | Train Time: 2.410s | Train Loss: 0.074733 |
2020-05-27 02:01:20,910 - root - INFO - | Epoch: 057/150 | Train Time: 1.663s | Train Loss: 0.075704 |
2020-05-27 02:01:22,748 - root - INFO - | Epoch: 058/150 | Train Time: 1.838s | Train Loss: 0.075092 |
2020-05-27 02:01:25,449 - root - INFO - | Epoch: 059/150 | Train Time: 2.700s | Train Loss: 0.073694 |
2020-05-27 02:01:28,021 - root - INFO - | Epoch: 060/150 | Train Time: 2.572s | Train Loss: 0.073475 |
2020-05-27 02:01:30,874 - root - INFO - | Epoch: 061/150 | Train Time: 2.853s | Train Loss: 0.073272 |
2020-05-27 02:01:34,157 - root - INFO - | Epoch: 062/150 | Train Time: 3.282s | Train Loss: 0.072615 |
2020-05-27 02:01:37,503 - root - INFO - | Epoch: 063/150 | Train Time: 3.272s | Train Loss: 0.072506 |
2020-05-27 02:01:40,318 - root - INFO - | Epoch: 064/150 | Train Time: 2.814s | Train Loss: 0.071792 |
2020-05-27 02:01:42,768 - root - INFO - | Epoch: 065/150 | Train Time: 2.449s | Train Loss: 0.072869 |
2020-05-27 02:01:45,212 - root - INFO - | Epoch: 066/150 | Train Time: 2.444s | Train Loss: 0.072753 |
2020-05-27 02:01:47,953 - root - INFO - | Epoch: 067/150 | Train Time: 2.741s | Train Loss: 0.072671 |
2020-05-27 02:01:50,983 - root - INFO - | Epoch: 068/150 | Train Time: 3.029s | Train Loss: 0.073297 |
2020-05-27 02:01:54,261 - root - INFO - | Epoch: 069/150 | Train Time: 3.277s | Train Loss: 0.073786 |
2020-05-27 02:01:56,229 - root - INFO - | Epoch: 070/150 | Train Time: 1.968s | Train Loss: 0.071674 |
2020-05-27 02:01:58,759 - root - INFO - | Epoch: 071/150 | Train Time: 2.529s | Train Loss: 0.072510 |
2020-05-27 02:02:01,855 - root - INFO - | Epoch: 072/150 | Train Time: 3.095s | Train Loss: 0.071842 |
2020-05-27 02:02:05,377 - root - INFO - | Epoch: 073/150 | Train Time: 3.521s | Train Loss: 0.071883 |
2020-05-27 02:02:08,847 - root - INFO - | Epoch: 074/150 | Train Time: 3.470s | Train Loss: 0.071527 |
2020-05-27 02:02:12,237 - root - INFO - | Epoch: 075/150 | Train Time: 3.389s | Train Loss: 0.071651 |
2020-05-27 02:02:15,740 - root - INFO - | Epoch: 076/150 | Train Time: 3.503s | Train Loss: 0.070976 |
2020-05-27 02:02:18,335 - root - INFO - | Epoch: 077/150 | Train Time: 2.594s | Train Loss: 0.071912 |
2020-05-27 02:02:20,691 - root - INFO - | Epoch: 078/150 | Train Time: 2.356s | Train Loss: 0.071695 |
2020-05-27 02:02:22,815 - root - INFO - | Epoch: 079/150 | Train Time: 2.124s | Train Loss: 0.072605 |
2020-05-27 02:02:24,900 - root - INFO - | Epoch: 080/150 | Train Time: 2.084s | Train Loss: 0.071116 |
2020-05-27 02:02:27,527 - root - INFO - | Epoch: 081/150 | Train Time: 2.627s | Train Loss: 0.071627 |
2020-05-27 02:02:29,687 - root - INFO - | Epoch: 082/150 | Train Time: 2.159s | Train Loss: 0.069120 |
2020-05-27 02:02:32,279 - root - INFO - | Epoch: 083/150 | Train Time: 2.591s | Train Loss: 0.070092 |
2020-05-27 02:02:35,247 - root - INFO - | Epoch: 084/150 | Train Time: 2.968s | Train Loss: 0.068083 |
2020-05-27 02:02:37,936 - root - INFO - | Epoch: 085/150 | Train Time: 2.689s | Train Loss: 0.070071 |
2020-05-27 02:02:40,475 - root - INFO - | Epoch: 086/150 | Train Time: 2.538s | Train Loss: 0.070808 |
2020-05-27 02:02:43,137 - root - INFO - | Epoch: 087/150 | Train Time: 2.661s | Train Loss: 0.069269 |
2020-05-27 02:02:46,210 - root - INFO - | Epoch: 088/150 | Train Time: 3.073s | Train Loss: 0.069414 |
2020-05-27 02:02:49,125 - root - INFO - | Epoch: 089/150 | Train Time: 2.914s | Train Loss: 0.069719 |
2020-05-27 02:02:52,072 - root - INFO - | Epoch: 090/150 | Train Time: 2.947s | Train Loss: 0.067381 |
2020-05-27 02:02:54,931 - root - INFO - | Epoch: 091/150 | Train Time: 2.858s | Train Loss: 0.069797 |
2020-05-27 02:02:58,323 - root - INFO - | Epoch: 092/150 | Train Time: 3.391s | Train Loss: 0.067699 |
2020-05-27 02:03:01,381 - root - INFO - | Epoch: 093/150 | Train Time: 3.057s | Train Loss: 0.069747 |
2020-05-27 02:03:03,802 - root - INFO - | Epoch: 094/150 | Train Time: 2.421s | Train Loss: 0.069004 |
2020-05-27 02:03:06,621 - root - INFO - | Epoch: 095/150 | Train Time: 2.818s | Train Loss: 0.069003 |
2020-05-27 02:03:09,746 - root - INFO - | Epoch: 096/150 | Train Time: 3.124s | Train Loss: 0.068729 |
2020-05-27 02:03:13,545 - root - INFO - | Epoch: 097/150 | Train Time: 3.799s | Train Loss: 0.066779 |
2020-05-27 02:03:16,996 - root - INFO - | Epoch: 098/150 | Train Time: 3.450s | Train Loss: 0.067927 |
2020-05-27 02:03:19,257 - root - INFO - | Epoch: 099/150 | Train Time: 2.260s | Train Loss: 0.067078 |
2020-05-27 02:03:21,860 - root - INFO - | Epoch: 100/150 | Train Time: 2.603s | Train Loss: 0.068618 |
2020-05-27 02:03:24,818 - root - INFO - | Epoch: 101/150 | Train Time: 2.957s | Train Loss: 0.066564 |
2020-05-27 02:03:27,113 - root - INFO - | Epoch: 102/150 | Train Time: 2.294s | Train Loss: 0.067257 |
2020-05-27 02:03:29,294 - root - INFO - | Epoch: 103/150 | Train Time: 2.181s | Train Loss: 0.066691 |
2020-05-27 02:03:31,916 - root - INFO - | Epoch: 104/150 | Train Time: 2.622s | Train Loss: 0.066006 |
2020-05-27 02:03:34,790 - root - INFO - | Epoch: 105/150 | Train Time: 2.873s | Train Loss: 0.067566 |
2020-05-27 02:03:37,606 - root - INFO - | Epoch: 106/150 | Train Time: 2.815s | Train Loss: 0.066706 |
2020-05-27 02:03:40,678 - root - INFO - | Epoch: 107/150 | Train Time: 3.072s | Train Loss: 0.067599 |
2020-05-27 02:03:42,391 - root - INFO - | Epoch: 108/150 | Train Time: 1.712s | Train Loss: 0.065314 |
2020-05-27 02:03:44,722 - root - INFO - | Epoch: 109/150 | Train Time: 2.331s | Train Loss: 0.066558 |
2020-05-27 02:03:47,861 - root - INFO - | Epoch: 110/150 | Train Time: 3.138s | Train Loss: 0.064592 |
2020-05-27 02:03:51,889 - root - INFO - | Epoch: 111/150 | Train Time: 4.027s | Train Loss: 0.064074 |
2020-05-27 02:03:56,058 - root - INFO - | Epoch: 112/150 | Train Time: 4.167s | Train Loss: 0.064816 |
2020-05-27 02:03:59,032 - root - INFO - | Epoch: 113/150 | Train Time: 2.974s | Train Loss: 0.065850 |
2020-05-27 02:04:01,508 - root - INFO - | Epoch: 114/150 | Train Time: 2.475s | Train Loss: 0.065093 |
2020-05-27 02:04:04,227 - root - INFO - | Epoch: 115/150 | Train Time: 2.719s | Train Loss: 0.065311 |
2020-05-27 02:04:06,962 - root - INFO - | Epoch: 116/150 | Train Time: 2.735s | Train Loss: 0.064032 |
2020-05-27 02:04:09,779 - root - INFO - | Epoch: 117/150 | Train Time: 2.816s | Train Loss: 0.064540 |
2020-05-27 02:04:12,309 - root - INFO - | Epoch: 118/150 | Train Time: 2.530s | Train Loss: 0.063868 |
2020-05-27 02:04:14,336 - root - INFO - | Epoch: 119/150 | Train Time: 2.027s | Train Loss: 0.065190 |
2020-05-27 02:04:17,712 - root - INFO - | Epoch: 120/150 | Train Time: 3.376s | Train Loss: 0.064382 |
2020-05-27 02:04:21,018 - root - INFO - | Epoch: 121/150 | Train Time: 3.305s | Train Loss: 0.063114 |
2020-05-27 02:04:23,924 - root - INFO - | Epoch: 122/150 | Train Time: 2.906s | Train Loss: 0.064624 |
2020-05-27 02:04:26,834 - root - INFO - | Epoch: 123/150 | Train Time: 2.909s | Train Loss: 0.064210 |
2020-05-27 02:04:29,705 - root - INFO - | Epoch: 124/150 | Train Time: 2.870s | Train Loss: 0.062801 |
2020-05-27 02:04:33,053 - root - INFO - | Epoch: 125/150 | Train Time: 3.347s | Train Loss: 0.064592 |
2020-05-27 02:04:35,683 - root - INFO - | Epoch: 126/150 | Train Time: 2.629s | Train Loss: 0.062194 |
2020-05-27 02:04:38,371 - root - INFO - | Epoch: 127/150 | Train Time: 2.688s | Train Loss: 0.061800 |
2020-05-27 02:04:40,967 - root - INFO - | Epoch: 128/150 | Train Time: 2.595s | Train Loss: 0.063454 |
2020-05-27 02:04:42,784 - root - INFO - | Epoch: 129/150 | Train Time: 1.816s | Train Loss: 0.064487 |
2020-05-27 02:04:45,200 - root - INFO - | Epoch: 130/150 | Train Time: 2.416s | Train Loss: 0.062635 |
2020-05-27 02:04:47,644 - root - INFO - | Epoch: 131/150 | Train Time: 2.443s | Train Loss: 0.062220 |
2020-05-27 02:04:50,167 - root - INFO - | Epoch: 132/150 | Train Time: 2.523s | Train Loss: 0.063085 |
2020-05-27 02:04:52,966 - root - INFO - | Epoch: 133/150 | Train Time: 2.798s | Train Loss: 0.061083 |
2020-05-27 02:04:55,838 - root - INFO - | Epoch: 134/150 | Train Time: 2.872s | Train Loss: 0.062497 |
2020-05-27 02:04:58,799 - root - INFO - | Epoch: 135/150 | Train Time: 2.960s | Train Loss: 0.060997 |
2020-05-27 02:05:01,705 - root - INFO - | Epoch: 136/150 | Train Time: 2.905s | Train Loss: 0.060822 |
2020-05-27 02:05:04,504 - root - INFO - | Epoch: 137/150 | Train Time: 2.799s | Train Loss: 0.061949 |
2020-05-27 02:05:07,915 - root - INFO - | Epoch: 138/150 | Train Time: 3.407s | Train Loss: 0.061385 |
2020-05-27 02:05:10,937 - root - INFO - | Epoch: 139/150 | Train Time: 3.021s | Train Loss: 0.062542 |
2020-05-27 02:05:14,010 - root - INFO - | Epoch: 140/150 | Train Time: 3.072s | Train Loss: 0.060450 |
2020-05-27 02:05:17,056 - root - INFO - | Epoch: 141/150 | Train Time: 3.045s | Train Loss: 0.058752 |
2020-05-27 02:05:19,810 - root - INFO - | Epoch: 142/150 | Train Time: 2.753s | Train Loss: 0.060347 |
2020-05-27 02:05:23,404 - root - INFO - | Epoch: 143/150 | Train Time: 3.593s | Train Loss: 0.059453 |
2020-05-27 02:05:26,956 - root - INFO - | Epoch: 144/150 | Train Time: 3.552s | Train Loss: 0.059366 |
2020-05-27 02:05:29,809 - root - INFO - | Epoch: 145/150 | Train Time: 2.852s | Train Loss: 0.058964 |
2020-05-27 02:05:32,403 - root - INFO - | Epoch: 146/150 | Train Time: 2.594s | Train Loss: 0.059526 |
2020-05-27 02:05:34,533 - root - INFO - | Epoch: 147/150 | Train Time: 2.129s | Train Loss: 0.059567 |
2020-05-27 02:05:36,461 - root - INFO - | Epoch: 148/150 | Train Time: 1.928s | Train Loss: 0.057992 |
2020-05-27 02:05:39,423 - root - INFO - | Epoch: 149/150 | Train Time: 2.961s | Train Loss: 0.061843 |
2020-05-27 02:05:42,064 - root - INFO - | Epoch: 150/150 | Train Time: 2.641s | Train Loss: 0.059247 |
2020-05-27 02:05:42,065 - root - INFO - Training Time: 419.107s
2020-05-27 02:05:42,065 - root - INFO - Finished training.
2020-05-27 02:05:42,067 - root - INFO - Starting testing...
2020-05-27 02:05:45,410 - root - INFO - Test Loss: 0.322407
2020-05-27 02:05:45,410 - root - INFO - Test AUC: 73.11%
2020-05-27 02:05:45,410 - root - INFO - Test Time: 3.328s
2020-05-27 02:05:45,411 - root - INFO - Finished testing.
