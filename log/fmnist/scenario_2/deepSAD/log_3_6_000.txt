2020-05-27 02:51:13,534 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_3_6_000.txt
2020-05-27 02:51:13,534 - root - INFO - Data path is ../data
2020-05-27 02:51:13,534 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 02:51:13,534 - root - INFO - Dataset: fmnist
2020-05-27 02:51:13,534 - root - INFO - Normal class: 3
2020-05-27 02:51:13,534 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 02:51:13,535 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 02:51:13,535 - root - INFO - Pollution ratio of unlabeled train data: 0.00
2020-05-27 02:51:13,535 - root - INFO - Scenario Running: 2
2020-05-27 02:51:13,535 - root - INFO - Train only the network: True
2020-05-27 02:51:13,535 - root - INFO - Output and AE dimensions: 128
2020-05-27 02:51:13,535 - root - INFO - Known anomaly class: 6
2020-05-27 02:51:13,535 - root - INFO - Network: fmnist_LeNet
2020-05-27 02:51:13,535 - root - INFO - Eta-parameter: 1.00
2020-05-27 02:51:13,542 - root - INFO - Set seed to 0.
2020-05-27 02:51:13,638 - root - INFO - Computation device: cuda
2020-05-27 02:51:13,639 - root - INFO - Number of threads: 0
2020-05-27 02:51:13,639 - root - INFO - Number of dataloader workers: 6
2020-05-27 02:51:21,237 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 02:51:21,240 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 02:51:21,240 - root - INFO - Pretraining: True
2020-05-27 02:51:21,240 - root - INFO - Training optimizer: adam
2020-05-27 02:51:21,240 - root - INFO - Training learning rate: 0.0001
2020-05-27 02:51:21,241 - root - INFO - Training epochs: 150
2020-05-27 02:51:21,241 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 02:51:21,241 - root - INFO - Training batch size: 200
2020-05-27 02:51:21,241 - root - INFO - Training weight decay: 5e-07
2020-05-27 02:51:21,264 - root - INFO - Starting training...
2020-05-27 02:51:27,750 - root - INFO - | Epoch: 001/150 | Train Time: 6.486s | Train Loss: 1.960800 |
2020-05-27 02:51:30,580 - root - INFO - | Epoch: 002/150 | Train Time: 2.829s | Train Loss: 0.537696 |
2020-05-27 02:51:33,473 - root - INFO - | Epoch: 003/150 | Train Time: 2.893s | Train Loss: 0.369612 |
2020-05-27 02:51:36,024 - root - INFO - | Epoch: 004/150 | Train Time: 2.551s | Train Loss: 0.294422 |
2020-05-27 02:51:38,502 - root - INFO - | Epoch: 005/150 | Train Time: 2.477s | Train Loss: 0.247039 |
2020-05-27 02:51:41,210 - root - INFO - | Epoch: 006/150 | Train Time: 2.708s | Train Loss: 0.217321 |
2020-05-27 02:51:43,493 - root - INFO - | Epoch: 007/150 | Train Time: 2.282s | Train Loss: 0.193485 |
2020-05-27 02:51:45,997 - root - INFO - | Epoch: 008/150 | Train Time: 2.503s | Train Loss: 0.179087 |
2020-05-27 02:51:48,839 - root - INFO - | Epoch: 009/150 | Train Time: 2.842s | Train Loss: 0.168489 |
2020-05-27 02:51:51,724 - root - INFO - | Epoch: 010/150 | Train Time: 2.884s | Train Loss: 0.154523 |
2020-05-27 02:51:54,573 - root - INFO - | Epoch: 011/150 | Train Time: 2.848s | Train Loss: 0.150922 |
2020-05-27 02:51:57,143 - root - INFO - | Epoch: 012/150 | Train Time: 2.570s | Train Loss: 0.142182 |
2020-05-27 02:52:00,310 - root - INFO - | Epoch: 013/150 | Train Time: 3.166s | Train Loss: 0.130696 |
2020-05-27 02:52:03,527 - root - INFO - | Epoch: 014/150 | Train Time: 3.216s | Train Loss: 0.125179 |
2020-05-27 02:52:05,740 - root - INFO - | Epoch: 015/150 | Train Time: 2.213s | Train Loss: 0.120823 |
2020-05-27 02:52:08,407 - root - INFO - | Epoch: 016/150 | Train Time: 2.667s | Train Loss: 0.113578 |
2020-05-27 02:52:11,055 - root - INFO - | Epoch: 017/150 | Train Time: 2.647s | Train Loss: 0.112075 |
2020-05-27 02:52:13,289 - root - INFO - | Epoch: 018/150 | Train Time: 2.233s | Train Loss: 0.108934 |
2020-05-27 02:52:15,371 - root - INFO - | Epoch: 019/150 | Train Time: 2.081s | Train Loss: 0.105228 |
2020-05-27 02:52:17,817 - root - INFO - | Epoch: 020/150 | Train Time: 2.446s | Train Loss: 0.106703 |
2020-05-27 02:52:20,061 - root - INFO - | Epoch: 021/150 | Train Time: 2.243s | Train Loss: 0.098848 |
2020-05-27 02:52:22,772 - root - INFO - | Epoch: 022/150 | Train Time: 2.711s | Train Loss: 0.095176 |
2020-05-27 02:52:25,694 - root - INFO - | Epoch: 023/150 | Train Time: 2.922s | Train Loss: 0.091103 |
2020-05-27 02:52:28,687 - root - INFO - | Epoch: 024/150 | Train Time: 2.992s | Train Loss: 0.089146 |
2020-05-27 02:52:31,426 - root - INFO - | Epoch: 025/150 | Train Time: 2.738s | Train Loss: 0.087206 |
2020-05-27 02:52:34,198 - root - INFO - | Epoch: 026/150 | Train Time: 2.771s | Train Loss: 0.085631 |
2020-05-27 02:52:37,049 - root - INFO - | Epoch: 027/150 | Train Time: 2.850s | Train Loss: 0.086374 |
2020-05-27 02:52:39,354 - root - INFO - | Epoch: 028/150 | Train Time: 2.305s | Train Loss: 0.082294 |
2020-05-27 02:52:42,058 - root - INFO - | Epoch: 029/150 | Train Time: 2.703s | Train Loss: 0.082811 |
2020-05-27 02:52:43,637 - root - INFO - | Epoch: 030/150 | Train Time: 1.579s | Train Loss: 0.079531 |
2020-05-27 02:52:46,397 - root - INFO - | Epoch: 031/150 | Train Time: 2.759s | Train Loss: 0.075982 |
2020-05-27 02:52:48,338 - root - INFO - | Epoch: 032/150 | Train Time: 1.941s | Train Loss: 0.074944 |
2020-05-27 02:52:50,619 - root - INFO - | Epoch: 033/150 | Train Time: 2.281s | Train Loss: 0.077406 |
2020-05-27 02:52:53,214 - root - INFO - | Epoch: 034/150 | Train Time: 2.595s | Train Loss: 0.072889 |
2020-05-27 02:52:56,041 - root - INFO - | Epoch: 035/150 | Train Time: 2.826s | Train Loss: 0.073125 |
2020-05-27 02:52:58,788 - root - INFO - | Epoch: 036/150 | Train Time: 2.746s | Train Loss: 0.075810 |
2020-05-27 02:53:01,286 - root - INFO - | Epoch: 037/150 | Train Time: 2.498s | Train Loss: 0.069868 |
2020-05-27 02:53:03,430 - root - INFO - | Epoch: 038/150 | Train Time: 2.144s | Train Loss: 0.068809 |
2020-05-27 02:53:06,262 - root - INFO - | Epoch: 039/150 | Train Time: 2.831s | Train Loss: 0.067974 |
2020-05-27 02:53:08,750 - root - INFO - | Epoch: 040/150 | Train Time: 2.488s | Train Loss: 0.070303 |
2020-05-27 02:53:11,356 - root - INFO - | Epoch: 041/150 | Train Time: 2.605s | Train Loss: 0.064024 |
2020-05-27 02:53:13,512 - root - INFO - | Epoch: 042/150 | Train Time: 2.155s | Train Loss: 0.065047 |
2020-05-27 02:53:15,817 - root - INFO - | Epoch: 043/150 | Train Time: 2.304s | Train Loss: 0.063148 |
2020-05-27 02:53:18,644 - root - INFO - | Epoch: 044/150 | Train Time: 2.826s | Train Loss: 0.059884 |
2020-05-27 02:53:20,866 - root - INFO - | Epoch: 045/150 | Train Time: 2.222s | Train Loss: 0.063300 |
2020-05-27 02:53:23,167 - root - INFO - | Epoch: 046/150 | Train Time: 2.300s | Train Loss: 0.062569 |
2020-05-27 02:53:25,574 - root - INFO - | Epoch: 047/150 | Train Time: 2.406s | Train Loss: 0.059093 |
2020-05-27 02:53:28,128 - root - INFO - | Epoch: 048/150 | Train Time: 2.553s | Train Loss: 0.058103 |
2020-05-27 02:53:30,396 - root - INFO - | Epoch: 049/150 | Train Time: 2.268s | Train Loss: 0.053900 |
2020-05-27 02:53:32,846 - root - INFO - | Epoch: 050/150 | Train Time: 2.449s | Train Loss: 0.055147 |
2020-05-27 02:53:32,846 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 02:53:35,357 - root - INFO - | Epoch: 051/150 | Train Time: 2.511s | Train Loss: 0.056159 |
2020-05-27 02:53:37,887 - root - INFO - | Epoch: 052/150 | Train Time: 2.529s | Train Loss: 0.053643 |
2020-05-27 02:53:40,925 - root - INFO - | Epoch: 053/150 | Train Time: 3.038s | Train Loss: 0.055254 |
2020-05-27 02:53:43,542 - root - INFO - | Epoch: 054/150 | Train Time: 2.615s | Train Loss: 0.051851 |
2020-05-27 02:53:46,505 - root - INFO - | Epoch: 055/150 | Train Time: 2.963s | Train Loss: 0.053452 |
2020-05-27 02:53:49,245 - root - INFO - | Epoch: 056/150 | Train Time: 2.740s | Train Loss: 0.052105 |
2020-05-27 02:53:51,855 - root - INFO - | Epoch: 057/150 | Train Time: 2.609s | Train Loss: 0.051607 |
2020-05-27 02:53:54,700 - root - INFO - | Epoch: 058/150 | Train Time: 2.844s | Train Loss: 0.053338 |
2020-05-27 02:53:58,036 - root - INFO - | Epoch: 059/150 | Train Time: 3.336s | Train Loss: 0.052588 |
2020-05-27 02:54:00,731 - root - INFO - | Epoch: 060/150 | Train Time: 2.695s | Train Loss: 0.052533 |
2020-05-27 02:54:03,058 - root - INFO - | Epoch: 061/150 | Train Time: 2.327s | Train Loss: 0.052206 |
2020-05-27 02:54:05,799 - root - INFO - | Epoch: 062/150 | Train Time: 2.741s | Train Loss: 0.051844 |
2020-05-27 02:54:08,203 - root - INFO - | Epoch: 063/150 | Train Time: 2.401s | Train Loss: 0.052477 |
2020-05-27 02:54:11,343 - root - INFO - | Epoch: 064/150 | Train Time: 3.139s | Train Loss: 0.054160 |
2020-05-27 02:54:14,127 - root - INFO - | Epoch: 065/150 | Train Time: 2.783s | Train Loss: 0.053812 |
2020-05-27 02:54:17,301 - root - INFO - | Epoch: 066/150 | Train Time: 3.174s | Train Loss: 0.052430 |
2020-05-27 02:54:20,515 - root - INFO - | Epoch: 067/150 | Train Time: 3.213s | Train Loss: 0.052088 |
2020-05-27 02:54:23,671 - root - INFO - | Epoch: 068/150 | Train Time: 3.144s | Train Loss: 0.053375 |
2020-05-27 02:54:26,462 - root - INFO - | Epoch: 069/150 | Train Time: 2.791s | Train Loss: 0.053525 |
2020-05-27 02:54:29,589 - root - INFO - | Epoch: 070/150 | Train Time: 3.126s | Train Loss: 0.052735 |
2020-05-27 02:54:32,329 - root - INFO - | Epoch: 071/150 | Train Time: 2.740s | Train Loss: 0.054172 |
2020-05-27 02:54:35,173 - root - INFO - | Epoch: 072/150 | Train Time: 2.843s | Train Loss: 0.050732 |
2020-05-27 02:54:37,737 - root - INFO - | Epoch: 073/150 | Train Time: 2.563s | Train Loss: 0.051343 |
2020-05-27 02:54:40,074 - root - INFO - | Epoch: 074/150 | Train Time: 2.337s | Train Loss: 0.052395 |
2020-05-27 02:54:43,192 - root - INFO - | Epoch: 075/150 | Train Time: 3.117s | Train Loss: 0.050273 |
2020-05-27 02:54:46,174 - root - INFO - | Epoch: 076/150 | Train Time: 2.982s | Train Loss: 0.052324 |
2020-05-27 02:54:49,255 - root - INFO - | Epoch: 077/150 | Train Time: 3.080s | Train Loss: 0.051069 |
2020-05-27 02:54:51,763 - root - INFO - | Epoch: 078/150 | Train Time: 2.508s | Train Loss: 0.050998 |
2020-05-27 02:54:54,565 - root - INFO - | Epoch: 079/150 | Train Time: 2.801s | Train Loss: 0.052102 |
2020-05-27 02:54:57,231 - root - INFO - | Epoch: 080/150 | Train Time: 2.666s | Train Loss: 0.051828 |
2020-05-27 02:54:59,852 - root - INFO - | Epoch: 081/150 | Train Time: 2.620s | Train Loss: 0.053196 |
2020-05-27 02:55:02,397 - root - INFO - | Epoch: 082/150 | Train Time: 2.545s | Train Loss: 0.050974 |
2020-05-27 02:55:04,506 - root - INFO - | Epoch: 083/150 | Train Time: 2.108s | Train Loss: 0.052830 |
2020-05-27 02:55:06,536 - root - INFO - | Epoch: 084/150 | Train Time: 2.029s | Train Loss: 0.050025 |
2020-05-27 02:55:09,057 - root - INFO - | Epoch: 085/150 | Train Time: 2.521s | Train Loss: 0.050731 |
2020-05-27 02:55:11,034 - root - INFO - | Epoch: 086/150 | Train Time: 1.977s | Train Loss: 0.053286 |
2020-05-27 02:55:12,883 - root - INFO - | Epoch: 087/150 | Train Time: 1.848s | Train Loss: 0.050692 |
2020-05-27 02:55:14,934 - root - INFO - | Epoch: 088/150 | Train Time: 2.050s | Train Loss: 0.050636 |
2020-05-27 02:55:16,936 - root - INFO - | Epoch: 089/150 | Train Time: 2.001s | Train Loss: 0.050113 |
2020-05-27 02:55:18,785 - root - INFO - | Epoch: 090/150 | Train Time: 1.849s | Train Loss: 0.050635 |
2020-05-27 02:55:20,860 - root - INFO - | Epoch: 091/150 | Train Time: 2.074s | Train Loss: 0.049967 |
2020-05-27 02:55:23,905 - root - INFO - | Epoch: 092/150 | Train Time: 3.045s | Train Loss: 0.053991 |
2020-05-27 02:55:27,198 - root - INFO - | Epoch: 093/150 | Train Time: 3.292s | Train Loss: 0.049238 |
2020-05-27 02:55:29,995 - root - INFO - | Epoch: 094/150 | Train Time: 2.795s | Train Loss: 0.051553 |
2020-05-27 02:55:32,386 - root - INFO - | Epoch: 095/150 | Train Time: 2.391s | Train Loss: 0.049953 |
2020-05-27 02:55:35,818 - root - INFO - | Epoch: 096/150 | Train Time: 3.431s | Train Loss: 0.048736 |
2020-05-27 02:55:38,884 - root - INFO - | Epoch: 097/150 | Train Time: 3.066s | Train Loss: 0.049936 |
2020-05-27 02:55:41,970 - root - INFO - | Epoch: 098/150 | Train Time: 3.086s | Train Loss: 0.047292 |
2020-05-27 02:55:44,649 - root - INFO - | Epoch: 099/150 | Train Time: 2.679s | Train Loss: 0.049144 |
2020-05-27 02:55:47,541 - root - INFO - | Epoch: 100/150 | Train Time: 2.891s | Train Loss: 0.048240 |
2020-05-27 02:55:50,340 - root - INFO - | Epoch: 101/150 | Train Time: 2.799s | Train Loss: 0.049613 |
2020-05-27 02:55:53,276 - root - INFO - | Epoch: 102/150 | Train Time: 2.936s | Train Loss: 0.050467 |
2020-05-27 02:55:56,686 - root - INFO - | Epoch: 103/150 | Train Time: 3.410s | Train Loss: 0.048203 |
2020-05-27 02:55:59,775 - root - INFO - | Epoch: 104/150 | Train Time: 3.088s | Train Loss: 0.048902 |
2020-05-27 02:56:02,255 - root - INFO - | Epoch: 105/150 | Train Time: 2.480s | Train Loss: 0.048066 |
2020-05-27 02:56:05,061 - root - INFO - | Epoch: 106/150 | Train Time: 2.805s | Train Loss: 0.050967 |
2020-05-27 02:56:07,769 - root - INFO - | Epoch: 107/150 | Train Time: 2.708s | Train Loss: 0.048496 |
2020-05-27 02:56:10,332 - root - INFO - | Epoch: 108/150 | Train Time: 2.563s | Train Loss: 0.050364 |
2020-05-27 02:56:13,050 - root - INFO - | Epoch: 109/150 | Train Time: 2.718s | Train Loss: 0.049483 |
2020-05-27 02:56:15,237 - root - INFO - | Epoch: 110/150 | Train Time: 2.186s | Train Loss: 0.049281 |
2020-05-27 02:56:18,086 - root - INFO - | Epoch: 111/150 | Train Time: 2.849s | Train Loss: 0.046606 |
2020-05-27 02:56:20,663 - root - INFO - | Epoch: 112/150 | Train Time: 2.576s | Train Loss: 0.047233 |
2020-05-27 02:56:23,001 - root - INFO - | Epoch: 113/150 | Train Time: 2.338s | Train Loss: 0.047587 |
2020-05-27 02:56:25,492 - root - INFO - | Epoch: 114/150 | Train Time: 2.490s | Train Loss: 0.047297 |
2020-05-27 02:56:27,995 - root - INFO - | Epoch: 115/150 | Train Time: 2.498s | Train Loss: 0.045910 |
2020-05-27 02:56:30,309 - root - INFO - | Epoch: 116/150 | Train Time: 2.313s | Train Loss: 0.046542 |
2020-05-27 02:56:33,073 - root - INFO - | Epoch: 117/150 | Train Time: 2.764s | Train Loss: 0.046651 |
2020-05-27 02:56:35,804 - root - INFO - | Epoch: 118/150 | Train Time: 2.730s | Train Loss: 0.048500 |
2020-05-27 02:56:38,882 - root - INFO - | Epoch: 119/150 | Train Time: 3.077s | Train Loss: 0.046311 |
2020-05-27 02:56:41,402 - root - INFO - | Epoch: 120/150 | Train Time: 2.520s | Train Loss: 0.047534 |
2020-05-27 02:56:44,274 - root - INFO - | Epoch: 121/150 | Train Time: 2.871s | Train Loss: 0.046866 |
2020-05-27 02:56:46,856 - root - INFO - | Epoch: 122/150 | Train Time: 2.581s | Train Loss: 0.045141 |
2020-05-27 02:56:49,680 - root - INFO - | Epoch: 123/150 | Train Time: 2.824s | Train Loss: 0.048883 |
2020-05-27 02:56:52,507 - root - INFO - | Epoch: 124/150 | Train Time: 2.826s | Train Loss: 0.046744 |
2020-05-27 02:56:55,600 - root - INFO - | Epoch: 125/150 | Train Time: 3.093s | Train Loss: 0.046084 |
2020-05-27 02:56:58,729 - root - INFO - | Epoch: 126/150 | Train Time: 3.128s | Train Loss: 0.047720 |
2020-05-27 02:57:01,579 - root - INFO - | Epoch: 127/150 | Train Time: 2.850s | Train Loss: 0.043496 |
2020-05-27 02:57:04,380 - root - INFO - | Epoch: 128/150 | Train Time: 2.800s | Train Loss: 0.043950 |
2020-05-27 02:57:06,571 - root - INFO - | Epoch: 129/150 | Train Time: 2.190s | Train Loss: 0.045644 |
2020-05-27 02:57:09,087 - root - INFO - | Epoch: 130/150 | Train Time: 2.516s | Train Loss: 0.045006 |
2020-05-27 02:57:11,731 - root - INFO - | Epoch: 131/150 | Train Time: 2.644s | Train Loss: 0.048330 |
2020-05-27 02:57:14,881 - root - INFO - | Epoch: 132/150 | Train Time: 3.149s | Train Loss: 0.047672 |
2020-05-27 02:57:17,110 - root - INFO - | Epoch: 133/150 | Train Time: 2.229s | Train Loss: 0.044491 |
2020-05-27 02:57:20,081 - root - INFO - | Epoch: 134/150 | Train Time: 2.970s | Train Loss: 0.046175 |
2020-05-27 02:57:22,790 - root - INFO - | Epoch: 135/150 | Train Time: 2.709s | Train Loss: 0.045105 |
2020-05-27 02:57:25,537 - root - INFO - | Epoch: 136/150 | Train Time: 2.746s | Train Loss: 0.045528 |
2020-05-27 02:57:28,592 - root - INFO - | Epoch: 137/150 | Train Time: 3.054s | Train Loss: 0.043950 |
2020-05-27 02:57:31,670 - root - INFO - | Epoch: 138/150 | Train Time: 3.078s | Train Loss: 0.043646 |
2020-05-27 02:57:34,662 - root - INFO - | Epoch: 139/150 | Train Time: 2.991s | Train Loss: 0.046799 |
2020-05-27 02:57:38,061 - root - INFO - | Epoch: 140/150 | Train Time: 3.399s | Train Loss: 0.044490 |
2020-05-27 02:57:41,419 - root - INFO - | Epoch: 141/150 | Train Time: 3.357s | Train Loss: 0.044279 |
2020-05-27 02:57:44,276 - root - INFO - | Epoch: 142/150 | Train Time: 2.856s | Train Loss: 0.042239 |
2020-05-27 02:57:47,750 - root - INFO - | Epoch: 143/150 | Train Time: 3.473s | Train Loss: 0.043170 |
2020-05-27 02:57:50,342 - root - INFO - | Epoch: 144/150 | Train Time: 2.592s | Train Loss: 0.045240 |
2020-05-27 02:57:53,296 - root - INFO - | Epoch: 145/150 | Train Time: 2.953s | Train Loss: 0.043345 |
2020-05-27 02:57:56,215 - root - INFO - | Epoch: 146/150 | Train Time: 2.918s | Train Loss: 0.042789 |
2020-05-27 02:57:59,726 - root - INFO - | Epoch: 147/150 | Train Time: 3.510s | Train Loss: 0.042521 |
2020-05-27 02:58:02,851 - root - INFO - | Epoch: 148/150 | Train Time: 3.125s | Train Loss: 0.041774 |
2020-05-27 02:58:06,218 - root - INFO - | Epoch: 149/150 | Train Time: 3.366s | Train Loss: 0.042973 |
2020-05-27 02:58:09,425 - root - INFO - | Epoch: 150/150 | Train Time: 3.207s | Train Loss: 0.043181 |
2020-05-27 02:58:09,426 - root - INFO - Training Time: 408.161s
2020-05-27 02:58:09,426 - root - INFO - Finished training.
2020-05-27 02:58:09,427 - root - INFO - Starting testing...
2020-05-27 02:58:12,111 - root - INFO - Test Loss: 3.576469
2020-05-27 02:58:12,111 - root - INFO - Test AUC: 97.14%
2020-05-27 02:58:12,111 - root - INFO - Test Time: 2.662s
2020-05-27 02:58:12,111 - root - INFO - Finished testing.
