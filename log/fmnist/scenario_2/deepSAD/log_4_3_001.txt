2020-05-27 07:15:32,395 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_4_3_001.txt
2020-05-27 07:15:32,395 - root - INFO - Data path is ../data
2020-05-27 07:15:32,395 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 07:15:32,395 - root - INFO - Dataset: fmnist
2020-05-27 07:15:32,395 - root - INFO - Normal class: 4
2020-05-27 07:15:32,395 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 07:15:32,396 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 07:15:32,396 - root - INFO - Pollution ratio of unlabeled train data: 0.01
2020-05-27 07:15:32,396 - root - INFO - Scenario Running: 2
2020-05-27 07:15:32,396 - root - INFO - Train only the network: True
2020-05-27 07:15:32,396 - root - INFO - Output and AE dimensions: 128
2020-05-27 07:15:32,396 - root - INFO - Known anomaly class: 3
2020-05-27 07:15:32,396 - root - INFO - Network: fmnist_LeNet
2020-05-27 07:15:32,396 - root - INFO - Eta-parameter: 1.00
2020-05-27 07:15:32,404 - root - INFO - Set seed to 0.
2020-05-27 07:15:32,466 - root - INFO - Computation device: cuda
2020-05-27 07:15:32,466 - root - INFO - Number of threads: 0
2020-05-27 07:15:32,467 - root - INFO - Number of dataloader workers: 6
2020-05-27 07:15:41,371 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 07:15:41,379 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 07:15:41,379 - root - INFO - Pretraining: True
2020-05-27 07:15:41,379 - root - INFO - Training optimizer: adam
2020-05-27 07:15:41,380 - root - INFO - Training learning rate: 0.0001
2020-05-27 07:15:41,380 - root - INFO - Training epochs: 150
2020-05-27 07:15:41,380 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 07:15:41,380 - root - INFO - Training batch size: 200
2020-05-27 07:15:41,380 - root - INFO - Training weight decay: 5e-07
2020-05-27 07:15:41,450 - root - INFO - Starting training...
2020-05-27 07:15:49,116 - root - INFO - | Epoch: 001/150 | Train Time: 7.665s | Train Loss: 2.309559 |
2020-05-27 07:15:51,745 - root - INFO - | Epoch: 002/150 | Train Time: 2.620s | Train Loss: 0.547452 |
2020-05-27 07:15:54,446 - root - INFO - | Epoch: 003/150 | Train Time: 2.700s | Train Loss: 0.369170 |
2020-05-27 07:15:56,909 - root - INFO - | Epoch: 004/150 | Train Time: 2.462s | Train Loss: 0.294574 |
2020-05-27 07:15:59,561 - root - INFO - | Epoch: 005/150 | Train Time: 2.652s | Train Loss: 0.253276 |
2020-05-27 07:16:02,164 - root - INFO - | Epoch: 006/150 | Train Time: 2.603s | Train Loss: 0.221121 |
2020-05-27 07:16:04,424 - root - INFO - | Epoch: 007/150 | Train Time: 2.259s | Train Loss: 0.197245 |
2020-05-27 07:16:06,774 - root - INFO - | Epoch: 008/150 | Train Time: 2.349s | Train Loss: 0.184118 |
2020-05-27 07:16:09,236 - root - INFO - | Epoch: 009/150 | Train Time: 2.461s | Train Loss: 0.171760 |
2020-05-27 07:16:11,708 - root - INFO - | Epoch: 010/150 | Train Time: 2.471s | Train Loss: 0.160215 |
2020-05-27 07:16:14,327 - root - INFO - | Epoch: 011/150 | Train Time: 2.619s | Train Loss: 0.155496 |
2020-05-27 07:16:16,949 - root - INFO - | Epoch: 012/150 | Train Time: 2.622s | Train Loss: 0.143821 |
2020-05-27 07:16:19,546 - root - INFO - | Epoch: 013/150 | Train Time: 2.596s | Train Loss: 0.138382 |
2020-05-27 07:16:22,733 - root - INFO - | Epoch: 014/150 | Train Time: 3.187s | Train Loss: 0.131444 |
2020-05-27 07:16:25,417 - root - INFO - | Epoch: 015/150 | Train Time: 2.684s | Train Loss: 0.126323 |
2020-05-27 07:16:27,582 - root - INFO - | Epoch: 016/150 | Train Time: 2.164s | Train Loss: 0.124382 |
2020-05-27 07:16:30,166 - root - INFO - | Epoch: 017/150 | Train Time: 2.584s | Train Loss: 0.118114 |
2020-05-27 07:16:32,738 - root - INFO - | Epoch: 018/150 | Train Time: 2.571s | Train Loss: 0.120199 |
2020-05-27 07:16:34,795 - root - INFO - | Epoch: 019/150 | Train Time: 2.057s | Train Loss: 0.113582 |
2020-05-27 07:16:37,280 - root - INFO - | Epoch: 020/150 | Train Time: 2.484s | Train Loss: 0.109582 |
2020-05-27 07:16:39,808 - root - INFO - | Epoch: 021/150 | Train Time: 2.527s | Train Loss: 0.107825 |
2020-05-27 07:16:42,078 - root - INFO - | Epoch: 022/150 | Train Time: 2.269s | Train Loss: 0.102607 |
2020-05-27 07:16:44,386 - root - INFO - | Epoch: 023/150 | Train Time: 2.308s | Train Loss: 0.102857 |
2020-05-27 07:16:46,627 - root - INFO - | Epoch: 024/150 | Train Time: 2.241s | Train Loss: 0.099224 |
2020-05-27 07:16:48,784 - root - INFO - | Epoch: 025/150 | Train Time: 2.157s | Train Loss: 0.097942 |
2020-05-27 07:16:50,966 - root - INFO - | Epoch: 026/150 | Train Time: 2.181s | Train Loss: 0.091345 |
2020-05-27 07:16:52,915 - root - INFO - | Epoch: 027/150 | Train Time: 1.949s | Train Loss: 0.092010 |
2020-05-27 07:16:55,227 - root - INFO - | Epoch: 028/150 | Train Time: 2.312s | Train Loss: 0.091081 |
2020-05-27 07:16:57,542 - root - INFO - | Epoch: 029/150 | Train Time: 2.313s | Train Loss: 0.086786 |
2020-05-27 07:17:00,103 - root - INFO - | Epoch: 030/150 | Train Time: 2.561s | Train Loss: 0.084957 |
2020-05-27 07:17:02,121 - root - INFO - | Epoch: 031/150 | Train Time: 2.018s | Train Loss: 0.086688 |
2020-05-27 07:17:04,384 - root - INFO - | Epoch: 032/150 | Train Time: 2.262s | Train Loss: 0.087656 |
2020-05-27 07:17:06,942 - root - INFO - | Epoch: 033/150 | Train Time: 2.557s | Train Loss: 0.083001 |
2020-05-27 07:17:09,199 - root - INFO - | Epoch: 034/150 | Train Time: 2.256s | Train Loss: 0.078838 |
2020-05-27 07:17:11,468 - root - INFO - | Epoch: 035/150 | Train Time: 2.269s | Train Loss: 0.079601 |
2020-05-27 07:17:13,782 - root - INFO - | Epoch: 036/150 | Train Time: 2.313s | Train Loss: 0.078664 |
2020-05-27 07:17:15,716 - root - INFO - | Epoch: 037/150 | Train Time: 1.933s | Train Loss: 0.077891 |
2020-05-27 07:17:17,853 - root - INFO - | Epoch: 038/150 | Train Time: 2.136s | Train Loss: 0.074873 |
2020-05-27 07:17:19,865 - root - INFO - | Epoch: 039/150 | Train Time: 2.012s | Train Loss: 0.070301 |
2020-05-27 07:17:22,218 - root - INFO - | Epoch: 040/150 | Train Time: 2.352s | Train Loss: 0.074160 |
2020-05-27 07:17:24,522 - root - INFO - | Epoch: 041/150 | Train Time: 2.303s | Train Loss: 0.071162 |
2020-05-27 07:17:26,989 - root - INFO - | Epoch: 042/150 | Train Time: 2.466s | Train Loss: 0.070778 |
2020-05-27 07:17:29,559 - root - INFO - | Epoch: 043/150 | Train Time: 2.569s | Train Loss: 0.071546 |
2020-05-27 07:17:32,222 - root - INFO - | Epoch: 044/150 | Train Time: 2.663s | Train Loss: 0.068082 |
2020-05-27 07:17:34,503 - root - INFO - | Epoch: 045/150 | Train Time: 2.280s | Train Loss: 0.067033 |
2020-05-27 07:17:36,682 - root - INFO - | Epoch: 046/150 | Train Time: 2.178s | Train Loss: 0.064840 |
2020-05-27 07:17:38,911 - root - INFO - | Epoch: 047/150 | Train Time: 2.229s | Train Loss: 0.065352 |
2020-05-27 07:17:41,100 - root - INFO - | Epoch: 048/150 | Train Time: 2.189s | Train Loss: 0.062752 |
2020-05-27 07:17:43,160 - root - INFO - | Epoch: 049/150 | Train Time: 2.059s | Train Loss: 0.061749 |
2020-05-27 07:17:45,539 - root - INFO - | Epoch: 050/150 | Train Time: 2.378s | Train Loss: 0.059209 |
2020-05-27 07:17:45,539 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 07:17:47,881 - root - INFO - | Epoch: 051/150 | Train Time: 2.341s | Train Loss: 0.059731 |
2020-05-27 07:17:50,409 - root - INFO - | Epoch: 052/150 | Train Time: 2.528s | Train Loss: 0.061420 |
2020-05-27 07:17:52,710 - root - INFO - | Epoch: 053/150 | Train Time: 2.301s | Train Loss: 0.058623 |
2020-05-27 07:17:55,020 - root - INFO - | Epoch: 054/150 | Train Time: 2.309s | Train Loss: 0.059011 |
2020-05-27 07:17:57,275 - root - INFO - | Epoch: 055/150 | Train Time: 2.254s | Train Loss: 0.058791 |
2020-05-27 07:17:59,750 - root - INFO - | Epoch: 056/150 | Train Time: 2.474s | Train Loss: 0.058260 |
2020-05-27 07:18:02,118 - root - INFO - | Epoch: 057/150 | Train Time: 2.368s | Train Loss: 0.059269 |
2020-05-27 07:18:05,012 - root - INFO - | Epoch: 058/150 | Train Time: 2.893s | Train Loss: 0.058988 |
2020-05-27 07:18:07,081 - root - INFO - | Epoch: 059/150 | Train Time: 2.069s | Train Loss: 0.058834 |
2020-05-27 07:18:09,872 - root - INFO - | Epoch: 060/150 | Train Time: 2.790s | Train Loss: 0.058226 |
2020-05-27 07:18:12,889 - root - INFO - | Epoch: 061/150 | Train Time: 3.017s | Train Loss: 0.055634 |
2020-05-27 07:18:15,311 - root - INFO - | Epoch: 062/150 | Train Time: 2.422s | Train Loss: 0.058410 |
2020-05-27 07:18:17,379 - root - INFO - | Epoch: 063/150 | Train Time: 2.067s | Train Loss: 0.056803 |
2020-05-27 07:18:19,842 - root - INFO - | Epoch: 064/150 | Train Time: 2.463s | Train Loss: 0.059622 |
2020-05-27 07:18:21,977 - root - INFO - | Epoch: 065/150 | Train Time: 2.135s | Train Loss: 0.058839 |
2020-05-27 07:18:23,950 - root - INFO - | Epoch: 066/150 | Train Time: 1.972s | Train Loss: 0.056396 |
2020-05-27 07:18:26,336 - root - INFO - | Epoch: 067/150 | Train Time: 2.385s | Train Loss: 0.056532 |
2020-05-27 07:18:28,514 - root - INFO - | Epoch: 068/150 | Train Time: 2.178s | Train Loss: 0.058107 |
2020-05-27 07:18:30,745 - root - INFO - | Epoch: 069/150 | Train Time: 2.231s | Train Loss: 0.057792 |
2020-05-27 07:18:33,173 - root - INFO - | Epoch: 070/150 | Train Time: 2.428s | Train Loss: 0.058868 |
2020-05-27 07:18:35,448 - root - INFO - | Epoch: 071/150 | Train Time: 2.274s | Train Loss: 0.056297 |
2020-05-27 07:18:37,569 - root - INFO - | Epoch: 072/150 | Train Time: 2.121s | Train Loss: 0.058513 |
2020-05-27 07:18:39,645 - root - INFO - | Epoch: 073/150 | Train Time: 2.076s | Train Loss: 0.056844 |
2020-05-27 07:18:41,361 - root - INFO - | Epoch: 074/150 | Train Time: 1.711s | Train Loss: 0.058449 |
2020-05-27 07:18:42,931 - root - INFO - | Epoch: 075/150 | Train Time: 1.569s | Train Loss: 0.057150 |
2020-05-27 07:18:45,265 - root - INFO - | Epoch: 076/150 | Train Time: 2.333s | Train Loss: 0.058095 |
2020-05-27 07:18:47,652 - root - INFO - | Epoch: 077/150 | Train Time: 2.386s | Train Loss: 0.056058 |
2020-05-27 07:18:49,817 - root - INFO - | Epoch: 078/150 | Train Time: 2.165s | Train Loss: 0.057633 |
2020-05-27 07:18:51,864 - root - INFO - | Epoch: 079/150 | Train Time: 2.047s | Train Loss: 0.056695 |
2020-05-27 07:18:54,301 - root - INFO - | Epoch: 080/150 | Train Time: 2.436s | Train Loss: 0.057028 |
2020-05-27 07:18:56,208 - root - INFO - | Epoch: 081/150 | Train Time: 1.907s | Train Loss: 0.054806 |
2020-05-27 07:18:58,530 - root - INFO - | Epoch: 082/150 | Train Time: 2.321s | Train Loss: 0.056056 |
2020-05-27 07:19:01,169 - root - INFO - | Epoch: 083/150 | Train Time: 2.638s | Train Loss: 0.055679 |
2020-05-27 07:19:03,451 - root - INFO - | Epoch: 084/150 | Train Time: 2.281s | Train Loss: 0.054272 |
2020-05-27 07:19:05,529 - root - INFO - | Epoch: 085/150 | Train Time: 2.078s | Train Loss: 0.055149 |
2020-05-27 07:19:07,739 - root - INFO - | Epoch: 086/150 | Train Time: 2.209s | Train Loss: 0.054001 |
2020-05-27 07:19:09,951 - root - INFO - | Epoch: 087/150 | Train Time: 2.212s | Train Loss: 0.055764 |
2020-05-27 07:19:11,821 - root - INFO - | Epoch: 088/150 | Train Time: 1.869s | Train Loss: 0.056571 |
2020-05-27 07:19:13,908 - root - INFO - | Epoch: 089/150 | Train Time: 2.086s | Train Loss: 0.053854 |
2020-05-27 07:19:16,574 - root - INFO - | Epoch: 090/150 | Train Time: 2.666s | Train Loss: 0.053973 |
2020-05-27 07:19:19,149 - root - INFO - | Epoch: 091/150 | Train Time: 2.574s | Train Loss: 0.054148 |
2020-05-27 07:19:21,725 - root - INFO - | Epoch: 092/150 | Train Time: 2.576s | Train Loss: 0.055015 |
2020-05-27 07:19:24,185 - root - INFO - | Epoch: 093/150 | Train Time: 2.459s | Train Loss: 0.053248 |
2020-05-27 07:19:26,815 - root - INFO - | Epoch: 094/150 | Train Time: 2.629s | Train Loss: 0.054310 |
2020-05-27 07:19:28,986 - root - INFO - | Epoch: 095/150 | Train Time: 2.171s | Train Loss: 0.055723 |
2020-05-27 07:19:31,071 - root - INFO - | Epoch: 096/150 | Train Time: 2.084s | Train Loss: 0.055032 |
2020-05-27 07:19:33,341 - root - INFO - | Epoch: 097/150 | Train Time: 2.270s | Train Loss: 0.054191 |
2020-05-27 07:19:35,972 - root - INFO - | Epoch: 098/150 | Train Time: 2.630s | Train Loss: 0.054491 |
2020-05-27 07:19:38,308 - root - INFO - | Epoch: 099/150 | Train Time: 2.335s | Train Loss: 0.052183 |
2020-05-27 07:19:40,916 - root - INFO - | Epoch: 100/150 | Train Time: 2.607s | Train Loss: 0.053867 |
2020-05-27 07:19:43,131 - root - INFO - | Epoch: 101/150 | Train Time: 2.215s | Train Loss: 0.053606 |
2020-05-27 07:19:45,626 - root - INFO - | Epoch: 102/150 | Train Time: 2.494s | Train Loss: 0.052249 |
2020-05-27 07:19:48,042 - root - INFO - | Epoch: 103/150 | Train Time: 2.415s | Train Loss: 0.052768 |
2020-05-27 07:19:50,808 - root - INFO - | Epoch: 104/150 | Train Time: 2.766s | Train Loss: 0.052755 |
2020-05-27 07:19:53,324 - root - INFO - | Epoch: 105/150 | Train Time: 2.515s | Train Loss: 0.054310 |
2020-05-27 07:19:56,135 - root - INFO - | Epoch: 106/150 | Train Time: 2.811s | Train Loss: 0.051237 |
2020-05-27 07:19:58,712 - root - INFO - | Epoch: 107/150 | Train Time: 2.577s | Train Loss: 0.051747 |
2020-05-27 07:20:01,346 - root - INFO - | Epoch: 108/150 | Train Time: 2.633s | Train Loss: 0.052986 |
2020-05-27 07:20:03,735 - root - INFO - | Epoch: 109/150 | Train Time: 2.388s | Train Loss: 0.054165 |
2020-05-27 07:20:06,388 - root - INFO - | Epoch: 110/150 | Train Time: 2.653s | Train Loss: 0.053233 |
2020-05-27 07:20:08,885 - root - INFO - | Epoch: 111/150 | Train Time: 2.497s | Train Loss: 0.053451 |
2020-05-27 07:20:11,193 - root - INFO - | Epoch: 112/150 | Train Time: 2.307s | Train Loss: 0.052196 |
2020-05-27 07:20:13,217 - root - INFO - | Epoch: 113/150 | Train Time: 2.024s | Train Loss: 0.053500 |
2020-05-27 07:20:15,589 - root - INFO - | Epoch: 114/150 | Train Time: 2.371s | Train Loss: 0.051214 |
2020-05-27 07:20:17,799 - root - INFO - | Epoch: 115/150 | Train Time: 2.210s | Train Loss: 0.053531 |
2020-05-27 07:20:20,321 - root - INFO - | Epoch: 116/150 | Train Time: 2.522s | Train Loss: 0.053407 |
2020-05-27 07:20:22,475 - root - INFO - | Epoch: 117/150 | Train Time: 2.153s | Train Loss: 0.054182 |
2020-05-27 07:20:24,676 - root - INFO - | Epoch: 118/150 | Train Time: 2.201s | Train Loss: 0.052789 |
2020-05-27 07:20:27,167 - root - INFO - | Epoch: 119/150 | Train Time: 2.490s | Train Loss: 0.051156 |
2020-05-27 07:20:29,760 - root - INFO - | Epoch: 120/150 | Train Time: 2.593s | Train Loss: 0.051745 |
2020-05-27 07:20:31,751 - root - INFO - | Epoch: 121/150 | Train Time: 1.990s | Train Loss: 0.052503 |
2020-05-27 07:20:34,466 - root - INFO - | Epoch: 122/150 | Train Time: 2.714s | Train Loss: 0.050585 |
2020-05-27 07:20:37,173 - root - INFO - | Epoch: 123/150 | Train Time: 2.707s | Train Loss: 0.051422 |
2020-05-27 07:20:39,528 - root - INFO - | Epoch: 124/150 | Train Time: 2.355s | Train Loss: 0.049809 |
2020-05-27 07:20:41,608 - root - INFO - | Epoch: 125/150 | Train Time: 2.079s | Train Loss: 0.050480 |
2020-05-27 07:20:43,800 - root - INFO - | Epoch: 126/150 | Train Time: 2.192s | Train Loss: 0.050369 |
2020-05-27 07:20:45,874 - root - INFO - | Epoch: 127/150 | Train Time: 2.073s | Train Loss: 0.049401 |
2020-05-27 07:20:47,739 - root - INFO - | Epoch: 128/150 | Train Time: 1.864s | Train Loss: 0.051393 |
2020-05-27 07:20:49,901 - root - INFO - | Epoch: 129/150 | Train Time: 2.162s | Train Loss: 0.050083 |
2020-05-27 07:20:51,824 - root - INFO - | Epoch: 130/150 | Train Time: 1.921s | Train Loss: 0.050280 |
2020-05-27 07:20:53,575 - root - INFO - | Epoch: 131/150 | Train Time: 1.751s | Train Loss: 0.050632 |
2020-05-27 07:20:56,190 - root - INFO - | Epoch: 132/150 | Train Time: 2.615s | Train Loss: 0.049885 |
2020-05-27 07:20:58,171 - root - INFO - | Epoch: 133/150 | Train Time: 1.980s | Train Loss: 0.049100 |
2020-05-27 07:21:00,247 - root - INFO - | Epoch: 134/150 | Train Time: 2.076s | Train Loss: 0.049110 |
2020-05-27 07:21:02,186 - root - INFO - | Epoch: 135/150 | Train Time: 1.939s | Train Loss: 0.049620 |
2020-05-27 07:21:04,269 - root - INFO - | Epoch: 136/150 | Train Time: 2.082s | Train Loss: 0.047581 |
2020-05-27 07:21:07,074 - root - INFO - | Epoch: 137/150 | Train Time: 2.805s | Train Loss: 0.049297 |
2020-05-27 07:21:09,789 - root - INFO - | Epoch: 138/150 | Train Time: 2.715s | Train Loss: 0.049990 |
2020-05-27 07:21:12,665 - root - INFO - | Epoch: 139/150 | Train Time: 2.875s | Train Loss: 0.047871 |
2020-05-27 07:21:15,003 - root - INFO - | Epoch: 140/150 | Train Time: 2.338s | Train Loss: 0.047901 |
2020-05-27 07:21:17,121 - root - INFO - | Epoch: 141/150 | Train Time: 2.118s | Train Loss: 0.048697 |
2020-05-27 07:21:19,427 - root - INFO - | Epoch: 142/150 | Train Time: 2.305s | Train Loss: 0.048538 |
2020-05-27 07:21:22,011 - root - INFO - | Epoch: 143/150 | Train Time: 2.584s | Train Loss: 0.048241 |
2020-05-27 07:21:24,286 - root - INFO - | Epoch: 144/150 | Train Time: 2.274s | Train Loss: 0.048917 |
2020-05-27 07:21:26,279 - root - INFO - | Epoch: 145/150 | Train Time: 1.993s | Train Loss: 0.047514 |
2020-05-27 07:21:28,525 - root - INFO - | Epoch: 146/150 | Train Time: 2.246s | Train Loss: 0.048390 |
2020-05-27 07:21:31,064 - root - INFO - | Epoch: 147/150 | Train Time: 2.538s | Train Loss: 0.048137 |
2020-05-27 07:21:33,226 - root - INFO - | Epoch: 148/150 | Train Time: 2.162s | Train Loss: 0.049492 |
2020-05-27 07:21:35,797 - root - INFO - | Epoch: 149/150 | Train Time: 2.570s | Train Loss: 0.046962 |
2020-05-27 07:21:38,020 - root - INFO - | Epoch: 150/150 | Train Time: 2.223s | Train Loss: 0.047087 |
2020-05-27 07:21:38,021 - root - INFO - Training Time: 356.571s
2020-05-27 07:21:38,021 - root - INFO - Finished training.
2020-05-27 07:21:38,022 - root - INFO - Starting testing...
2020-05-27 07:21:41,015 - root - INFO - Test Loss: 0.655432
2020-05-27 07:21:41,016 - root - INFO - Test AUC: 89.00%
2020-05-27 07:21:41,016 - root - INFO - Test Time: 2.979s
2020-05-27 07:21:41,016 - root - INFO - Finished testing.
