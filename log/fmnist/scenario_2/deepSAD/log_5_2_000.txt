2020-05-27 14:13:13,171 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_5_2_000.txt
2020-05-27 14:13:13,171 - root - INFO - Data path is ../data
2020-05-27 14:13:13,171 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 14:13:13,171 - root - INFO - Dataset: fmnist
2020-05-27 14:13:13,171 - root - INFO - Normal class: 5
2020-05-27 14:13:13,172 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 14:13:13,172 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 14:13:13,172 - root - INFO - Pollution ratio of unlabeled train data: 0.00
2020-05-27 14:13:13,172 - root - INFO - Scenario Running: 2
2020-05-27 14:13:13,172 - root - INFO - Train only the network: True
2020-05-27 14:13:13,172 - root - INFO - Output and AE dimensions: 128
2020-05-27 14:13:13,172 - root - INFO - Known anomaly class: 2
2020-05-27 14:13:13,172 - root - INFO - Network: fmnist_LeNet
2020-05-27 14:13:13,172 - root - INFO - Eta-parameter: 1.00
2020-05-27 14:13:13,191 - root - INFO - Set seed to 0.
2020-05-27 14:13:13,213 - root - INFO - Computation device: cuda
2020-05-27 14:13:13,214 - root - INFO - Number of threads: 0
2020-05-27 14:13:13,214 - root - INFO - Number of dataloader workers: 6
2020-05-27 14:13:21,731 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 14:13:21,741 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 14:13:21,741 - root - INFO - Pretraining: True
2020-05-27 14:13:21,741 - root - INFO - Training optimizer: adam
2020-05-27 14:13:21,741 - root - INFO - Training learning rate: 0.0001
2020-05-27 14:13:21,741 - root - INFO - Training epochs: 150
2020-05-27 14:13:21,741 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 14:13:21,741 - root - INFO - Training batch size: 200
2020-05-27 14:13:21,741 - root - INFO - Training weight decay: 5e-07
2020-05-27 14:13:21,743 - root - INFO - Starting training...
2020-05-27 14:13:28,702 - root - INFO - | Epoch: 001/150 | Train Time: 6.958s | Train Loss: 2.624439 |
2020-05-27 14:13:31,182 - root - INFO - | Epoch: 002/150 | Train Time: 2.480s | Train Loss: 0.607101 |
2020-05-27 14:13:33,706 - root - INFO - | Epoch: 003/150 | Train Time: 2.524s | Train Loss: 0.381771 |
2020-05-27 14:13:36,429 - root - INFO - | Epoch: 004/150 | Train Time: 2.722s | Train Loss: 0.289739 |
2020-05-27 14:13:38,810 - root - INFO - | Epoch: 005/150 | Train Time: 2.381s | Train Loss: 0.223029 |
2020-05-27 14:13:41,202 - root - INFO - | Epoch: 006/150 | Train Time: 2.392s | Train Loss: 0.184019 |
2020-05-27 14:13:43,990 - root - INFO - | Epoch: 007/150 | Train Time: 2.787s | Train Loss: 0.153194 |
2020-05-27 14:13:46,609 - root - INFO - | Epoch: 008/150 | Train Time: 2.618s | Train Loss: 0.135239 |
2020-05-27 14:13:49,246 - root - INFO - | Epoch: 009/150 | Train Time: 2.636s | Train Loss: 0.123177 |
2020-05-27 14:13:51,863 - root - INFO - | Epoch: 010/150 | Train Time: 2.616s | Train Loss: 0.105494 |
2020-05-27 14:13:54,256 - root - INFO - | Epoch: 011/150 | Train Time: 2.393s | Train Loss: 0.113270 |
2020-05-27 14:13:56,473 - root - INFO - | Epoch: 012/150 | Train Time: 2.215s | Train Loss: 0.086896 |
2020-05-27 14:13:59,054 - root - INFO - | Epoch: 013/150 | Train Time: 2.581s | Train Loss: 0.082717 |
2020-05-27 14:14:01,786 - root - INFO - | Epoch: 014/150 | Train Time: 2.731s | Train Loss: 0.076920 |
2020-05-27 14:14:04,134 - root - INFO - | Epoch: 015/150 | Train Time: 2.348s | Train Loss: 0.069741 |
2020-05-27 14:14:06,687 - root - INFO - | Epoch: 016/150 | Train Time: 2.552s | Train Loss: 0.069717 |
2020-05-27 14:14:08,737 - root - INFO - | Epoch: 017/150 | Train Time: 2.050s | Train Loss: 0.063741 |
2020-05-27 14:14:10,974 - root - INFO - | Epoch: 018/150 | Train Time: 2.236s | Train Loss: 0.060349 |
2020-05-27 14:14:13,442 - root - INFO - | Epoch: 019/150 | Train Time: 2.468s | Train Loss: 0.058138 |
2020-05-27 14:14:15,940 - root - INFO - | Epoch: 020/150 | Train Time: 2.497s | Train Loss: 0.058980 |
2020-05-27 14:14:18,323 - root - INFO - | Epoch: 021/150 | Train Time: 2.382s | Train Loss: 0.053697 |
2020-05-27 14:14:20,578 - root - INFO - | Epoch: 022/150 | Train Time: 2.254s | Train Loss: 0.047505 |
2020-05-27 14:14:23,391 - root - INFO - | Epoch: 023/150 | Train Time: 2.813s | Train Loss: 0.047234 |
2020-05-27 14:14:26,338 - root - INFO - | Epoch: 024/150 | Train Time: 2.946s | Train Loss: 0.043735 |
2020-05-27 14:14:29,080 - root - INFO - | Epoch: 025/150 | Train Time: 2.742s | Train Loss: 0.043262 |
2020-05-27 14:14:31,581 - root - INFO - | Epoch: 026/150 | Train Time: 2.500s | Train Loss: 0.041105 |
2020-05-27 14:14:34,320 - root - INFO - | Epoch: 027/150 | Train Time: 2.739s | Train Loss: 0.040756 |
2020-05-27 14:14:36,927 - root - INFO - | Epoch: 028/150 | Train Time: 2.607s | Train Loss: 0.039777 |
2020-05-27 14:14:39,904 - root - INFO - | Epoch: 029/150 | Train Time: 2.976s | Train Loss: 0.038411 |
2020-05-27 14:14:43,069 - root - INFO - | Epoch: 030/150 | Train Time: 3.164s | Train Loss: 0.041144 |
2020-05-27 14:14:46,378 - root - INFO - | Epoch: 031/150 | Train Time: 3.309s | Train Loss: 0.034949 |
2020-05-27 14:14:49,270 - root - INFO - | Epoch: 032/150 | Train Time: 2.891s | Train Loss: 0.034353 |
2020-05-27 14:14:51,920 - root - INFO - | Epoch: 033/150 | Train Time: 2.650s | Train Loss: 0.038216 |
2020-05-27 14:14:54,472 - root - INFO - | Epoch: 034/150 | Train Time: 2.552s | Train Loss: 0.035214 |
2020-05-27 14:14:57,189 - root - INFO - | Epoch: 035/150 | Train Time: 2.715s | Train Loss: 0.030789 |
2020-05-27 14:14:59,565 - root - INFO - | Epoch: 036/150 | Train Time: 2.375s | Train Loss: 0.031870 |
2020-05-27 14:15:02,362 - root - INFO - | Epoch: 037/150 | Train Time: 2.797s | Train Loss: 0.030932 |
2020-05-27 14:15:05,213 - root - INFO - | Epoch: 038/150 | Train Time: 2.850s | Train Loss: 0.027048 |
2020-05-27 14:15:08,225 - root - INFO - | Epoch: 039/150 | Train Time: 3.012s | Train Loss: 0.030210 |
2020-05-27 14:15:10,625 - root - INFO - | Epoch: 040/150 | Train Time: 2.399s | Train Loss: 0.036272 |
2020-05-27 14:15:13,305 - root - INFO - | Epoch: 041/150 | Train Time: 2.679s | Train Loss: 0.027265 |
2020-05-27 14:15:16,089 - root - INFO - | Epoch: 042/150 | Train Time: 2.783s | Train Loss: 0.027890 |
2020-05-27 14:15:17,730 - root - INFO - | Epoch: 043/150 | Train Time: 1.641s | Train Loss: 0.023933 |
2020-05-27 14:15:19,548 - root - INFO - | Epoch: 044/150 | Train Time: 1.817s | Train Loss: 0.022958 |
2020-05-27 14:15:21,137 - root - INFO - | Epoch: 045/150 | Train Time: 1.589s | Train Loss: 0.022957 |
2020-05-27 14:15:23,367 - root - INFO - | Epoch: 046/150 | Train Time: 2.229s | Train Loss: 0.025251 |
2020-05-27 14:15:26,034 - root - INFO - | Epoch: 047/150 | Train Time: 2.666s | Train Loss: 0.024145 |
2020-05-27 14:15:28,548 - root - INFO - | Epoch: 048/150 | Train Time: 2.514s | Train Loss: 0.022586 |
2020-05-27 14:15:31,238 - root - INFO - | Epoch: 049/150 | Train Time: 2.689s | Train Loss: 0.021191 |
2020-05-27 14:15:33,741 - root - INFO - | Epoch: 050/150 | Train Time: 2.502s | Train Loss: 0.021672 |
2020-05-27 14:15:33,741 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 14:15:36,294 - root - INFO - | Epoch: 051/150 | Train Time: 2.553s | Train Loss: 0.021206 |
2020-05-27 14:15:39,302 - root - INFO - | Epoch: 052/150 | Train Time: 3.007s | Train Loss: 0.020580 |
2020-05-27 14:15:41,891 - root - INFO - | Epoch: 053/150 | Train Time: 2.588s | Train Loss: 0.019918 |
2020-05-27 14:15:44,531 - root - INFO - | Epoch: 054/150 | Train Time: 2.639s | Train Loss: 0.019493 |
2020-05-27 14:15:46,965 - root - INFO - | Epoch: 055/150 | Train Time: 2.434s | Train Loss: 0.019660 |
2020-05-27 14:15:49,318 - root - INFO - | Epoch: 056/150 | Train Time: 2.353s | Train Loss: 0.022018 |
2020-05-27 14:15:51,780 - root - INFO - | Epoch: 057/150 | Train Time: 2.461s | Train Loss: 0.019433 |
2020-05-27 14:15:53,928 - root - INFO - | Epoch: 058/150 | Train Time: 2.148s | Train Loss: 0.021593 |
2020-05-27 14:15:56,072 - root - INFO - | Epoch: 059/150 | Train Time: 2.143s | Train Loss: 0.019999 |
2020-05-27 14:15:58,768 - root - INFO - | Epoch: 060/150 | Train Time: 2.695s | Train Loss: 0.021104 |
2020-05-27 14:16:01,209 - root - INFO - | Epoch: 061/150 | Train Time: 2.441s | Train Loss: 0.021111 |
2020-05-27 14:16:03,500 - root - INFO - | Epoch: 062/150 | Train Time: 2.290s | Train Loss: 0.020334 |
2020-05-27 14:16:05,994 - root - INFO - | Epoch: 063/150 | Train Time: 2.493s | Train Loss: 0.019295 |
2020-05-27 14:16:08,768 - root - INFO - | Epoch: 064/150 | Train Time: 2.773s | Train Loss: 0.021006 |
2020-05-27 14:16:10,830 - root - INFO - | Epoch: 065/150 | Train Time: 2.060s | Train Loss: 0.021744 |
2020-05-27 14:16:13,089 - root - INFO - | Epoch: 066/150 | Train Time: 2.259s | Train Loss: 0.020050 |
2020-05-27 14:16:15,277 - root - INFO - | Epoch: 067/150 | Train Time: 2.187s | Train Loss: 0.020629 |
2020-05-27 14:16:17,501 - root - INFO - | Epoch: 068/150 | Train Time: 2.223s | Train Loss: 0.020649 |
2020-05-27 14:16:19,666 - root - INFO - | Epoch: 069/150 | Train Time: 2.164s | Train Loss: 0.021640 |
2020-05-27 14:16:21,568 - root - INFO - | Epoch: 070/150 | Train Time: 1.901s | Train Loss: 0.019768 |
2020-05-27 14:16:23,814 - root - INFO - | Epoch: 071/150 | Train Time: 2.246s | Train Loss: 0.021677 |
2020-05-27 14:16:26,210 - root - INFO - | Epoch: 072/150 | Train Time: 2.395s | Train Loss: 0.019309 |
2020-05-27 14:16:28,636 - root - INFO - | Epoch: 073/150 | Train Time: 2.426s | Train Loss: 0.019316 |
2020-05-27 14:16:31,368 - root - INFO - | Epoch: 074/150 | Train Time: 2.732s | Train Loss: 0.019332 |
2020-05-27 14:16:33,920 - root - INFO - | Epoch: 075/150 | Train Time: 2.551s | Train Loss: 0.019769 |
2020-05-27 14:16:36,321 - root - INFO - | Epoch: 076/150 | Train Time: 2.401s | Train Loss: 0.020646 |
2020-05-27 14:16:38,389 - root - INFO - | Epoch: 077/150 | Train Time: 2.068s | Train Loss: 0.019420 |
2020-05-27 14:16:41,146 - root - INFO - | Epoch: 078/150 | Train Time: 2.756s | Train Loss: 0.019866 |
2020-05-27 14:16:44,088 - root - INFO - | Epoch: 079/150 | Train Time: 2.942s | Train Loss: 0.020281 |
2020-05-27 14:16:46,736 - root - INFO - | Epoch: 080/150 | Train Time: 2.648s | Train Loss: 0.020034 |
2020-05-27 14:16:49,642 - root - INFO - | Epoch: 081/150 | Train Time: 2.905s | Train Loss: 0.021368 |
2020-05-27 14:16:52,873 - root - INFO - | Epoch: 082/150 | Train Time: 3.230s | Train Loss: 0.022928 |
2020-05-27 14:16:56,063 - root - INFO - | Epoch: 083/150 | Train Time: 3.189s | Train Loss: 0.019597 |
2020-05-27 14:16:59,588 - root - INFO - | Epoch: 084/150 | Train Time: 3.525s | Train Loss: 0.019922 |
2020-05-27 14:17:02,450 - root - INFO - | Epoch: 085/150 | Train Time: 2.861s | Train Loss: 0.018542 |
2020-05-27 14:17:05,492 - root - INFO - | Epoch: 086/150 | Train Time: 3.042s | Train Loss: 0.018479 |
2020-05-27 14:17:08,452 - root - INFO - | Epoch: 087/150 | Train Time: 2.959s | Train Loss: 0.018272 |
2020-05-27 14:17:11,344 - root - INFO - | Epoch: 088/150 | Train Time: 2.892s | Train Loss: 0.019173 |
2020-05-27 14:17:13,801 - root - INFO - | Epoch: 089/150 | Train Time: 2.457s | Train Loss: 0.018458 |
2020-05-27 14:17:16,805 - root - INFO - | Epoch: 090/150 | Train Time: 3.003s | Train Loss: 0.017883 |
2020-05-27 14:17:19,745 - root - INFO - | Epoch: 091/150 | Train Time: 2.940s | Train Loss: 0.018766 |
2020-05-27 14:17:23,044 - root - INFO - | Epoch: 092/150 | Train Time: 3.298s | Train Loss: 0.022775 |
2020-05-27 14:17:25,392 - root - INFO - | Epoch: 093/150 | Train Time: 2.348s | Train Loss: 0.019670 |
2020-05-27 14:17:28,048 - root - INFO - | Epoch: 094/150 | Train Time: 2.656s | Train Loss: 0.019217 |
2020-05-27 14:17:30,720 - root - INFO - | Epoch: 095/150 | Train Time: 2.671s | Train Loss: 0.019086 |
2020-05-27 14:17:33,049 - root - INFO - | Epoch: 096/150 | Train Time: 2.328s | Train Loss: 0.017613 |
2020-05-27 14:17:35,479 - root - INFO - | Epoch: 097/150 | Train Time: 2.429s | Train Loss: 0.018276 |
2020-05-27 14:17:38,162 - root - INFO - | Epoch: 098/150 | Train Time: 2.683s | Train Loss: 0.017747 |
2020-05-27 14:17:40,385 - root - INFO - | Epoch: 099/150 | Train Time: 2.223s | Train Loss: 0.019424 |
2020-05-27 14:17:43,294 - root - INFO - | Epoch: 100/150 | Train Time: 2.908s | Train Loss: 0.017427 |
2020-05-27 14:17:45,993 - root - INFO - | Epoch: 101/150 | Train Time: 2.698s | Train Loss: 0.018666 |
2020-05-27 14:17:48,609 - root - INFO - | Epoch: 102/150 | Train Time: 2.616s | Train Loss: 0.020511 |
2020-05-27 14:17:50,716 - root - INFO - | Epoch: 103/150 | Train Time: 2.106s | Train Loss: 0.017367 |
2020-05-27 14:17:54,094 - root - INFO - | Epoch: 104/150 | Train Time: 3.377s | Train Loss: 0.020017 |
2020-05-27 14:17:56,615 - root - INFO - | Epoch: 105/150 | Train Time: 2.521s | Train Loss: 0.016420 |
2020-05-27 14:17:59,561 - root - INFO - | Epoch: 106/150 | Train Time: 2.945s | Train Loss: 0.018086 |
2020-05-27 14:18:02,097 - root - INFO - | Epoch: 107/150 | Train Time: 2.536s | Train Loss: 0.018600 |
2020-05-27 14:18:04,598 - root - INFO - | Epoch: 108/150 | Train Time: 2.501s | Train Loss: 0.017677 |
2020-05-27 14:18:07,111 - root - INFO - | Epoch: 109/150 | Train Time: 2.512s | Train Loss: 0.018153 |
2020-05-27 14:18:09,950 - root - INFO - | Epoch: 110/150 | Train Time: 2.839s | Train Loss: 0.016982 |
2020-05-27 14:18:12,095 - root - INFO - | Epoch: 111/150 | Train Time: 2.144s | Train Loss: 0.017040 |
2020-05-27 14:18:14,248 - root - INFO - | Epoch: 112/150 | Train Time: 2.153s | Train Loss: 0.017847 |
2020-05-27 14:18:16,208 - root - INFO - | Epoch: 113/150 | Train Time: 1.960s | Train Loss: 0.017353 |
2020-05-27 14:18:18,974 - root - INFO - | Epoch: 114/150 | Train Time: 2.765s | Train Loss: 0.017471 |
2020-05-27 14:18:21,174 - root - INFO - | Epoch: 115/150 | Train Time: 2.199s | Train Loss: 0.017778 |
2020-05-27 14:18:23,185 - root - INFO - | Epoch: 116/150 | Train Time: 2.011s | Train Loss: 0.016525 |
2020-05-27 14:18:25,313 - root - INFO - | Epoch: 117/150 | Train Time: 2.128s | Train Loss: 0.015814 |
2020-05-27 14:18:27,867 - root - INFO - | Epoch: 118/150 | Train Time: 2.553s | Train Loss: 0.016988 |
2020-05-27 14:18:30,713 - root - INFO - | Epoch: 119/150 | Train Time: 2.846s | Train Loss: 0.017841 |
2020-05-27 14:18:33,498 - root - INFO - | Epoch: 120/150 | Train Time: 2.785s | Train Loss: 0.016986 |
2020-05-27 14:18:36,042 - root - INFO - | Epoch: 121/150 | Train Time: 2.544s | Train Loss: 0.018124 |
2020-05-27 14:18:38,055 - root - INFO - | Epoch: 122/150 | Train Time: 2.012s | Train Loss: 0.016758 |
2020-05-27 14:18:39,798 - root - INFO - | Epoch: 123/150 | Train Time: 1.742s | Train Loss: 0.016083 |
2020-05-27 14:18:41,479 - root - INFO - | Epoch: 124/150 | Train Time: 1.681s | Train Loss: 0.018015 |
2020-05-27 14:18:43,786 - root - INFO - | Epoch: 125/150 | Train Time: 2.306s | Train Loss: 0.016504 |
2020-05-27 14:18:46,245 - root - INFO - | Epoch: 126/150 | Train Time: 2.459s | Train Loss: 0.017058 |
2020-05-27 14:18:48,760 - root - INFO - | Epoch: 127/150 | Train Time: 2.514s | Train Loss: 0.016084 |
2020-05-27 14:18:51,148 - root - INFO - | Epoch: 128/150 | Train Time: 2.388s | Train Loss: 0.015177 |
2020-05-27 14:18:53,175 - root - INFO - | Epoch: 129/150 | Train Time: 2.026s | Train Loss: 0.015777 |
2020-05-27 14:18:55,317 - root - INFO - | Epoch: 130/150 | Train Time: 2.141s | Train Loss: 0.017504 |
2020-05-27 14:18:57,473 - root - INFO - | Epoch: 131/150 | Train Time: 2.156s | Train Loss: 0.016786 |
2020-05-27 14:18:59,632 - root - INFO - | Epoch: 132/150 | Train Time: 2.159s | Train Loss: 0.017875 |
2020-05-27 14:19:02,246 - root - INFO - | Epoch: 133/150 | Train Time: 2.613s | Train Loss: 0.015981 |
2020-05-27 14:19:04,976 - root - INFO - | Epoch: 134/150 | Train Time: 2.729s | Train Loss: 0.017750 |
2020-05-27 14:19:07,795 - root - INFO - | Epoch: 135/150 | Train Time: 2.819s | Train Loss: 0.016189 |
2020-05-27 14:19:10,220 - root - INFO - | Epoch: 136/150 | Train Time: 2.424s | Train Loss: 0.017713 |
2020-05-27 14:19:12,745 - root - INFO - | Epoch: 137/150 | Train Time: 2.525s | Train Loss: 0.016420 |
2020-05-27 14:19:15,528 - root - INFO - | Epoch: 138/150 | Train Time: 2.783s | Train Loss: 0.015833 |
2020-05-27 14:19:18,257 - root - INFO - | Epoch: 139/150 | Train Time: 2.728s | Train Loss: 0.017046 |
2020-05-27 14:19:20,898 - root - INFO - | Epoch: 140/150 | Train Time: 2.640s | Train Loss: 0.014722 |
2020-05-27 14:19:23,346 - root - INFO - | Epoch: 141/150 | Train Time: 2.447s | Train Loss: 0.015752 |
2020-05-27 14:19:25,735 - root - INFO - | Epoch: 142/150 | Train Time: 2.389s | Train Loss: 0.016518 |
2020-05-27 14:19:28,238 - root - INFO - | Epoch: 143/150 | Train Time: 2.502s | Train Loss: 0.015678 |
2020-05-27 14:19:30,683 - root - INFO - | Epoch: 144/150 | Train Time: 2.444s | Train Loss: 0.014673 |
2020-05-27 14:19:33,390 - root - INFO - | Epoch: 145/150 | Train Time: 2.707s | Train Loss: 0.014827 |
2020-05-27 14:19:35,771 - root - INFO - | Epoch: 146/150 | Train Time: 2.380s | Train Loss: 0.016760 |
2020-05-27 14:19:38,543 - root - INFO - | Epoch: 147/150 | Train Time: 2.772s | Train Loss: 0.016019 |
2020-05-27 14:19:41,148 - root - INFO - | Epoch: 148/150 | Train Time: 2.604s | Train Loss: 0.014247 |
2020-05-27 14:19:43,786 - root - INFO - | Epoch: 149/150 | Train Time: 2.638s | Train Loss: 0.014347 |
2020-05-27 14:19:46,633 - root - INFO - | Epoch: 150/150 | Train Time: 2.846s | Train Loss: 0.017250 |
2020-05-27 14:19:46,634 - root - INFO - Training Time: 384.890s
2020-05-27 14:19:46,634 - root - INFO - Finished training.
2020-05-27 14:19:46,635 - root - INFO - Starting testing...
2020-05-27 14:19:49,966 - root - INFO - Test Loss: 15.930616
2020-05-27 14:19:49,966 - root - INFO - Test AUC: 90.31%
2020-05-27 14:19:49,966 - root - INFO - Test Time: 3.316s
2020-05-27 14:19:49,966 - root - INFO - Finished testing.
