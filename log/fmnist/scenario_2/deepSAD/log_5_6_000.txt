2020-05-27 16:04:10,093 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_5_6_000.txt
2020-05-27 16:04:10,093 - root - INFO - Data path is ../data
2020-05-27 16:04:10,093 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 16:04:10,093 - root - INFO - Dataset: fmnist
2020-05-27 16:04:10,094 - root - INFO - Normal class: 5
2020-05-27 16:04:10,094 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 16:04:10,094 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 16:04:10,094 - root - INFO - Pollution ratio of unlabeled train data: 0.00
2020-05-27 16:04:10,094 - root - INFO - Scenario Running: 2
2020-05-27 16:04:10,094 - root - INFO - Train only the network: True
2020-05-27 16:04:10,094 - root - INFO - Output and AE dimensions: 128
2020-05-27 16:04:10,094 - root - INFO - Known anomaly class: 6
2020-05-27 16:04:10,094 - root - INFO - Network: fmnist_LeNet
2020-05-27 16:04:10,094 - root - INFO - Eta-parameter: 1.00
2020-05-27 16:04:10,106 - root - INFO - Set seed to 0.
2020-05-27 16:04:10,177 - root - INFO - Computation device: cuda
2020-05-27 16:04:10,177 - root - INFO - Number of threads: 0
2020-05-27 16:04:10,177 - root - INFO - Number of dataloader workers: 6
2020-05-27 16:04:21,246 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 16:04:21,301 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 16:04:21,302 - root - INFO - Pretraining: True
2020-05-27 16:04:21,302 - root - INFO - Training optimizer: adam
2020-05-27 16:04:21,302 - root - INFO - Training learning rate: 0.0001
2020-05-27 16:04:21,302 - root - INFO - Training epochs: 150
2020-05-27 16:04:21,302 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 16:04:21,302 - root - INFO - Training batch size: 200
2020-05-27 16:04:21,302 - root - INFO - Training weight decay: 5e-07
2020-05-27 16:04:21,304 - root - INFO - Starting training...
2020-05-27 16:04:29,979 - root - INFO - | Epoch: 001/150 | Train Time: 8.673s | Train Loss: 2.673105 |
2020-05-27 16:04:32,795 - root - INFO - | Epoch: 002/150 | Train Time: 2.807s | Train Loss: 0.633390 |
2020-05-27 16:04:36,142 - root - INFO - | Epoch: 003/150 | Train Time: 3.347s | Train Loss: 0.402313 |
2020-05-27 16:04:38,554 - root - INFO - | Epoch: 004/150 | Train Time: 2.411s | Train Loss: 0.304701 |
2020-05-27 16:04:40,961 - root - INFO - | Epoch: 005/150 | Train Time: 2.407s | Train Loss: 0.237183 |
2020-05-27 16:04:43,330 - root - INFO - | Epoch: 006/150 | Train Time: 2.368s | Train Loss: 0.197405 |
2020-05-27 16:04:45,742 - root - INFO - | Epoch: 007/150 | Train Time: 2.412s | Train Loss: 0.166572 |
2020-05-27 16:04:48,191 - root - INFO - | Epoch: 008/150 | Train Time: 2.448s | Train Loss: 0.148820 |
2020-05-27 16:04:50,629 - root - INFO - | Epoch: 009/150 | Train Time: 2.438s | Train Loss: 0.135265 |
2020-05-27 16:04:53,254 - root - INFO - | Epoch: 010/150 | Train Time: 2.624s | Train Loss: 0.116843 |
2020-05-27 16:04:56,283 - root - INFO - | Epoch: 011/150 | Train Time: 3.028s | Train Loss: 0.114255 |
2020-05-27 16:04:59,182 - root - INFO - | Epoch: 012/150 | Train Time: 2.899s | Train Loss: 0.095581 |
2020-05-27 16:05:02,094 - root - INFO - | Epoch: 013/150 | Train Time: 2.912s | Train Loss: 0.089533 |
2020-05-27 16:05:05,565 - root - INFO - | Epoch: 014/150 | Train Time: 3.470s | Train Loss: 0.082784 |
2020-05-27 16:05:08,681 - root - INFO - | Epoch: 015/150 | Train Time: 3.116s | Train Loss: 0.077520 |
2020-05-27 16:05:11,431 - root - INFO - | Epoch: 016/150 | Train Time: 2.749s | Train Loss: 0.073415 |
2020-05-27 16:05:14,005 - root - INFO - | Epoch: 017/150 | Train Time: 2.574s | Train Loss: 0.070123 |
2020-05-27 16:05:16,709 - root - INFO - | Epoch: 018/150 | Train Time: 2.704s | Train Loss: 0.067366 |
2020-05-27 16:05:19,763 - root - INFO - | Epoch: 019/150 | Train Time: 3.054s | Train Loss: 0.065632 |
2020-05-27 16:05:22,907 - root - INFO - | Epoch: 020/150 | Train Time: 3.143s | Train Loss: 0.065862 |
2020-05-27 16:05:25,654 - root - INFO - | Epoch: 021/150 | Train Time: 2.747s | Train Loss: 0.060035 |
2020-05-27 16:05:28,507 - root - INFO - | Epoch: 022/150 | Train Time: 2.852s | Train Loss: 0.053574 |
2020-05-27 16:05:31,536 - root - INFO - | Epoch: 023/150 | Train Time: 3.028s | Train Loss: 0.052603 |
2020-05-27 16:05:34,325 - root - INFO - | Epoch: 024/150 | Train Time: 2.789s | Train Loss: 0.049856 |
2020-05-27 16:05:37,013 - root - INFO - | Epoch: 025/150 | Train Time: 2.687s | Train Loss: 0.047179 |
2020-05-27 16:05:39,534 - root - INFO - | Epoch: 026/150 | Train Time: 2.521s | Train Loss: 0.045758 |
2020-05-27 16:05:42,078 - root - INFO - | Epoch: 027/150 | Train Time: 2.544s | Train Loss: 0.045532 |
2020-05-27 16:05:44,512 - root - INFO - | Epoch: 028/150 | Train Time: 2.433s | Train Loss: 0.045498 |
2020-05-27 16:05:46,803 - root - INFO - | Epoch: 029/150 | Train Time: 2.291s | Train Loss: 0.043617 |
2020-05-27 16:05:48,537 - root - INFO - | Epoch: 030/150 | Train Time: 1.733s | Train Loss: 0.045810 |
2020-05-27 16:05:51,002 - root - INFO - | Epoch: 031/150 | Train Time: 2.464s | Train Loss: 0.041728 |
2020-05-27 16:05:52,989 - root - INFO - | Epoch: 032/150 | Train Time: 1.986s | Train Loss: 0.037110 |
2020-05-27 16:05:55,736 - root - INFO - | Epoch: 033/150 | Train Time: 2.747s | Train Loss: 0.040068 |
2020-05-27 16:05:58,982 - root - INFO - | Epoch: 034/150 | Train Time: 3.246s | Train Loss: 0.040216 |
2020-05-27 16:06:02,241 - root - INFO - | Epoch: 035/150 | Train Time: 3.258s | Train Loss: 0.036102 |
2020-05-27 16:06:05,203 - root - INFO - | Epoch: 036/150 | Train Time: 2.961s | Train Loss: 0.036983 |
2020-05-27 16:06:07,934 - root - INFO - | Epoch: 037/150 | Train Time: 2.731s | Train Loss: 0.035339 |
2020-05-27 16:06:10,887 - root - INFO - | Epoch: 038/150 | Train Time: 2.953s | Train Loss: 0.030807 |
2020-05-27 16:06:13,379 - root - INFO - | Epoch: 039/150 | Train Time: 2.491s | Train Loss: 0.033620 |
2020-05-27 16:06:16,276 - root - INFO - | Epoch: 040/150 | Train Time: 2.897s | Train Loss: 0.035714 |
2020-05-27 16:06:19,142 - root - INFO - | Epoch: 041/150 | Train Time: 2.865s | Train Loss: 0.029273 |
2020-05-27 16:06:21,905 - root - INFO - | Epoch: 042/150 | Train Time: 2.762s | Train Loss: 0.030935 |
2020-05-27 16:06:24,896 - root - INFO - | Epoch: 043/150 | Train Time: 2.991s | Train Loss: 0.027168 |
2020-05-27 16:06:27,598 - root - INFO - | Epoch: 044/150 | Train Time: 2.702s | Train Loss: 0.026028 |
2020-05-27 16:06:30,551 - root - INFO - | Epoch: 045/150 | Train Time: 2.952s | Train Loss: 0.027815 |
2020-05-27 16:06:33,344 - root - INFO - | Epoch: 046/150 | Train Time: 2.793s | Train Loss: 0.028128 |
2020-05-27 16:06:35,952 - root - INFO - | Epoch: 047/150 | Train Time: 2.608s | Train Loss: 0.027867 |
2020-05-27 16:06:38,579 - root - INFO - | Epoch: 048/150 | Train Time: 2.626s | Train Loss: 0.026102 |
2020-05-27 16:06:41,240 - root - INFO - | Epoch: 049/150 | Train Time: 2.660s | Train Loss: 0.025265 |
2020-05-27 16:06:43,845 - root - INFO - | Epoch: 050/150 | Train Time: 2.605s | Train Loss: 0.024537 |
2020-05-27 16:06:43,846 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 16:06:46,165 - root - INFO - | Epoch: 051/150 | Train Time: 2.319s | Train Loss: 0.024743 |
2020-05-27 16:06:48,264 - root - INFO - | Epoch: 052/150 | Train Time: 2.099s | Train Loss: 0.023841 |
2020-05-27 16:06:51,086 - root - INFO - | Epoch: 053/150 | Train Time: 2.821s | Train Loss: 0.023392 |
2020-05-27 16:06:53,848 - root - INFO - | Epoch: 054/150 | Train Time: 2.761s | Train Loss: 0.023371 |
2020-05-27 16:06:57,186 - root - INFO - | Epoch: 055/150 | Train Time: 3.338s | Train Loss: 0.022949 |
2020-05-27 16:07:00,353 - root - INFO - | Epoch: 056/150 | Train Time: 3.167s | Train Loss: 0.023486 |
2020-05-27 16:07:03,254 - root - INFO - | Epoch: 057/150 | Train Time: 2.900s | Train Loss: 0.022378 |
2020-05-27 16:07:06,313 - root - INFO - | Epoch: 058/150 | Train Time: 3.059s | Train Loss: 0.024337 |
2020-05-27 16:07:08,997 - root - INFO - | Epoch: 059/150 | Train Time: 2.683s | Train Loss: 0.022437 |
2020-05-27 16:07:11,762 - root - INFO - | Epoch: 060/150 | Train Time: 2.764s | Train Loss: 0.023156 |
2020-05-27 16:07:14,559 - root - INFO - | Epoch: 061/150 | Train Time: 2.796s | Train Loss: 0.023312 |
2020-05-27 16:07:18,021 - root - INFO - | Epoch: 062/150 | Train Time: 3.462s | Train Loss: 0.023886 |
2020-05-27 16:07:20,963 - root - INFO - | Epoch: 063/150 | Train Time: 2.941s | Train Loss: 0.022332 |
2020-05-27 16:07:23,987 - root - INFO - | Epoch: 064/150 | Train Time: 3.023s | Train Loss: 0.023638 |
2020-05-27 16:07:26,671 - root - INFO - | Epoch: 065/150 | Train Time: 2.683s | Train Loss: 0.023311 |
2020-05-27 16:07:29,728 - root - INFO - | Epoch: 066/150 | Train Time: 3.057s | Train Loss: 0.023853 |
2020-05-27 16:07:32,956 - root - INFO - | Epoch: 067/150 | Train Time: 3.228s | Train Loss: 0.023279 |
2020-05-27 16:07:35,982 - root - INFO - | Epoch: 068/150 | Train Time: 3.025s | Train Loss: 0.024776 |
2020-05-27 16:07:39,059 - root - INFO - | Epoch: 069/150 | Train Time: 3.076s | Train Loss: 0.023055 |
2020-05-27 16:07:42,256 - root - INFO - | Epoch: 070/150 | Train Time: 3.197s | Train Loss: 0.022328 |
2020-05-27 16:07:45,346 - root - INFO - | Epoch: 071/150 | Train Time: 3.089s | Train Loss: 0.024996 |
2020-05-27 16:07:48,438 - root - INFO - | Epoch: 072/150 | Train Time: 3.092s | Train Loss: 0.022054 |
2020-05-27 16:07:51,642 - root - INFO - | Epoch: 073/150 | Train Time: 3.203s | Train Loss: 0.021846 |
2020-05-27 16:07:54,669 - root - INFO - | Epoch: 074/150 | Train Time: 3.026s | Train Loss: 0.022931 |
2020-05-27 16:07:57,572 - root - INFO - | Epoch: 075/150 | Train Time: 2.902s | Train Loss: 0.021980 |
2020-05-27 16:08:00,280 - root - INFO - | Epoch: 076/150 | Train Time: 2.708s | Train Loss: 0.022416 |
2020-05-27 16:08:03,293 - root - INFO - | Epoch: 077/150 | Train Time: 3.012s | Train Loss: 0.022781 |
2020-05-27 16:08:06,000 - root - INFO - | Epoch: 078/150 | Train Time: 2.706s | Train Loss: 0.022899 |
2020-05-27 16:08:08,601 - root - INFO - | Epoch: 079/150 | Train Time: 2.601s | Train Loss: 0.022138 |
2020-05-27 16:08:11,305 - root - INFO - | Epoch: 080/150 | Train Time: 2.703s | Train Loss: 0.023693 |
2020-05-27 16:08:13,987 - root - INFO - | Epoch: 081/150 | Train Time: 2.682s | Train Loss: 0.022893 |
2020-05-27 16:08:17,001 - root - INFO - | Epoch: 082/150 | Train Time: 3.013s | Train Loss: 0.023597 |
2020-05-27 16:08:19,844 - root - INFO - | Epoch: 083/150 | Train Time: 2.843s | Train Loss: 0.022301 |
2020-05-27 16:08:22,834 - root - INFO - | Epoch: 084/150 | Train Time: 2.989s | Train Loss: 0.022837 |
2020-05-27 16:08:25,915 - root - INFO - | Epoch: 085/150 | Train Time: 3.081s | Train Loss: 0.020708 |
2020-05-27 16:08:28,986 - root - INFO - | Epoch: 086/150 | Train Time: 3.071s | Train Loss: 0.022548 |
2020-05-27 16:08:31,857 - root - INFO - | Epoch: 087/150 | Train Time: 2.871s | Train Loss: 0.021417 |
2020-05-27 16:08:34,312 - root - INFO - | Epoch: 088/150 | Train Time: 2.454s | Train Loss: 0.021860 |
2020-05-27 16:08:36,956 - root - INFO - | Epoch: 089/150 | Train Time: 2.644s | Train Loss: 0.020900 |
2020-05-27 16:08:39,420 - root - INFO - | Epoch: 090/150 | Train Time: 2.463s | Train Loss: 0.020374 |
2020-05-27 16:08:41,921 - root - INFO - | Epoch: 091/150 | Train Time: 2.501s | Train Loss: 0.021091 |
2020-05-27 16:08:44,597 - root - INFO - | Epoch: 092/150 | Train Time: 2.675s | Train Loss: 0.022503 |
2020-05-27 16:08:46,842 - root - INFO - | Epoch: 093/150 | Train Time: 2.245s | Train Loss: 0.022497 |
2020-05-27 16:08:49,185 - root - INFO - | Epoch: 094/150 | Train Time: 2.342s | Train Loss: 0.022654 |
2020-05-27 16:08:51,723 - root - INFO - | Epoch: 095/150 | Train Time: 2.537s | Train Loss: 0.021475 |
2020-05-27 16:08:54,948 - root - INFO - | Epoch: 096/150 | Train Time: 3.224s | Train Loss: 0.020509 |
2020-05-27 16:08:58,339 - root - INFO - | Epoch: 097/150 | Train Time: 3.391s | Train Loss: 0.020302 |
2020-05-27 16:09:01,257 - root - INFO - | Epoch: 098/150 | Train Time: 2.917s | Train Loss: 0.020251 |
2020-05-27 16:09:04,551 - root - INFO - | Epoch: 099/150 | Train Time: 3.294s | Train Loss: 0.021143 |
2020-05-27 16:09:07,090 - root - INFO - | Epoch: 100/150 | Train Time: 2.539s | Train Loss: 0.019566 |
2020-05-27 16:09:09,855 - root - INFO - | Epoch: 101/150 | Train Time: 2.765s | Train Loss: 0.021420 |
2020-05-27 16:09:12,370 - root - INFO - | Epoch: 102/150 | Train Time: 2.514s | Train Loss: 0.021921 |
2020-05-27 16:09:15,135 - root - INFO - | Epoch: 103/150 | Train Time: 2.764s | Train Loss: 0.020197 |
2020-05-27 16:09:18,018 - root - INFO - | Epoch: 104/150 | Train Time: 2.883s | Train Loss: 0.021277 |
2020-05-27 16:09:21,004 - root - INFO - | Epoch: 105/150 | Train Time: 2.985s | Train Loss: 0.018764 |
2020-05-27 16:09:23,892 - root - INFO - | Epoch: 106/150 | Train Time: 2.887s | Train Loss: 0.021223 |
2020-05-27 16:09:26,240 - root - INFO - | Epoch: 107/150 | Train Time: 2.348s | Train Loss: 0.020477 |
2020-05-27 16:09:28,798 - root - INFO - | Epoch: 108/150 | Train Time: 2.558s | Train Loss: 0.019935 |
2020-05-27 16:09:31,615 - root - INFO - | Epoch: 109/150 | Train Time: 2.816s | Train Loss: 0.020276 |
2020-05-27 16:09:34,236 - root - INFO - | Epoch: 110/150 | Train Time: 2.620s | Train Loss: 0.019579 |
2020-05-27 16:09:37,042 - root - INFO - | Epoch: 111/150 | Train Time: 2.806s | Train Loss: 0.019660 |
2020-05-27 16:09:40,444 - root - INFO - | Epoch: 112/150 | Train Time: 3.401s | Train Loss: 0.019418 |
2020-05-27 16:09:43,261 - root - INFO - | Epoch: 113/150 | Train Time: 2.816s | Train Loss: 0.019458 |
2020-05-27 16:09:45,922 - root - INFO - | Epoch: 114/150 | Train Time: 2.661s | Train Loss: 0.019599 |
2020-05-27 16:09:49,026 - root - INFO - | Epoch: 115/150 | Train Time: 3.103s | Train Loss: 0.020275 |
2020-05-27 16:09:51,875 - root - INFO - | Epoch: 116/150 | Train Time: 2.848s | Train Loss: 0.018929 |
2020-05-27 16:09:54,584 - root - INFO - | Epoch: 117/150 | Train Time: 2.709s | Train Loss: 0.018834 |
2020-05-27 16:09:57,358 - root - INFO - | Epoch: 118/150 | Train Time: 2.774s | Train Loss: 0.020059 |
2020-05-27 16:09:59,711 - root - INFO - | Epoch: 119/150 | Train Time: 2.352s | Train Loss: 0.020382 |
2020-05-27 16:10:02,450 - root - INFO - | Epoch: 120/150 | Train Time: 2.739s | Train Loss: 0.019422 |
2020-05-27 16:10:04,980 - root - INFO - | Epoch: 121/150 | Train Time: 2.529s | Train Loss: 0.021422 |
2020-05-27 16:10:07,659 - root - INFO - | Epoch: 122/150 | Train Time: 2.678s | Train Loss: 0.019417 |
2020-05-27 16:10:10,584 - root - INFO - | Epoch: 123/150 | Train Time: 2.924s | Train Loss: 0.018440 |
2020-05-27 16:10:13,488 - root - INFO - | Epoch: 124/150 | Train Time: 2.904s | Train Loss: 0.020615 |
2020-05-27 16:10:16,387 - root - INFO - | Epoch: 125/150 | Train Time: 2.898s | Train Loss: 0.018625 |
2020-05-27 16:10:18,674 - root - INFO - | Epoch: 126/150 | Train Time: 2.286s | Train Loss: 0.020293 |
2020-05-27 16:10:21,426 - root - INFO - | Epoch: 127/150 | Train Time: 2.752s | Train Loss: 0.017668 |
2020-05-27 16:10:24,235 - root - INFO - | Epoch: 128/150 | Train Time: 2.809s | Train Loss: 0.017710 |
2020-05-27 16:10:26,739 - root - INFO - | Epoch: 129/150 | Train Time: 2.504s | Train Loss: 0.018451 |
2020-05-27 16:10:28,694 - root - INFO - | Epoch: 130/150 | Train Time: 1.954s | Train Loss: 0.019458 |
2020-05-27 16:10:31,377 - root - INFO - | Epoch: 131/150 | Train Time: 2.683s | Train Loss: 0.019380 |
2020-05-27 16:10:34,218 - root - INFO - | Epoch: 132/150 | Train Time: 2.840s | Train Loss: 0.019298 |
2020-05-27 16:10:36,483 - root - INFO - | Epoch: 133/150 | Train Time: 2.264s | Train Loss: 0.018592 |
2020-05-27 16:10:38,783 - root - INFO - | Epoch: 134/150 | Train Time: 2.300s | Train Loss: 0.019737 |
2020-05-27 16:10:40,903 - root - INFO - | Epoch: 135/150 | Train Time: 2.119s | Train Loss: 0.018489 |
2020-05-27 16:10:43,183 - root - INFO - | Epoch: 136/150 | Train Time: 2.280s | Train Loss: 0.020430 |
2020-05-27 16:10:45,736 - root - INFO - | Epoch: 137/150 | Train Time: 2.552s | Train Loss: 0.018099 |
2020-05-27 16:10:48,182 - root - INFO - | Epoch: 138/150 | Train Time: 2.445s | Train Loss: 0.017259 |
2020-05-27 16:10:50,448 - root - INFO - | Epoch: 139/150 | Train Time: 2.266s | Train Loss: 0.019250 |
2020-05-27 16:10:52,356 - root - INFO - | Epoch: 140/150 | Train Time: 1.907s | Train Loss: 0.017167 |
2020-05-27 16:10:54,705 - root - INFO - | Epoch: 141/150 | Train Time: 2.349s | Train Loss: 0.017995 |
2020-05-27 16:10:56,807 - root - INFO - | Epoch: 142/150 | Train Time: 2.099s | Train Loss: 0.018886 |
2020-05-27 16:10:59,425 - root - INFO - | Epoch: 143/150 | Train Time: 2.617s | Train Loss: 0.018983 |
2020-05-27 16:11:01,955 - root - INFO - | Epoch: 144/150 | Train Time: 2.529s | Train Loss: 0.016704 |
2020-05-27 16:11:04,525 - root - INFO - | Epoch: 145/150 | Train Time: 2.570s | Train Loss: 0.016822 |
2020-05-27 16:11:06,668 - root - INFO - | Epoch: 146/150 | Train Time: 2.142s | Train Loss: 0.018175 |
2020-05-27 16:11:09,368 - root - INFO - | Epoch: 147/150 | Train Time: 2.700s | Train Loss: 0.018625 |
2020-05-27 16:11:12,279 - root - INFO - | Epoch: 148/150 | Train Time: 2.910s | Train Loss: 0.017136 |
2020-05-27 16:11:14,919 - root - INFO - | Epoch: 149/150 | Train Time: 2.639s | Train Loss: 0.015877 |
2020-05-27 16:11:17,957 - root - INFO - | Epoch: 150/150 | Train Time: 3.038s | Train Loss: 0.019187 |
2020-05-27 16:11:17,958 - root - INFO - Training Time: 416.653s
2020-05-27 16:11:17,958 - root - INFO - Finished training.
2020-05-27 16:11:17,959 - root - INFO - Starting testing...
2020-05-27 16:11:21,609 - root - INFO - Test Loss: 14.628003
2020-05-27 16:11:21,609 - root - INFO - Test AUC: 89.98%
2020-05-27 16:11:21,609 - root - INFO - Test Time: 3.623s
2020-05-27 16:11:21,609 - root - INFO - Finished testing.
