2020-05-27 17:27:13,223 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_5_8_001.txt
2020-05-27 17:27:13,223 - root - INFO - Data path is ../data
2020-05-27 17:27:13,223 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 17:27:13,223 - root - INFO - Dataset: fmnist
2020-05-27 17:27:13,223 - root - INFO - Normal class: 5
2020-05-27 17:27:13,224 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 17:27:13,224 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 17:27:13,224 - root - INFO - Pollution ratio of unlabeled train data: 0.01
2020-05-27 17:27:13,224 - root - INFO - Scenario Running: 2
2020-05-27 17:27:13,224 - root - INFO - Train only the network: True
2020-05-27 17:27:13,224 - root - INFO - Output and AE dimensions: 128
2020-05-27 17:27:13,224 - root - INFO - Known anomaly class: 8
2020-05-27 17:27:13,224 - root - INFO - Network: fmnist_LeNet
2020-05-27 17:27:13,224 - root - INFO - Eta-parameter: 1.00
2020-05-27 17:27:13,233 - root - INFO - Set seed to 0.
2020-05-27 17:27:13,271 - root - INFO - Computation device: cuda
2020-05-27 17:27:13,272 - root - INFO - Number of threads: 0
2020-05-27 17:27:13,273 - root - INFO - Number of dataloader workers: 6
2020-05-27 17:27:21,575 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 17:27:21,586 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 17:27:21,586 - root - INFO - Pretraining: True
2020-05-27 17:27:21,586 - root - INFO - Training optimizer: adam
2020-05-27 17:27:21,586 - root - INFO - Training learning rate: 0.0001
2020-05-27 17:27:21,586 - root - INFO - Training epochs: 150
2020-05-27 17:27:21,586 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 17:27:21,587 - root - INFO - Training batch size: 200
2020-05-27 17:27:21,587 - root - INFO - Training weight decay: 5e-07
2020-05-27 17:27:21,589 - root - INFO - Starting training...
2020-05-27 17:27:28,927 - root - INFO - | Epoch: 001/150 | Train Time: 7.338s | Train Loss: 3.018605 |
2020-05-27 17:27:32,031 - root - INFO - | Epoch: 002/150 | Train Time: 3.104s | Train Loss: 0.731074 |
2020-05-27 17:27:34,828 - root - INFO - | Epoch: 003/150 | Train Time: 2.797s | Train Loss: 0.459385 |
2020-05-27 17:27:37,435 - root - INFO - | Epoch: 004/150 | Train Time: 2.606s | Train Loss: 0.346838 |
2020-05-27 17:27:40,082 - root - INFO - | Epoch: 005/150 | Train Time: 2.647s | Train Loss: 0.280275 |
2020-05-27 17:27:42,568 - root - INFO - | Epoch: 006/150 | Train Time: 2.485s | Train Loss: 0.234806 |
2020-05-27 17:27:44,727 - root - INFO - | Epoch: 007/150 | Train Time: 2.159s | Train Loss: 0.201772 |
2020-05-27 17:27:46,918 - root - INFO - | Epoch: 008/150 | Train Time: 2.190s | Train Loss: 0.179076 |
2020-05-27 17:27:49,319 - root - INFO - | Epoch: 009/150 | Train Time: 2.401s | Train Loss: 0.157282 |
2020-05-27 17:27:51,770 - root - INFO - | Epoch: 010/150 | Train Time: 2.451s | Train Loss: 0.146065 |
2020-05-27 17:27:54,428 - root - INFO - | Epoch: 011/150 | Train Time: 2.657s | Train Loss: 0.134083 |
2020-05-27 17:27:56,927 - root - INFO - | Epoch: 012/150 | Train Time: 2.499s | Train Loss: 0.122053 |
2020-05-27 17:27:59,476 - root - INFO - | Epoch: 013/150 | Train Time: 2.549s | Train Loss: 0.112283 |
2020-05-27 17:28:02,057 - root - INFO - | Epoch: 014/150 | Train Time: 2.581s | Train Loss: 0.106429 |
2020-05-27 17:28:04,643 - root - INFO - | Epoch: 015/150 | Train Time: 2.585s | Train Loss: 0.100182 |
2020-05-27 17:28:07,295 - root - INFO - | Epoch: 016/150 | Train Time: 2.652s | Train Loss: 0.095893 |
2020-05-27 17:28:10,194 - root - INFO - | Epoch: 017/150 | Train Time: 2.898s | Train Loss: 0.091020 |
2020-05-27 17:28:12,824 - root - INFO - | Epoch: 018/150 | Train Time: 2.629s | Train Loss: 0.085034 |
2020-05-27 17:28:15,544 - root - INFO - | Epoch: 019/150 | Train Time: 2.720s | Train Loss: 0.084494 |
2020-05-27 17:28:18,387 - root - INFO - | Epoch: 020/150 | Train Time: 2.842s | Train Loss: 0.080404 |
2020-05-27 17:28:21,023 - root - INFO - | Epoch: 021/150 | Train Time: 2.635s | Train Loss: 0.077861 |
2020-05-27 17:28:24,026 - root - INFO - | Epoch: 022/150 | Train Time: 3.002s | Train Loss: 0.074814 |
2020-05-27 17:28:26,854 - root - INFO - | Epoch: 023/150 | Train Time: 2.828s | Train Loss: 0.073183 |
2020-05-27 17:28:29,898 - root - INFO - | Epoch: 024/150 | Train Time: 3.043s | Train Loss: 0.069424 |
2020-05-27 17:28:32,849 - root - INFO - | Epoch: 025/150 | Train Time: 2.950s | Train Loss: 0.069809 |
2020-05-27 17:28:35,746 - root - INFO - | Epoch: 026/150 | Train Time: 2.896s | Train Loss: 0.065238 |
2020-05-27 17:28:38,560 - root - INFO - | Epoch: 027/150 | Train Time: 2.814s | Train Loss: 0.065757 |
2020-05-27 17:28:40,711 - root - INFO - | Epoch: 028/150 | Train Time: 2.150s | Train Loss: 0.064387 |
2020-05-27 17:28:43,438 - root - INFO - | Epoch: 029/150 | Train Time: 2.726s | Train Loss: 0.064762 |
2020-05-27 17:28:45,795 - root - INFO - | Epoch: 030/150 | Train Time: 2.357s | Train Loss: 0.062225 |
2020-05-27 17:28:48,523 - root - INFO - | Epoch: 031/150 | Train Time: 2.727s | Train Loss: 0.059162 |
2020-05-27 17:28:50,946 - root - INFO - | Epoch: 032/150 | Train Time: 2.423s | Train Loss: 0.060176 |
2020-05-27 17:28:53,771 - root - INFO - | Epoch: 033/150 | Train Time: 2.824s | Train Loss: 0.056470 |
2020-05-27 17:28:55,763 - root - INFO - | Epoch: 034/150 | Train Time: 1.992s | Train Loss: 0.056695 |
2020-05-27 17:28:57,840 - root - INFO - | Epoch: 035/150 | Train Time: 2.076s | Train Loss: 0.057258 |
2020-05-27 17:29:00,215 - root - INFO - | Epoch: 036/150 | Train Time: 2.374s | Train Loss: 0.054256 |
2020-05-27 17:29:02,809 - root - INFO - | Epoch: 037/150 | Train Time: 2.594s | Train Loss: 0.053228 |
2020-05-27 17:29:05,577 - root - INFO - | Epoch: 038/150 | Train Time: 2.767s | Train Loss: 0.053201 |
2020-05-27 17:29:08,310 - root - INFO - | Epoch: 039/150 | Train Time: 2.732s | Train Loss: 0.052916 |
2020-05-27 17:29:10,950 - root - INFO - | Epoch: 040/150 | Train Time: 2.639s | Train Loss: 0.050549 |
2020-05-27 17:29:13,922 - root - INFO - | Epoch: 041/150 | Train Time: 2.972s | Train Loss: 0.048315 |
2020-05-27 17:29:16,862 - root - INFO - | Epoch: 042/150 | Train Time: 2.939s | Train Loss: 0.049535 |
2020-05-27 17:29:19,845 - root - INFO - | Epoch: 043/150 | Train Time: 2.983s | Train Loss: 0.051041 |
2020-05-27 17:29:22,861 - root - INFO - | Epoch: 044/150 | Train Time: 3.015s | Train Loss: 0.048145 |
2020-05-27 17:29:26,045 - root - INFO - | Epoch: 045/150 | Train Time: 3.184s | Train Loss: 0.046528 |
2020-05-27 17:29:29,104 - root - INFO - | Epoch: 046/150 | Train Time: 3.058s | Train Loss: 0.044976 |
2020-05-27 17:29:31,692 - root - INFO - | Epoch: 047/150 | Train Time: 2.588s | Train Loss: 0.044981 |
2020-05-27 17:29:33,935 - root - INFO - | Epoch: 048/150 | Train Time: 2.242s | Train Loss: 0.045982 |
2020-05-27 17:29:36,129 - root - INFO - | Epoch: 049/150 | Train Time: 2.193s | Train Loss: 0.044590 |
2020-05-27 17:29:38,747 - root - INFO - | Epoch: 050/150 | Train Time: 2.618s | Train Loss: 0.041275 |
2020-05-27 17:29:38,747 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 17:29:40,898 - root - INFO - | Epoch: 051/150 | Train Time: 2.151s | Train Loss: 0.041230 |
2020-05-27 17:29:43,673 - root - INFO - | Epoch: 052/150 | Train Time: 2.774s | Train Loss: 0.041328 |
2020-05-27 17:29:45,982 - root - INFO - | Epoch: 053/150 | Train Time: 2.309s | Train Loss: 0.041117 |
2020-05-27 17:29:48,599 - root - INFO - | Epoch: 054/150 | Train Time: 2.617s | Train Loss: 0.040960 |
2020-05-27 17:29:51,219 - root - INFO - | Epoch: 055/150 | Train Time: 2.620s | Train Loss: 0.041009 |
2020-05-27 17:29:53,622 - root - INFO - | Epoch: 056/150 | Train Time: 2.402s | Train Loss: 0.042401 |
2020-05-27 17:29:56,057 - root - INFO - | Epoch: 057/150 | Train Time: 2.434s | Train Loss: 0.041893 |
2020-05-27 17:29:58,167 - root - INFO - | Epoch: 058/150 | Train Time: 2.109s | Train Loss: 0.040975 |
2020-05-27 17:30:00,365 - root - INFO - | Epoch: 059/150 | Train Time: 2.198s | Train Loss: 0.042210 |
2020-05-27 17:30:02,653 - root - INFO - | Epoch: 060/150 | Train Time: 2.288s | Train Loss: 0.042290 |
2020-05-27 17:30:05,008 - root - INFO - | Epoch: 061/150 | Train Time: 2.354s | Train Loss: 0.041869 |
2020-05-27 17:30:07,153 - root - INFO - | Epoch: 062/150 | Train Time: 2.145s | Train Loss: 0.041971 |
2020-05-27 17:30:09,662 - root - INFO - | Epoch: 063/150 | Train Time: 2.508s | Train Loss: 0.040448 |
2020-05-27 17:30:11,944 - root - INFO - | Epoch: 064/150 | Train Time: 2.282s | Train Loss: 0.041062 |
2020-05-27 17:30:14,358 - root - INFO - | Epoch: 065/150 | Train Time: 2.413s | Train Loss: 0.041372 |
2020-05-27 17:30:16,665 - root - INFO - | Epoch: 066/150 | Train Time: 2.306s | Train Loss: 0.040824 |
2020-05-27 17:30:19,171 - root - INFO - | Epoch: 067/150 | Train Time: 2.506s | Train Loss: 0.040335 |
2020-05-27 17:30:21,556 - root - INFO - | Epoch: 068/150 | Train Time: 2.385s | Train Loss: 0.043066 |
2020-05-27 17:30:23,920 - root - INFO - | Epoch: 069/150 | Train Time: 2.363s | Train Loss: 0.042095 |
2020-05-27 17:30:26,615 - root - INFO - | Epoch: 070/150 | Train Time: 2.694s | Train Loss: 0.041715 |
2020-05-27 17:30:29,422 - root - INFO - | Epoch: 071/150 | Train Time: 2.807s | Train Loss: 0.040273 |
2020-05-27 17:30:31,987 - root - INFO - | Epoch: 072/150 | Train Time: 2.564s | Train Loss: 0.040865 |
2020-05-27 17:30:34,121 - root - INFO - | Epoch: 073/150 | Train Time: 2.134s | Train Loss: 0.040697 |
2020-05-27 17:30:36,116 - root - INFO - | Epoch: 074/150 | Train Time: 1.995s | Train Loss: 0.041695 |
2020-05-27 17:30:38,423 - root - INFO - | Epoch: 075/150 | Train Time: 2.306s | Train Loss: 0.039520 |
2020-05-27 17:30:41,092 - root - INFO - | Epoch: 076/150 | Train Time: 2.668s | Train Loss: 0.041013 |
2020-05-27 17:30:43,872 - root - INFO - | Epoch: 077/150 | Train Time: 2.779s | Train Loss: 0.039850 |
2020-05-27 17:30:46,710 - root - INFO - | Epoch: 078/150 | Train Time: 2.838s | Train Loss: 0.040869 |
2020-05-27 17:30:49,511 - root - INFO - | Epoch: 079/150 | Train Time: 2.800s | Train Loss: 0.040447 |
2020-05-27 17:30:51,669 - root - INFO - | Epoch: 080/150 | Train Time: 2.157s | Train Loss: 0.041913 |
2020-05-27 17:30:54,427 - root - INFO - | Epoch: 081/150 | Train Time: 2.757s | Train Loss: 0.040086 |
2020-05-27 17:30:56,714 - root - INFO - | Epoch: 082/150 | Train Time: 2.287s | Train Loss: 0.040543 |
2020-05-27 17:30:59,287 - root - INFO - | Epoch: 083/150 | Train Time: 2.573s | Train Loss: 0.041124 |
2020-05-27 17:31:02,087 - root - INFO - | Epoch: 084/150 | Train Time: 2.799s | Train Loss: 0.039201 |
2020-05-27 17:31:05,229 - root - INFO - | Epoch: 085/150 | Train Time: 3.142s | Train Loss: 0.040772 |
2020-05-27 17:31:07,639 - root - INFO - | Epoch: 086/150 | Train Time: 2.410s | Train Loss: 0.038809 |
2020-05-27 17:31:09,432 - root - INFO - | Epoch: 087/150 | Train Time: 1.792s | Train Loss: 0.039270 |
2020-05-27 17:31:11,806 - root - INFO - | Epoch: 088/150 | Train Time: 2.374s | Train Loss: 0.041813 |
2020-05-27 17:31:13,697 - root - INFO - | Epoch: 089/150 | Train Time: 1.890s | Train Loss: 0.038492 |
2020-05-27 17:31:16,036 - root - INFO - | Epoch: 090/150 | Train Time: 2.339s | Train Loss: 0.039220 |
2020-05-27 17:31:18,635 - root - INFO - | Epoch: 091/150 | Train Time: 2.599s | Train Loss: 0.039856 |
2020-05-27 17:31:20,719 - root - INFO - | Epoch: 092/150 | Train Time: 2.084s | Train Loss: 0.039778 |
2020-05-27 17:31:22,822 - root - INFO - | Epoch: 093/150 | Train Time: 2.102s | Train Loss: 0.040290 |
2020-05-27 17:31:25,284 - root - INFO - | Epoch: 094/150 | Train Time: 2.462s | Train Loss: 0.040213 |
2020-05-27 17:31:28,261 - root - INFO - | Epoch: 095/150 | Train Time: 2.976s | Train Loss: 0.039850 |
2020-05-27 17:31:30,967 - root - INFO - | Epoch: 096/150 | Train Time: 2.705s | Train Loss: 0.039414 |
2020-05-27 17:31:33,642 - root - INFO - | Epoch: 097/150 | Train Time: 2.675s | Train Loss: 0.038412 |
2020-05-27 17:31:36,130 - root - INFO - | Epoch: 098/150 | Train Time: 2.488s | Train Loss: 0.039891 |
2020-05-27 17:31:38,416 - root - INFO - | Epoch: 099/150 | Train Time: 2.286s | Train Loss: 0.038465 |
2020-05-27 17:31:40,736 - root - INFO - | Epoch: 100/150 | Train Time: 2.319s | Train Loss: 0.038648 |
2020-05-27 17:31:43,440 - root - INFO - | Epoch: 101/150 | Train Time: 2.703s | Train Loss: 0.039662 |
2020-05-27 17:31:46,232 - root - INFO - | Epoch: 102/150 | Train Time: 2.792s | Train Loss: 0.037624 |
2020-05-27 17:31:49,013 - root - INFO - | Epoch: 103/150 | Train Time: 2.781s | Train Loss: 0.038786 |
2020-05-27 17:31:51,841 - root - INFO - | Epoch: 104/150 | Train Time: 2.827s | Train Loss: 0.038029 |
2020-05-27 17:31:54,658 - root - INFO - | Epoch: 105/150 | Train Time: 2.816s | Train Loss: 0.040763 |
2020-05-27 17:31:58,081 - root - INFO - | Epoch: 106/150 | Train Time: 3.423s | Train Loss: 0.037594 |
2020-05-27 17:32:00,486 - root - INFO - | Epoch: 107/150 | Train Time: 2.405s | Train Loss: 0.038585 |
2020-05-27 17:32:02,930 - root - INFO - | Epoch: 108/150 | Train Time: 2.444s | Train Loss: 0.039690 |
2020-05-27 17:32:05,259 - root - INFO - | Epoch: 109/150 | Train Time: 2.327s | Train Loss: 0.039630 |
2020-05-27 17:32:08,209 - root - INFO - | Epoch: 110/150 | Train Time: 2.950s | Train Loss: 0.038148 |
2020-05-27 17:32:11,242 - root - INFO - | Epoch: 111/150 | Train Time: 3.033s | Train Loss: 0.037718 |
2020-05-27 17:32:13,827 - root - INFO - | Epoch: 112/150 | Train Time: 2.584s | Train Loss: 0.038456 |
2020-05-27 17:32:16,379 - root - INFO - | Epoch: 113/150 | Train Time: 2.552s | Train Loss: 0.038573 |
2020-05-27 17:32:19,048 - root - INFO - | Epoch: 114/150 | Train Time: 2.668s | Train Loss: 0.037978 |
2020-05-27 17:32:21,041 - root - INFO - | Epoch: 115/150 | Train Time: 1.993s | Train Loss: 0.036907 |
2020-05-27 17:32:23,181 - root - INFO - | Epoch: 116/150 | Train Time: 2.140s | Train Loss: 0.037440 |
2020-05-27 17:32:25,482 - root - INFO - | Epoch: 117/150 | Train Time: 2.300s | Train Loss: 0.038058 |
2020-05-27 17:32:27,582 - root - INFO - | Epoch: 118/150 | Train Time: 2.100s | Train Loss: 0.038137 |
2020-05-27 17:32:29,987 - root - INFO - | Epoch: 119/150 | Train Time: 2.404s | Train Loss: 0.037643 |
2020-05-27 17:32:32,619 - root - INFO - | Epoch: 120/150 | Train Time: 2.631s | Train Loss: 0.037959 |
2020-05-27 17:32:35,249 - root - INFO - | Epoch: 121/150 | Train Time: 2.630s | Train Loss: 0.036579 |
2020-05-27 17:32:37,639 - root - INFO - | Epoch: 122/150 | Train Time: 2.390s | Train Loss: 0.035115 |
2020-05-27 17:32:39,894 - root - INFO - | Epoch: 123/150 | Train Time: 2.254s | Train Loss: 0.036695 |
2020-05-27 17:32:42,253 - root - INFO - | Epoch: 124/150 | Train Time: 2.359s | Train Loss: 0.036560 |
2020-05-27 17:32:44,466 - root - INFO - | Epoch: 125/150 | Train Time: 2.212s | Train Loss: 0.036868 |
2020-05-27 17:32:46,817 - root - INFO - | Epoch: 126/150 | Train Time: 2.351s | Train Loss: 0.036222 |
2020-05-27 17:32:49,110 - root - INFO - | Epoch: 127/150 | Train Time: 2.292s | Train Loss: 0.036888 |
2020-05-27 17:32:51,492 - root - INFO - | Epoch: 128/150 | Train Time: 2.382s | Train Loss: 0.037871 |
2020-05-27 17:32:54,136 - root - INFO - | Epoch: 129/150 | Train Time: 2.644s | Train Loss: 0.035628 |
2020-05-27 17:32:56,590 - root - INFO - | Epoch: 130/150 | Train Time: 2.453s | Train Loss: 0.035992 |
2020-05-27 17:32:59,527 - root - INFO - | Epoch: 131/150 | Train Time: 2.937s | Train Loss: 0.036798 |
2020-05-27 17:33:02,159 - root - INFO - | Epoch: 132/150 | Train Time: 2.631s | Train Loss: 0.036697 |
2020-05-27 17:33:04,789 - root - INFO - | Epoch: 133/150 | Train Time: 2.629s | Train Loss: 0.035766 |
2020-05-27 17:33:07,783 - root - INFO - | Epoch: 134/150 | Train Time: 2.994s | Train Loss: 0.036461 |
2020-05-27 17:33:10,472 - root - INFO - | Epoch: 135/150 | Train Time: 2.688s | Train Loss: 0.036317 |
2020-05-27 17:33:13,349 - root - INFO - | Epoch: 136/150 | Train Time: 2.877s | Train Loss: 0.036917 |
2020-05-27 17:33:16,303 - root - INFO - | Epoch: 137/150 | Train Time: 2.953s | Train Loss: 0.037426 |
2020-05-27 17:33:18,839 - root - INFO - | Epoch: 138/150 | Train Time: 2.535s | Train Loss: 0.037796 |
2020-05-27 17:33:21,005 - root - INFO - | Epoch: 139/150 | Train Time: 2.166s | Train Loss: 0.035932 |
2020-05-27 17:33:23,430 - root - INFO - | Epoch: 140/150 | Train Time: 2.424s | Train Loss: 0.034432 |
2020-05-27 17:33:25,802 - root - INFO - | Epoch: 141/150 | Train Time: 2.372s | Train Loss: 0.035857 |
2020-05-27 17:33:28,130 - root - INFO - | Epoch: 142/150 | Train Time: 2.328s | Train Loss: 0.036112 |
2020-05-27 17:33:31,258 - root - INFO - | Epoch: 143/150 | Train Time: 3.127s | Train Loss: 0.036660 |
2020-05-27 17:33:33,744 - root - INFO - | Epoch: 144/150 | Train Time: 2.485s | Train Loss: 0.035294 |
2020-05-27 17:33:36,322 - root - INFO - | Epoch: 145/150 | Train Time: 2.578s | Train Loss: 0.035442 |
2020-05-27 17:33:38,761 - root - INFO - | Epoch: 146/150 | Train Time: 2.438s | Train Loss: 0.034435 |
2020-05-27 17:33:41,380 - root - INFO - | Epoch: 147/150 | Train Time: 2.619s | Train Loss: 0.036140 |
2020-05-27 17:33:44,258 - root - INFO - | Epoch: 148/150 | Train Time: 2.878s | Train Loss: 0.036845 |
2020-05-27 17:33:46,575 - root - INFO - | Epoch: 149/150 | Train Time: 2.316s | Train Loss: 0.033885 |
2020-05-27 17:33:48,841 - root - INFO - | Epoch: 150/150 | Train Time: 2.266s | Train Loss: 0.035576 |
2020-05-27 17:33:48,842 - root - INFO - Training Time: 387.253s
2020-05-27 17:33:48,842 - root - INFO - Finished training.
2020-05-27 17:33:48,843 - root - INFO - Starting testing...
2020-05-27 17:33:51,687 - root - INFO - Test Loss: 0.773009
2020-05-27 17:33:51,687 - root - INFO - Test AUC: 91.74%
2020-05-27 17:33:51,687 - root - INFO - Test Time: 2.830s
2020-05-27 17:33:51,687 - root - INFO - Finished testing.
