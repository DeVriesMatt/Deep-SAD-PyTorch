2020-05-27 20:30:11,585 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_6_3_001.txt
2020-05-27 20:30:11,585 - root - INFO - Data path is ../data
2020-05-27 20:30:11,586 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-27 20:30:11,586 - root - INFO - Dataset: fmnist
2020-05-27 20:30:11,586 - root - INFO - Normal class: 6
2020-05-27 20:30:11,586 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-27 20:30:11,586 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-27 20:30:11,586 - root - INFO - Pollution ratio of unlabeled train data: 0.01
2020-05-27 20:30:11,586 - root - INFO - Scenario Running: 2
2020-05-27 20:30:11,586 - root - INFO - Train only the network: True
2020-05-27 20:30:11,586 - root - INFO - Output and AE dimensions: 128
2020-05-27 20:30:11,586 - root - INFO - Known anomaly class: 3
2020-05-27 20:30:11,586 - root - INFO - Network: fmnist_LeNet
2020-05-27 20:30:11,586 - root - INFO - Eta-parameter: 1.00
2020-05-27 20:30:11,593 - root - INFO - Set seed to 0.
2020-05-27 20:30:11,634 - root - INFO - Computation device: cuda
2020-05-27 20:30:11,640 - root - INFO - Number of threads: 0
2020-05-27 20:30:11,650 - root - INFO - Number of dataloader workers: 6
2020-05-27 20:30:21,660 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-27 20:30:21,681 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-27 20:30:21,681 - root - INFO - Pretraining: True
2020-05-27 20:30:21,681 - root - INFO - Training optimizer: adam
2020-05-27 20:30:21,681 - root - INFO - Training learning rate: 0.0001
2020-05-27 20:30:21,681 - root - INFO - Training epochs: 150
2020-05-27 20:30:21,681 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-27 20:30:21,682 - root - INFO - Training batch size: 200
2020-05-27 20:30:21,682 - root - INFO - Training weight decay: 5e-07
2020-05-27 20:30:21,684 - root - INFO - Starting training...
2020-05-27 20:30:30,530 - root - INFO - | Epoch: 001/150 | Train Time: 8.846s | Train Loss: 2.123099 |
2020-05-27 20:30:33,590 - root - INFO - | Epoch: 002/150 | Train Time: 3.060s | Train Loss: 0.553427 |
2020-05-27 20:30:35,895 - root - INFO - | Epoch: 003/150 | Train Time: 2.304s | Train Loss: 0.367298 |
2020-05-27 20:30:38,632 - root - INFO - | Epoch: 004/150 | Train Time: 2.737s | Train Loss: 0.295265 |
2020-05-27 20:30:41,354 - root - INFO - | Epoch: 005/150 | Train Time: 2.722s | Train Loss: 0.257313 |
2020-05-27 20:30:43,828 - root - INFO - | Epoch: 006/150 | Train Time: 2.473s | Train Loss: 0.227194 |
2020-05-27 20:30:46,075 - root - INFO - | Epoch: 007/150 | Train Time: 2.247s | Train Loss: 0.204176 |
2020-05-27 20:30:48,370 - root - INFO - | Epoch: 008/150 | Train Time: 2.294s | Train Loss: 0.188636 |
2020-05-27 20:30:50,798 - root - INFO - | Epoch: 009/150 | Train Time: 2.428s | Train Loss: 0.180233 |
2020-05-27 20:30:52,868 - root - INFO - | Epoch: 010/150 | Train Time: 2.070s | Train Loss: 0.168139 |
2020-05-27 20:30:55,392 - root - INFO - | Epoch: 011/150 | Train Time: 2.523s | Train Loss: 0.159741 |
2020-05-27 20:30:57,762 - root - INFO - | Epoch: 012/150 | Train Time: 2.369s | Train Loss: 0.151301 |
2020-05-27 20:30:59,966 - root - INFO - | Epoch: 013/150 | Train Time: 2.204s | Train Loss: 0.144143 |
2020-05-27 20:31:01,985 - root - INFO - | Epoch: 014/150 | Train Time: 2.018s | Train Loss: 0.138793 |
2020-05-27 20:31:03,956 - root - INFO - | Epoch: 015/150 | Train Time: 1.970s | Train Loss: 0.133547 |
2020-05-27 20:31:05,889 - root - INFO - | Epoch: 016/150 | Train Time: 1.933s | Train Loss: 0.130647 |
2020-05-27 20:31:08,329 - root - INFO - | Epoch: 017/150 | Train Time: 2.439s | Train Loss: 0.124599 |
2020-05-27 20:31:10,781 - root - INFO - | Epoch: 018/150 | Train Time: 2.452s | Train Loss: 0.124019 |
2020-05-27 20:31:13,544 - root - INFO - | Epoch: 019/150 | Train Time: 2.763s | Train Loss: 0.119535 |
2020-05-27 20:31:16,493 - root - INFO - | Epoch: 020/150 | Train Time: 2.949s | Train Loss: 0.117587 |
2020-05-27 20:31:19,116 - root - INFO - | Epoch: 021/150 | Train Time: 2.622s | Train Loss: 0.112332 |
2020-05-27 20:31:21,864 - root - INFO - | Epoch: 022/150 | Train Time: 2.747s | Train Loss: 0.110552 |
2020-05-27 20:31:24,764 - root - INFO - | Epoch: 023/150 | Train Time: 2.900s | Train Loss: 0.110174 |
2020-05-27 20:31:27,563 - root - INFO - | Epoch: 024/150 | Train Time: 2.799s | Train Loss: 0.105211 |
2020-05-27 20:31:30,847 - root - INFO - | Epoch: 025/150 | Train Time: 3.284s | Train Loss: 0.105610 |
2020-05-27 20:31:33,523 - root - INFO - | Epoch: 026/150 | Train Time: 2.675s | Train Loss: 0.099844 |
2020-05-27 20:31:35,936 - root - INFO - | Epoch: 027/150 | Train Time: 2.413s | Train Loss: 0.099267 |
2020-05-27 20:31:38,137 - root - INFO - | Epoch: 028/150 | Train Time: 2.200s | Train Loss: 0.101763 |
2020-05-27 20:31:40,403 - root - INFO - | Epoch: 029/150 | Train Time: 2.265s | Train Loss: 0.095516 |
2020-05-27 20:31:42,990 - root - INFO - | Epoch: 030/150 | Train Time: 2.586s | Train Loss: 0.094345 |
2020-05-27 20:31:45,937 - root - INFO - | Epoch: 031/150 | Train Time: 2.946s | Train Loss: 0.094734 |
2020-05-27 20:31:48,671 - root - INFO - | Epoch: 032/150 | Train Time: 2.733s | Train Loss: 0.095600 |
2020-05-27 20:31:51,311 - root - INFO - | Epoch: 033/150 | Train Time: 2.640s | Train Loss: 0.091534 |
2020-05-27 20:31:54,324 - root - INFO - | Epoch: 034/150 | Train Time: 3.012s | Train Loss: 0.088243 |
2020-05-27 20:31:57,032 - root - INFO - | Epoch: 035/150 | Train Time: 2.708s | Train Loss: 0.088056 |
2020-05-27 20:31:59,529 - root - INFO - | Epoch: 036/150 | Train Time: 2.497s | Train Loss: 0.086276 |
2020-05-27 20:32:01,973 - root - INFO - | Epoch: 037/150 | Train Time: 2.443s | Train Loss: 0.085248 |
2020-05-27 20:32:04,118 - root - INFO - | Epoch: 038/150 | Train Time: 2.145s | Train Loss: 0.084333 |
2020-05-27 20:32:06,717 - root - INFO - | Epoch: 039/150 | Train Time: 2.598s | Train Loss: 0.080832 |
2020-05-27 20:32:09,564 - root - INFO - | Epoch: 040/150 | Train Time: 2.846s | Train Loss: 0.083626 |
2020-05-27 20:32:11,817 - root - INFO - | Epoch: 041/150 | Train Time: 2.252s | Train Loss: 0.080115 |
2020-05-27 20:32:14,299 - root - INFO - | Epoch: 042/150 | Train Time: 2.480s | Train Loss: 0.080233 |
2020-05-27 20:32:16,856 - root - INFO - | Epoch: 043/150 | Train Time: 2.556s | Train Loss: 0.080003 |
2020-05-27 20:32:19,246 - root - INFO - | Epoch: 044/150 | Train Time: 2.389s | Train Loss: 0.076127 |
2020-05-27 20:32:21,374 - root - INFO - | Epoch: 045/150 | Train Time: 2.128s | Train Loss: 0.078132 |
2020-05-27 20:32:23,836 - root - INFO - | Epoch: 046/150 | Train Time: 2.462s | Train Loss: 0.074358 |
2020-05-27 20:32:26,054 - root - INFO - | Epoch: 047/150 | Train Time: 2.218s | Train Loss: 0.074605 |
2020-05-27 20:32:28,642 - root - INFO - | Epoch: 048/150 | Train Time: 2.588s | Train Loss: 0.072599 |
2020-05-27 20:32:31,363 - root - INFO - | Epoch: 049/150 | Train Time: 2.720s | Train Loss: 0.070958 |
2020-05-27 20:32:34,109 - root - INFO - | Epoch: 050/150 | Train Time: 2.745s | Train Loss: 0.068879 |
2020-05-27 20:32:34,109 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-27 20:32:36,570 - root - INFO - | Epoch: 051/150 | Train Time: 2.460s | Train Loss: 0.068606 |
2020-05-27 20:32:38,954 - root - INFO - | Epoch: 052/150 | Train Time: 2.384s | Train Loss: 0.070174 |
2020-05-27 20:32:41,376 - root - INFO - | Epoch: 053/150 | Train Time: 2.421s | Train Loss: 0.067457 |
2020-05-27 20:32:43,788 - root - INFO - | Epoch: 054/150 | Train Time: 2.412s | Train Loss: 0.068742 |
2020-05-27 20:32:46,291 - root - INFO - | Epoch: 055/150 | Train Time: 2.502s | Train Loss: 0.067741 |
2020-05-27 20:32:48,837 - root - INFO - | Epoch: 056/150 | Train Time: 2.546s | Train Loss: 0.068077 |
2020-05-27 20:32:51,190 - root - INFO - | Epoch: 057/150 | Train Time: 2.352s | Train Loss: 0.067844 |
2020-05-27 20:32:53,839 - root - INFO - | Epoch: 058/150 | Train Time: 2.648s | Train Loss: 0.068592 |
2020-05-27 20:32:56,812 - root - INFO - | Epoch: 059/150 | Train Time: 2.973s | Train Loss: 0.070089 |
2020-05-27 20:32:59,633 - root - INFO - | Epoch: 060/150 | Train Time: 2.820s | Train Loss: 0.068315 |
2020-05-27 20:33:02,491 - root - INFO - | Epoch: 061/150 | Train Time: 2.858s | Train Loss: 0.065947 |
2020-05-27 20:33:06,025 - root - INFO - | Epoch: 062/150 | Train Time: 3.534s | Train Loss: 0.068538 |
2020-05-27 20:33:09,087 - root - INFO - | Epoch: 063/150 | Train Time: 3.061s | Train Loss: 0.067743 |
2020-05-27 20:33:11,731 - root - INFO - | Epoch: 064/150 | Train Time: 2.643s | Train Loss: 0.067817 |
2020-05-27 20:33:14,552 - root - INFO - | Epoch: 065/150 | Train Time: 2.820s | Train Loss: 0.068024 |
2020-05-27 20:33:16,680 - root - INFO - | Epoch: 066/150 | Train Time: 2.127s | Train Loss: 0.066356 |
2020-05-27 20:33:18,902 - root - INFO - | Epoch: 067/150 | Train Time: 2.222s | Train Loss: 0.065886 |
2020-05-27 20:33:21,451 - root - INFO - | Epoch: 068/150 | Train Time: 2.548s | Train Loss: 0.067476 |
2020-05-27 20:33:24,244 - root - INFO - | Epoch: 069/150 | Train Time: 2.792s | Train Loss: 0.068029 |
2020-05-27 20:33:26,913 - root - INFO - | Epoch: 070/150 | Train Time: 2.668s | Train Loss: 0.068568 |
2020-05-27 20:33:29,648 - root - INFO - | Epoch: 071/150 | Train Time: 2.734s | Train Loss: 0.066379 |
2020-05-27 20:33:32,152 - root - INFO - | Epoch: 072/150 | Train Time: 2.504s | Train Loss: 0.068011 |
2020-05-27 20:33:34,966 - root - INFO - | Epoch: 073/150 | Train Time: 2.814s | Train Loss: 0.066539 |
2020-05-27 20:33:37,496 - root - INFO - | Epoch: 074/150 | Train Time: 2.529s | Train Loss: 0.066838 |
2020-05-27 20:33:39,974 - root - INFO - | Epoch: 075/150 | Train Time: 2.478s | Train Loss: 0.066363 |
2020-05-27 20:33:42,372 - root - INFO - | Epoch: 076/150 | Train Time: 2.397s | Train Loss: 0.067763 |
2020-05-27 20:33:44,803 - root - INFO - | Epoch: 077/150 | Train Time: 2.431s | Train Loss: 0.066267 |
2020-05-27 20:33:47,215 - root - INFO - | Epoch: 078/150 | Train Time: 2.411s | Train Loss: 0.068727 |
2020-05-27 20:33:49,769 - root - INFO - | Epoch: 079/150 | Train Time: 2.553s | Train Loss: 0.066264 |
2020-05-27 20:33:52,407 - root - INFO - | Epoch: 080/150 | Train Time: 2.637s | Train Loss: 0.067877 |
2020-05-27 20:33:55,236 - root - INFO - | Epoch: 081/150 | Train Time: 2.829s | Train Loss: 0.064454 |
2020-05-27 20:33:58,061 - root - INFO - | Epoch: 082/150 | Train Time: 2.824s | Train Loss: 0.064639 |
2020-05-27 20:34:00,548 - root - INFO - | Epoch: 083/150 | Train Time: 2.487s | Train Loss: 0.066530 |
2020-05-27 20:34:03,565 - root - INFO - | Epoch: 084/150 | Train Time: 3.016s | Train Loss: 0.064931 |
2020-05-27 20:34:06,161 - root - INFO - | Epoch: 085/150 | Train Time: 2.595s | Train Loss: 0.064240 |
2020-05-27 20:34:08,585 - root - INFO - | Epoch: 086/150 | Train Time: 2.424s | Train Loss: 0.064771 |
2020-05-27 20:34:11,552 - root - INFO - | Epoch: 087/150 | Train Time: 2.966s | Train Loss: 0.065062 |
2020-05-27 20:34:13,813 - root - INFO - | Epoch: 088/150 | Train Time: 2.261s | Train Loss: 0.066181 |
2020-05-27 20:34:16,260 - root - INFO - | Epoch: 089/150 | Train Time: 2.447s | Train Loss: 0.063130 |
2020-05-27 20:34:18,440 - root - INFO - | Epoch: 090/150 | Train Time: 2.180s | Train Loss: 0.063433 |
2020-05-27 20:34:20,843 - root - INFO - | Epoch: 091/150 | Train Time: 2.403s | Train Loss: 0.064656 |
2020-05-27 20:34:23,226 - root - INFO - | Epoch: 092/150 | Train Time: 2.382s | Train Loss: 0.063128 |
2020-05-27 20:34:25,501 - root - INFO - | Epoch: 093/150 | Train Time: 2.275s | Train Loss: 0.065016 |
2020-05-27 20:34:27,492 - root - INFO - | Epoch: 094/150 | Train Time: 1.990s | Train Loss: 0.064205 |
2020-05-27 20:34:29,514 - root - INFO - | Epoch: 095/150 | Train Time: 2.022s | Train Loss: 0.064143 |
2020-05-27 20:34:31,888 - root - INFO - | Epoch: 096/150 | Train Time: 2.373s | Train Loss: 0.065500 |
2020-05-27 20:34:34,218 - root - INFO - | Epoch: 097/150 | Train Time: 2.330s | Train Loss: 0.062966 |
2020-05-27 20:34:36,505 - root - INFO - | Epoch: 098/150 | Train Time: 2.286s | Train Loss: 0.064208 |
2020-05-27 20:34:39,004 - root - INFO - | Epoch: 099/150 | Train Time: 2.499s | Train Loss: 0.062215 |
2020-05-27 20:34:42,144 - root - INFO - | Epoch: 100/150 | Train Time: 3.139s | Train Loss: 0.063297 |
2020-05-27 20:34:44,909 - root - INFO - | Epoch: 101/150 | Train Time: 2.765s | Train Loss: 0.062481 |
2020-05-27 20:34:47,786 - root - INFO - | Epoch: 102/150 | Train Time: 2.876s | Train Loss: 0.062217 |
2020-05-27 20:34:50,704 - root - INFO - | Epoch: 103/150 | Train Time: 2.918s | Train Loss: 0.061710 |
2020-05-27 20:34:53,824 - root - INFO - | Epoch: 104/150 | Train Time: 3.120s | Train Loss: 0.063110 |
2020-05-27 20:34:56,227 - root - INFO - | Epoch: 105/150 | Train Time: 2.402s | Train Loss: 0.064509 |
2020-05-27 20:34:59,476 - root - INFO - | Epoch: 106/150 | Train Time: 3.249s | Train Loss: 0.060508 |
2020-05-27 20:35:02,382 - root - INFO - | Epoch: 107/150 | Train Time: 2.905s | Train Loss: 0.060613 |
2020-05-27 20:35:05,118 - root - INFO - | Epoch: 108/150 | Train Time: 2.736s | Train Loss: 0.062137 |
2020-05-27 20:35:08,177 - root - INFO - | Epoch: 109/150 | Train Time: 3.059s | Train Loss: 0.063363 |
2020-05-27 20:35:11,404 - root - INFO - | Epoch: 110/150 | Train Time: 3.226s | Train Loss: 0.061838 |
2020-05-27 20:35:14,327 - root - INFO - | Epoch: 111/150 | Train Time: 2.922s | Train Loss: 0.062747 |
2020-05-27 20:35:17,533 - root - INFO - | Epoch: 112/150 | Train Time: 3.206s | Train Loss: 0.061393 |
2020-05-27 20:35:20,513 - root - INFO - | Epoch: 113/150 | Train Time: 2.980s | Train Loss: 0.061906 |
2020-05-27 20:35:23,597 - root - INFO - | Epoch: 114/150 | Train Time: 3.083s | Train Loss: 0.059680 |
2020-05-27 20:35:26,498 - root - INFO - | Epoch: 115/150 | Train Time: 2.901s | Train Loss: 0.062031 |
2020-05-27 20:35:29,639 - root - INFO - | Epoch: 116/150 | Train Time: 3.140s | Train Loss: 0.061148 |
2020-05-27 20:35:32,347 - root - INFO - | Epoch: 117/150 | Train Time: 2.708s | Train Loss: 0.061788 |
2020-05-27 20:35:34,979 - root - INFO - | Epoch: 118/150 | Train Time: 2.632s | Train Loss: 0.062105 |
2020-05-27 20:35:37,576 - root - INFO - | Epoch: 119/150 | Train Time: 2.596s | Train Loss: 0.061128 |
2020-05-27 20:35:39,852 - root - INFO - | Epoch: 120/150 | Train Time: 2.276s | Train Loss: 0.060190 |
2020-05-27 20:35:41,958 - root - INFO - | Epoch: 121/150 | Train Time: 2.105s | Train Loss: 0.061606 |
2020-05-27 20:35:44,414 - root - INFO - | Epoch: 122/150 | Train Time: 2.456s | Train Loss: 0.058809 |
2020-05-27 20:35:46,713 - root - INFO - | Epoch: 123/150 | Train Time: 2.298s | Train Loss: 0.060421 |
2020-05-27 20:35:49,030 - root - INFO - | Epoch: 124/150 | Train Time: 2.316s | Train Loss: 0.059684 |
2020-05-27 20:35:51,575 - root - INFO - | Epoch: 125/150 | Train Time: 2.544s | Train Loss: 0.059842 |
2020-05-27 20:35:53,786 - root - INFO - | Epoch: 126/150 | Train Time: 2.211s | Train Loss: 0.059557 |
2020-05-27 20:35:56,591 - root - INFO - | Epoch: 127/150 | Train Time: 2.804s | Train Loss: 0.058668 |
2020-05-27 20:35:59,378 - root - INFO - | Epoch: 128/150 | Train Time: 2.787s | Train Loss: 0.060749 |
2020-05-27 20:36:01,602 - root - INFO - | Epoch: 129/150 | Train Time: 2.224s | Train Loss: 0.058275 |
2020-05-27 20:36:04,239 - root - INFO - | Epoch: 130/150 | Train Time: 2.636s | Train Loss: 0.058786 |
2020-05-27 20:36:06,432 - root - INFO - | Epoch: 131/150 | Train Time: 2.192s | Train Loss: 0.061172 |
2020-05-27 20:36:08,696 - root - INFO - | Epoch: 132/150 | Train Time: 2.264s | Train Loss: 0.059385 |
2020-05-27 20:36:10,768 - root - INFO - | Epoch: 133/150 | Train Time: 2.072s | Train Loss: 0.057346 |
2020-05-27 20:36:12,919 - root - INFO - | Epoch: 134/150 | Train Time: 2.150s | Train Loss: 0.057767 |
2020-05-27 20:36:15,143 - root - INFO - | Epoch: 135/150 | Train Time: 2.224s | Train Loss: 0.058044 |
2020-05-27 20:36:17,463 - root - INFO - | Epoch: 136/150 | Train Time: 2.319s | Train Loss: 0.057178 |
2020-05-27 20:36:19,805 - root - INFO - | Epoch: 137/150 | Train Time: 2.342s | Train Loss: 0.058551 |
2020-05-27 20:36:22,019 - root - INFO - | Epoch: 138/150 | Train Time: 2.213s | Train Loss: 0.059426 |
2020-05-27 20:36:24,431 - root - INFO - | Epoch: 139/150 | Train Time: 2.412s | Train Loss: 0.056482 |
2020-05-27 20:36:27,054 - root - INFO - | Epoch: 140/150 | Train Time: 2.623s | Train Loss: 0.057488 |
2020-05-27 20:36:29,243 - root - INFO - | Epoch: 141/150 | Train Time: 2.188s | Train Loss: 0.056709 |
2020-05-27 20:36:31,363 - root - INFO - | Epoch: 142/150 | Train Time: 2.120s | Train Loss: 0.057877 |
2020-05-27 20:36:33,867 - root - INFO - | Epoch: 143/150 | Train Time: 2.504s | Train Loss: 0.055803 |
2020-05-27 20:36:36,750 - root - INFO - | Epoch: 144/150 | Train Time: 2.882s | Train Loss: 0.057913 |
2020-05-27 20:36:38,583 - root - INFO - | Epoch: 145/150 | Train Time: 1.833s | Train Loss: 0.056438 |
2020-05-27 20:36:40,774 - root - INFO - | Epoch: 146/150 | Train Time: 2.188s | Train Loss: 0.057152 |
2020-05-27 20:36:43,016 - root - INFO - | Epoch: 147/150 | Train Time: 2.242s | Train Loss: 0.056988 |
2020-05-27 20:36:45,067 - root - INFO - | Epoch: 148/150 | Train Time: 2.050s | Train Loss: 0.058791 |
2020-05-27 20:36:47,125 - root - INFO - | Epoch: 149/150 | Train Time: 2.057s | Train Loss: 0.055518 |
2020-05-27 20:36:49,207 - root - INFO - | Epoch: 150/150 | Train Time: 2.082s | Train Loss: 0.056754 |
2020-05-27 20:36:49,207 - root - INFO - Training Time: 387.523s
2020-05-27 20:36:49,207 - root - INFO - Finished training.
2020-05-27 20:36:49,209 - root - INFO - Starting testing...
2020-05-27 20:36:52,279 - root - INFO - Test Loss: 0.545428
2020-05-27 20:36:52,280 - root - INFO - Test AUC: 76.70%
2020-05-27 20:36:52,280 - root - INFO - Test Time: 3.058s
2020-05-27 20:36:52,280 - root - INFO - Finished testing.
