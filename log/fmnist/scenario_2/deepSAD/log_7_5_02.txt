2020-05-28 03:32:15,686 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_7_5_02.txt
2020-05-28 03:32:15,686 - root - INFO - Data path is ../data
2020-05-28 03:32:15,686 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-28 03:32:15,686 - root - INFO - Dataset: fmnist
2020-05-28 03:32:15,687 - root - INFO - Normal class: 7
2020-05-28 03:32:15,687 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-28 03:32:15,687 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-28 03:32:15,687 - root - INFO - Pollution ratio of unlabeled train data: 0.20
2020-05-28 03:32:15,687 - root - INFO - Scenario Running: 2
2020-05-28 03:32:15,687 - root - INFO - Train only the network: True
2020-05-28 03:32:15,687 - root - INFO - Output and AE dimensions: 128
2020-05-28 03:32:15,687 - root - INFO - Known anomaly class: 5
2020-05-28 03:32:15,687 - root - INFO - Network: fmnist_LeNet
2020-05-28 03:32:15,687 - root - INFO - Eta-parameter: 1.00
2020-05-28 03:32:15,702 - root - INFO - Set seed to 0.
2020-05-28 03:32:15,726 - root - INFO - Computation device: cuda
2020-05-28 03:32:15,727 - root - INFO - Number of threads: 0
2020-05-28 03:32:15,727 - root - INFO - Number of dataloader workers: 6
2020-05-28 03:32:24,429 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-28 03:32:24,439 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-28 03:32:24,439 - root - INFO - Pretraining: True
2020-05-28 03:32:24,439 - root - INFO - Training optimizer: adam
2020-05-28 03:32:24,439 - root - INFO - Training learning rate: 0.0001
2020-05-28 03:32:24,440 - root - INFO - Training epochs: 150
2020-05-28 03:32:24,440 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-28 03:32:24,440 - root - INFO - Training batch size: 200
2020-05-28 03:32:24,440 - root - INFO - Training weight decay: 5e-07
2020-05-28 03:32:24,443 - root - INFO - Starting training...
2020-05-28 03:32:31,431 - root - INFO - | Epoch: 001/150 | Train Time: 6.988s | Train Loss: 1.650743 |
2020-05-28 03:32:34,485 - root - INFO - | Epoch: 002/150 | Train Time: 3.054s | Train Loss: 0.551981 |
2020-05-28 03:32:37,437 - root - INFO - | Epoch: 003/150 | Train Time: 2.951s | Train Loss: 0.392823 |
2020-05-28 03:32:39,958 - root - INFO - | Epoch: 004/150 | Train Time: 2.521s | Train Loss: 0.388908 |
2020-05-28 03:32:42,635 - root - INFO - | Epoch: 005/150 | Train Time: 2.676s | Train Loss: 0.300527 |
2020-05-28 03:32:45,692 - root - INFO - | Epoch: 006/150 | Train Time: 3.056s | Train Loss: 0.250651 |
2020-05-28 03:32:48,227 - root - INFO - | Epoch: 007/150 | Train Time: 2.535s | Train Loss: 0.253910 |
2020-05-28 03:32:51,205 - root - INFO - | Epoch: 008/150 | Train Time: 2.977s | Train Loss: 0.209196 |
2020-05-28 03:32:54,220 - root - INFO - | Epoch: 009/150 | Train Time: 3.014s | Train Loss: 0.205499 |
2020-05-28 03:32:57,426 - root - INFO - | Epoch: 010/150 | Train Time: 3.205s | Train Loss: 0.188499 |
2020-05-28 03:33:00,367 - root - INFO - | Epoch: 011/150 | Train Time: 2.941s | Train Loss: 0.179278 |
2020-05-28 03:33:03,163 - root - INFO - | Epoch: 012/150 | Train Time: 2.795s | Train Loss: 0.175602 |
2020-05-28 03:33:05,885 - root - INFO - | Epoch: 013/150 | Train Time: 2.722s | Train Loss: 0.153325 |
2020-05-28 03:33:08,504 - root - INFO - | Epoch: 014/150 | Train Time: 2.618s | Train Loss: 0.154518 |
2020-05-28 03:33:11,072 - root - INFO - | Epoch: 015/150 | Train Time: 2.568s | Train Loss: 0.154984 |
2020-05-28 03:33:14,130 - root - INFO - | Epoch: 016/150 | Train Time: 3.057s | Train Loss: 0.163934 |
2020-05-28 03:33:17,116 - root - INFO - | Epoch: 017/150 | Train Time: 2.985s | Train Loss: 0.142793 |
2020-05-28 03:33:20,214 - root - INFO - | Epoch: 018/150 | Train Time: 3.098s | Train Loss: 0.134705 |
2020-05-28 03:33:23,257 - root - INFO - | Epoch: 019/150 | Train Time: 3.033s | Train Loss: 0.131447 |
2020-05-28 03:33:26,425 - root - INFO - | Epoch: 020/150 | Train Time: 3.167s | Train Loss: 0.126237 |
2020-05-28 03:33:28,937 - root - INFO - | Epoch: 021/150 | Train Time: 2.511s | Train Loss: 0.130454 |
2020-05-28 03:33:31,977 - root - INFO - | Epoch: 022/150 | Train Time: 3.040s | Train Loss: 0.123215 |
2020-05-28 03:33:34,819 - root - INFO - | Epoch: 023/150 | Train Time: 2.841s | Train Loss: 0.131235 |
2020-05-28 03:33:37,701 - root - INFO - | Epoch: 024/150 | Train Time: 2.881s | Train Loss: 0.116675 |
2020-05-28 03:33:40,713 - root - INFO - | Epoch: 025/150 | Train Time: 3.011s | Train Loss: 0.124177 |
2020-05-28 03:33:43,545 - root - INFO - | Epoch: 026/150 | Train Time: 2.831s | Train Loss: 0.114020 |
2020-05-28 03:33:46,478 - root - INFO - | Epoch: 027/150 | Train Time: 2.932s | Train Loss: 0.111894 |
2020-05-28 03:33:49,345 - root - INFO - | Epoch: 028/150 | Train Time: 2.867s | Train Loss: 0.107911 |
2020-05-28 03:33:52,257 - root - INFO - | Epoch: 029/150 | Train Time: 2.911s | Train Loss: 0.105972 |
2020-05-28 03:33:55,244 - root - INFO - | Epoch: 030/150 | Train Time: 2.987s | Train Loss: 0.103369 |
2020-05-28 03:33:58,768 - root - INFO - | Epoch: 031/150 | Train Time: 3.523s | Train Loss: 0.103938 |
2020-05-28 03:34:02,627 - root - INFO - | Epoch: 032/150 | Train Time: 3.859s | Train Loss: 0.102987 |
2020-05-28 03:34:05,451 - root - INFO - | Epoch: 033/150 | Train Time: 2.823s | Train Loss: 0.099579 |
2020-05-28 03:34:08,307 - root - INFO - | Epoch: 034/150 | Train Time: 2.855s | Train Loss: 0.102697 |
2020-05-28 03:34:11,350 - root - INFO - | Epoch: 035/150 | Train Time: 3.043s | Train Loss: 0.094723 |
2020-05-28 03:34:13,902 - root - INFO - | Epoch: 036/150 | Train Time: 2.551s | Train Loss: 0.098427 |
2020-05-28 03:34:16,599 - root - INFO - | Epoch: 037/150 | Train Time: 2.697s | Train Loss: 0.097535 |
2020-05-28 03:34:19,559 - root - INFO - | Epoch: 038/150 | Train Time: 2.959s | Train Loss: 0.094755 |
2020-05-28 03:34:22,592 - root - INFO - | Epoch: 039/150 | Train Time: 3.032s | Train Loss: 0.088976 |
2020-05-28 03:34:25,659 - root - INFO - | Epoch: 040/150 | Train Time: 3.066s | Train Loss: 0.088864 |
2020-05-28 03:34:28,924 - root - INFO - | Epoch: 041/150 | Train Time: 3.265s | Train Loss: 0.088027 |
2020-05-28 03:34:32,096 - root - INFO - | Epoch: 042/150 | Train Time: 3.171s | Train Loss: 0.086754 |
2020-05-28 03:34:35,114 - root - INFO - | Epoch: 043/150 | Train Time: 3.017s | Train Loss: 0.084387 |
2020-05-28 03:34:37,573 - root - INFO - | Epoch: 044/150 | Train Time: 2.459s | Train Loss: 0.081882 |
2020-05-28 03:34:40,130 - root - INFO - | Epoch: 045/150 | Train Time: 2.556s | Train Loss: 0.082558 |
2020-05-28 03:34:43,074 - root - INFO - | Epoch: 046/150 | Train Time: 2.944s | Train Loss: 0.080043 |
2020-05-28 03:34:46,149 - root - INFO - | Epoch: 047/150 | Train Time: 3.074s | Train Loss: 0.075825 |
2020-05-28 03:34:49,220 - root - INFO - | Epoch: 048/150 | Train Time: 3.071s | Train Loss: 0.074811 |
2020-05-28 03:34:52,420 - root - INFO - | Epoch: 049/150 | Train Time: 3.200s | Train Loss: 0.075261 |
2020-05-28 03:34:56,022 - root - INFO - | Epoch: 050/150 | Train Time: 3.601s | Train Loss: 0.069807 |
2020-05-28 03:34:56,022 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-28 03:34:58,857 - root - INFO - | Epoch: 051/150 | Train Time: 2.835s | Train Loss: 0.071942 |
2020-05-28 03:35:01,811 - root - INFO - | Epoch: 052/150 | Train Time: 2.953s | Train Loss: 0.079308 |
2020-05-28 03:35:04,941 - root - INFO - | Epoch: 053/150 | Train Time: 3.130s | Train Loss: 0.068639 |
2020-05-28 03:35:08,262 - root - INFO - | Epoch: 054/150 | Train Time: 3.320s | Train Loss: 0.068929 |
2020-05-28 03:35:11,363 - root - INFO - | Epoch: 055/150 | Train Time: 3.101s | Train Loss: 0.070054 |
2020-05-28 03:35:14,476 - root - INFO - | Epoch: 056/150 | Train Time: 3.112s | Train Loss: 0.068912 |
2020-05-28 03:35:17,506 - root - INFO - | Epoch: 057/150 | Train Time: 3.030s | Train Loss: 0.072776 |
2020-05-28 03:35:20,669 - root - INFO - | Epoch: 058/150 | Train Time: 3.163s | Train Loss: 0.072948 |
2020-05-28 03:35:23,796 - root - INFO - | Epoch: 059/150 | Train Time: 3.126s | Train Loss: 0.068776 |
2020-05-28 03:35:26,827 - root - INFO - | Epoch: 060/150 | Train Time: 3.030s | Train Loss: 0.067708 |
2020-05-28 03:35:29,480 - root - INFO - | Epoch: 061/150 | Train Time: 2.652s | Train Loss: 0.069065 |
2020-05-28 03:35:32,457 - root - INFO - | Epoch: 062/150 | Train Time: 2.977s | Train Loss: 0.071107 |
2020-05-28 03:35:35,926 - root - INFO - | Epoch: 063/150 | Train Time: 3.468s | Train Loss: 0.074536 |
2020-05-28 03:35:38,978 - root - INFO - | Epoch: 064/150 | Train Time: 3.051s | Train Loss: 0.071829 |
2020-05-28 03:35:41,864 - root - INFO - | Epoch: 065/150 | Train Time: 2.885s | Train Loss: 0.068315 |
2020-05-28 03:35:44,531 - root - INFO - | Epoch: 066/150 | Train Time: 2.667s | Train Loss: 0.067786 |
2020-05-28 03:35:47,453 - root - INFO - | Epoch: 067/150 | Train Time: 2.921s | Train Loss: 0.067821 |
2020-05-28 03:35:50,847 - root - INFO - | Epoch: 068/150 | Train Time: 3.394s | Train Loss: 0.067766 |
2020-05-28 03:35:54,063 - root - INFO - | Epoch: 069/150 | Train Time: 3.215s | Train Loss: 0.070555 |
2020-05-28 03:35:56,904 - root - INFO - | Epoch: 070/150 | Train Time: 2.840s | Train Loss: 0.067788 |
2020-05-28 03:35:59,399 - root - INFO - | Epoch: 071/150 | Train Time: 2.494s | Train Loss: 0.071299 |
2020-05-28 03:36:03,162 - root - INFO - | Epoch: 072/150 | Train Time: 3.763s | Train Loss: 0.068769 |
2020-05-28 03:36:06,756 - root - INFO - | Epoch: 073/150 | Train Time: 3.594s | Train Loss: 0.073919 |
2020-05-28 03:36:09,951 - root - INFO - | Epoch: 074/150 | Train Time: 3.194s | Train Loss: 0.069789 |
2020-05-28 03:36:12,842 - root - INFO - | Epoch: 075/150 | Train Time: 2.891s | Train Loss: 0.065476 |
2020-05-28 03:36:15,100 - root - INFO - | Epoch: 076/150 | Train Time: 2.257s | Train Loss: 0.066708 |
2020-05-28 03:36:17,763 - root - INFO - | Epoch: 077/150 | Train Time: 2.662s | Train Loss: 0.066161 |
2020-05-28 03:36:20,547 - root - INFO - | Epoch: 078/150 | Train Time: 2.784s | Train Loss: 0.066992 |
2020-05-28 03:36:22,979 - root - INFO - | Epoch: 079/150 | Train Time: 2.431s | Train Loss: 0.069205 |
2020-05-28 03:36:25,803 - root - INFO - | Epoch: 080/150 | Train Time: 2.824s | Train Loss: 0.066317 |
2020-05-28 03:36:29,139 - root - INFO - | Epoch: 081/150 | Train Time: 3.335s | Train Loss: 0.067877 |
2020-05-28 03:36:31,536 - root - INFO - | Epoch: 082/150 | Train Time: 2.396s | Train Loss: 0.067283 |
2020-05-28 03:36:34,581 - root - INFO - | Epoch: 083/150 | Train Time: 3.045s | Train Loss: 0.066871 |
2020-05-28 03:36:37,870 - root - INFO - | Epoch: 084/150 | Train Time: 3.288s | Train Loss: 0.067590 |
2020-05-28 03:36:41,239 - root - INFO - | Epoch: 085/150 | Train Time: 3.368s | Train Loss: 0.063361 |
2020-05-28 03:36:44,419 - root - INFO - | Epoch: 086/150 | Train Time: 3.179s | Train Loss: 0.067615 |
2020-05-28 03:36:47,470 - root - INFO - | Epoch: 087/150 | Train Time: 3.050s | Train Loss: 0.067370 |
2020-05-28 03:36:50,287 - root - INFO - | Epoch: 088/150 | Train Time: 2.817s | Train Loss: 0.067480 |
2020-05-28 03:36:53,031 - root - INFO - | Epoch: 089/150 | Train Time: 2.744s | Train Loss: 0.064604 |
2020-05-28 03:36:56,271 - root - INFO - | Epoch: 090/150 | Train Time: 3.239s | Train Loss: 0.062906 |
2020-05-28 03:36:59,126 - root - INFO - | Epoch: 091/150 | Train Time: 2.854s | Train Loss: 0.067850 |
2020-05-28 03:37:02,355 - root - INFO - | Epoch: 092/150 | Train Time: 3.228s | Train Loss: 0.063433 |
2020-05-28 03:37:05,145 - root - INFO - | Epoch: 093/150 | Train Time: 2.789s | Train Loss: 0.062679 |
2020-05-28 03:37:08,075 - root - INFO - | Epoch: 094/150 | Train Time: 2.929s | Train Loss: 0.063103 |
2020-05-28 03:37:10,672 - root - INFO - | Epoch: 095/150 | Train Time: 2.597s | Train Loss: 0.065823 |
2020-05-28 03:37:13,743 - root - INFO - | Epoch: 096/150 | Train Time: 3.070s | Train Loss: 0.062855 |
2020-05-28 03:37:16,980 - root - INFO - | Epoch: 097/150 | Train Time: 3.237s | Train Loss: 0.066304 |
2020-05-28 03:37:19,946 - root - INFO - | Epoch: 098/150 | Train Time: 2.965s | Train Loss: 0.062105 |
2020-05-28 03:37:23,150 - root - INFO - | Epoch: 099/150 | Train Time: 3.203s | Train Loss: 0.065245 |
2020-05-28 03:37:25,755 - root - INFO - | Epoch: 100/150 | Train Time: 2.605s | Train Loss: 0.061981 |
2020-05-28 03:37:28,293 - root - INFO - | Epoch: 101/150 | Train Time: 2.537s | Train Loss: 0.061226 |
2020-05-28 03:37:30,897 - root - INFO - | Epoch: 102/150 | Train Time: 2.604s | Train Loss: 0.061046 |
2020-05-28 03:37:34,487 - root - INFO - | Epoch: 103/150 | Train Time: 3.589s | Train Loss: 0.065418 |
2020-05-28 03:37:37,423 - root - INFO - | Epoch: 104/150 | Train Time: 2.935s | Train Loss: 0.059877 |
2020-05-28 03:37:40,740 - root - INFO - | Epoch: 105/150 | Train Time: 3.316s | Train Loss: 0.063613 |
2020-05-28 03:37:43,686 - root - INFO - | Epoch: 106/150 | Train Time: 2.945s | Train Loss: 0.060219 |
2020-05-28 03:37:46,592 - root - INFO - | Epoch: 107/150 | Train Time: 2.905s | Train Loss: 0.059002 |
2020-05-28 03:37:49,229 - root - INFO - | Epoch: 108/150 | Train Time: 2.636s | Train Loss: 0.059400 |
2020-05-28 03:37:51,919 - root - INFO - | Epoch: 109/150 | Train Time: 2.690s | Train Loss: 0.062688 |
2020-05-28 03:37:55,264 - root - INFO - | Epoch: 110/150 | Train Time: 3.345s | Train Loss: 0.058274 |
2020-05-28 03:37:58,440 - root - INFO - | Epoch: 111/150 | Train Time: 3.175s | Train Loss: 0.059474 |
2020-05-28 03:38:01,802 - root - INFO - | Epoch: 112/150 | Train Time: 3.362s | Train Loss: 0.060855 |
2020-05-28 03:38:05,149 - root - INFO - | Epoch: 113/150 | Train Time: 3.346s | Train Loss: 0.064689 |
2020-05-28 03:38:08,206 - root - INFO - | Epoch: 114/150 | Train Time: 3.057s | Train Loss: 0.061306 |
2020-05-28 03:38:11,541 - root - INFO - | Epoch: 115/150 | Train Time: 3.335s | Train Loss: 0.060617 |
2020-05-28 03:38:14,703 - root - INFO - | Epoch: 116/150 | Train Time: 3.161s | Train Loss: 0.062848 |
2020-05-28 03:38:17,842 - root - INFO - | Epoch: 117/150 | Train Time: 3.138s | Train Loss: 0.062842 |
2020-05-28 03:38:20,990 - root - INFO - | Epoch: 118/150 | Train Time: 3.147s | Train Loss: 0.061306 |
2020-05-28 03:38:24,017 - root - INFO - | Epoch: 119/150 | Train Time: 3.026s | Train Loss: 0.056897 |
2020-05-28 03:38:27,152 - root - INFO - | Epoch: 120/150 | Train Time: 3.134s | Train Loss: 0.058362 |
2020-05-28 03:38:30,206 - root - INFO - | Epoch: 121/150 | Train Time: 3.054s | Train Loss: 0.063031 |
2020-05-28 03:38:33,294 - root - INFO - | Epoch: 122/150 | Train Time: 3.088s | Train Loss: 0.059252 |
2020-05-28 03:38:36,086 - root - INFO - | Epoch: 123/150 | Train Time: 2.792s | Train Loss: 0.058535 |
2020-05-28 03:38:38,860 - root - INFO - | Epoch: 124/150 | Train Time: 2.773s | Train Loss: 0.061761 |
2020-05-28 03:38:41,872 - root - INFO - | Epoch: 125/150 | Train Time: 3.012s | Train Loss: 0.057293 |
2020-05-28 03:38:44,624 - root - INFO - | Epoch: 126/150 | Train Time: 2.751s | Train Loss: 0.060354 |
2020-05-28 03:38:47,231 - root - INFO - | Epoch: 127/150 | Train Time: 2.607s | Train Loss: 0.057892 |
2020-05-28 03:38:49,838 - root - INFO - | Epoch: 128/150 | Train Time: 2.606s | Train Loss: 0.058069 |
2020-05-28 03:38:52,551 - root - INFO - | Epoch: 129/150 | Train Time: 2.712s | Train Loss: 0.058539 |
2020-05-28 03:38:54,892 - root - INFO - | Epoch: 130/150 | Train Time: 2.341s | Train Loss: 0.056704 |
2020-05-28 03:38:57,229 - root - INFO - | Epoch: 131/150 | Train Time: 2.336s | Train Loss: 0.058828 |
2020-05-28 03:38:59,622 - root - INFO - | Epoch: 132/150 | Train Time: 2.392s | Train Loss: 0.056504 |
2020-05-28 03:39:02,585 - root - INFO - | Epoch: 133/150 | Train Time: 2.962s | Train Loss: 0.057907 |
2020-05-28 03:39:05,779 - root - INFO - | Epoch: 134/150 | Train Time: 3.194s | Train Loss: 0.056809 |
2020-05-28 03:39:09,035 - root - INFO - | Epoch: 135/150 | Train Time: 3.256s | Train Loss: 0.054481 |
2020-05-28 03:39:12,435 - root - INFO - | Epoch: 136/150 | Train Time: 3.399s | Train Loss: 0.054213 |
2020-05-28 03:39:16,343 - root - INFO - | Epoch: 137/150 | Train Time: 3.908s | Train Loss: 0.056073 |
2020-05-28 03:39:19,506 - root - INFO - | Epoch: 138/150 | Train Time: 3.163s | Train Loss: 0.055153 |
2020-05-28 03:39:22,172 - root - INFO - | Epoch: 139/150 | Train Time: 2.666s | Train Loss: 0.057793 |
2020-05-28 03:39:25,281 - root - INFO - | Epoch: 140/150 | Train Time: 3.108s | Train Loss: 0.054209 |
2020-05-28 03:39:28,415 - root - INFO - | Epoch: 141/150 | Train Time: 3.134s | Train Loss: 0.056645 |
2020-05-28 03:39:32,124 - root - INFO - | Epoch: 142/150 | Train Time: 3.708s | Train Loss: 0.051679 |
2020-05-28 03:39:35,413 - root - INFO - | Epoch: 143/150 | Train Time: 3.289s | Train Loss: 0.056562 |
2020-05-28 03:39:38,604 - root - INFO - | Epoch: 144/150 | Train Time: 3.190s | Train Loss: 0.055316 |
2020-05-28 03:39:42,013 - root - INFO - | Epoch: 145/150 | Train Time: 3.408s | Train Loss: 0.054242 |
2020-05-28 03:39:45,287 - root - INFO - | Epoch: 146/150 | Train Time: 3.273s | Train Loss: 0.054973 |
2020-05-28 03:39:47,509 - root - INFO - | Epoch: 147/150 | Train Time: 2.221s | Train Loss: 0.052331 |
2020-05-28 03:39:49,539 - root - INFO - | Epoch: 148/150 | Train Time: 2.029s | Train Loss: 0.052472 |
2020-05-28 03:39:51,432 - root - INFO - | Epoch: 149/150 | Train Time: 1.893s | Train Loss: 0.053020 |
2020-05-28 03:39:53,992 - root - INFO - | Epoch: 150/150 | Train Time: 2.559s | Train Loss: 0.052027 |
2020-05-28 03:39:53,992 - root - INFO - Training Time: 449.549s
2020-05-28 03:39:53,992 - root - INFO - Finished training.
2020-05-28 03:39:53,994 - root - INFO - Starting testing...
2020-05-28 03:39:57,332 - root - INFO - Test Loss: 0.253896
2020-05-28 03:39:57,332 - root - INFO - Test AUC: 90.22%
2020-05-28 03:39:57,332 - root - INFO - Test Time: 3.319s
2020-05-28 03:39:57,332 - root - INFO - Finished testing.
