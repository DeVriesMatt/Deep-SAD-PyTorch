2020-05-28 09:01:42,936 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_8_6_001.txt
2020-05-28 09:01:42,936 - root - INFO - Data path is ../data
2020-05-28 09:01:42,937 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-28 09:01:42,937 - root - INFO - Dataset: fmnist
2020-05-28 09:01:42,937 - root - INFO - Normal class: 8
2020-05-28 09:01:42,938 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-28 09:01:42,938 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-28 09:01:42,939 - root - INFO - Pollution ratio of unlabeled train data: 0.01
2020-05-28 09:01:42,939 - root - INFO - Scenario Running: 2
2020-05-28 09:01:42,939 - root - INFO - Train only the network: True
2020-05-28 09:01:42,940 - root - INFO - Output and AE dimensions: 128
2020-05-28 09:01:42,940 - root - INFO - Known anomaly class: 6
2020-05-28 09:01:42,941 - root - INFO - Network: fmnist_LeNet
2020-05-28 09:01:42,941 - root - INFO - Eta-parameter: 1.00
2020-05-28 09:01:42,950 - root - INFO - Set seed to 0.
2020-05-28 09:01:43,023 - root - INFO - Computation device: cuda
2020-05-28 09:01:43,023 - root - INFO - Number of threads: 0
2020-05-28 09:01:43,024 - root - INFO - Number of dataloader workers: 6
2020-05-28 09:01:52,024 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-28 09:01:52,036 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-28 09:01:52,037 - root - INFO - Pretraining: True
2020-05-28 09:01:52,037 - root - INFO - Training optimizer: adam
2020-05-28 09:01:52,037 - root - INFO - Training learning rate: 0.0001
2020-05-28 09:01:52,037 - root - INFO - Training epochs: 150
2020-05-28 09:01:52,037 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-28 09:01:52,037 - root - INFO - Training batch size: 200
2020-05-28 09:01:52,037 - root - INFO - Training weight decay: 5e-07
2020-05-28 09:01:52,040 - root - INFO - Starting training...
2020-05-28 09:01:57,915 - root - INFO - | Epoch: 001/150 | Train Time: 5.875s | Train Loss: 2.603867 |
2020-05-28 09:02:00,322 - root - INFO - | Epoch: 002/150 | Train Time: 2.405s | Train Loss: 0.605292 |
2020-05-28 09:02:03,253 - root - INFO - | Epoch: 003/150 | Train Time: 2.931s | Train Loss: 0.389659 |
2020-05-28 09:02:05,780 - root - INFO - | Epoch: 004/150 | Train Time: 2.526s | Train Loss: 0.305024 |
2020-05-28 09:02:08,893 - root - INFO - | Epoch: 005/150 | Train Time: 3.113s | Train Loss: 0.253990 |
2020-05-28 09:02:12,081 - root - INFO - | Epoch: 006/150 | Train Time: 3.188s | Train Loss: 0.218061 |
2020-05-28 09:02:15,315 - root - INFO - | Epoch: 007/150 | Train Time: 3.233s | Train Loss: 0.193274 |
2020-05-28 09:02:18,019 - root - INFO - | Epoch: 008/150 | Train Time: 2.704s | Train Loss: 0.174858 |
2020-05-28 09:02:20,673 - root - INFO - | Epoch: 009/150 | Train Time: 2.652s | Train Loss: 0.161255 |
2020-05-28 09:02:23,228 - root - INFO - | Epoch: 010/150 | Train Time: 2.554s | Train Loss: 0.149548 |
2020-05-28 09:02:26,298 - root - INFO - | Epoch: 011/150 | Train Time: 3.069s | Train Loss: 0.140532 |
2020-05-28 09:02:28,739 - root - INFO - | Epoch: 012/150 | Train Time: 2.440s | Train Loss: 0.133229 |
2020-05-28 09:02:31,363 - root - INFO - | Epoch: 013/150 | Train Time: 2.623s | Train Loss: 0.126831 |
2020-05-28 09:02:33,862 - root - INFO - | Epoch: 014/150 | Train Time: 2.499s | Train Loss: 0.122325 |
2020-05-28 09:02:36,206 - root - INFO - | Epoch: 015/150 | Train Time: 2.343s | Train Loss: 0.117253 |
2020-05-28 09:02:38,790 - root - INFO - | Epoch: 016/150 | Train Time: 2.583s | Train Loss: 0.114829 |
2020-05-28 09:02:41,216 - root - INFO - | Epoch: 017/150 | Train Time: 2.426s | Train Loss: 0.110692 |
2020-05-28 09:02:43,831 - root - INFO - | Epoch: 018/150 | Train Time: 2.615s | Train Loss: 0.109680 |
2020-05-28 09:02:46,292 - root - INFO - | Epoch: 019/150 | Train Time: 2.460s | Train Loss: 0.103355 |
2020-05-28 09:02:48,674 - root - INFO - | Epoch: 020/150 | Train Time: 2.380s | Train Loss: 0.101584 |
2020-05-28 09:02:50,831 - root - INFO - | Epoch: 021/150 | Train Time: 2.157s | Train Loss: 0.100359 |
2020-05-28 09:02:53,150 - root - INFO - | Epoch: 022/150 | Train Time: 2.318s | Train Loss: 0.096881 |
2020-05-28 09:02:55,796 - root - INFO - | Epoch: 023/150 | Train Time: 2.646s | Train Loss: 0.095228 |
2020-05-28 09:02:58,410 - root - INFO - | Epoch: 024/150 | Train Time: 2.613s | Train Loss: 0.093266 |
2020-05-28 09:03:00,721 - root - INFO - | Epoch: 025/150 | Train Time: 2.310s | Train Loss: 0.091683 |
2020-05-28 09:03:03,357 - root - INFO - | Epoch: 026/150 | Train Time: 2.636s | Train Loss: 0.086754 |
2020-05-28 09:03:06,302 - root - INFO - | Epoch: 027/150 | Train Time: 2.943s | Train Loss: 0.089568 |
2020-05-28 09:03:09,213 - root - INFO - | Epoch: 028/150 | Train Time: 2.911s | Train Loss: 0.088722 |
2020-05-28 09:03:11,958 - root - INFO - | Epoch: 029/150 | Train Time: 2.745s | Train Loss: 0.082458 |
2020-05-28 09:03:14,400 - root - INFO - | Epoch: 030/150 | Train Time: 2.441s | Train Loss: 0.080952 |
2020-05-28 09:03:17,085 - root - INFO - | Epoch: 031/150 | Train Time: 2.685s | Train Loss: 0.080444 |
2020-05-28 09:03:20,011 - root - INFO - | Epoch: 032/150 | Train Time: 2.926s | Train Loss: 0.080184 |
2020-05-28 09:03:22,798 - root - INFO - | Epoch: 033/150 | Train Time: 2.786s | Train Loss: 0.079493 |
2020-05-28 09:03:25,639 - root - INFO - | Epoch: 034/150 | Train Time: 2.840s | Train Loss: 0.075713 |
2020-05-28 09:03:28,387 - root - INFO - | Epoch: 035/150 | Train Time: 2.748s | Train Loss: 0.077554 |
2020-05-28 09:03:30,828 - root - INFO - | Epoch: 036/150 | Train Time: 2.440s | Train Loss: 0.073978 |
2020-05-28 09:03:32,949 - root - INFO - | Epoch: 037/150 | Train Time: 2.121s | Train Loss: 0.073149 |
2020-05-28 09:03:35,166 - root - INFO - | Epoch: 038/150 | Train Time: 2.217s | Train Loss: 0.072146 |
2020-05-28 09:03:37,338 - root - INFO - | Epoch: 039/150 | Train Time: 2.171s | Train Loss: 0.070765 |
2020-05-28 09:03:40,001 - root - INFO - | Epoch: 040/150 | Train Time: 2.663s | Train Loss: 0.071432 |
2020-05-28 09:03:42,464 - root - INFO - | Epoch: 041/150 | Train Time: 2.462s | Train Loss: 0.068417 |
2020-05-28 09:03:44,875 - root - INFO - | Epoch: 042/150 | Train Time: 2.411s | Train Loss: 0.068619 |
2020-05-28 09:03:46,900 - root - INFO - | Epoch: 043/150 | Train Time: 2.024s | Train Loss: 0.070054 |
2020-05-28 09:03:48,942 - root - INFO - | Epoch: 044/150 | Train Time: 2.041s | Train Loss: 0.066605 |
2020-05-28 09:03:51,152 - root - INFO - | Epoch: 045/150 | Train Time: 2.210s | Train Loss: 0.065929 |
2020-05-28 09:03:53,744 - root - INFO - | Epoch: 046/150 | Train Time: 2.591s | Train Loss: 0.064621 |
2020-05-28 09:03:55,933 - root - INFO - | Epoch: 047/150 | Train Time: 2.189s | Train Loss: 0.066645 |
2020-05-28 09:03:58,389 - root - INFO - | Epoch: 048/150 | Train Time: 2.455s | Train Loss: 0.063714 |
2020-05-28 09:04:01,119 - root - INFO - | Epoch: 049/150 | Train Time: 2.729s | Train Loss: 0.061017 |
2020-05-28 09:04:03,610 - root - INFO - | Epoch: 050/150 | Train Time: 2.490s | Train Loss: 0.057431 |
2020-05-28 09:04:03,610 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-28 09:04:06,498 - root - INFO - | Epoch: 051/150 | Train Time: 2.888s | Train Loss: 0.056709 |
2020-05-28 09:04:09,257 - root - INFO - | Epoch: 052/150 | Train Time: 2.758s | Train Loss: 0.056888 |
2020-05-28 09:04:11,984 - root - INFO - | Epoch: 053/150 | Train Time: 2.727s | Train Loss: 0.057028 |
2020-05-28 09:04:14,883 - root - INFO - | Epoch: 054/150 | Train Time: 2.898s | Train Loss: 0.057363 |
2020-05-28 09:04:17,713 - root - INFO - | Epoch: 055/150 | Train Time: 2.830s | Train Loss: 0.055865 |
2020-05-28 09:04:20,246 - root - INFO - | Epoch: 056/150 | Train Time: 2.532s | Train Loss: 0.056662 |
2020-05-28 09:04:22,837 - root - INFO - | Epoch: 057/150 | Train Time: 2.590s | Train Loss: 0.056832 |
2020-05-28 09:04:25,605 - root - INFO - | Epoch: 058/150 | Train Time: 2.768s | Train Loss: 0.057416 |
2020-05-28 09:04:28,684 - root - INFO - | Epoch: 059/150 | Train Time: 3.078s | Train Loss: 0.057515 |
2020-05-28 09:04:31,391 - root - INFO - | Epoch: 060/150 | Train Time: 2.706s | Train Loss: 0.055127 |
2020-05-28 09:04:34,041 - root - INFO - | Epoch: 061/150 | Train Time: 2.650s | Train Loss: 0.056690 |
2020-05-28 09:04:36,696 - root - INFO - | Epoch: 062/150 | Train Time: 2.654s | Train Loss: 0.056865 |
2020-05-28 09:04:39,748 - root - INFO - | Epoch: 063/150 | Train Time: 3.051s | Train Loss: 0.055354 |
2020-05-28 09:04:42,427 - root - INFO - | Epoch: 064/150 | Train Time: 2.678s | Train Loss: 0.057330 |
2020-05-28 09:04:45,437 - root - INFO - | Epoch: 065/150 | Train Time: 3.010s | Train Loss: 0.057956 |
2020-05-28 09:04:47,263 - root - INFO - | Epoch: 066/150 | Train Time: 1.825s | Train Loss: 0.055582 |
2020-05-28 09:04:49,747 - root - INFO - | Epoch: 067/150 | Train Time: 2.483s | Train Loss: 0.055144 |
2020-05-28 09:04:52,553 - root - INFO - | Epoch: 068/150 | Train Time: 2.805s | Train Loss: 0.057460 |
2020-05-28 09:04:54,824 - root - INFO - | Epoch: 069/150 | Train Time: 2.271s | Train Loss: 0.055337 |
2020-05-28 09:04:57,993 - root - INFO - | Epoch: 070/150 | Train Time: 3.168s | Train Loss: 0.057555 |
2020-05-28 09:05:00,944 - root - INFO - | Epoch: 071/150 | Train Time: 2.951s | Train Loss: 0.055496 |
2020-05-28 09:05:03,705 - root - INFO - | Epoch: 072/150 | Train Time: 2.760s | Train Loss: 0.055674 |
2020-05-28 09:05:05,788 - root - INFO - | Epoch: 073/150 | Train Time: 2.082s | Train Loss: 0.055122 |
2020-05-28 09:05:08,060 - root - INFO - | Epoch: 074/150 | Train Time: 2.271s | Train Loss: 0.057036 |
2020-05-28 09:05:10,515 - root - INFO - | Epoch: 075/150 | Train Time: 2.454s | Train Loss: 0.055586 |
2020-05-28 09:05:12,878 - root - INFO - | Epoch: 076/150 | Train Time: 2.363s | Train Loss: 0.056499 |
2020-05-28 09:05:15,626 - root - INFO - | Epoch: 077/150 | Train Time: 2.747s | Train Loss: 0.055671 |
2020-05-28 09:05:18,502 - root - INFO - | Epoch: 078/150 | Train Time: 2.875s | Train Loss: 0.055873 |
2020-05-28 09:05:21,137 - root - INFO - | Epoch: 079/150 | Train Time: 2.634s | Train Loss: 0.054851 |
2020-05-28 09:05:23,727 - root - INFO - | Epoch: 080/150 | Train Time: 2.589s | Train Loss: 0.055522 |
2020-05-28 09:05:26,419 - root - INFO - | Epoch: 081/150 | Train Time: 2.692s | Train Loss: 0.054391 |
2020-05-28 09:05:29,379 - root - INFO - | Epoch: 082/150 | Train Time: 2.960s | Train Loss: 0.054922 |
2020-05-28 09:05:32,149 - root - INFO - | Epoch: 083/150 | Train Time: 2.769s | Train Loss: 0.055246 |
2020-05-28 09:05:34,665 - root - INFO - | Epoch: 084/150 | Train Time: 2.515s | Train Loss: 0.054373 |
2020-05-28 09:05:37,276 - root - INFO - | Epoch: 085/150 | Train Time: 2.611s | Train Loss: 0.055007 |
2020-05-28 09:05:39,764 - root - INFO - | Epoch: 086/150 | Train Time: 2.487s | Train Loss: 0.053855 |
2020-05-28 09:05:42,570 - root - INFO - | Epoch: 087/150 | Train Time: 2.806s | Train Loss: 0.054122 |
2020-05-28 09:05:44,923 - root - INFO - | Epoch: 088/150 | Train Time: 2.352s | Train Loss: 0.054599 |
2020-05-28 09:05:46,821 - root - INFO - | Epoch: 089/150 | Train Time: 1.898s | Train Loss: 0.053974 |
2020-05-28 09:05:49,031 - root - INFO - | Epoch: 090/150 | Train Time: 2.209s | Train Loss: 0.052806 |
2020-05-28 09:05:51,127 - root - INFO - | Epoch: 091/150 | Train Time: 2.095s | Train Loss: 0.054285 |
2020-05-28 09:05:53,246 - root - INFO - | Epoch: 092/150 | Train Time: 2.119s | Train Loss: 0.052499 |
2020-05-28 09:05:55,312 - root - INFO - | Epoch: 093/150 | Train Time: 2.066s | Train Loss: 0.051561 |
2020-05-28 09:05:57,786 - root - INFO - | Epoch: 094/150 | Train Time: 2.473s | Train Loss: 0.052716 |
2020-05-28 09:06:00,351 - root - INFO - | Epoch: 095/150 | Train Time: 2.564s | Train Loss: 0.054865 |
2020-05-28 09:06:02,705 - root - INFO - | Epoch: 096/150 | Train Time: 2.353s | Train Loss: 0.054452 |
2020-05-28 09:06:05,389 - root - INFO - | Epoch: 097/150 | Train Time: 2.683s | Train Loss: 0.053599 |
2020-05-28 09:06:07,688 - root - INFO - | Epoch: 098/150 | Train Time: 2.299s | Train Loss: 0.052426 |
2020-05-28 09:06:09,661 - root - INFO - | Epoch: 099/150 | Train Time: 1.970s | Train Loss: 0.050944 |
2020-05-28 09:06:11,704 - root - INFO - | Epoch: 100/150 | Train Time: 2.043s | Train Loss: 0.053280 |
2020-05-28 09:06:13,617 - root - INFO - | Epoch: 101/150 | Train Time: 1.911s | Train Loss: 0.052265 |
2020-05-28 09:06:15,710 - root - INFO - | Epoch: 102/150 | Train Time: 2.093s | Train Loss: 0.052693 |
2020-05-28 09:06:18,005 - root - INFO - | Epoch: 103/150 | Train Time: 2.294s | Train Loss: 0.051972 |
2020-05-28 09:06:20,689 - root - INFO - | Epoch: 104/150 | Train Time: 2.684s | Train Loss: 0.053191 |
2020-05-28 09:06:23,274 - root - INFO - | Epoch: 105/150 | Train Time: 2.584s | Train Loss: 0.054957 |
2020-05-28 09:06:25,391 - root - INFO - | Epoch: 106/150 | Train Time: 2.117s | Train Loss: 0.050603 |
2020-05-28 09:06:27,869 - root - INFO - | Epoch: 107/150 | Train Time: 2.477s | Train Loss: 0.050427 |
2020-05-28 09:06:30,132 - root - INFO - | Epoch: 108/150 | Train Time: 2.263s | Train Loss: 0.052782 |
2020-05-28 09:06:32,353 - root - INFO - | Epoch: 109/150 | Train Time: 2.220s | Train Loss: 0.052223 |
2020-05-28 09:06:34,933 - root - INFO - | Epoch: 110/150 | Train Time: 2.580s | Train Loss: 0.054669 |
2020-05-28 09:06:37,165 - root - INFO - | Epoch: 111/150 | Train Time: 2.231s | Train Loss: 0.052494 |
2020-05-28 09:06:39,593 - root - INFO - | Epoch: 112/150 | Train Time: 2.428s | Train Loss: 0.050809 |
2020-05-28 09:06:42,022 - root - INFO - | Epoch: 113/150 | Train Time: 2.429s | Train Loss: 0.051244 |
2020-05-28 09:06:44,622 - root - INFO - | Epoch: 114/150 | Train Time: 2.599s | Train Loss: 0.048894 |
2020-05-28 09:06:47,632 - root - INFO - | Epoch: 115/150 | Train Time: 3.010s | Train Loss: 0.050773 |
2020-05-28 09:06:50,242 - root - INFO - | Epoch: 116/150 | Train Time: 2.609s | Train Loss: 0.049880 |
2020-05-28 09:06:52,891 - root - INFO - | Epoch: 117/150 | Train Time: 2.648s | Train Loss: 0.049784 |
2020-05-28 09:06:55,203 - root - INFO - | Epoch: 118/150 | Train Time: 2.312s | Train Loss: 0.051381 |
2020-05-28 09:06:58,180 - root - INFO - | Epoch: 119/150 | Train Time: 2.976s | Train Loss: 0.050177 |
2020-05-28 09:07:01,008 - root - INFO - | Epoch: 120/150 | Train Time: 2.828s | Train Loss: 0.050469 |
2020-05-28 09:07:03,496 - root - INFO - | Epoch: 121/150 | Train Time: 2.488s | Train Loss: 0.049093 |
2020-05-28 09:07:06,472 - root - INFO - | Epoch: 122/150 | Train Time: 2.975s | Train Loss: 0.048136 |
2020-05-28 09:07:09,422 - root - INFO - | Epoch: 123/150 | Train Time: 2.949s | Train Loss: 0.049343 |
2020-05-28 09:07:12,225 - root - INFO - | Epoch: 124/150 | Train Time: 2.802s | Train Loss: 0.049250 |
2020-05-28 09:07:14,777 - root - INFO - | Epoch: 125/150 | Train Time: 2.552s | Train Loss: 0.051315 |
2020-05-28 09:07:17,484 - root - INFO - | Epoch: 126/150 | Train Time: 2.707s | Train Loss: 0.049868 |
2020-05-28 09:07:20,820 - root - INFO - | Epoch: 127/150 | Train Time: 3.336s | Train Loss: 0.047582 |
2020-05-28 09:07:23,355 - root - INFO - | Epoch: 128/150 | Train Time: 2.534s | Train Loss: 0.049470 |
2020-05-28 09:07:26,100 - root - INFO - | Epoch: 129/150 | Train Time: 2.745s | Train Loss: 0.048205 |
2020-05-28 09:07:28,188 - root - INFO - | Epoch: 130/150 | Train Time: 2.087s | Train Loss: 0.050958 |
2020-05-28 09:07:30,511 - root - INFO - | Epoch: 131/150 | Train Time: 2.322s | Train Loss: 0.048211 |
2020-05-28 09:07:33,392 - root - INFO - | Epoch: 132/150 | Train Time: 2.880s | Train Loss: 0.049999 |
2020-05-28 09:07:35,655 - root - INFO - | Epoch: 133/150 | Train Time: 2.263s | Train Loss: 0.047744 |
2020-05-28 09:07:38,301 - root - INFO - | Epoch: 134/150 | Train Time: 2.645s | Train Loss: 0.048407 |
2020-05-28 09:07:40,199 - root - INFO - | Epoch: 135/150 | Train Time: 1.898s | Train Loss: 0.048401 |
2020-05-28 09:07:42,192 - root - INFO - | Epoch: 136/150 | Train Time: 1.992s | Train Loss: 0.048279 |
2020-05-28 09:07:44,435 - root - INFO - | Epoch: 137/150 | Train Time: 2.242s | Train Loss: 0.046975 |
2020-05-28 09:07:47,211 - root - INFO - | Epoch: 138/150 | Train Time: 2.776s | Train Loss: 0.050279 |
2020-05-28 09:07:49,805 - root - INFO - | Epoch: 139/150 | Train Time: 2.593s | Train Loss: 0.047518 |
2020-05-28 09:07:52,365 - root - INFO - | Epoch: 140/150 | Train Time: 2.560s | Train Loss: 0.048190 |
2020-05-28 09:07:54,716 - root - INFO - | Epoch: 141/150 | Train Time: 2.351s | Train Loss: 0.048759 |
2020-05-28 09:07:56,688 - root - INFO - | Epoch: 142/150 | Train Time: 1.972s | Train Loss: 0.048789 |
2020-05-28 09:07:58,865 - root - INFO - | Epoch: 143/150 | Train Time: 2.177s | Train Loss: 0.047856 |
2020-05-28 09:08:00,727 - root - INFO - | Epoch: 144/150 | Train Time: 1.861s | Train Loss: 0.047394 |
2020-05-28 09:08:02,896 - root - INFO - | Epoch: 145/150 | Train Time: 2.168s | Train Loss: 0.045455 |
2020-05-28 09:08:05,146 - root - INFO - | Epoch: 146/150 | Train Time: 2.249s | Train Loss: 0.047297 |
2020-05-28 09:08:07,751 - root - INFO - | Epoch: 147/150 | Train Time: 2.605s | Train Loss: 0.047909 |
2020-05-28 09:08:10,205 - root - INFO - | Epoch: 148/150 | Train Time: 2.453s | Train Loss: 0.048711 |
2020-05-28 09:08:12,925 - root - INFO - | Epoch: 149/150 | Train Time: 2.720s | Train Loss: 0.047038 |
2020-05-28 09:08:15,525 - root - INFO - | Epoch: 150/150 | Train Time: 2.599s | Train Loss: 0.044440 |
2020-05-28 09:08:15,525 - root - INFO - Training Time: 383.485s
2020-05-28 09:08:15,525 - root - INFO - Finished training.
2020-05-28 09:08:15,527 - root - INFO - Starting testing...
2020-05-28 09:08:18,691 - root - INFO - Test Loss: 1.351573
2020-05-28 09:08:18,691 - root - INFO - Test AUC: 92.90%
2020-05-28 09:08:18,691 - root - INFO - Test Time: 3.137s
2020-05-28 09:08:18,691 - root - INFO - Finished testing.
