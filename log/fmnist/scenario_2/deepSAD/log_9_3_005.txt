2020-05-28 20:18:15,083 - root - INFO - Log file is ../log/fmnist/scenario_2/deepSAD/log_9_3_005.txt
2020-05-28 20:18:15,083 - root - INFO - Data path is ../data
2020-05-28 20:18:15,083 - root - INFO - Export path is ../log/fmnist/scenario_2/deepSAD
2020-05-28 20:18:15,083 - root - INFO - Dataset: fmnist
2020-05-28 20:18:15,083 - root - INFO - Normal class: 9
2020-05-28 20:18:15,083 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-28 20:18:15,083 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-28 20:18:15,083 - root - INFO - Pollution ratio of unlabeled train data: 0.05
2020-05-28 20:18:15,083 - root - INFO - Scenario Running: 2
2020-05-28 20:18:15,084 - root - INFO - Train only the network: True
2020-05-28 20:18:15,084 - root - INFO - Output and AE dimensions: 128
2020-05-28 20:18:15,084 - root - INFO - Known anomaly class: 3
2020-05-28 20:18:15,084 - root - INFO - Network: fmnist_LeNet
2020-05-28 20:18:15,084 - root - INFO - Eta-parameter: 1.00
2020-05-28 20:18:15,098 - root - INFO - Set seed to 0.
2020-05-28 20:18:15,153 - root - INFO - Computation device: cuda
2020-05-28 20:18:15,154 - root - INFO - Number of threads: 0
2020-05-28 20:18:15,154 - root - INFO - Number of dataloader workers: 6
2020-05-28 20:18:24,263 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-28 20:18:24,302 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-28 20:18:24,302 - root - INFO - Pretraining: True
2020-05-28 20:18:24,302 - root - INFO - Training optimizer: adam
2020-05-28 20:18:24,302 - root - INFO - Training learning rate: 0.0001
2020-05-28 20:18:24,302 - root - INFO - Training epochs: 150
2020-05-28 20:18:24,302 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-28 20:18:24,303 - root - INFO - Training batch size: 200
2020-05-28 20:18:24,303 - root - INFO - Training weight decay: 5e-07
2020-05-28 20:18:24,305 - root - INFO - Starting training...
2020-05-28 20:18:31,956 - root - INFO - | Epoch: 001/150 | Train Time: 7.650s | Train Loss: 2.021382 |
2020-05-28 20:18:34,284 - root - INFO - | Epoch: 002/150 | Train Time: 2.327s | Train Loss: 0.594967 |
2020-05-28 20:18:37,080 - root - INFO - | Epoch: 003/150 | Train Time: 2.796s | Train Loss: 0.382933 |
2020-05-28 20:18:39,389 - root - INFO - | Epoch: 004/150 | Train Time: 2.309s | Train Loss: 0.304335 |
2020-05-28 20:18:41,736 - root - INFO - | Epoch: 005/150 | Train Time: 2.347s | Train Loss: 0.247179 |
2020-05-28 20:18:44,017 - root - INFO - | Epoch: 006/150 | Train Time: 2.281s | Train Loss: 0.232273 |
2020-05-28 20:18:46,451 - root - INFO - | Epoch: 007/150 | Train Time: 2.433s | Train Loss: 0.195377 |
2020-05-28 20:18:49,038 - root - INFO - | Epoch: 008/150 | Train Time: 2.586s | Train Loss: 0.173953 |
2020-05-28 20:18:51,732 - root - INFO - | Epoch: 009/150 | Train Time: 2.693s | Train Loss: 0.159830 |
2020-05-28 20:18:54,252 - root - INFO - | Epoch: 010/150 | Train Time: 2.520s | Train Loss: 0.149200 |
2020-05-28 20:18:56,968 - root - INFO - | Epoch: 011/150 | Train Time: 2.716s | Train Loss: 0.139901 |
2020-05-28 20:18:59,697 - root - INFO - | Epoch: 012/150 | Train Time: 2.728s | Train Loss: 0.128390 |
2020-05-28 20:19:02,435 - root - INFO - | Epoch: 013/150 | Train Time: 2.737s | Train Loss: 0.124139 |
2020-05-28 20:19:05,256 - root - INFO - | Epoch: 014/150 | Train Time: 2.821s | Train Loss: 0.116658 |
2020-05-28 20:19:07,886 - root - INFO - | Epoch: 015/150 | Train Time: 2.629s | Train Loss: 0.119443 |
2020-05-28 20:19:10,560 - root - INFO - | Epoch: 016/150 | Train Time: 2.674s | Train Loss: 0.112000 |
2020-05-28 20:19:13,155 - root - INFO - | Epoch: 017/150 | Train Time: 2.595s | Train Loss: 0.110731 |
2020-05-28 20:19:15,552 - root - INFO - | Epoch: 018/150 | Train Time: 2.396s | Train Loss: 0.101532 |
2020-05-28 20:19:18,718 - root - INFO - | Epoch: 019/150 | Train Time: 3.165s | Train Loss: 0.106579 |
2020-05-28 20:19:21,337 - root - INFO - | Epoch: 020/150 | Train Time: 2.618s | Train Loss: 0.095945 |
2020-05-28 20:19:23,986 - root - INFO - | Epoch: 021/150 | Train Time: 2.648s | Train Loss: 0.089370 |
2020-05-28 20:19:26,474 - root - INFO - | Epoch: 022/150 | Train Time: 2.487s | Train Loss: 0.088339 |
2020-05-28 20:19:28,874 - root - INFO - | Epoch: 023/150 | Train Time: 2.400s | Train Loss: 0.086957 |
2020-05-28 20:19:31,191 - root - INFO - | Epoch: 024/150 | Train Time: 2.316s | Train Loss: 0.084653 |
2020-05-28 20:19:33,862 - root - INFO - | Epoch: 025/150 | Train Time: 2.671s | Train Loss: 0.087166 |
2020-05-28 20:19:36,913 - root - INFO - | Epoch: 026/150 | Train Time: 3.050s | Train Loss: 0.087385 |
2020-05-28 20:19:39,863 - root - INFO - | Epoch: 027/150 | Train Time: 2.949s | Train Loss: 0.079357 |
2020-05-28 20:19:42,884 - root - INFO - | Epoch: 028/150 | Train Time: 3.020s | Train Loss: 0.079714 |
2020-05-28 20:19:45,824 - root - INFO - | Epoch: 029/150 | Train Time: 2.939s | Train Loss: 0.076171 |
2020-05-28 20:19:48,220 - root - INFO - | Epoch: 030/150 | Train Time: 2.396s | Train Loss: 0.075824 |
2020-05-28 20:19:50,903 - root - INFO - | Epoch: 031/150 | Train Time: 2.682s | Train Loss: 0.074688 |
2020-05-28 20:19:53,325 - root - INFO - | Epoch: 032/150 | Train Time: 2.421s | Train Loss: 0.073210 |
2020-05-28 20:19:55,695 - root - INFO - | Epoch: 033/150 | Train Time: 2.370s | Train Loss: 0.070643 |
2020-05-28 20:19:57,635 - root - INFO - | Epoch: 034/150 | Train Time: 1.939s | Train Loss: 0.073063 |
2020-05-28 20:19:59,434 - root - INFO - | Epoch: 035/150 | Train Time: 1.799s | Train Loss: 0.068351 |
2020-05-28 20:20:01,874 - root - INFO - | Epoch: 036/150 | Train Time: 2.439s | Train Loss: 0.067219 |
2020-05-28 20:20:04,032 - root - INFO - | Epoch: 037/150 | Train Time: 2.157s | Train Loss: 0.070344 |
2020-05-28 20:20:05,757 - root - INFO - | Epoch: 038/150 | Train Time: 1.724s | Train Loss: 0.062626 |
2020-05-28 20:20:08,219 - root - INFO - | Epoch: 039/150 | Train Time: 2.461s | Train Loss: 0.068585 |
2020-05-28 20:20:10,814 - root - INFO - | Epoch: 040/150 | Train Time: 2.595s | Train Loss: 0.067490 |
2020-05-28 20:20:13,325 - root - INFO - | Epoch: 041/150 | Train Time: 2.510s | Train Loss: 0.066224 |
2020-05-28 20:20:15,742 - root - INFO - | Epoch: 042/150 | Train Time: 2.417s | Train Loss: 0.064528 |
2020-05-28 20:20:17,892 - root - INFO - | Epoch: 043/150 | Train Time: 2.149s | Train Loss: 0.060367 |
2020-05-28 20:20:19,794 - root - INFO - | Epoch: 044/150 | Train Time: 1.901s | Train Loss: 0.061493 |
2020-05-28 20:20:22,023 - root - INFO - | Epoch: 045/150 | Train Time: 2.228s | Train Loss: 0.057454 |
2020-05-28 20:20:24,410 - root - INFO - | Epoch: 046/150 | Train Time: 2.386s | Train Loss: 0.059566 |
2020-05-28 20:20:26,692 - root - INFO - | Epoch: 047/150 | Train Time: 2.281s | Train Loss: 0.065757 |
2020-05-28 20:20:28,739 - root - INFO - | Epoch: 048/150 | Train Time: 2.047s | Train Loss: 0.059084 |
2020-05-28 20:20:31,436 - root - INFO - | Epoch: 049/150 | Train Time: 2.697s | Train Loss: 0.060998 |
2020-05-28 20:20:34,491 - root - INFO - | Epoch: 050/150 | Train Time: 3.054s | Train Loss: 0.055491 |
2020-05-28 20:20:34,491 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-28 20:20:37,295 - root - INFO - | Epoch: 051/150 | Train Time: 2.804s | Train Loss: 0.052544 |
2020-05-28 20:20:40,149 - root - INFO - | Epoch: 052/150 | Train Time: 2.853s | Train Loss: 0.054061 |
2020-05-28 20:20:43,450 - root - INFO - | Epoch: 053/150 | Train Time: 3.300s | Train Loss: 0.053375 |
2020-05-28 20:20:46,186 - root - INFO - | Epoch: 054/150 | Train Time: 2.736s | Train Loss: 0.052270 |
2020-05-28 20:20:49,324 - root - INFO - | Epoch: 055/150 | Train Time: 3.138s | Train Loss: 0.048287 |
2020-05-28 20:20:51,835 - root - INFO - | Epoch: 056/150 | Train Time: 2.510s | Train Loss: 0.052653 |
2020-05-28 20:20:54,704 - root - INFO - | Epoch: 057/150 | Train Time: 2.869s | Train Loss: 0.051766 |
2020-05-28 20:20:57,605 - root - INFO - | Epoch: 058/150 | Train Time: 2.900s | Train Loss: 0.053008 |
2020-05-28 20:21:00,624 - root - INFO - | Epoch: 059/150 | Train Time: 3.018s | Train Loss: 0.053181 |
2020-05-28 20:21:03,443 - root - INFO - | Epoch: 060/150 | Train Time: 2.819s | Train Loss: 0.055393 |
2020-05-28 20:21:06,311 - root - INFO - | Epoch: 061/150 | Train Time: 2.868s | Train Loss: 0.053893 |
2020-05-28 20:21:08,940 - root - INFO - | Epoch: 062/150 | Train Time: 2.628s | Train Loss: 0.054365 |
2020-05-28 20:21:11,271 - root - INFO - | Epoch: 063/150 | Train Time: 2.331s | Train Loss: 0.055988 |
2020-05-28 20:21:14,304 - root - INFO - | Epoch: 064/150 | Train Time: 3.032s | Train Loss: 0.052143 |
2020-05-28 20:21:17,006 - root - INFO - | Epoch: 065/150 | Train Time: 2.702s | Train Loss: 0.053659 |
2020-05-28 20:21:20,243 - root - INFO - | Epoch: 066/150 | Train Time: 3.236s | Train Loss: 0.054174 |
2020-05-28 20:21:23,303 - root - INFO - | Epoch: 067/150 | Train Time: 3.060s | Train Loss: 0.051353 |
2020-05-28 20:21:25,827 - root - INFO - | Epoch: 068/150 | Train Time: 2.523s | Train Loss: 0.051943 |
2020-05-28 20:21:28,550 - root - INFO - | Epoch: 069/150 | Train Time: 2.722s | Train Loss: 0.050713 |
2020-05-28 20:21:31,125 - root - INFO - | Epoch: 070/150 | Train Time: 2.575s | Train Loss: 0.052150 |
2020-05-28 20:21:33,860 - root - INFO - | Epoch: 071/150 | Train Time: 2.735s | Train Loss: 0.051968 |
2020-05-28 20:21:35,966 - root - INFO - | Epoch: 072/150 | Train Time: 2.105s | Train Loss: 0.051751 |
2020-05-28 20:21:38,614 - root - INFO - | Epoch: 073/150 | Train Time: 2.647s | Train Loss: 0.048180 |
2020-05-28 20:21:40,529 - root - INFO - | Epoch: 074/150 | Train Time: 1.914s | Train Loss: 0.050190 |
2020-05-28 20:21:42,431 - root - INFO - | Epoch: 075/150 | Train Time: 1.901s | Train Loss: 0.051573 |
2020-05-28 20:21:44,456 - root - INFO - | Epoch: 076/150 | Train Time: 2.024s | Train Loss: 0.050694 |
2020-05-28 20:21:46,965 - root - INFO - | Epoch: 077/150 | Train Time: 2.509s | Train Loss: 0.051919 |
2020-05-28 20:21:49,201 - root - INFO - | Epoch: 078/150 | Train Time: 2.235s | Train Loss: 0.049035 |
2020-05-28 20:21:51,254 - root - INFO - | Epoch: 079/150 | Train Time: 2.053s | Train Loss: 0.055338 |
2020-05-28 20:21:53,635 - root - INFO - | Epoch: 080/150 | Train Time: 2.380s | Train Loss: 0.052479 |
2020-05-28 20:21:56,164 - root - INFO - | Epoch: 081/150 | Train Time: 2.529s | Train Loss: 0.052254 |
2020-05-28 20:21:58,432 - root - INFO - | Epoch: 082/150 | Train Time: 2.267s | Train Loss: 0.050482 |
2020-05-28 20:22:00,746 - root - INFO - | Epoch: 083/150 | Train Time: 2.313s | Train Loss: 0.052781 |
2020-05-28 20:22:02,635 - root - INFO - | Epoch: 084/150 | Train Time: 1.888s | Train Loss: 0.050680 |
2020-05-28 20:22:04,298 - root - INFO - | Epoch: 085/150 | Train Time: 1.663s | Train Loss: 0.048950 |
2020-05-28 20:22:06,771 - root - INFO - | Epoch: 086/150 | Train Time: 2.473s | Train Loss: 0.049181 |
2020-05-28 20:22:09,104 - root - INFO - | Epoch: 087/150 | Train Time: 2.332s | Train Loss: 0.049724 |
2020-05-28 20:22:11,412 - root - INFO - | Epoch: 088/150 | Train Time: 2.308s | Train Loss: 0.050217 |
2020-05-28 20:22:13,550 - root - INFO - | Epoch: 089/150 | Train Time: 2.138s | Train Loss: 0.051432 |
2020-05-28 20:22:15,675 - root - INFO - | Epoch: 090/150 | Train Time: 2.124s | Train Loss: 0.051708 |
2020-05-28 20:22:18,389 - root - INFO - | Epoch: 091/150 | Train Time: 2.713s | Train Loss: 0.048976 |
2020-05-28 20:22:21,111 - root - INFO - | Epoch: 092/150 | Train Time: 2.721s | Train Loss: 0.050871 |
2020-05-28 20:22:24,098 - root - INFO - | Epoch: 093/150 | Train Time: 2.987s | Train Loss: 0.052082 |
2020-05-28 20:22:26,826 - root - INFO - | Epoch: 094/150 | Train Time: 2.727s | Train Loss: 0.048733 |
2020-05-28 20:22:29,780 - root - INFO - | Epoch: 095/150 | Train Time: 2.954s | Train Loss: 0.051544 |
2020-05-28 20:22:32,324 - root - INFO - | Epoch: 096/150 | Train Time: 2.544s | Train Loss: 0.049689 |
2020-05-28 20:22:34,925 - root - INFO - | Epoch: 097/150 | Train Time: 2.600s | Train Loss: 0.049658 |
2020-05-28 20:22:37,477 - root - INFO - | Epoch: 098/150 | Train Time: 2.552s | Train Loss: 0.047507 |
2020-05-28 20:22:40,114 - root - INFO - | Epoch: 099/150 | Train Time: 2.636s | Train Loss: 0.045495 |
2020-05-28 20:22:42,518 - root - INFO - | Epoch: 100/150 | Train Time: 2.404s | Train Loss: 0.049436 |
2020-05-28 20:22:44,886 - root - INFO - | Epoch: 101/150 | Train Time: 2.368s | Train Loss: 0.047065 |
2020-05-28 20:22:47,307 - root - INFO - | Epoch: 102/150 | Train Time: 2.420s | Train Loss: 0.050445 |
2020-05-28 20:22:49,539 - root - INFO - | Epoch: 103/150 | Train Time: 2.231s | Train Loss: 0.048870 |
2020-05-28 20:22:52,083 - root - INFO - | Epoch: 104/150 | Train Time: 2.544s | Train Loss: 0.047504 |
2020-05-28 20:22:54,205 - root - INFO - | Epoch: 105/150 | Train Time: 2.122s | Train Loss: 0.051478 |
2020-05-28 20:22:56,836 - root - INFO - | Epoch: 106/150 | Train Time: 2.630s | Train Loss: 0.047370 |
2020-05-28 20:22:59,158 - root - INFO - | Epoch: 107/150 | Train Time: 2.322s | Train Loss: 0.048363 |
2020-05-28 20:23:00,975 - root - INFO - | Epoch: 108/150 | Train Time: 1.816s | Train Loss: 0.047758 |
2020-05-28 20:23:02,844 - root - INFO - | Epoch: 109/150 | Train Time: 1.869s | Train Loss: 0.050194 |
2020-05-28 20:23:04,939 - root - INFO - | Epoch: 110/150 | Train Time: 2.095s | Train Loss: 0.046952 |
2020-05-28 20:23:06,923 - root - INFO - | Epoch: 111/150 | Train Time: 1.983s | Train Loss: 0.045354 |
2020-05-28 20:23:09,434 - root - INFO - | Epoch: 112/150 | Train Time: 2.511s | Train Loss: 0.048810 |
2020-05-28 20:23:11,484 - root - INFO - | Epoch: 113/150 | Train Time: 2.049s | Train Loss: 0.047316 |
2020-05-28 20:23:13,925 - root - INFO - | Epoch: 114/150 | Train Time: 2.441s | Train Loss: 0.044946 |
2020-05-28 20:23:17,151 - root - INFO - | Epoch: 115/150 | Train Time: 3.225s | Train Loss: 0.047490 |
2020-05-28 20:23:19,850 - root - INFO - | Epoch: 116/150 | Train Time: 2.698s | Train Loss: 0.051982 |
2020-05-28 20:23:22,825 - root - INFO - | Epoch: 117/150 | Train Time: 2.975s | Train Loss: 0.049257 |
2020-05-28 20:23:25,496 - root - INFO - | Epoch: 118/150 | Train Time: 2.670s | Train Loss: 0.045682 |
2020-05-28 20:23:27,796 - root - INFO - | Epoch: 119/150 | Train Time: 2.299s | Train Loss: 0.046654 |
2020-05-28 20:23:30,177 - root - INFO - | Epoch: 120/150 | Train Time: 2.380s | Train Loss: 0.046091 |
2020-05-28 20:23:32,979 - root - INFO - | Epoch: 121/150 | Train Time: 2.801s | Train Loss: 0.047477 |
2020-05-28 20:23:35,724 - root - INFO - | Epoch: 122/150 | Train Time: 2.744s | Train Loss: 0.048487 |
2020-05-28 20:23:38,190 - root - INFO - | Epoch: 123/150 | Train Time: 2.466s | Train Loss: 0.045923 |
2020-05-28 20:23:41,177 - root - INFO - | Epoch: 124/150 | Train Time: 2.987s | Train Loss: 0.047464 |
2020-05-28 20:23:44,512 - root - INFO - | Epoch: 125/150 | Train Time: 3.335s | Train Loss: 0.046518 |
2020-05-28 20:23:47,114 - root - INFO - | Epoch: 126/150 | Train Time: 2.601s | Train Loss: 0.044379 |
2020-05-28 20:23:49,955 - root - INFO - | Epoch: 127/150 | Train Time: 2.840s | Train Loss: 0.052312 |
2020-05-28 20:23:52,948 - root - INFO - | Epoch: 128/150 | Train Time: 2.993s | Train Loss: 0.046184 |
2020-05-28 20:23:55,931 - root - INFO - | Epoch: 129/150 | Train Time: 2.982s | Train Loss: 0.046221 |
2020-05-28 20:23:59,044 - root - INFO - | Epoch: 130/150 | Train Time: 3.112s | Train Loss: 0.043817 |
2020-05-28 20:24:01,928 - root - INFO - | Epoch: 131/150 | Train Time: 2.883s | Train Loss: 0.047076 |
2020-05-28 20:24:04,996 - root - INFO - | Epoch: 132/150 | Train Time: 3.067s | Train Loss: 0.050300 |
2020-05-28 20:24:07,906 - root - INFO - | Epoch: 133/150 | Train Time: 2.910s | Train Loss: 0.048294 |
2020-05-28 20:24:10,943 - root - INFO - | Epoch: 134/150 | Train Time: 3.036s | Train Loss: 0.045690 |
2020-05-28 20:24:13,942 - root - INFO - | Epoch: 135/150 | Train Time: 2.999s | Train Loss: 0.043709 |
2020-05-28 20:24:16,831 - root - INFO - | Epoch: 136/150 | Train Time: 2.888s | Train Loss: 0.045725 |
2020-05-28 20:24:19,706 - root - INFO - | Epoch: 137/150 | Train Time: 2.874s | Train Loss: 0.045510 |
2020-05-28 20:24:23,016 - root - INFO - | Epoch: 138/150 | Train Time: 3.310s | Train Loss: 0.043547 |
2020-05-28 20:24:25,437 - root - INFO - | Epoch: 139/150 | Train Time: 2.398s | Train Loss: 0.046399 |
2020-05-28 20:24:27,920 - root - INFO - | Epoch: 140/150 | Train Time: 2.482s | Train Loss: 0.045484 |
2020-05-28 20:24:30,372 - root - INFO - | Epoch: 141/150 | Train Time: 2.451s | Train Loss: 0.045847 |
2020-05-28 20:24:32,654 - root - INFO - | Epoch: 142/150 | Train Time: 2.281s | Train Loss: 0.041813 |
2020-05-28 20:24:34,758 - root - INFO - | Epoch: 143/150 | Train Time: 2.104s | Train Loss: 0.045800 |
2020-05-28 20:24:37,057 - root - INFO - | Epoch: 144/150 | Train Time: 2.298s | Train Loss: 0.043298 |
2020-05-28 20:24:39,850 - root - INFO - | Epoch: 145/150 | Train Time: 2.792s | Train Loss: 0.045615 |
2020-05-28 20:24:42,164 - root - INFO - | Epoch: 146/150 | Train Time: 2.314s | Train Loss: 0.045910 |
2020-05-28 20:24:44,565 - root - INFO - | Epoch: 147/150 | Train Time: 2.401s | Train Loss: 0.048663 |
2020-05-28 20:24:47,255 - root - INFO - | Epoch: 148/150 | Train Time: 2.690s | Train Loss: 0.044208 |
2020-05-28 20:24:50,006 - root - INFO - | Epoch: 149/150 | Train Time: 2.750s | Train Loss: 0.042940 |
2020-05-28 20:24:52,554 - root - INFO - | Epoch: 150/150 | Train Time: 2.547s | Train Loss: 0.047523 |
2020-05-28 20:24:52,554 - root - INFO - Training Time: 388.249s
2020-05-28 20:24:52,554 - root - INFO - Finished training.
2020-05-28 20:24:52,555 - root - INFO - Starting testing...
2020-05-28 20:24:54,891 - root - INFO - Test Loss: 0.696428
2020-05-28 20:24:54,891 - root - INFO - Test AUC: 97.27%
2020-05-28 20:24:54,891 - root - INFO - Test Time: 2.323s
2020-05-28 20:24:54,892 - root - INFO - Finished testing.
