2020-05-20 23:11:41,497 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_3_0_512.txt
2020-05-20 23:11:41,497 - root - INFO - Data path is ../data
2020-05-20 23:11:41,497 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-20 23:11:41,497 - root - INFO - Dataset: fmnist
2020-05-20 23:11:41,497 - root - INFO - Normal class: 3
2020-05-20 23:11:41,498 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-20 23:11:41,498 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-20 23:11:41,498 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-20 23:11:41,498 - root - INFO - Scenario Running: 5
2020-05-20 23:11:41,498 - root - INFO - Train only the network: True
2020-05-20 23:11:41,498 - root - INFO - Output and AE dimensions: 512
2020-05-20 23:11:41,498 - root - INFO - Known anomaly class: 0
2020-05-20 23:11:41,498 - root - INFO - Network: fmnist_LeNet
2020-05-20 23:11:41,498 - root - INFO - Eta-parameter: 1.00
2020-05-20 23:11:41,507 - root - INFO - Set seed to 0.
2020-05-20 23:11:41,541 - root - INFO - Computation device: cuda
2020-05-20 23:11:41,542 - root - INFO - Number of threads: 0
2020-05-20 23:11:41,542 - root - INFO - Number of dataloader workers: 6
2020-05-20 23:11:45,488 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_512.tar.
2020-05-20 23:11:45,490 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-20 23:11:45,491 - root - INFO - Pretraining: True
2020-05-20 23:11:45,491 - root - INFO - Training optimizer: adam
2020-05-20 23:11:45,491 - root - INFO - Training learning rate: 0.0001
2020-05-20 23:11:45,491 - root - INFO - Training epochs: 150
2020-05-20 23:11:45,491 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-20 23:11:45,491 - root - INFO - Training batch size: 200
2020-05-20 23:11:45,491 - root - INFO - Training weight decay: 5e-07
2020-05-20 23:11:45,493 - root - INFO - Starting training...
2020-05-20 23:11:48,295 - root - INFO - | Epoch: 001/150 | Train Time: 2.801s | Train Loss: 0.460339 |
2020-05-20 23:11:49,154 - root - INFO - | Epoch: 002/150 | Train Time: 0.859s | Train Loss: 0.285433 |
2020-05-20 23:11:50,050 - root - INFO - | Epoch: 003/150 | Train Time: 0.895s | Train Loss: 0.240466 |
2020-05-20 23:11:51,147 - root - INFO - | Epoch: 004/150 | Train Time: 1.097s | Train Loss: 0.227272 |
2020-05-20 23:11:52,424 - root - INFO - | Epoch: 005/150 | Train Time: 1.277s | Train Loss: 0.212624 |
2020-05-20 23:11:53,656 - root - INFO - | Epoch: 006/150 | Train Time: 1.231s | Train Loss: 0.206051 |
2020-05-20 23:11:54,736 - root - INFO - | Epoch: 007/150 | Train Time: 1.080s | Train Loss: 0.187745 |
2020-05-20 23:11:55,949 - root - INFO - | Epoch: 008/150 | Train Time: 1.212s | Train Loss: 0.181789 |
2020-05-20 23:11:57,058 - root - INFO - | Epoch: 009/150 | Train Time: 1.109s | Train Loss: 0.181310 |
2020-05-20 23:11:58,332 - root - INFO - | Epoch: 010/150 | Train Time: 1.273s | Train Loss: 0.172941 |
2020-05-20 23:11:59,524 - root - INFO - | Epoch: 011/150 | Train Time: 1.192s | Train Loss: 0.170136 |
2020-05-20 23:12:00,827 - root - INFO - | Epoch: 012/150 | Train Time: 1.303s | Train Loss: 0.169720 |
2020-05-20 23:12:02,056 - root - INFO - | Epoch: 013/150 | Train Time: 1.228s | Train Loss: 0.159361 |
2020-05-20 23:12:03,381 - root - INFO - | Epoch: 014/150 | Train Time: 1.324s | Train Loss: 0.152665 |
2020-05-20 23:12:04,760 - root - INFO - | Epoch: 015/150 | Train Time: 1.379s | Train Loss: 0.150274 |
2020-05-20 23:12:05,959 - root - INFO - | Epoch: 016/150 | Train Time: 1.198s | Train Loss: 0.147624 |
2020-05-20 23:12:07,504 - root - INFO - | Epoch: 017/150 | Train Time: 1.545s | Train Loss: 0.144036 |
2020-05-20 23:12:08,708 - root - INFO - | Epoch: 018/150 | Train Time: 1.203s | Train Loss: 0.148054 |
2020-05-20 23:12:09,938 - root - INFO - | Epoch: 019/150 | Train Time: 1.229s | Train Loss: 0.143939 |
2020-05-20 23:12:11,253 - root - INFO - | Epoch: 020/150 | Train Time: 1.314s | Train Loss: 0.137518 |
2020-05-20 23:12:13,136 - root - INFO - | Epoch: 021/150 | Train Time: 1.883s | Train Loss: 0.143510 |
2020-05-20 23:12:14,635 - root - INFO - | Epoch: 022/150 | Train Time: 1.498s | Train Loss: 0.140038 |
2020-05-20 23:12:16,080 - root - INFO - | Epoch: 023/150 | Train Time: 1.444s | Train Loss: 0.132248 |
2020-05-20 23:12:17,854 - root - INFO - | Epoch: 024/150 | Train Time: 1.774s | Train Loss: 0.132002 |
2020-05-20 23:12:19,309 - root - INFO - | Epoch: 025/150 | Train Time: 1.454s | Train Loss: 0.136371 |
2020-05-20 23:12:20,990 - root - INFO - | Epoch: 026/150 | Train Time: 1.681s | Train Loss: 0.131417 |
2020-05-20 23:12:22,403 - root - INFO - | Epoch: 027/150 | Train Time: 1.412s | Train Loss: 0.132972 |
2020-05-20 23:12:23,676 - root - INFO - | Epoch: 028/150 | Train Time: 1.273s | Train Loss: 0.131489 |
2020-05-20 23:12:24,982 - root - INFO - | Epoch: 029/150 | Train Time: 1.305s | Train Loss: 0.131838 |
2020-05-20 23:12:26,739 - root - INFO - | Epoch: 030/150 | Train Time: 1.756s | Train Loss: 0.125008 |
2020-05-20 23:12:28,213 - root - INFO - | Epoch: 031/150 | Train Time: 1.474s | Train Loss: 0.130334 |
2020-05-20 23:12:29,314 - root - INFO - | Epoch: 032/150 | Train Time: 1.100s | Train Loss: 0.123833 |
2020-05-20 23:12:30,919 - root - INFO - | Epoch: 033/150 | Train Time: 1.605s | Train Loss: 0.120572 |
2020-05-20 23:12:32,770 - root - INFO - | Epoch: 034/150 | Train Time: 1.851s | Train Loss: 0.119350 |
2020-05-20 23:12:34,226 - root - INFO - | Epoch: 035/150 | Train Time: 1.456s | Train Loss: 0.116997 |
2020-05-20 23:12:35,788 - root - INFO - | Epoch: 036/150 | Train Time: 1.561s | Train Loss: 0.116710 |
2020-05-20 23:12:37,207 - root - INFO - | Epoch: 037/150 | Train Time: 1.418s | Train Loss: 0.113152 |
2020-05-20 23:12:39,106 - root - INFO - | Epoch: 038/150 | Train Time: 1.899s | Train Loss: 0.123267 |
2020-05-20 23:12:40,684 - root - INFO - | Epoch: 039/150 | Train Time: 1.577s | Train Loss: 0.113061 |
2020-05-20 23:12:42,219 - root - INFO - | Epoch: 040/150 | Train Time: 1.535s | Train Loss: 0.116789 |
2020-05-20 23:12:43,828 - root - INFO - | Epoch: 041/150 | Train Time: 1.608s | Train Loss: 0.114374 |
2020-05-20 23:12:45,114 - root - INFO - | Epoch: 042/150 | Train Time: 1.286s | Train Loss: 0.115991 |
2020-05-20 23:12:46,422 - root - INFO - | Epoch: 043/150 | Train Time: 1.307s | Train Loss: 0.112047 |
2020-05-20 23:12:48,213 - root - INFO - | Epoch: 044/150 | Train Time: 1.791s | Train Loss: 0.111614 |
2020-05-20 23:12:49,554 - root - INFO - | Epoch: 045/150 | Train Time: 1.341s | Train Loss: 0.108235 |
2020-05-20 23:12:50,900 - root - INFO - | Epoch: 046/150 | Train Time: 1.345s | Train Loss: 0.109900 |
2020-05-20 23:12:52,303 - root - INFO - | Epoch: 047/150 | Train Time: 1.403s | Train Loss: 0.116832 |
2020-05-20 23:12:53,919 - root - INFO - | Epoch: 048/150 | Train Time: 1.615s | Train Loss: 0.115212 |
2020-05-20 23:12:55,321 - root - INFO - | Epoch: 049/150 | Train Time: 1.402s | Train Loss: 0.103367 |
2020-05-20 23:12:56,879 - root - INFO - | Epoch: 050/150 | Train Time: 1.557s | Train Loss: 0.098592 |
2020-05-20 23:12:56,879 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-20 23:12:58,097 - root - INFO - | Epoch: 051/150 | Train Time: 1.218s | Train Loss: 0.097134 |
2020-05-20 23:12:59,631 - root - INFO - | Epoch: 052/150 | Train Time: 1.533s | Train Loss: 0.100435 |
2020-05-20 23:13:01,371 - root - INFO - | Epoch: 053/150 | Train Time: 1.739s | Train Loss: 0.097375 |
2020-05-20 23:13:03,040 - root - INFO - | Epoch: 054/150 | Train Time: 1.669s | Train Loss: 0.097016 |
2020-05-20 23:13:04,016 - root - INFO - | Epoch: 055/150 | Train Time: 0.975s | Train Loss: 0.098326 |
2020-05-20 23:13:05,563 - root - INFO - | Epoch: 056/150 | Train Time: 1.547s | Train Loss: 0.096775 |
2020-05-20 23:13:07,145 - root - INFO - | Epoch: 057/150 | Train Time: 1.582s | Train Loss: 0.098632 |
2020-05-20 23:13:08,843 - root - INFO - | Epoch: 058/150 | Train Time: 1.697s | Train Loss: 0.093271 |
2020-05-20 23:13:10,644 - root - INFO - | Epoch: 059/150 | Train Time: 1.801s | Train Loss: 0.100644 |
2020-05-20 23:13:12,249 - root - INFO - | Epoch: 060/150 | Train Time: 1.604s | Train Loss: 0.097897 |
2020-05-20 23:13:13,764 - root - INFO - | Epoch: 061/150 | Train Time: 1.514s | Train Loss: 0.095819 |
2020-05-20 23:13:15,446 - root - INFO - | Epoch: 062/150 | Train Time: 1.681s | Train Loss: 0.095850 |
2020-05-20 23:13:16,751 - root - INFO - | Epoch: 063/150 | Train Time: 1.305s | Train Loss: 0.102372 |
2020-05-20 23:13:17,879 - root - INFO - | Epoch: 064/150 | Train Time: 1.128s | Train Loss: 0.094599 |
2020-05-20 23:13:19,145 - root - INFO - | Epoch: 065/150 | Train Time: 1.265s | Train Loss: 0.098056 |
2020-05-20 23:13:20,258 - root - INFO - | Epoch: 066/150 | Train Time: 1.112s | Train Loss: 0.094119 |
2020-05-20 23:13:21,465 - root - INFO - | Epoch: 067/150 | Train Time: 1.207s | Train Loss: 0.097671 |
2020-05-20 23:13:23,198 - root - INFO - | Epoch: 068/150 | Train Time: 1.732s | Train Loss: 0.094971 |
2020-05-20 23:13:24,544 - root - INFO - | Epoch: 069/150 | Train Time: 1.346s | Train Loss: 0.094836 |
2020-05-20 23:13:25,828 - root - INFO - | Epoch: 070/150 | Train Time: 1.283s | Train Loss: 0.095170 |
2020-05-20 23:13:27,136 - root - INFO - | Epoch: 071/150 | Train Time: 1.307s | Train Loss: 0.095283 |
2020-05-20 23:13:28,650 - root - INFO - | Epoch: 072/150 | Train Time: 1.514s | Train Loss: 0.093390 |
2020-05-20 23:13:30,078 - root - INFO - | Epoch: 073/150 | Train Time: 1.427s | Train Loss: 0.094349 |
2020-05-20 23:13:31,538 - root - INFO - | Epoch: 074/150 | Train Time: 1.459s | Train Loss: 0.096123 |
2020-05-20 23:13:33,050 - root - INFO - | Epoch: 075/150 | Train Time: 1.512s | Train Loss: 0.094364 |
2020-05-20 23:13:34,625 - root - INFO - | Epoch: 076/150 | Train Time: 1.575s | Train Loss: 0.095461 |
2020-05-20 23:13:35,912 - root - INFO - | Epoch: 077/150 | Train Time: 1.287s | Train Loss: 0.091651 |
2020-05-20 23:13:37,339 - root - INFO - | Epoch: 078/150 | Train Time: 1.426s | Train Loss: 0.092474 |
2020-05-20 23:13:39,009 - root - INFO - | Epoch: 079/150 | Train Time: 1.670s | Train Loss: 0.095247 |
2020-05-20 23:13:40,584 - root - INFO - | Epoch: 080/150 | Train Time: 1.575s | Train Loss: 0.100591 |
2020-05-20 23:13:42,321 - root - INFO - | Epoch: 081/150 | Train Time: 1.736s | Train Loss: 0.094523 |
2020-05-20 23:13:43,839 - root - INFO - | Epoch: 082/150 | Train Time: 1.518s | Train Loss: 0.092126 |
2020-05-20 23:13:45,732 - root - INFO - | Epoch: 083/150 | Train Time: 1.892s | Train Loss: 0.091695 |
2020-05-20 23:13:47,097 - root - INFO - | Epoch: 084/150 | Train Time: 1.364s | Train Loss: 0.095054 |
2020-05-20 23:13:48,346 - root - INFO - | Epoch: 085/150 | Train Time: 1.249s | Train Loss: 0.094822 |
2020-05-20 23:13:49,818 - root - INFO - | Epoch: 086/150 | Train Time: 1.472s | Train Loss: 0.095658 |
2020-05-20 23:13:51,052 - root - INFO - | Epoch: 087/150 | Train Time: 1.234s | Train Loss: 0.095303 |
2020-05-20 23:13:52,604 - root - INFO - | Epoch: 088/150 | Train Time: 1.551s | Train Loss: 0.092646 |
2020-05-20 23:13:53,607 - root - INFO - | Epoch: 089/150 | Train Time: 1.002s | Train Loss: 0.095787 |
2020-05-20 23:13:54,821 - root - INFO - | Epoch: 090/150 | Train Time: 1.214s | Train Loss: 0.096046 |
2020-05-20 23:13:56,139 - root - INFO - | Epoch: 091/150 | Train Time: 1.317s | Train Loss: 0.094088 |
2020-05-20 23:13:57,666 - root - INFO - | Epoch: 092/150 | Train Time: 1.527s | Train Loss: 0.095297 |
2020-05-20 23:13:59,184 - root - INFO - | Epoch: 093/150 | Train Time: 1.517s | Train Loss: 0.092523 |
2020-05-20 23:14:00,427 - root - INFO - | Epoch: 094/150 | Train Time: 1.243s | Train Loss: 0.093723 |
2020-05-20 23:14:01,976 - root - INFO - | Epoch: 095/150 | Train Time: 1.547s | Train Loss: 0.095304 |
2020-05-20 23:14:03,726 - root - INFO - | Epoch: 096/150 | Train Time: 1.750s | Train Loss: 0.096542 |
2020-05-20 23:14:05,226 - root - INFO - | Epoch: 097/150 | Train Time: 1.499s | Train Loss: 0.096067 |
2020-05-20 23:14:07,074 - root - INFO - | Epoch: 098/150 | Train Time: 1.848s | Train Loss: 0.093457 |
2020-05-20 23:14:08,562 - root - INFO - | Epoch: 099/150 | Train Time: 1.487s | Train Loss: 0.093699 |
2020-05-20 23:14:09,929 - root - INFO - | Epoch: 100/150 | Train Time: 1.366s | Train Loss: 0.090301 |
2020-05-20 23:14:11,527 - root - INFO - | Epoch: 101/150 | Train Time: 1.597s | Train Loss: 0.094481 |
2020-05-20 23:14:13,282 - root - INFO - | Epoch: 102/150 | Train Time: 1.755s | Train Loss: 0.094013 |
2020-05-20 23:14:14,627 - root - INFO - | Epoch: 103/150 | Train Time: 1.344s | Train Loss: 0.091897 |
2020-05-20 23:14:15,946 - root - INFO - | Epoch: 104/150 | Train Time: 1.319s | Train Loss: 0.090750 |
2020-05-20 23:14:17,477 - root - INFO - | Epoch: 105/150 | Train Time: 1.530s | Train Loss: 0.094139 |
2020-05-20 23:14:18,911 - root - INFO - | Epoch: 106/150 | Train Time: 1.434s | Train Loss: 0.092317 |
2020-05-20 23:14:20,433 - root - INFO - | Epoch: 107/150 | Train Time: 1.521s | Train Loss: 0.091956 |
2020-05-20 23:14:22,135 - root - INFO - | Epoch: 108/150 | Train Time: 1.702s | Train Loss: 0.091640 |
2020-05-20 23:14:23,305 - root - INFO - | Epoch: 109/150 | Train Time: 1.170s | Train Loss: 0.091877 |
2020-05-20 23:14:24,670 - root - INFO - | Epoch: 110/150 | Train Time: 1.365s | Train Loss: 0.090639 |
2020-05-20 23:14:25,836 - root - INFO - | Epoch: 111/150 | Train Time: 1.166s | Train Loss: 0.090172 |
2020-05-20 23:14:26,953 - root - INFO - | Epoch: 112/150 | Train Time: 1.116s | Train Loss: 0.089604 |
2020-05-20 23:14:28,555 - root - INFO - | Epoch: 113/150 | Train Time: 1.601s | Train Loss: 0.091679 |
2020-05-20 23:14:29,762 - root - INFO - | Epoch: 114/150 | Train Time: 1.207s | Train Loss: 0.095431 |
2020-05-20 23:14:31,309 - root - INFO - | Epoch: 115/150 | Train Time: 1.547s | Train Loss: 0.090460 |
2020-05-20 23:14:32,471 - root - INFO - | Epoch: 116/150 | Train Time: 1.161s | Train Loss: 0.089013 |
2020-05-20 23:14:33,743 - root - INFO - | Epoch: 117/150 | Train Time: 1.271s | Train Loss: 0.091495 |
2020-05-20 23:14:35,169 - root - INFO - | Epoch: 118/150 | Train Time: 1.426s | Train Loss: 0.092979 |
2020-05-20 23:14:36,597 - root - INFO - | Epoch: 119/150 | Train Time: 1.428s | Train Loss: 0.091863 |
2020-05-20 23:14:38,108 - root - INFO - | Epoch: 120/150 | Train Time: 1.510s | Train Loss: 0.092598 |
2020-05-20 23:14:39,399 - root - INFO - | Epoch: 121/150 | Train Time: 1.291s | Train Loss: 0.091603 |
2020-05-20 23:14:40,479 - root - INFO - | Epoch: 122/150 | Train Time: 1.079s | Train Loss: 0.091523 |
2020-05-20 23:14:41,726 - root - INFO - | Epoch: 123/150 | Train Time: 1.247s | Train Loss: 0.089061 |
2020-05-20 23:14:42,846 - root - INFO - | Epoch: 124/150 | Train Time: 1.119s | Train Loss: 0.089997 |
2020-05-20 23:14:44,145 - root - INFO - | Epoch: 125/150 | Train Time: 1.298s | Train Loss: 0.090388 |
2020-05-20 23:14:45,363 - root - INFO - | Epoch: 126/150 | Train Time: 1.217s | Train Loss: 0.093053 |
2020-05-20 23:14:46,601 - root - INFO - | Epoch: 127/150 | Train Time: 1.238s | Train Loss: 0.090311 |
2020-05-20 23:14:47,631 - root - INFO - | Epoch: 128/150 | Train Time: 1.029s | Train Loss: 0.089956 |
2020-05-20 23:14:48,667 - root - INFO - | Epoch: 129/150 | Train Time: 1.036s | Train Loss: 0.092876 |
2020-05-20 23:14:49,790 - root - INFO - | Epoch: 130/150 | Train Time: 1.122s | Train Loss: 0.091737 |
2020-05-20 23:14:50,965 - root - INFO - | Epoch: 131/150 | Train Time: 1.175s | Train Loss: 0.089420 |
2020-05-20 23:14:52,123 - root - INFO - | Epoch: 132/150 | Train Time: 1.157s | Train Loss: 0.090447 |
2020-05-20 23:14:53,423 - root - INFO - | Epoch: 133/150 | Train Time: 1.299s | Train Loss: 0.100248 |
2020-05-20 23:14:54,732 - root - INFO - | Epoch: 134/150 | Train Time: 1.309s | Train Loss: 0.090335 |
2020-05-20 23:14:55,803 - root - INFO - | Epoch: 135/150 | Train Time: 1.070s | Train Loss: 0.090446 |
2020-05-20 23:14:56,976 - root - INFO - | Epoch: 136/150 | Train Time: 1.173s | Train Loss: 0.094214 |
2020-05-20 23:14:58,083 - root - INFO - | Epoch: 137/150 | Train Time: 1.106s | Train Loss: 0.090548 |
2020-05-20 23:14:59,202 - root - INFO - | Epoch: 138/150 | Train Time: 1.119s | Train Loss: 0.089790 |
2020-05-20 23:15:00,385 - root - INFO - | Epoch: 139/150 | Train Time: 1.182s | Train Loss: 0.088429 |
2020-05-20 23:15:01,396 - root - INFO - | Epoch: 140/150 | Train Time: 1.011s | Train Loss: 0.093959 |
2020-05-20 23:15:02,484 - root - INFO - | Epoch: 141/150 | Train Time: 1.087s | Train Loss: 0.089287 |
2020-05-20 23:15:03,714 - root - INFO - | Epoch: 142/150 | Train Time: 1.230s | Train Loss: 0.088346 |
2020-05-20 23:15:04,905 - root - INFO - | Epoch: 143/150 | Train Time: 1.190s | Train Loss: 0.092244 |
2020-05-20 23:15:06,273 - root - INFO - | Epoch: 144/150 | Train Time: 1.368s | Train Loss: 0.088422 |
2020-05-20 23:15:07,633 - root - INFO - | Epoch: 145/150 | Train Time: 1.359s | Train Loss: 0.088943 |
2020-05-20 23:15:08,735 - root - INFO - | Epoch: 146/150 | Train Time: 1.102s | Train Loss: 0.089545 |
2020-05-20 23:15:09,778 - root - INFO - | Epoch: 147/150 | Train Time: 1.043s | Train Loss: 0.087050 |
2020-05-20 23:15:11,017 - root - INFO - | Epoch: 148/150 | Train Time: 1.238s | Train Loss: 0.087933 |
2020-05-20 23:15:12,270 - root - INFO - | Epoch: 149/150 | Train Time: 1.253s | Train Loss: 0.093287 |
2020-05-20 23:15:13,742 - root - INFO - | Epoch: 150/150 | Train Time: 1.471s | Train Loss: 0.086030 |
2020-05-20 23:15:13,742 - root - INFO - Training Time: 208.249s
2020-05-20 23:15:13,742 - root - INFO - Finished training.
2020-05-20 23:15:13,744 - root - INFO - Starting testing...
2020-05-20 23:15:15,257 - root - INFO - Test Loss: 0.241592
2020-05-20 23:15:15,258 - root - INFO - Test AUC: 66.85%
2020-05-20 23:15:15,258 - root - INFO - Test Time: 1.501s
2020-05-20 23:15:15,258 - root - INFO - Finished testing.
