2020-05-21 01:38:33,183 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_3_8_256.txt
2020-05-21 01:38:33,183 - root - INFO - Data path is ../data
2020-05-21 01:38:33,183 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 01:38:33,184 - root - INFO - Dataset: fmnist
2020-05-21 01:38:33,184 - root - INFO - Normal class: 3
2020-05-21 01:38:33,184 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 01:38:33,184 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 01:38:33,184 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 01:38:33,184 - root - INFO - Scenario Running: 5
2020-05-21 01:38:33,184 - root - INFO - Train only the network: True
2020-05-21 01:38:33,184 - root - INFO - Output and AE dimensions: 256
2020-05-21 01:38:33,184 - root - INFO - Known anomaly class: 8
2020-05-21 01:38:33,184 - root - INFO - Network: fmnist_LeNet
2020-05-21 01:38:33,185 - root - INFO - Eta-parameter: 1.00
2020-05-21 01:38:33,195 - root - INFO - Set seed to 0.
2020-05-21 01:38:33,685 - root - INFO - Computation device: cuda
2020-05-21 01:38:33,686 - root - INFO - Number of threads: 0
2020-05-21 01:38:33,686 - root - INFO - Number of dataloader workers: 6
2020-05-21 01:38:40,014 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_256.tar.
2020-05-21 01:38:40,035 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 01:38:40,035 - root - INFO - Pretraining: True
2020-05-21 01:38:40,035 - root - INFO - Training optimizer: adam
2020-05-21 01:38:40,035 - root - INFO - Training learning rate: 0.0001
2020-05-21 01:38:40,036 - root - INFO - Training epochs: 150
2020-05-21 01:38:40,036 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 01:38:40,036 - root - INFO - Training batch size: 200
2020-05-21 01:38:40,036 - root - INFO - Training weight decay: 5e-07
2020-05-21 01:38:40,039 - root - INFO - Starting training...
2020-05-21 01:38:45,007 - root - INFO - | Epoch: 001/150 | Train Time: 4.967s | Train Loss: 0.293942 |
2020-05-21 01:38:46,456 - root - INFO - | Epoch: 002/150 | Train Time: 1.448s | Train Loss: 0.174322 |
2020-05-21 01:38:47,897 - root - INFO - | Epoch: 003/150 | Train Time: 1.441s | Train Loss: 0.148731 |
2020-05-21 01:38:49,647 - root - INFO - | Epoch: 004/150 | Train Time: 1.749s | Train Loss: 0.129397 |
2020-05-21 01:38:51,597 - root - INFO - | Epoch: 005/150 | Train Time: 1.950s | Train Loss: 0.119382 |
2020-05-21 01:38:53,663 - root - INFO - | Epoch: 006/150 | Train Time: 2.065s | Train Loss: 0.113500 |
2020-05-21 01:38:55,263 - root - INFO - | Epoch: 007/150 | Train Time: 1.600s | Train Loss: 0.107578 |
2020-05-21 01:38:56,740 - root - INFO - | Epoch: 008/150 | Train Time: 1.477s | Train Loss: 0.106570 |
2020-05-21 01:38:58,116 - root - INFO - | Epoch: 009/150 | Train Time: 1.375s | Train Loss: 0.099698 |
2020-05-21 01:38:59,767 - root - INFO - | Epoch: 010/150 | Train Time: 1.650s | Train Loss: 0.097527 |
2020-05-21 01:39:01,556 - root - INFO - | Epoch: 011/150 | Train Time: 1.788s | Train Loss: 0.093544 |
2020-05-21 01:39:03,632 - root - INFO - | Epoch: 012/150 | Train Time: 2.076s | Train Loss: 0.092383 |
2020-05-21 01:39:05,438 - root - INFO - | Epoch: 013/150 | Train Time: 1.806s | Train Loss: 0.091443 |
2020-05-21 01:39:06,809 - root - INFO - | Epoch: 014/150 | Train Time: 1.371s | Train Loss: 0.089387 |
2020-05-21 01:39:08,260 - root - INFO - | Epoch: 015/150 | Train Time: 1.450s | Train Loss: 0.088717 |
2020-05-21 01:39:10,056 - root - INFO - | Epoch: 016/150 | Train Time: 1.796s | Train Loss: 0.086927 |
2020-05-21 01:39:11,795 - root - INFO - | Epoch: 017/150 | Train Time: 1.738s | Train Loss: 0.084034 |
2020-05-21 01:39:13,220 - root - INFO - | Epoch: 018/150 | Train Time: 1.425s | Train Loss: 0.081639 |
2020-05-21 01:39:14,408 - root - INFO - | Epoch: 019/150 | Train Time: 1.187s | Train Loss: 0.081982 |
2020-05-21 01:39:15,757 - root - INFO - | Epoch: 020/150 | Train Time: 1.348s | Train Loss: 0.082307 |
2020-05-21 01:39:17,336 - root - INFO - | Epoch: 021/150 | Train Time: 1.578s | Train Loss: 0.080146 |
2020-05-21 01:39:18,958 - root - INFO - | Epoch: 022/150 | Train Time: 1.622s | Train Loss: 0.077359 |
2020-05-21 01:39:20,594 - root - INFO - | Epoch: 023/150 | Train Time: 1.636s | Train Loss: 0.076917 |
2020-05-21 01:39:22,640 - root - INFO - | Epoch: 024/150 | Train Time: 2.046s | Train Loss: 0.077138 |
2020-05-21 01:39:24,403 - root - INFO - | Epoch: 025/150 | Train Time: 1.763s | Train Loss: 0.076082 |
2020-05-21 01:39:25,895 - root - INFO - | Epoch: 026/150 | Train Time: 1.491s | Train Loss: 0.074339 |
2020-05-21 01:39:27,511 - root - INFO - | Epoch: 027/150 | Train Time: 1.616s | Train Loss: 0.074458 |
2020-05-21 01:39:28,895 - root - INFO - | Epoch: 028/150 | Train Time: 1.383s | Train Loss: 0.072810 |
2020-05-21 01:39:30,569 - root - INFO - | Epoch: 029/150 | Train Time: 1.673s | Train Loss: 0.075176 |
2020-05-21 01:39:32,380 - root - INFO - | Epoch: 030/150 | Train Time: 1.811s | Train Loss: 0.074593 |
2020-05-21 01:39:33,938 - root - INFO - | Epoch: 031/150 | Train Time: 1.557s | Train Loss: 0.071398 |
2020-05-21 01:39:35,475 - root - INFO - | Epoch: 032/150 | Train Time: 1.537s | Train Loss: 0.074362 |
2020-05-21 01:39:37,059 - root - INFO - | Epoch: 033/150 | Train Time: 1.583s | Train Loss: 0.075830 |
2020-05-21 01:39:38,815 - root - INFO - | Epoch: 034/150 | Train Time: 1.756s | Train Loss: 0.070780 |
2020-05-21 01:39:40,167 - root - INFO - | Epoch: 035/150 | Train Time: 1.351s | Train Loss: 0.069119 |
2020-05-21 01:39:41,618 - root - INFO - | Epoch: 036/150 | Train Time: 1.451s | Train Loss: 0.068487 |
2020-05-21 01:39:43,885 - root - INFO - | Epoch: 037/150 | Train Time: 2.266s | Train Loss: 0.068501 |
2020-05-21 01:39:45,242 - root - INFO - | Epoch: 038/150 | Train Time: 1.357s | Train Loss: 0.069527 |
2020-05-21 01:39:47,079 - root - INFO - | Epoch: 039/150 | Train Time: 1.837s | Train Loss: 0.065182 |
2020-05-21 01:39:48,462 - root - INFO - | Epoch: 040/150 | Train Time: 1.382s | Train Loss: 0.066301 |
2020-05-21 01:39:50,110 - root - INFO - | Epoch: 041/150 | Train Time: 1.648s | Train Loss: 0.066015 |
2020-05-21 01:39:51,773 - root - INFO - | Epoch: 042/150 | Train Time: 1.661s | Train Loss: 0.065512 |
2020-05-21 01:39:53,390 - root - INFO - | Epoch: 043/150 | Train Time: 1.617s | Train Loss: 0.066375 |
2020-05-21 01:39:55,081 - root - INFO - | Epoch: 044/150 | Train Time: 1.689s | Train Loss: 0.068254 |
2020-05-21 01:39:56,792 - root - INFO - | Epoch: 045/150 | Train Time: 1.711s | Train Loss: 0.065930 |
2020-05-21 01:39:58,003 - root - INFO - | Epoch: 046/150 | Train Time: 1.210s | Train Loss: 0.064851 |
2020-05-21 01:39:59,711 - root - INFO - | Epoch: 047/150 | Train Time: 1.707s | Train Loss: 0.065640 |
2020-05-21 01:40:01,328 - root - INFO - | Epoch: 048/150 | Train Time: 1.617s | Train Loss: 0.065302 |
2020-05-21 01:40:03,515 - root - INFO - | Epoch: 049/150 | Train Time: 2.187s | Train Loss: 0.066077 |
2020-05-21 01:40:05,555 - root - INFO - | Epoch: 050/150 | Train Time: 2.040s | Train Loss: 0.061612 |
2020-05-21 01:40:05,556 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 01:40:07,387 - root - INFO - | Epoch: 051/150 | Train Time: 1.831s | Train Loss: 0.059388 |
2020-05-21 01:40:09,376 - root - INFO - | Epoch: 052/150 | Train Time: 1.989s | Train Loss: 0.061441 |
2020-05-21 01:40:11,155 - root - INFO - | Epoch: 053/150 | Train Time: 1.778s | Train Loss: 0.058639 |
2020-05-21 01:40:12,924 - root - INFO - | Epoch: 054/150 | Train Time: 1.768s | Train Loss: 0.060007 |
2020-05-21 01:40:14,629 - root - INFO - | Epoch: 055/150 | Train Time: 1.705s | Train Loss: 0.059434 |
2020-05-21 01:40:16,329 - root - INFO - | Epoch: 056/150 | Train Time: 1.699s | Train Loss: 0.059244 |
2020-05-21 01:40:17,946 - root - INFO - | Epoch: 057/150 | Train Time: 1.614s | Train Loss: 0.059471 |
2020-05-21 01:40:19,538 - root - INFO - | Epoch: 058/150 | Train Time: 1.592s | Train Loss: 0.059582 |
2020-05-21 01:40:21,440 - root - INFO - | Epoch: 059/150 | Train Time: 1.902s | Train Loss: 0.060389 |
2020-05-21 01:40:23,063 - root - INFO - | Epoch: 060/150 | Train Time: 1.623s | Train Loss: 0.059217 |
2020-05-21 01:40:24,570 - root - INFO - | Epoch: 061/150 | Train Time: 1.506s | Train Loss: 0.060406 |
2020-05-21 01:40:26,401 - root - INFO - | Epoch: 062/150 | Train Time: 1.831s | Train Loss: 0.060281 |
2020-05-21 01:40:28,007 - root - INFO - | Epoch: 063/150 | Train Time: 1.605s | Train Loss: 0.060623 |
2020-05-21 01:40:29,552 - root - INFO - | Epoch: 064/150 | Train Time: 1.544s | Train Loss: 0.059628 |
2020-05-21 01:40:30,894 - root - INFO - | Epoch: 065/150 | Train Time: 1.341s | Train Loss: 0.059767 |
2020-05-21 01:40:32,350 - root - INFO - | Epoch: 066/150 | Train Time: 1.456s | Train Loss: 0.059170 |
2020-05-21 01:40:33,950 - root - INFO - | Epoch: 067/150 | Train Time: 1.599s | Train Loss: 0.059335 |
2020-05-21 01:40:35,169 - root - INFO - | Epoch: 068/150 | Train Time: 1.219s | Train Loss: 0.059930 |
2020-05-21 01:40:36,760 - root - INFO - | Epoch: 069/150 | Train Time: 1.590s | Train Loss: 0.059193 |
2020-05-21 01:40:38,691 - root - INFO - | Epoch: 070/150 | Train Time: 1.931s | Train Loss: 0.059039 |
2020-05-21 01:40:40,477 - root - INFO - | Epoch: 071/150 | Train Time: 1.785s | Train Loss: 0.060041 |
2020-05-21 01:40:41,799 - root - INFO - | Epoch: 072/150 | Train Time: 1.321s | Train Loss: 0.060870 |
2020-05-21 01:40:43,694 - root - INFO - | Epoch: 073/150 | Train Time: 1.895s | Train Loss: 0.058716 |
2020-05-21 01:40:45,468 - root - INFO - | Epoch: 074/150 | Train Time: 1.773s | Train Loss: 0.060502 |
2020-05-21 01:40:46,886 - root - INFO - | Epoch: 075/150 | Train Time: 1.418s | Train Loss: 0.059021 |
2020-05-21 01:40:48,805 - root - INFO - | Epoch: 076/150 | Train Time: 1.918s | Train Loss: 0.059078 |
2020-05-21 01:40:50,479 - root - INFO - | Epoch: 077/150 | Train Time: 1.673s | Train Loss: 0.059494 |
2020-05-21 01:40:52,126 - root - INFO - | Epoch: 078/150 | Train Time: 1.646s | Train Loss: 0.059422 |
2020-05-21 01:40:53,595 - root - INFO - | Epoch: 079/150 | Train Time: 1.469s | Train Loss: 0.059448 |
2020-05-21 01:40:54,977 - root - INFO - | Epoch: 080/150 | Train Time: 1.381s | Train Loss: 0.058964 |
2020-05-21 01:40:56,465 - root - INFO - | Epoch: 081/150 | Train Time: 1.487s | Train Loss: 0.058652 |
2020-05-21 01:40:58,307 - root - INFO - | Epoch: 082/150 | Train Time: 1.842s | Train Loss: 0.058776 |
2020-05-21 01:41:00,190 - root - INFO - | Epoch: 083/150 | Train Time: 1.882s | Train Loss: 0.060091 |
2020-05-21 01:41:01,854 - root - INFO - | Epoch: 084/150 | Train Time: 1.663s | Train Loss: 0.057644 |
2020-05-21 01:41:04,232 - root - INFO - | Epoch: 085/150 | Train Time: 2.377s | Train Loss: 0.059196 |
2020-05-21 01:41:06,152 - root - INFO - | Epoch: 086/150 | Train Time: 1.920s | Train Loss: 0.058656 |
2020-05-21 01:41:07,733 - root - INFO - | Epoch: 087/150 | Train Time: 1.580s | Train Loss: 0.058412 |
2020-05-21 01:41:09,318 - root - INFO - | Epoch: 088/150 | Train Time: 1.585s | Train Loss: 0.057717 |
2020-05-21 01:41:11,015 - root - INFO - | Epoch: 089/150 | Train Time: 1.696s | Train Loss: 0.058197 |
2020-05-21 01:41:12,681 - root - INFO - | Epoch: 090/150 | Train Time: 1.665s | Train Loss: 0.057979 |
2020-05-21 01:41:14,103 - root - INFO - | Epoch: 091/150 | Train Time: 1.422s | Train Loss: 0.058909 |
2020-05-21 01:41:15,557 - root - INFO - | Epoch: 092/150 | Train Time: 1.453s | Train Loss: 0.059545 |
2020-05-21 01:41:17,559 - root - INFO - | Epoch: 093/150 | Train Time: 2.001s | Train Loss: 0.057236 |
2020-05-21 01:41:19,455 - root - INFO - | Epoch: 094/150 | Train Time: 1.895s | Train Loss: 0.058533 |
2020-05-21 01:41:20,895 - root - INFO - | Epoch: 095/150 | Train Time: 1.439s | Train Loss: 0.057409 |
2020-05-21 01:41:22,748 - root - INFO - | Epoch: 096/150 | Train Time: 1.853s | Train Loss: 0.057967 |
2020-05-21 01:41:24,782 - root - INFO - | Epoch: 097/150 | Train Time: 2.033s | Train Loss: 0.058842 |
2020-05-21 01:41:26,380 - root - INFO - | Epoch: 098/150 | Train Time: 1.598s | Train Loss: 0.057518 |
2020-05-21 01:41:27,557 - root - INFO - | Epoch: 099/150 | Train Time: 1.176s | Train Loss: 0.058748 |
2020-05-21 01:41:29,217 - root - INFO - | Epoch: 100/150 | Train Time: 1.660s | Train Loss: 0.059027 |
2020-05-21 01:41:30,737 - root - INFO - | Epoch: 101/150 | Train Time: 1.519s | Train Loss: 0.057757 |
2020-05-21 01:41:32,370 - root - INFO - | Epoch: 102/150 | Train Time: 1.633s | Train Loss: 0.057632 |
2020-05-21 01:41:33,941 - root - INFO - | Epoch: 103/150 | Train Time: 1.571s | Train Loss: 0.058674 |
2020-05-21 01:41:35,517 - root - INFO - | Epoch: 104/150 | Train Time: 1.576s | Train Loss: 0.058254 |
2020-05-21 01:41:37,306 - root - INFO - | Epoch: 105/150 | Train Time: 1.788s | Train Loss: 0.057352 |
2020-05-21 01:41:38,781 - root - INFO - | Epoch: 106/150 | Train Time: 1.474s | Train Loss: 0.058291 |
2020-05-21 01:41:40,510 - root - INFO - | Epoch: 107/150 | Train Time: 1.729s | Train Loss: 0.057005 |
2020-05-21 01:41:41,823 - root - INFO - | Epoch: 108/150 | Train Time: 1.313s | Train Loss: 0.057948 |
2020-05-21 01:41:43,325 - root - INFO - | Epoch: 109/150 | Train Time: 1.501s | Train Loss: 0.057009 |
2020-05-21 01:41:44,653 - root - INFO - | Epoch: 110/150 | Train Time: 1.327s | Train Loss: 0.057125 |
2020-05-21 01:41:46,201 - root - INFO - | Epoch: 111/150 | Train Time: 1.548s | Train Loss: 0.057358 |
2020-05-21 01:41:47,699 - root - INFO - | Epoch: 112/150 | Train Time: 1.497s | Train Loss: 0.057017 |
2020-05-21 01:41:49,198 - root - INFO - | Epoch: 113/150 | Train Time: 1.499s | Train Loss: 0.058647 |
2020-05-21 01:41:50,910 - root - INFO - | Epoch: 114/150 | Train Time: 1.711s | Train Loss: 0.057919 |
2020-05-21 01:41:52,442 - root - INFO - | Epoch: 115/150 | Train Time: 1.532s | Train Loss: 0.056603 |
2020-05-21 01:41:53,918 - root - INFO - | Epoch: 116/150 | Train Time: 1.476s | Train Loss: 0.058795 |
2020-05-21 01:41:55,618 - root - INFO - | Epoch: 117/150 | Train Time: 1.699s | Train Loss: 0.058714 |
2020-05-21 01:41:57,059 - root - INFO - | Epoch: 118/150 | Train Time: 1.441s | Train Loss: 0.056930 |
2020-05-21 01:41:58,812 - root - INFO - | Epoch: 119/150 | Train Time: 1.752s | Train Loss: 0.057251 |
2020-05-21 01:42:00,700 - root - INFO - | Epoch: 120/150 | Train Time: 1.887s | Train Loss: 0.057553 |
2020-05-21 01:42:02,339 - root - INFO - | Epoch: 121/150 | Train Time: 1.639s | Train Loss: 0.057183 |
2020-05-21 01:42:04,052 - root - INFO - | Epoch: 122/150 | Train Time: 1.712s | Train Loss: 0.058300 |
2020-05-21 01:42:05,872 - root - INFO - | Epoch: 123/150 | Train Time: 1.820s | Train Loss: 0.056201 |
2020-05-21 01:42:07,290 - root - INFO - | Epoch: 124/150 | Train Time: 1.416s | Train Loss: 0.056634 |
2020-05-21 01:42:09,046 - root - INFO - | Epoch: 125/150 | Train Time: 1.756s | Train Loss: 0.056744 |
2020-05-21 01:42:10,638 - root - INFO - | Epoch: 126/150 | Train Time: 1.591s | Train Loss: 0.057590 |
2020-05-21 01:42:12,211 - root - INFO - | Epoch: 127/150 | Train Time: 1.573s | Train Loss: 0.056697 |
2020-05-21 01:42:13,914 - root - INFO - | Epoch: 128/150 | Train Time: 1.702s | Train Loss: 0.057314 |
2020-05-21 01:42:15,181 - root - INFO - | Epoch: 129/150 | Train Time: 1.267s | Train Loss: 0.056248 |
2020-05-21 01:42:17,035 - root - INFO - | Epoch: 130/150 | Train Time: 1.853s | Train Loss: 0.056151 |
2020-05-21 01:42:19,000 - root - INFO - | Epoch: 131/150 | Train Time: 1.965s | Train Loss: 0.055962 |
2020-05-21 01:42:20,672 - root - INFO - | Epoch: 132/150 | Train Time: 1.672s | Train Loss: 0.057521 |
2020-05-21 01:42:21,847 - root - INFO - | Epoch: 133/150 | Train Time: 1.175s | Train Loss: 0.055695 |
2020-05-21 01:42:23,640 - root - INFO - | Epoch: 134/150 | Train Time: 1.793s | Train Loss: 0.057085 |
2020-05-21 01:42:25,222 - root - INFO - | Epoch: 135/150 | Train Time: 1.581s | Train Loss: 0.057191 |
2020-05-21 01:42:26,885 - root - INFO - | Epoch: 136/150 | Train Time: 1.662s | Train Loss: 0.056038 |
2020-05-21 01:42:28,611 - root - INFO - | Epoch: 137/150 | Train Time: 1.726s | Train Loss: 0.056381 |
2020-05-21 01:42:30,373 - root - INFO - | Epoch: 138/150 | Train Time: 1.762s | Train Loss: 0.055855 |
2020-05-21 01:42:32,061 - root - INFO - | Epoch: 139/150 | Train Time: 1.687s | Train Loss: 0.056952 |
2020-05-21 01:42:33,689 - root - INFO - | Epoch: 140/150 | Train Time: 1.628s | Train Loss: 0.055680 |
2020-05-21 01:42:35,252 - root - INFO - | Epoch: 141/150 | Train Time: 1.562s | Train Loss: 0.056573 |
2020-05-21 01:42:36,991 - root - INFO - | Epoch: 142/150 | Train Time: 1.739s | Train Loss: 0.055349 |
2020-05-21 01:42:38,548 - root - INFO - | Epoch: 143/150 | Train Time: 1.556s | Train Loss: 0.056514 |
2020-05-21 01:42:40,120 - root - INFO - | Epoch: 144/150 | Train Time: 1.572s | Train Loss: 0.055749 |
2020-05-21 01:42:41,804 - root - INFO - | Epoch: 145/150 | Train Time: 1.683s | Train Loss: 0.054941 |
2020-05-21 01:42:43,597 - root - INFO - | Epoch: 146/150 | Train Time: 1.792s | Train Loss: 0.055349 |
2020-05-21 01:42:45,757 - root - INFO - | Epoch: 147/150 | Train Time: 2.160s | Train Loss: 0.055585 |
2020-05-21 01:42:47,435 - root - INFO - | Epoch: 148/150 | Train Time: 1.677s | Train Loss: 0.055524 |
2020-05-21 01:42:49,332 - root - INFO - | Epoch: 149/150 | Train Time: 1.897s | Train Loss: 0.055873 |
2020-05-21 01:42:50,968 - root - INFO - | Epoch: 150/150 | Train Time: 1.635s | Train Loss: 0.054828 |
2020-05-21 01:42:50,968 - root - INFO - Training Time: 250.929s
2020-05-21 01:42:50,968 - root - INFO - Finished training.
2020-05-21 01:42:50,970 - root - INFO - Starting testing...
2020-05-21 01:42:52,452 - root - INFO - Test Loss: 0.252975
2020-05-21 01:42:52,452 - root - INFO - Test AUC: 83.86%
2020-05-21 01:42:52,453 - root - INFO - Test Time: 1.468s
2020-05-21 01:42:52,453 - root - INFO - Finished testing.
