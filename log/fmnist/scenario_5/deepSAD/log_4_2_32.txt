2020-05-21 03:00:34,347 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_4_2_32.txt
2020-05-21 03:00:34,347 - root - INFO - Data path is ../data
2020-05-21 03:00:34,347 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 03:00:34,347 - root - INFO - Dataset: fmnist
2020-05-21 03:00:34,347 - root - INFO - Normal class: 4
2020-05-21 03:00:34,347 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 03:00:34,347 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 03:00:34,347 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 03:00:34,347 - root - INFO - Scenario Running: 5
2020-05-21 03:00:34,347 - root - INFO - Train only the network: True
2020-05-21 03:00:34,347 - root - INFO - Output and AE dimensions: 32
2020-05-21 03:00:34,347 - root - INFO - Known anomaly class: 2
2020-05-21 03:00:34,347 - root - INFO - Network: fmnist_LeNet
2020-05-21 03:00:34,348 - root - INFO - Eta-parameter: 1.00
2020-05-21 03:00:34,363 - root - INFO - Set seed to 0.
2020-05-21 03:00:34,406 - root - INFO - Computation device: cuda
2020-05-21 03:00:34,406 - root - INFO - Number of threads: 0
2020-05-21 03:00:34,406 - root - INFO - Number of dataloader workers: 6
2020-05-21 03:00:39,503 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_32.tar.
2020-05-21 03:00:39,515 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 03:00:39,515 - root - INFO - Pretraining: True
2020-05-21 03:00:39,515 - root - INFO - Training optimizer: adam
2020-05-21 03:00:39,515 - root - INFO - Training learning rate: 0.0001
2020-05-21 03:00:39,515 - root - INFO - Training epochs: 150
2020-05-21 03:00:39,515 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 03:00:39,515 - root - INFO - Training batch size: 200
2020-05-21 03:00:39,516 - root - INFO - Training weight decay: 5e-07
2020-05-21 03:00:39,519 - root - INFO - Starting training...
2020-05-21 03:00:43,496 - root - INFO - | Epoch: 001/150 | Train Time: 3.977s | Train Loss: 0.464109 |
2020-05-21 03:00:45,270 - root - INFO - | Epoch: 002/150 | Train Time: 1.774s | Train Loss: 0.307319 |
2020-05-21 03:00:47,082 - root - INFO - | Epoch: 003/150 | Train Time: 1.811s | Train Loss: 0.259947 |
2020-05-21 03:00:48,457 - root - INFO - | Epoch: 004/150 | Train Time: 1.374s | Train Loss: 0.235060 |
2020-05-21 03:00:50,037 - root - INFO - | Epoch: 005/150 | Train Time: 1.580s | Train Loss: 0.214601 |
2020-05-21 03:00:51,579 - root - INFO - | Epoch: 006/150 | Train Time: 1.541s | Train Loss: 0.202183 |
2020-05-21 03:00:53,375 - root - INFO - | Epoch: 007/150 | Train Time: 1.792s | Train Loss: 0.193186 |
2020-05-21 03:00:55,174 - root - INFO - | Epoch: 008/150 | Train Time: 1.798s | Train Loss: 0.181975 |
2020-05-21 03:00:57,086 - root - INFO - | Epoch: 009/150 | Train Time: 1.912s | Train Loss: 0.175080 |
2020-05-21 03:00:58,954 - root - INFO - | Epoch: 010/150 | Train Time: 1.867s | Train Loss: 0.165412 |
2020-05-21 03:01:00,544 - root - INFO - | Epoch: 011/150 | Train Time: 1.589s | Train Loss: 0.158690 |
2020-05-21 03:01:02,461 - root - INFO - | Epoch: 012/150 | Train Time: 1.917s | Train Loss: 0.151895 |
2020-05-21 03:01:04,412 - root - INFO - | Epoch: 013/150 | Train Time: 1.951s | Train Loss: 0.147016 |
2020-05-21 03:01:06,441 - root - INFO - | Epoch: 014/150 | Train Time: 2.028s | Train Loss: 0.142329 |
2020-05-21 03:01:08,387 - root - INFO - | Epoch: 015/150 | Train Time: 1.945s | Train Loss: 0.139659 |
2020-05-21 03:01:09,858 - root - INFO - | Epoch: 016/150 | Train Time: 1.471s | Train Loss: 0.134043 |
2020-05-21 03:01:11,721 - root - INFO - | Epoch: 017/150 | Train Time: 1.862s | Train Loss: 0.131854 |
2020-05-21 03:01:13,724 - root - INFO - | Epoch: 018/150 | Train Time: 2.003s | Train Loss: 0.126683 |
2020-05-21 03:01:15,656 - root - INFO - | Epoch: 019/150 | Train Time: 1.931s | Train Loss: 0.121003 |
2020-05-21 03:01:17,462 - root - INFO - | Epoch: 020/150 | Train Time: 1.806s | Train Loss: 0.118719 |
2020-05-21 03:01:19,030 - root - INFO - | Epoch: 021/150 | Train Time: 1.568s | Train Loss: 0.115429 |
2020-05-21 03:01:20,134 - root - INFO - | Epoch: 022/150 | Train Time: 1.102s | Train Loss: 0.112071 |
2020-05-21 03:01:21,174 - root - INFO - | Epoch: 023/150 | Train Time: 1.039s | Train Loss: 0.111585 |
2020-05-21 03:01:22,495 - root - INFO - | Epoch: 024/150 | Train Time: 1.321s | Train Loss: 0.105570 |
2020-05-21 03:01:24,021 - root - INFO - | Epoch: 025/150 | Train Time: 1.525s | Train Loss: 0.105085 |
2020-05-21 03:01:25,728 - root - INFO - | Epoch: 026/150 | Train Time: 1.706s | Train Loss: 0.105961 |
2020-05-21 03:01:27,433 - root - INFO - | Epoch: 027/150 | Train Time: 1.705s | Train Loss: 0.100963 |
2020-05-21 03:01:28,671 - root - INFO - | Epoch: 028/150 | Train Time: 1.238s | Train Loss: 0.095439 |
2020-05-21 03:01:30,231 - root - INFO - | Epoch: 029/150 | Train Time: 1.559s | Train Loss: 0.092851 |
2020-05-21 03:01:31,854 - root - INFO - | Epoch: 030/150 | Train Time: 1.623s | Train Loss: 0.092821 |
2020-05-21 03:01:33,466 - root - INFO - | Epoch: 031/150 | Train Time: 1.611s | Train Loss: 0.090278 |
2020-05-21 03:01:35,170 - root - INFO - | Epoch: 032/150 | Train Time: 1.704s | Train Loss: 0.086108 |
2020-05-21 03:01:36,700 - root - INFO - | Epoch: 033/150 | Train Time: 1.530s | Train Loss: 0.091115 |
2020-05-21 03:01:38,349 - root - INFO - | Epoch: 034/150 | Train Time: 1.648s | Train Loss: 0.086559 |
2020-05-21 03:01:39,929 - root - INFO - | Epoch: 035/150 | Train Time: 1.580s | Train Loss: 0.083057 |
2020-05-21 03:01:41,451 - root - INFO - | Epoch: 036/150 | Train Time: 1.519s | Train Loss: 0.081299 |
2020-05-21 03:01:42,848 - root - INFO - | Epoch: 037/150 | Train Time: 1.396s | Train Loss: 0.079186 |
2020-05-21 03:01:43,767 - root - INFO - | Epoch: 038/150 | Train Time: 0.918s | Train Loss: 0.077111 |
2020-05-21 03:01:45,024 - root - INFO - | Epoch: 039/150 | Train Time: 1.257s | Train Loss: 0.077100 |
2020-05-21 03:01:46,237 - root - INFO - | Epoch: 040/150 | Train Time: 1.212s | Train Loss: 0.073730 |
2020-05-21 03:01:47,526 - root - INFO - | Epoch: 041/150 | Train Time: 1.288s | Train Loss: 0.072733 |
2020-05-21 03:01:48,930 - root - INFO - | Epoch: 042/150 | Train Time: 1.404s | Train Loss: 0.069989 |
2020-05-21 03:01:49,999 - root - INFO - | Epoch: 043/150 | Train Time: 1.068s | Train Loss: 0.075773 |
2020-05-21 03:01:51,194 - root - INFO - | Epoch: 044/150 | Train Time: 1.195s | Train Loss: 0.071159 |
2020-05-21 03:01:52,874 - root - INFO - | Epoch: 045/150 | Train Time: 1.680s | Train Loss: 0.067343 |
2020-05-21 03:01:54,512 - root - INFO - | Epoch: 046/150 | Train Time: 1.637s | Train Loss: 0.070121 |
2020-05-21 03:01:56,006 - root - INFO - | Epoch: 047/150 | Train Time: 1.492s | Train Loss: 0.064796 |
2020-05-21 03:01:57,165 - root - INFO - | Epoch: 048/150 | Train Time: 1.158s | Train Loss: 0.064271 |
2020-05-21 03:01:58,746 - root - INFO - | Epoch: 049/150 | Train Time: 1.580s | Train Loss: 0.067279 |
2020-05-21 03:02:00,768 - root - INFO - | Epoch: 050/150 | Train Time: 2.022s | Train Loss: 0.060070 |
2020-05-21 03:02:00,769 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 03:02:02,609 - root - INFO - | Epoch: 051/150 | Train Time: 1.840s | Train Loss: 0.058654 |
2020-05-21 03:02:04,534 - root - INFO - | Epoch: 052/150 | Train Time: 1.925s | Train Loss: 0.058973 |
2020-05-21 03:02:06,019 - root - INFO - | Epoch: 053/150 | Train Time: 1.484s | Train Loss: 0.058034 |
2020-05-21 03:02:07,691 - root - INFO - | Epoch: 054/150 | Train Time: 1.671s | Train Loss: 0.059693 |
2020-05-21 03:02:09,269 - root - INFO - | Epoch: 055/150 | Train Time: 1.577s | Train Loss: 0.058596 |
2020-05-21 03:02:10,752 - root - INFO - | Epoch: 056/150 | Train Time: 1.483s | Train Loss: 0.058092 |
2020-05-21 03:02:12,349 - root - INFO - | Epoch: 057/150 | Train Time: 1.596s | Train Loss: 0.057997 |
2020-05-21 03:02:13,965 - root - INFO - | Epoch: 058/150 | Train Time: 1.616s | Train Loss: 0.058265 |
2020-05-21 03:02:15,714 - root - INFO - | Epoch: 059/150 | Train Time: 1.748s | Train Loss: 0.057792 |
2020-05-21 03:02:17,168 - root - INFO - | Epoch: 060/150 | Train Time: 1.453s | Train Loss: 0.058938 |
2020-05-21 03:02:18,835 - root - INFO - | Epoch: 061/150 | Train Time: 1.666s | Train Loss: 0.058518 |
2020-05-21 03:02:20,377 - root - INFO - | Epoch: 062/150 | Train Time: 1.541s | Train Loss: 0.056111 |
2020-05-21 03:02:21,922 - root - INFO - | Epoch: 063/150 | Train Time: 1.545s | Train Loss: 0.057428 |
2020-05-21 03:02:23,798 - root - INFO - | Epoch: 064/150 | Train Time: 1.876s | Train Loss: 0.057803 |
2020-05-21 03:02:25,653 - root - INFO - | Epoch: 065/150 | Train Time: 1.854s | Train Loss: 0.056206 |
2020-05-21 03:02:26,944 - root - INFO - | Epoch: 066/150 | Train Time: 1.290s | Train Loss: 0.057431 |
2020-05-21 03:02:28,577 - root - INFO - | Epoch: 067/150 | Train Time: 1.632s | Train Loss: 0.057436 |
2020-05-21 03:02:29,764 - root - INFO - | Epoch: 068/150 | Train Time: 1.186s | Train Loss: 0.056968 |
2020-05-21 03:02:31,409 - root - INFO - | Epoch: 069/150 | Train Time: 1.645s | Train Loss: 0.056941 |
2020-05-21 03:02:32,654 - root - INFO - | Epoch: 070/150 | Train Time: 1.244s | Train Loss: 0.056144 |
2020-05-21 03:02:34,455 - root - INFO - | Epoch: 071/150 | Train Time: 1.801s | Train Loss: 0.056575 |
2020-05-21 03:02:35,853 - root - INFO - | Epoch: 072/150 | Train Time: 1.397s | Train Loss: 0.057384 |
2020-05-21 03:02:37,914 - root - INFO - | Epoch: 073/150 | Train Time: 2.061s | Train Loss: 0.055744 |
2020-05-21 03:02:40,049 - root - INFO - | Epoch: 074/150 | Train Time: 2.134s | Train Loss: 0.055851 |
2020-05-21 03:02:41,986 - root - INFO - | Epoch: 075/150 | Train Time: 1.936s | Train Loss: 0.057090 |
2020-05-21 03:02:43,735 - root - INFO - | Epoch: 076/150 | Train Time: 1.749s | Train Loss: 0.055506 |
2020-05-21 03:02:45,395 - root - INFO - | Epoch: 077/150 | Train Time: 1.659s | Train Loss: 0.055571 |
2020-05-21 03:02:47,058 - root - INFO - | Epoch: 078/150 | Train Time: 1.663s | Train Loss: 0.054483 |
2020-05-21 03:02:48,729 - root - INFO - | Epoch: 079/150 | Train Time: 1.670s | Train Loss: 0.055793 |
2020-05-21 03:02:50,856 - root - INFO - | Epoch: 080/150 | Train Time: 2.127s | Train Loss: 0.054598 |
2020-05-21 03:02:52,393 - root - INFO - | Epoch: 081/150 | Train Time: 1.536s | Train Loss: 0.055524 |
2020-05-21 03:02:54,341 - root - INFO - | Epoch: 082/150 | Train Time: 1.948s | Train Loss: 0.054891 |
2020-05-21 03:02:55,902 - root - INFO - | Epoch: 083/150 | Train Time: 1.561s | Train Loss: 0.053869 |
2020-05-21 03:02:57,528 - root - INFO - | Epoch: 084/150 | Train Time: 1.625s | Train Loss: 0.054186 |
2020-05-21 03:02:59,275 - root - INFO - | Epoch: 085/150 | Train Time: 1.747s | Train Loss: 0.055239 |
2020-05-21 03:03:01,159 - root - INFO - | Epoch: 086/150 | Train Time: 1.883s | Train Loss: 0.053612 |
2020-05-21 03:03:02,989 - root - INFO - | Epoch: 087/150 | Train Time: 1.829s | Train Loss: 0.054727 |
2020-05-21 03:03:04,750 - root - INFO - | Epoch: 088/150 | Train Time: 1.761s | Train Loss: 0.054037 |
2020-05-21 03:03:06,476 - root - INFO - | Epoch: 089/150 | Train Time: 1.726s | Train Loss: 0.053717 |
2020-05-21 03:03:08,124 - root - INFO - | Epoch: 090/150 | Train Time: 1.648s | Train Loss: 0.054954 |
2020-05-21 03:03:09,704 - root - INFO - | Epoch: 091/150 | Train Time: 1.579s | Train Loss: 0.053417 |
2020-05-21 03:03:10,923 - root - INFO - | Epoch: 092/150 | Train Time: 1.219s | Train Loss: 0.052799 |
2020-05-21 03:03:12,035 - root - INFO - | Epoch: 093/150 | Train Time: 1.111s | Train Loss: 0.052559 |
2020-05-21 03:03:13,446 - root - INFO - | Epoch: 094/150 | Train Time: 1.411s | Train Loss: 0.053451 |
2020-05-21 03:03:15,372 - root - INFO - | Epoch: 095/150 | Train Time: 1.926s | Train Loss: 0.054066 |
2020-05-21 03:03:16,996 - root - INFO - | Epoch: 096/150 | Train Time: 1.623s | Train Loss: 0.053733 |
2020-05-21 03:03:18,428 - root - INFO - | Epoch: 097/150 | Train Time: 1.431s | Train Loss: 0.053320 |
2020-05-21 03:03:20,446 - root - INFO - | Epoch: 098/150 | Train Time: 2.018s | Train Loss: 0.053529 |
2020-05-21 03:03:22,175 - root - INFO - | Epoch: 099/150 | Train Time: 1.728s | Train Loss: 0.052931 |
2020-05-21 03:03:23,659 - root - INFO - | Epoch: 100/150 | Train Time: 1.484s | Train Loss: 0.051699 |
2020-05-21 03:03:25,217 - root - INFO - | Epoch: 101/150 | Train Time: 1.557s | Train Loss: 0.052925 |
2020-05-21 03:03:26,617 - root - INFO - | Epoch: 102/150 | Train Time: 1.400s | Train Loss: 0.052505 |
2020-05-21 03:03:27,759 - root - INFO - | Epoch: 103/150 | Train Time: 1.142s | Train Loss: 0.052414 |
2020-05-21 03:03:29,139 - root - INFO - | Epoch: 104/150 | Train Time: 1.378s | Train Loss: 0.051695 |
2020-05-21 03:03:30,557 - root - INFO - | Epoch: 105/150 | Train Time: 1.418s | Train Loss: 0.052046 |
2020-05-21 03:03:31,918 - root - INFO - | Epoch: 106/150 | Train Time: 1.360s | Train Loss: 0.051648 |
2020-05-21 03:03:33,342 - root - INFO - | Epoch: 107/150 | Train Time: 1.423s | Train Loss: 0.051967 |
2020-05-21 03:03:34,904 - root - INFO - | Epoch: 108/150 | Train Time: 1.561s | Train Loss: 0.051996 |
2020-05-21 03:03:36,131 - root - INFO - | Epoch: 109/150 | Train Time: 1.226s | Train Loss: 0.050891 |
2020-05-21 03:03:37,300 - root - INFO - | Epoch: 110/150 | Train Time: 1.169s | Train Loss: 0.051550 |
2020-05-21 03:03:38,615 - root - INFO - | Epoch: 111/150 | Train Time: 1.315s | Train Loss: 0.053156 |
2020-05-21 03:03:39,913 - root - INFO - | Epoch: 112/150 | Train Time: 1.297s | Train Loss: 0.050738 |
2020-05-21 03:03:41,260 - root - INFO - | Epoch: 113/150 | Train Time: 1.346s | Train Loss: 0.050850 |
2020-05-21 03:03:42,688 - root - INFO - | Epoch: 114/150 | Train Time: 1.428s | Train Loss: 0.050526 |
2020-05-21 03:03:44,089 - root - INFO - | Epoch: 115/150 | Train Time: 1.400s | Train Loss: 0.052327 |
2020-05-21 03:03:45,442 - root - INFO - | Epoch: 116/150 | Train Time: 1.353s | Train Loss: 0.050475 |
2020-05-21 03:03:46,684 - root - INFO - | Epoch: 117/150 | Train Time: 1.241s | Train Loss: 0.050131 |
2020-05-21 03:03:47,758 - root - INFO - | Epoch: 118/150 | Train Time: 1.074s | Train Loss: 0.051539 |
2020-05-21 03:03:48,882 - root - INFO - | Epoch: 119/150 | Train Time: 1.124s | Train Loss: 0.051431 |
2020-05-21 03:03:49,737 - root - INFO - | Epoch: 120/150 | Train Time: 0.854s | Train Loss: 0.049254 |
2020-05-21 03:03:50,831 - root - INFO - | Epoch: 121/150 | Train Time: 1.093s | Train Loss: 0.050776 |
2020-05-21 03:03:52,344 - root - INFO - | Epoch: 122/150 | Train Time: 1.512s | Train Loss: 0.050691 |
2020-05-21 03:03:53,876 - root - INFO - | Epoch: 123/150 | Train Time: 1.532s | Train Loss: 0.050962 |
2020-05-21 03:03:55,309 - root - INFO - | Epoch: 124/150 | Train Time: 1.432s | Train Loss: 0.050938 |
2020-05-21 03:03:56,968 - root - INFO - | Epoch: 125/150 | Train Time: 1.658s | Train Loss: 0.049339 |
2020-05-21 03:03:58,361 - root - INFO - | Epoch: 126/150 | Train Time: 1.392s | Train Loss: 0.050324 |
2020-05-21 03:04:00,350 - root - INFO - | Epoch: 127/150 | Train Time: 1.989s | Train Loss: 0.049524 |
2020-05-21 03:04:02,378 - root - INFO - | Epoch: 128/150 | Train Time: 2.027s | Train Loss: 0.048835 |
2020-05-21 03:04:04,039 - root - INFO - | Epoch: 129/150 | Train Time: 1.660s | Train Loss: 0.048437 |
2020-05-21 03:04:05,734 - root - INFO - | Epoch: 130/150 | Train Time: 1.694s | Train Loss: 0.049823 |
2020-05-21 03:04:07,464 - root - INFO - | Epoch: 131/150 | Train Time: 1.730s | Train Loss: 0.048478 |
2020-05-21 03:04:09,376 - root - INFO - | Epoch: 132/150 | Train Time: 1.911s | Train Loss: 0.047188 |
2020-05-21 03:04:11,325 - root - INFO - | Epoch: 133/150 | Train Time: 1.949s | Train Loss: 0.048701 |
2020-05-21 03:04:13,150 - root - INFO - | Epoch: 134/150 | Train Time: 1.824s | Train Loss: 0.048642 |
2020-05-21 03:04:14,776 - root - INFO - | Epoch: 135/150 | Train Time: 1.626s | Train Loss: 0.048135 |
2020-05-21 03:04:16,204 - root - INFO - | Epoch: 136/150 | Train Time: 1.427s | Train Loss: 0.048449 |
2020-05-21 03:04:17,922 - root - INFO - | Epoch: 137/150 | Train Time: 1.717s | Train Loss: 0.049107 |
2020-05-21 03:04:19,615 - root - INFO - | Epoch: 138/150 | Train Time: 1.693s | Train Loss: 0.048351 |
2020-05-21 03:04:21,327 - root - INFO - | Epoch: 139/150 | Train Time: 1.711s | Train Loss: 0.047181 |
2020-05-21 03:04:23,252 - root - INFO - | Epoch: 140/150 | Train Time: 1.925s | Train Loss: 0.048537 |
2020-05-21 03:04:24,558 - root - INFO - | Epoch: 141/150 | Train Time: 1.305s | Train Loss: 0.047724 |
2020-05-21 03:04:26,696 - root - INFO - | Epoch: 142/150 | Train Time: 2.137s | Train Loss: 0.049414 |
2020-05-21 03:04:28,478 - root - INFO - | Epoch: 143/150 | Train Time: 1.781s | Train Loss: 0.046435 |
2020-05-21 03:04:30,241 - root - INFO - | Epoch: 144/150 | Train Time: 1.763s | Train Loss: 0.048112 |
2020-05-21 03:04:31,932 - root - INFO - | Epoch: 145/150 | Train Time: 1.690s | Train Loss: 0.046788 |
2020-05-21 03:04:33,351 - root - INFO - | Epoch: 146/150 | Train Time: 1.419s | Train Loss: 0.048032 |
2020-05-21 03:04:35,384 - root - INFO - | Epoch: 147/150 | Train Time: 2.033s | Train Loss: 0.048574 |
2020-05-21 03:04:37,704 - root - INFO - | Epoch: 148/150 | Train Time: 2.319s | Train Loss: 0.046155 |
2020-05-21 03:04:39,218 - root - INFO - | Epoch: 149/150 | Train Time: 1.514s | Train Loss: 0.046905 |
2020-05-21 03:04:40,622 - root - INFO - | Epoch: 150/150 | Train Time: 1.403s | Train Loss: 0.046615 |
2020-05-21 03:04:40,622 - root - INFO - Training Time: 241.103s
2020-05-21 03:04:40,622 - root - INFO - Finished training.
2020-05-21 03:04:40,624 - root - INFO - Starting testing...
2020-05-21 03:04:42,414 - root - INFO - Test Loss: 0.264195
2020-05-21 03:04:42,414 - root - INFO - Test AUC: 72.85%
2020-05-21 03:04:42,415 - root - INFO - Test Time: 1.778s
2020-05-21 03:04:42,415 - root - INFO - Finished testing.
