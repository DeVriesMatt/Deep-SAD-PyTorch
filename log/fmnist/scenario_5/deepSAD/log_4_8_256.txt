2020-05-21 05:03:12,035 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_4_8_256.txt
2020-05-21 05:03:12,035 - root - INFO - Data path is ../data
2020-05-21 05:03:12,035 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 05:03:12,035 - root - INFO - Dataset: fmnist
2020-05-21 05:03:12,035 - root - INFO - Normal class: 4
2020-05-21 05:03:12,035 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 05:03:12,035 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 05:03:12,036 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 05:03:12,036 - root - INFO - Scenario Running: 5
2020-05-21 05:03:12,036 - root - INFO - Train only the network: True
2020-05-21 05:03:12,036 - root - INFO - Output and AE dimensions: 256
2020-05-21 05:03:12,036 - root - INFO - Known anomaly class: 8
2020-05-21 05:03:12,036 - root - INFO - Network: fmnist_LeNet
2020-05-21 05:03:12,036 - root - INFO - Eta-parameter: 1.00
2020-05-21 05:03:12,044 - root - INFO - Set seed to 0.
2020-05-21 05:03:12,117 - root - INFO - Computation device: cuda
2020-05-21 05:03:12,117 - root - INFO - Number of threads: 0
2020-05-21 05:03:12,117 - root - INFO - Number of dataloader workers: 6
2020-05-21 05:03:17,416 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_256.tar.
2020-05-21 05:03:17,416 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 05:03:17,416 - root - INFO - Pretraining: True
2020-05-21 05:03:17,416 - root - INFO - Training optimizer: adam
2020-05-21 05:03:17,416 - root - INFO - Training learning rate: 0.0001
2020-05-21 05:03:17,416 - root - INFO - Training epochs: 150
2020-05-21 05:03:17,417 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 05:03:17,417 - root - INFO - Training batch size: 200
2020-05-21 05:03:17,417 - root - INFO - Training weight decay: 5e-07
2020-05-21 05:03:17,443 - root - INFO - Starting training...
2020-05-21 05:03:22,228 - root - INFO - | Epoch: 001/150 | Train Time: 4.786s | Train Loss: 0.262535 |
2020-05-21 05:03:24,008 - root - INFO - | Epoch: 002/150 | Train Time: 1.779s | Train Loss: 0.149700 |
2020-05-21 05:03:25,978 - root - INFO - | Epoch: 003/150 | Train Time: 1.970s | Train Loss: 0.128980 |
2020-05-21 05:03:27,934 - root - INFO - | Epoch: 004/150 | Train Time: 1.956s | Train Loss: 0.117506 |
2020-05-21 05:03:29,521 - root - INFO - | Epoch: 005/150 | Train Time: 1.586s | Train Loss: 0.112872 |
2020-05-21 05:03:31,323 - root - INFO - | Epoch: 006/150 | Train Time: 1.801s | Train Loss: 0.103879 |
2020-05-21 05:03:32,651 - root - INFO - | Epoch: 007/150 | Train Time: 1.328s | Train Loss: 0.099413 |
2020-05-21 05:03:34,778 - root - INFO - | Epoch: 008/150 | Train Time: 2.127s | Train Loss: 0.096426 |
2020-05-21 05:03:36,314 - root - INFO - | Epoch: 009/150 | Train Time: 1.536s | Train Loss: 0.096358 |
2020-05-21 05:03:38,220 - root - INFO - | Epoch: 010/150 | Train Time: 1.905s | Train Loss: 0.089732 |
2020-05-21 05:03:39,924 - root - INFO - | Epoch: 011/150 | Train Time: 1.703s | Train Loss: 0.089210 |
2020-05-21 05:03:41,664 - root - INFO - | Epoch: 012/150 | Train Time: 1.739s | Train Loss: 0.087826 |
2020-05-21 05:03:43,144 - root - INFO - | Epoch: 013/150 | Train Time: 1.480s | Train Loss: 0.086726 |
2020-05-21 05:03:44,867 - root - INFO - | Epoch: 014/150 | Train Time: 1.722s | Train Loss: 0.084689 |
2020-05-21 05:03:46,261 - root - INFO - | Epoch: 015/150 | Train Time: 1.394s | Train Loss: 0.081645 |
2020-05-21 05:03:47,789 - root - INFO - | Epoch: 016/150 | Train Time: 1.527s | Train Loss: 0.079195 |
2020-05-21 05:03:49,291 - root - INFO - | Epoch: 017/150 | Train Time: 1.501s | Train Loss: 0.078631 |
2020-05-21 05:03:50,958 - root - INFO - | Epoch: 018/150 | Train Time: 1.666s | Train Loss: 0.079240 |
2020-05-21 05:03:52,792 - root - INFO - | Epoch: 019/150 | Train Time: 1.834s | Train Loss: 0.078662 |
2020-05-21 05:03:54,777 - root - INFO - | Epoch: 020/150 | Train Time: 1.985s | Train Loss: 0.077138 |
2020-05-21 05:03:56,326 - root - INFO - | Epoch: 021/150 | Train Time: 1.548s | Train Loss: 0.076914 |
2020-05-21 05:03:58,267 - root - INFO - | Epoch: 022/150 | Train Time: 1.940s | Train Loss: 0.074983 |
2020-05-21 05:04:00,222 - root - INFO - | Epoch: 023/150 | Train Time: 1.955s | Train Loss: 0.073912 |
2020-05-21 05:04:02,062 - root - INFO - | Epoch: 024/150 | Train Time: 1.839s | Train Loss: 0.073645 |
2020-05-21 05:04:03,750 - root - INFO - | Epoch: 025/150 | Train Time: 1.688s | Train Loss: 0.072276 |
2020-05-21 05:04:05,723 - root - INFO - | Epoch: 026/150 | Train Time: 1.973s | Train Loss: 0.071534 |
2020-05-21 05:04:07,507 - root - INFO - | Epoch: 027/150 | Train Time: 1.783s | Train Loss: 0.069779 |
2020-05-21 05:04:09,350 - root - INFO - | Epoch: 028/150 | Train Time: 1.842s | Train Loss: 0.071359 |
2020-05-21 05:04:11,060 - root - INFO - | Epoch: 029/150 | Train Time: 1.710s | Train Loss: 0.069459 |
2020-05-21 05:04:13,021 - root - INFO - | Epoch: 030/150 | Train Time: 1.961s | Train Loss: 0.067581 |
2020-05-21 05:04:14,414 - root - INFO - | Epoch: 031/150 | Train Time: 1.392s | Train Loss: 0.072719 |
2020-05-21 05:04:16,073 - root - INFO - | Epoch: 032/150 | Train Time: 1.659s | Train Loss: 0.071741 |
2020-05-21 05:04:17,985 - root - INFO - | Epoch: 033/150 | Train Time: 1.912s | Train Loss: 0.072850 |
2020-05-21 05:04:20,208 - root - INFO - | Epoch: 034/150 | Train Time: 2.222s | Train Loss: 0.067330 |
2020-05-21 05:04:22,065 - root - INFO - | Epoch: 035/150 | Train Time: 1.856s | Train Loss: 0.064882 |
2020-05-21 05:04:24,107 - root - INFO - | Epoch: 036/150 | Train Time: 2.041s | Train Loss: 0.063980 |
2020-05-21 05:04:25,692 - root - INFO - | Epoch: 037/150 | Train Time: 1.585s | Train Loss: 0.065124 |
2020-05-21 05:04:27,667 - root - INFO - | Epoch: 038/150 | Train Time: 1.973s | Train Loss: 0.065339 |
2020-05-21 05:04:28,969 - root - INFO - | Epoch: 039/150 | Train Time: 1.302s | Train Loss: 0.064175 |
2020-05-21 05:04:30,462 - root - INFO - | Epoch: 040/150 | Train Time: 1.493s | Train Loss: 0.065103 |
2020-05-21 05:04:32,110 - root - INFO - | Epoch: 041/150 | Train Time: 1.648s | Train Loss: 0.062526 |
2020-05-21 05:04:33,656 - root - INFO - | Epoch: 042/150 | Train Time: 1.545s | Train Loss: 0.059680 |
2020-05-21 05:04:35,287 - root - INFO - | Epoch: 043/150 | Train Time: 1.630s | Train Loss: 0.060207 |
2020-05-21 05:04:37,072 - root - INFO - | Epoch: 044/150 | Train Time: 1.785s | Train Loss: 0.058138 |
2020-05-21 05:04:38,870 - root - INFO - | Epoch: 045/150 | Train Time: 1.798s | Train Loss: 0.059297 |
2020-05-21 05:04:40,587 - root - INFO - | Epoch: 046/150 | Train Time: 1.716s | Train Loss: 0.059848 |
2020-05-21 05:04:42,617 - root - INFO - | Epoch: 047/150 | Train Time: 2.029s | Train Loss: 0.057702 |
2020-05-21 05:04:44,623 - root - INFO - | Epoch: 048/150 | Train Time: 2.005s | Train Loss: 0.059715 |
2020-05-21 05:04:46,588 - root - INFO - | Epoch: 049/150 | Train Time: 1.964s | Train Loss: 0.057353 |
2020-05-21 05:04:48,644 - root - INFO - | Epoch: 050/150 | Train Time: 2.055s | Train Loss: 0.055380 |
2020-05-21 05:04:48,644 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 05:04:50,404 - root - INFO - | Epoch: 051/150 | Train Time: 1.760s | Train Loss: 0.055000 |
2020-05-21 05:04:52,300 - root - INFO - | Epoch: 052/150 | Train Time: 1.895s | Train Loss: 0.054372 |
2020-05-21 05:04:53,804 - root - INFO - | Epoch: 053/150 | Train Time: 1.503s | Train Loss: 0.053464 |
2020-05-21 05:04:56,099 - root - INFO - | Epoch: 054/150 | Train Time: 2.294s | Train Loss: 0.054840 |
2020-05-21 05:04:57,764 - root - INFO - | Epoch: 055/150 | Train Time: 1.664s | Train Loss: 0.054401 |
2020-05-21 05:04:59,684 - root - INFO - | Epoch: 056/150 | Train Time: 1.920s | Train Loss: 0.055233 |
2020-05-21 05:05:00,958 - root - INFO - | Epoch: 057/150 | Train Time: 1.274s | Train Loss: 0.054254 |
2020-05-21 05:05:02,971 - root - INFO - | Epoch: 058/150 | Train Time: 2.012s | Train Loss: 0.054286 |
2020-05-21 05:05:04,882 - root - INFO - | Epoch: 059/150 | Train Time: 1.911s | Train Loss: 0.055279 |
2020-05-21 05:05:06,366 - root - INFO - | Epoch: 060/150 | Train Time: 1.483s | Train Loss: 0.053608 |
2020-05-21 05:05:08,125 - root - INFO - | Epoch: 061/150 | Train Time: 1.758s | Train Loss: 0.053685 |
2020-05-21 05:05:09,781 - root - INFO - | Epoch: 062/150 | Train Time: 1.656s | Train Loss: 0.052946 |
2020-05-21 05:05:11,804 - root - INFO - | Epoch: 063/150 | Train Time: 2.022s | Train Loss: 0.055103 |
2020-05-21 05:05:13,556 - root - INFO - | Epoch: 064/150 | Train Time: 1.752s | Train Loss: 0.052456 |
2020-05-21 05:05:15,035 - root - INFO - | Epoch: 065/150 | Train Time: 1.479s | Train Loss: 0.054662 |
2020-05-21 05:05:17,470 - root - INFO - | Epoch: 066/150 | Train Time: 2.434s | Train Loss: 0.053201 |
2020-05-21 05:05:18,979 - root - INFO - | Epoch: 067/150 | Train Time: 1.508s | Train Loss: 0.054617 |
2020-05-21 05:05:20,529 - root - INFO - | Epoch: 068/150 | Train Time: 1.550s | Train Loss: 0.053035 |
2020-05-21 05:05:22,110 - root - INFO - | Epoch: 069/150 | Train Time: 1.580s | Train Loss: 0.053195 |
2020-05-21 05:05:24,246 - root - INFO - | Epoch: 070/150 | Train Time: 2.136s | Train Loss: 0.053250 |
2020-05-21 05:05:25,961 - root - INFO - | Epoch: 071/150 | Train Time: 1.714s | Train Loss: 0.053461 |
2020-05-21 05:05:27,697 - root - INFO - | Epoch: 072/150 | Train Time: 1.736s | Train Loss: 0.053540 |
2020-05-21 05:05:29,329 - root - INFO - | Epoch: 073/150 | Train Time: 1.631s | Train Loss: 0.052181 |
2020-05-21 05:05:31,443 - root - INFO - | Epoch: 074/150 | Train Time: 2.113s | Train Loss: 0.052867 |
2020-05-21 05:05:33,132 - root - INFO - | Epoch: 075/150 | Train Time: 1.689s | Train Loss: 0.052930 |
2020-05-21 05:05:34,743 - root - INFO - | Epoch: 076/150 | Train Time: 1.610s | Train Loss: 0.052503 |
2020-05-21 05:05:36,397 - root - INFO - | Epoch: 077/150 | Train Time: 1.653s | Train Loss: 0.055180 |
2020-05-21 05:05:38,083 - root - INFO - | Epoch: 078/150 | Train Time: 1.685s | Train Loss: 0.052507 |
2020-05-21 05:05:40,190 - root - INFO - | Epoch: 079/150 | Train Time: 2.107s | Train Loss: 0.053095 |
2020-05-21 05:05:42,016 - root - INFO - | Epoch: 080/150 | Train Time: 1.825s | Train Loss: 0.053822 |
2020-05-21 05:05:43,552 - root - INFO - | Epoch: 081/150 | Train Time: 1.535s | Train Loss: 0.052792 |
2020-05-21 05:05:45,087 - root - INFO - | Epoch: 082/150 | Train Time: 1.535s | Train Loss: 0.052694 |
2020-05-21 05:05:46,492 - root - INFO - | Epoch: 083/150 | Train Time: 1.404s | Train Loss: 0.054112 |
2020-05-21 05:05:48,915 - root - INFO - | Epoch: 084/150 | Train Time: 2.423s | Train Loss: 0.052949 |
2020-05-21 05:05:50,489 - root - INFO - | Epoch: 085/150 | Train Time: 1.573s | Train Loss: 0.053491 |
2020-05-21 05:05:52,553 - root - INFO - | Epoch: 086/150 | Train Time: 2.064s | Train Loss: 0.051235 |
2020-05-21 05:05:54,617 - root - INFO - | Epoch: 087/150 | Train Time: 2.062s | Train Loss: 0.053030 |
2020-05-21 05:05:56,447 - root - INFO - | Epoch: 088/150 | Train Time: 1.830s | Train Loss: 0.051273 |
2020-05-21 05:05:58,169 - root - INFO - | Epoch: 089/150 | Train Time: 1.721s | Train Loss: 0.054842 |
2020-05-21 05:05:59,848 - root - INFO - | Epoch: 090/150 | Train Time: 1.679s | Train Loss: 0.051582 |
2020-05-21 05:06:01,957 - root - INFO - | Epoch: 091/150 | Train Time: 2.108s | Train Loss: 0.053276 |
2020-05-21 05:06:04,058 - root - INFO - | Epoch: 092/150 | Train Time: 2.101s | Train Loss: 0.052430 |
2020-05-21 05:06:06,032 - root - INFO - | Epoch: 093/150 | Train Time: 1.973s | Train Loss: 0.052175 |
2020-05-21 05:06:07,889 - root - INFO - | Epoch: 094/150 | Train Time: 1.857s | Train Loss: 0.052317 |
2020-05-21 05:06:09,467 - root - INFO - | Epoch: 095/150 | Train Time: 1.578s | Train Loss: 0.051662 |
2020-05-21 05:06:11,464 - root - INFO - | Epoch: 096/150 | Train Time: 1.996s | Train Loss: 0.052657 |
2020-05-21 05:06:13,310 - root - INFO - | Epoch: 097/150 | Train Time: 1.845s | Train Loss: 0.052183 |
2020-05-21 05:06:14,985 - root - INFO - | Epoch: 098/150 | Train Time: 1.674s | Train Loss: 0.052424 |
2020-05-21 05:06:16,871 - root - INFO - | Epoch: 099/150 | Train Time: 1.886s | Train Loss: 0.054079 |
2020-05-21 05:06:18,490 - root - INFO - | Epoch: 100/150 | Train Time: 1.619s | Train Loss: 0.053158 |
2020-05-21 05:06:20,338 - root - INFO - | Epoch: 101/150 | Train Time: 1.847s | Train Loss: 0.051090 |
2020-05-21 05:06:22,940 - root - INFO - | Epoch: 102/150 | Train Time: 2.601s | Train Loss: 0.051333 |
2020-05-21 05:06:24,444 - root - INFO - | Epoch: 103/150 | Train Time: 1.503s | Train Loss: 0.051068 |
2020-05-21 05:06:26,413 - root - INFO - | Epoch: 104/150 | Train Time: 1.969s | Train Loss: 0.051175 |
2020-05-21 05:06:28,078 - root - INFO - | Epoch: 105/150 | Train Time: 1.664s | Train Loss: 0.052270 |
2020-05-21 05:06:29,447 - root - INFO - | Epoch: 106/150 | Train Time: 1.368s | Train Loss: 0.051366 |
2020-05-21 05:06:31,017 - root - INFO - | Epoch: 107/150 | Train Time: 1.570s | Train Loss: 0.049918 |
2020-05-21 05:06:32,624 - root - INFO - | Epoch: 108/150 | Train Time: 1.606s | Train Loss: 0.050172 |
2020-05-21 05:06:34,254 - root - INFO - | Epoch: 109/150 | Train Time: 1.629s | Train Loss: 0.051078 |
2020-05-21 05:06:35,962 - root - INFO - | Epoch: 110/150 | Train Time: 1.708s | Train Loss: 0.051210 |
2020-05-21 05:06:37,849 - root - INFO - | Epoch: 111/150 | Train Time: 1.887s | Train Loss: 0.052586 |
2020-05-21 05:06:38,846 - root - INFO - | Epoch: 112/150 | Train Time: 0.996s | Train Loss: 0.050610 |
2020-05-21 05:06:39,945 - root - INFO - | Epoch: 113/150 | Train Time: 1.099s | Train Loss: 0.050528 |
2020-05-21 05:06:41,211 - root - INFO - | Epoch: 114/150 | Train Time: 1.265s | Train Loss: 0.052515 |
2020-05-21 05:06:43,012 - root - INFO - | Epoch: 115/150 | Train Time: 1.801s | Train Loss: 0.050067 |
2020-05-21 05:06:44,392 - root - INFO - | Epoch: 116/150 | Train Time: 1.380s | Train Loss: 0.052084 |
2020-05-21 05:06:45,437 - root - INFO - | Epoch: 117/150 | Train Time: 1.044s | Train Loss: 0.052094 |
2020-05-21 05:06:47,112 - root - INFO - | Epoch: 118/150 | Train Time: 1.675s | Train Loss: 0.052349 |
2020-05-21 05:06:48,620 - root - INFO - | Epoch: 119/150 | Train Time: 1.507s | Train Loss: 0.051380 |
2020-05-21 05:06:50,493 - root - INFO - | Epoch: 120/150 | Train Time: 1.872s | Train Loss: 0.050180 |
2020-05-21 05:06:52,669 - root - INFO - | Epoch: 121/150 | Train Time: 2.175s | Train Loss: 0.050255 |
2020-05-21 05:06:54,520 - root - INFO - | Epoch: 122/150 | Train Time: 1.851s | Train Loss: 0.050929 |
2020-05-21 05:06:56,282 - root - INFO - | Epoch: 123/150 | Train Time: 1.761s | Train Loss: 0.051481 |
2020-05-21 05:06:58,029 - root - INFO - | Epoch: 124/150 | Train Time: 1.747s | Train Loss: 0.049580 |
2020-05-21 05:06:59,534 - root - INFO - | Epoch: 125/150 | Train Time: 1.505s | Train Loss: 0.049428 |
2020-05-21 05:07:01,550 - root - INFO - | Epoch: 126/150 | Train Time: 2.015s | Train Loss: 0.050624 |
2020-05-21 05:07:03,276 - root - INFO - | Epoch: 127/150 | Train Time: 1.725s | Train Loss: 0.049787 |
2020-05-21 05:07:05,110 - root - INFO - | Epoch: 128/150 | Train Time: 1.834s | Train Loss: 0.051236 |
2020-05-21 05:07:06,824 - root - INFO - | Epoch: 129/150 | Train Time: 1.713s | Train Loss: 0.050739 |
2020-05-21 05:07:08,515 - root - INFO - | Epoch: 130/150 | Train Time: 1.691s | Train Loss: 0.049954 |
2020-05-21 05:07:10,407 - root - INFO - | Epoch: 131/150 | Train Time: 1.891s | Train Loss: 0.050045 |
2020-05-21 05:07:12,202 - root - INFO - | Epoch: 132/150 | Train Time: 1.794s | Train Loss: 0.050228 |
2020-05-21 05:07:14,260 - root - INFO - | Epoch: 133/150 | Train Time: 2.058s | Train Loss: 0.050452 |
2020-05-21 05:07:16,086 - root - INFO - | Epoch: 134/150 | Train Time: 1.825s | Train Loss: 0.051352 |
2020-05-21 05:07:18,077 - root - INFO - | Epoch: 135/150 | Train Time: 1.991s | Train Loss: 0.048308 |
2020-05-21 05:07:19,744 - root - INFO - | Epoch: 136/150 | Train Time: 1.666s | Train Loss: 0.050191 |
2020-05-21 05:07:21,775 - root - INFO - | Epoch: 137/150 | Train Time: 2.030s | Train Loss: 0.051172 |
2020-05-21 05:07:23,429 - root - INFO - | Epoch: 138/150 | Train Time: 1.653s | Train Loss: 0.048938 |
2020-05-21 05:07:25,114 - root - INFO - | Epoch: 139/150 | Train Time: 1.682s | Train Loss: 0.048005 |
2020-05-21 05:07:27,348 - root - INFO - | Epoch: 140/150 | Train Time: 2.233s | Train Loss: 0.048828 |
2020-05-21 05:07:29,362 - root - INFO - | Epoch: 141/150 | Train Time: 2.014s | Train Loss: 0.050688 |
2020-05-21 05:07:31,163 - root - INFO - | Epoch: 142/150 | Train Time: 1.801s | Train Loss: 0.048416 |
2020-05-21 05:07:32,894 - root - INFO - | Epoch: 143/150 | Train Time: 1.730s | Train Loss: 0.050209 |
2020-05-21 05:07:34,554 - root - INFO - | Epoch: 144/150 | Train Time: 1.659s | Train Loss: 0.049760 |
2020-05-21 05:07:36,171 - root - INFO - | Epoch: 145/150 | Train Time: 1.616s | Train Loss: 0.049884 |
2020-05-21 05:07:38,664 - root - INFO - | Epoch: 146/150 | Train Time: 2.493s | Train Loss: 0.049780 |
2020-05-21 05:07:40,550 - root - INFO - | Epoch: 147/150 | Train Time: 1.885s | Train Loss: 0.048678 |
2020-05-21 05:07:42,336 - root - INFO - | Epoch: 148/150 | Train Time: 1.783s | Train Loss: 0.050017 |
2020-05-21 05:07:44,402 - root - INFO - | Epoch: 149/150 | Train Time: 2.065s | Train Loss: 0.051035 |
2020-05-21 05:07:46,118 - root - INFO - | Epoch: 150/150 | Train Time: 1.715s | Train Loss: 0.049650 |
2020-05-21 05:07:46,118 - root - INFO - Training Time: 268.675s
2020-05-21 05:07:46,118 - root - INFO - Finished training.
2020-05-21 05:07:46,119 - root - INFO - Starting testing...
2020-05-21 05:07:48,311 - root - INFO - Test Loss: 0.250342
2020-05-21 05:07:48,312 - root - INFO - Test AUC: 82.49%
2020-05-21 05:07:48,312 - root - INFO - Test Time: 2.177s
2020-05-21 05:07:48,312 - root - INFO - Finished testing.
