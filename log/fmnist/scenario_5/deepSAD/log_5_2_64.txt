2020-05-21 06:29:07,561 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_5_2_64.txt
2020-05-21 06:29:07,562 - root - INFO - Data path is ../data
2020-05-21 06:29:07,562 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 06:29:07,562 - root - INFO - Dataset: fmnist
2020-05-21 06:29:07,562 - root - INFO - Normal class: 5
2020-05-21 06:29:07,562 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 06:29:07,562 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 06:29:07,562 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 06:29:07,562 - root - INFO - Scenario Running: 5
2020-05-21 06:29:07,562 - root - INFO - Train only the network: True
2020-05-21 06:29:07,562 - root - INFO - Output and AE dimensions: 64
2020-05-21 06:29:07,562 - root - INFO - Known anomaly class: 2
2020-05-21 06:29:07,562 - root - INFO - Network: fmnist_LeNet
2020-05-21 06:29:07,563 - root - INFO - Eta-parameter: 1.00
2020-05-21 06:29:07,577 - root - INFO - Set seed to 0.
2020-05-21 06:29:07,644 - root - INFO - Computation device: cuda
2020-05-21 06:29:07,644 - root - INFO - Number of threads: 0
2020-05-21 06:29:07,644 - root - INFO - Number of dataloader workers: 6
2020-05-21 06:29:11,885 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_64.tar.
2020-05-21 06:29:11,885 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 06:29:11,885 - root - INFO - Pretraining: True
2020-05-21 06:29:11,885 - root - INFO - Training optimizer: adam
2020-05-21 06:29:11,885 - root - INFO - Training learning rate: 0.0001
2020-05-21 06:29:11,885 - root - INFO - Training epochs: 150
2020-05-21 06:29:11,885 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 06:29:11,885 - root - INFO - Training batch size: 200
2020-05-21 06:29:11,885 - root - INFO - Training weight decay: 5e-07
2020-05-21 06:29:11,887 - root - INFO - Starting training...
2020-05-21 06:29:15,461 - root - INFO - | Epoch: 001/150 | Train Time: 3.574s | Train Loss: 0.199013 |
2020-05-21 06:29:16,811 - root - INFO - | Epoch: 002/150 | Train Time: 1.350s | Train Loss: 0.136929 |
2020-05-21 06:29:18,282 - root - INFO - | Epoch: 003/150 | Train Time: 1.470s | Train Loss: 0.121064 |
2020-05-21 06:29:19,692 - root - INFO - | Epoch: 004/150 | Train Time: 1.409s | Train Loss: 0.114566 |
2020-05-21 06:29:20,934 - root - INFO - | Epoch: 005/150 | Train Time: 1.242s | Train Loss: 0.106578 |
2020-05-21 06:29:22,146 - root - INFO - | Epoch: 006/150 | Train Time: 1.211s | Train Loss: 0.101222 |
2020-05-21 06:29:22,924 - root - INFO - | Epoch: 007/150 | Train Time: 0.777s | Train Loss: 0.099683 |
2020-05-21 06:29:23,981 - root - INFO - | Epoch: 008/150 | Train Time: 1.057s | Train Loss: 0.094865 |
2020-05-21 06:29:25,359 - root - INFO - | Epoch: 009/150 | Train Time: 1.377s | Train Loss: 0.095224 |
2020-05-21 06:29:26,925 - root - INFO - | Epoch: 010/150 | Train Time: 1.565s | Train Loss: 0.090801 |
2020-05-21 06:29:28,673 - root - INFO - | Epoch: 011/150 | Train Time: 1.748s | Train Loss: 0.088783 |
2020-05-21 06:29:30,085 - root - INFO - | Epoch: 012/150 | Train Time: 1.411s | Train Loss: 0.089818 |
2020-05-21 06:29:31,490 - root - INFO - | Epoch: 013/150 | Train Time: 1.404s | Train Loss: 0.085179 |
2020-05-21 06:29:32,974 - root - INFO - | Epoch: 014/150 | Train Time: 1.483s | Train Loss: 0.083942 |
2020-05-21 06:29:34,595 - root - INFO - | Epoch: 015/150 | Train Time: 1.620s | Train Loss: 0.085092 |
2020-05-21 06:29:36,376 - root - INFO - | Epoch: 016/150 | Train Time: 1.780s | Train Loss: 0.082115 |
2020-05-21 06:29:38,031 - root - INFO - | Epoch: 017/150 | Train Time: 1.655s | Train Loss: 0.076891 |
2020-05-21 06:29:39,851 - root - INFO - | Epoch: 018/150 | Train Time: 1.820s | Train Loss: 0.079358 |
2020-05-21 06:29:41,605 - root - INFO - | Epoch: 019/150 | Train Time: 1.753s | Train Loss: 0.074913 |
2020-05-21 06:29:43,651 - root - INFO - | Epoch: 020/150 | Train Time: 2.046s | Train Loss: 0.070952 |
2020-05-21 06:29:45,505 - root - INFO - | Epoch: 021/150 | Train Time: 1.853s | Train Loss: 0.070595 |
2020-05-21 06:29:47,242 - root - INFO - | Epoch: 022/150 | Train Time: 1.737s | Train Loss: 0.068607 |
2020-05-21 06:29:48,984 - root - INFO - | Epoch: 023/150 | Train Time: 1.741s | Train Loss: 0.068310 |
2020-05-21 06:29:50,646 - root - INFO - | Epoch: 024/150 | Train Time: 1.661s | Train Loss: 0.065687 |
2020-05-21 06:29:52,362 - root - INFO - | Epoch: 025/150 | Train Time: 1.716s | Train Loss: 0.065895 |
2020-05-21 06:29:54,417 - root - INFO - | Epoch: 026/150 | Train Time: 2.054s | Train Loss: 0.062309 |
2020-05-21 06:29:56,205 - root - INFO - | Epoch: 027/150 | Train Time: 1.787s | Train Loss: 0.060926 |
2020-05-21 06:29:58,266 - root - INFO - | Epoch: 028/150 | Train Time: 2.060s | Train Loss: 0.061179 |
2020-05-21 06:29:59,770 - root - INFO - | Epoch: 029/150 | Train Time: 1.504s | Train Loss: 0.058242 |
2020-05-21 06:30:01,050 - root - INFO - | Epoch: 030/150 | Train Time: 1.279s | Train Loss: 0.062374 |
2020-05-21 06:30:02,591 - root - INFO - | Epoch: 031/150 | Train Time: 1.540s | Train Loss: 0.056454 |
2020-05-21 06:30:04,344 - root - INFO - | Epoch: 032/150 | Train Time: 1.753s | Train Loss: 0.056456 |
2020-05-21 06:30:06,001 - root - INFO - | Epoch: 033/150 | Train Time: 1.657s | Train Loss: 0.056782 |
2020-05-21 06:30:07,416 - root - INFO - | Epoch: 034/150 | Train Time: 1.414s | Train Loss: 0.057564 |
2020-05-21 06:30:09,445 - root - INFO - | Epoch: 035/150 | Train Time: 2.029s | Train Loss: 0.161005 |
2020-05-21 06:30:11,069 - root - INFO - | Epoch: 036/150 | Train Time: 1.624s | Train Loss: 0.086985 |
2020-05-21 06:30:12,968 - root - INFO - | Epoch: 037/150 | Train Time: 1.899s | Train Loss: 0.077408 |
2020-05-21 06:30:14,815 - root - INFO - | Epoch: 038/150 | Train Time: 1.846s | Train Loss: 0.075046 |
2020-05-21 06:30:16,226 - root - INFO - | Epoch: 039/150 | Train Time: 1.410s | Train Loss: 0.073750 |
2020-05-21 06:30:17,938 - root - INFO - | Epoch: 040/150 | Train Time: 1.712s | Train Loss: 0.072666 |
2020-05-21 06:30:19,409 - root - INFO - | Epoch: 041/150 | Train Time: 1.470s | Train Loss: 0.076281 |
2020-05-21 06:30:21,284 - root - INFO - | Epoch: 042/150 | Train Time: 1.875s | Train Loss: 0.069642 |
2020-05-21 06:30:22,928 - root - INFO - | Epoch: 043/150 | Train Time: 1.644s | Train Loss: 0.068279 |
2020-05-21 06:30:24,977 - root - INFO - | Epoch: 044/150 | Train Time: 2.048s | Train Loss: 0.067731 |
2020-05-21 06:30:26,929 - root - INFO - | Epoch: 045/150 | Train Time: 1.951s | Train Loss: 0.066143 |
2020-05-21 06:30:28,886 - root - INFO - | Epoch: 046/150 | Train Time: 1.957s | Train Loss: 0.064137 |
2020-05-21 06:30:30,884 - root - INFO - | Epoch: 047/150 | Train Time: 1.998s | Train Loss: 0.064469 |
2020-05-21 06:30:32,850 - root - INFO - | Epoch: 048/150 | Train Time: 1.965s | Train Loss: 0.061215 |
2020-05-21 06:30:34,584 - root - INFO - | Epoch: 049/150 | Train Time: 1.734s | Train Loss: 0.061225 |
2020-05-21 06:30:36,471 - root - INFO - | Epoch: 050/150 | Train Time: 1.886s | Train Loss: 0.059156 |
2020-05-21 06:30:36,472 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 06:30:38,210 - root - INFO - | Epoch: 051/150 | Train Time: 1.738s | Train Loss: 0.057589 |
2020-05-21 06:30:39,747 - root - INFO - | Epoch: 052/150 | Train Time: 1.536s | Train Loss: 0.057736 |
2020-05-21 06:30:41,129 - root - INFO - | Epoch: 053/150 | Train Time: 1.381s | Train Loss: 0.056779 |
2020-05-21 06:30:43,011 - root - INFO - | Epoch: 054/150 | Train Time: 1.881s | Train Loss: 0.055945 |
2020-05-21 06:30:44,694 - root - INFO - | Epoch: 055/150 | Train Time: 1.683s | Train Loss: 0.056353 |
2020-05-21 06:30:46,275 - root - INFO - | Epoch: 056/150 | Train Time: 1.580s | Train Loss: 0.056179 |
2020-05-21 06:30:48,021 - root - INFO - | Epoch: 057/150 | Train Time: 1.746s | Train Loss: 0.057444 |
2020-05-21 06:30:49,444 - root - INFO - | Epoch: 058/150 | Train Time: 1.422s | Train Loss: 0.054083 |
2020-05-21 06:30:51,280 - root - INFO - | Epoch: 059/150 | Train Time: 1.836s | Train Loss: 0.055051 |
2020-05-21 06:30:52,662 - root - INFO - | Epoch: 060/150 | Train Time: 1.381s | Train Loss: 0.054352 |
2020-05-21 06:30:54,337 - root - INFO - | Epoch: 061/150 | Train Time: 1.674s | Train Loss: 0.057260 |
2020-05-21 06:30:56,314 - root - INFO - | Epoch: 062/150 | Train Time: 1.976s | Train Loss: 0.053431 |
2020-05-21 06:30:58,079 - root - INFO - | Epoch: 063/150 | Train Time: 1.765s | Train Loss: 0.055137 |
2020-05-21 06:31:00,139 - root - INFO - | Epoch: 064/150 | Train Time: 2.059s | Train Loss: 0.054926 |
2020-05-21 06:31:02,138 - root - INFO - | Epoch: 065/150 | Train Time: 1.999s | Train Loss: 0.054461 |
2020-05-21 06:31:03,686 - root - INFO - | Epoch: 066/150 | Train Time: 1.547s | Train Loss: 0.054117 |
2020-05-21 06:31:05,262 - root - INFO - | Epoch: 067/150 | Train Time: 1.575s | Train Loss: 0.054664 |
2020-05-21 06:31:06,890 - root - INFO - | Epoch: 068/150 | Train Time: 1.628s | Train Loss: 0.054439 |
2020-05-21 06:31:08,504 - root - INFO - | Epoch: 069/150 | Train Time: 1.614s | Train Loss: 0.053464 |
2020-05-21 06:31:10,349 - root - INFO - | Epoch: 070/150 | Train Time: 1.844s | Train Loss: 0.054578 |
2020-05-21 06:31:12,217 - root - INFO - | Epoch: 071/150 | Train Time: 1.867s | Train Loss: 0.052773 |
2020-05-21 06:31:13,752 - root - INFO - | Epoch: 072/150 | Train Time: 1.535s | Train Loss: 0.055353 |
2020-05-21 06:31:15,086 - root - INFO - | Epoch: 073/150 | Train Time: 1.333s | Train Loss: 0.054482 |
2020-05-21 06:31:16,655 - root - INFO - | Epoch: 074/150 | Train Time: 1.569s | Train Loss: 0.052205 |
2020-05-21 06:31:18,100 - root - INFO - | Epoch: 075/150 | Train Time: 1.444s | Train Loss: 0.053525 |
2020-05-21 06:31:20,179 - root - INFO - | Epoch: 076/150 | Train Time: 2.078s | Train Loss: 0.052528 |
2020-05-21 06:31:21,908 - root - INFO - | Epoch: 077/150 | Train Time: 1.728s | Train Loss: 0.053119 |
2020-05-21 06:31:23,551 - root - INFO - | Epoch: 078/150 | Train Time: 1.643s | Train Loss: 0.052269 |
2020-05-21 06:31:25,189 - root - INFO - | Epoch: 079/150 | Train Time: 1.638s | Train Loss: 0.052653 |
2020-05-21 06:31:26,818 - root - INFO - | Epoch: 080/150 | Train Time: 1.628s | Train Loss: 0.052709 |
2020-05-21 06:31:28,600 - root - INFO - | Epoch: 081/150 | Train Time: 1.781s | Train Loss: 0.050853 |
2020-05-21 06:31:30,753 - root - INFO - | Epoch: 082/150 | Train Time: 2.153s | Train Loss: 0.053815 |
2020-05-21 06:31:32,070 - root - INFO - | Epoch: 083/150 | Train Time: 1.316s | Train Loss: 0.052776 |
2020-05-21 06:31:34,120 - root - INFO - | Epoch: 084/150 | Train Time: 2.049s | Train Loss: 0.052670 |
2020-05-21 06:31:35,809 - root - INFO - | Epoch: 085/150 | Train Time: 1.689s | Train Loss: 0.051810 |
2020-05-21 06:31:37,914 - root - INFO - | Epoch: 086/150 | Train Time: 2.105s | Train Loss: 0.050518 |
2020-05-21 06:31:39,638 - root - INFO - | Epoch: 087/150 | Train Time: 1.723s | Train Loss: 0.052192 |
2020-05-21 06:31:41,408 - root - INFO - | Epoch: 088/150 | Train Time: 1.769s | Train Loss: 0.052351 |
2020-05-21 06:31:43,215 - root - INFO - | Epoch: 089/150 | Train Time: 1.807s | Train Loss: 0.051612 |
2020-05-21 06:31:44,651 - root - INFO - | Epoch: 090/150 | Train Time: 1.436s | Train Loss: 0.052111 |
2020-05-21 06:31:46,387 - root - INFO - | Epoch: 091/150 | Train Time: 1.735s | Train Loss: 0.052493 |
2020-05-21 06:31:48,226 - root - INFO - | Epoch: 092/150 | Train Time: 1.838s | Train Loss: 0.051596 |
2020-05-21 06:31:50,055 - root - INFO - | Epoch: 093/150 | Train Time: 1.829s | Train Loss: 0.049892 |
2020-05-21 06:31:51,502 - root - INFO - | Epoch: 094/150 | Train Time: 1.446s | Train Loss: 0.051434 |
2020-05-21 06:31:53,182 - root - INFO - | Epoch: 095/150 | Train Time: 1.680s | Train Loss: 0.053038 |
2020-05-21 06:31:54,782 - root - INFO - | Epoch: 096/150 | Train Time: 1.600s | Train Loss: 0.050006 |
2020-05-21 06:31:56,452 - root - INFO - | Epoch: 097/150 | Train Time: 1.669s | Train Loss: 0.048801 |
2020-05-21 06:31:57,848 - root - INFO - | Epoch: 098/150 | Train Time: 1.395s | Train Loss: 0.050098 |
2020-05-21 06:31:59,455 - root - INFO - | Epoch: 099/150 | Train Time: 1.607s | Train Loss: 0.051337 |
2020-05-21 06:32:00,995 - root - INFO - | Epoch: 100/150 | Train Time: 1.539s | Train Loss: 0.049574 |
2020-05-21 06:32:02,437 - root - INFO - | Epoch: 101/150 | Train Time: 1.441s | Train Loss: 0.049217 |
2020-05-21 06:32:03,895 - root - INFO - | Epoch: 102/150 | Train Time: 1.458s | Train Loss: 0.050579 |
2020-05-21 06:32:05,753 - root - INFO - | Epoch: 103/150 | Train Time: 1.857s | Train Loss: 0.050906 |
2020-05-21 06:32:07,353 - root - INFO - | Epoch: 104/150 | Train Time: 1.599s | Train Loss: 0.050351 |
2020-05-21 06:32:09,202 - root - INFO - | Epoch: 105/150 | Train Time: 1.849s | Train Loss: 0.049148 |
2020-05-21 06:32:10,883 - root - INFO - | Epoch: 106/150 | Train Time: 1.680s | Train Loss: 0.050454 |
2020-05-21 06:32:12,567 - root - INFO - | Epoch: 107/150 | Train Time: 1.683s | Train Loss: 0.049359 |
2020-05-21 06:32:14,189 - root - INFO - | Epoch: 108/150 | Train Time: 1.622s | Train Loss: 0.050058 |
2020-05-21 06:32:16,072 - root - INFO - | Epoch: 109/150 | Train Time: 1.882s | Train Loss: 0.048143 |
2020-05-21 06:32:18,008 - root - INFO - | Epoch: 110/150 | Train Time: 1.936s | Train Loss: 0.048692 |
2020-05-21 06:32:19,839 - root - INFO - | Epoch: 111/150 | Train Time: 1.831s | Train Loss: 0.048811 |
2020-05-21 06:32:22,048 - root - INFO - | Epoch: 112/150 | Train Time: 2.208s | Train Loss: 0.047512 |
2020-05-21 06:32:24,119 - root - INFO - | Epoch: 113/150 | Train Time: 2.071s | Train Loss: 0.049268 |
2020-05-21 06:32:25,534 - root - INFO - | Epoch: 114/150 | Train Time: 1.415s | Train Loss: 0.048983 |
2020-05-21 06:32:27,406 - root - INFO - | Epoch: 115/150 | Train Time: 1.872s | Train Loss: 0.047611 |
2020-05-21 06:32:29,079 - root - INFO - | Epoch: 116/150 | Train Time: 1.672s | Train Loss: 0.048216 |
2020-05-21 06:32:30,795 - root - INFO - | Epoch: 117/150 | Train Time: 1.715s | Train Loss: 0.047812 |
2020-05-21 06:32:32,362 - root - INFO - | Epoch: 118/150 | Train Time: 1.567s | Train Loss: 0.051635 |
2020-05-21 06:32:34,150 - root - INFO - | Epoch: 119/150 | Train Time: 1.788s | Train Loss: 0.048265 |
2020-05-21 06:32:35,798 - root - INFO - | Epoch: 120/150 | Train Time: 1.647s | Train Loss: 0.048398 |
2020-05-21 06:32:37,560 - root - INFO - | Epoch: 121/150 | Train Time: 1.761s | Train Loss: 0.047877 |
2020-05-21 06:32:39,134 - root - INFO - | Epoch: 122/150 | Train Time: 1.574s | Train Loss: 0.048149 |
2020-05-21 06:32:41,294 - root - INFO - | Epoch: 123/150 | Train Time: 2.159s | Train Loss: 0.048364 |
2020-05-21 06:32:43,187 - root - INFO - | Epoch: 124/150 | Train Time: 1.892s | Train Loss: 0.048419 |
2020-05-21 06:32:45,056 - root - INFO - | Epoch: 125/150 | Train Time: 1.869s | Train Loss: 0.049582 |
2020-05-21 06:32:46,818 - root - INFO - | Epoch: 126/150 | Train Time: 1.762s | Train Loss: 0.046904 |
2020-05-21 06:32:48,662 - root - INFO - | Epoch: 127/150 | Train Time: 1.844s | Train Loss: 0.047478 |
2020-05-21 06:32:50,490 - root - INFO - | Epoch: 128/150 | Train Time: 1.827s | Train Loss: 0.045550 |
2020-05-21 06:32:52,074 - root - INFO - | Epoch: 129/150 | Train Time: 1.584s | Train Loss: 0.046337 |
2020-05-21 06:32:53,368 - root - INFO - | Epoch: 130/150 | Train Time: 1.293s | Train Loss: 0.046120 |
2020-05-21 06:32:54,988 - root - INFO - | Epoch: 131/150 | Train Time: 1.620s | Train Loss: 0.046274 |
2020-05-21 06:32:56,772 - root - INFO - | Epoch: 132/150 | Train Time: 1.783s | Train Loss: 0.045501 |
2020-05-21 06:32:58,202 - root - INFO - | Epoch: 133/150 | Train Time: 1.429s | Train Loss: 0.044710 |
2020-05-21 06:32:59,742 - root - INFO - | Epoch: 134/150 | Train Time: 1.540s | Train Loss: 0.047984 |
2020-05-21 06:33:01,830 - root - INFO - | Epoch: 135/150 | Train Time: 2.087s | Train Loss: 0.045121 |
2020-05-21 06:33:03,711 - root - INFO - | Epoch: 136/150 | Train Time: 1.881s | Train Loss: 0.046373 |
2020-05-21 06:33:05,526 - root - INFO - | Epoch: 137/150 | Train Time: 1.815s | Train Loss: 0.046113 |
2020-05-21 06:33:07,423 - root - INFO - | Epoch: 138/150 | Train Time: 1.897s | Train Loss: 0.046583 |
2020-05-21 06:33:09,031 - root - INFO - | Epoch: 139/150 | Train Time: 1.607s | Train Loss: 0.047383 |
2020-05-21 06:33:10,939 - root - INFO - | Epoch: 140/150 | Train Time: 1.907s | Train Loss: 0.047063 |
2020-05-21 06:33:12,786 - root - INFO - | Epoch: 141/150 | Train Time: 1.846s | Train Loss: 0.046060 |
2020-05-21 06:33:14,491 - root - INFO - | Epoch: 142/150 | Train Time: 1.705s | Train Loss: 0.045130 |
2020-05-21 06:33:16,117 - root - INFO - | Epoch: 143/150 | Train Time: 1.625s | Train Loss: 0.046091 |
2020-05-21 06:33:17,962 - root - INFO - | Epoch: 144/150 | Train Time: 1.844s | Train Loss: 0.044831 |
2020-05-21 06:33:20,022 - root - INFO - | Epoch: 145/150 | Train Time: 2.060s | Train Loss: 0.044257 |
2020-05-21 06:33:21,792 - root - INFO - | Epoch: 146/150 | Train Time: 1.770s | Train Loss: 0.045367 |
2020-05-21 06:33:24,068 - root - INFO - | Epoch: 147/150 | Train Time: 2.275s | Train Loss: 0.046955 |
2020-05-21 06:33:25,946 - root - INFO - | Epoch: 148/150 | Train Time: 1.878s | Train Loss: 0.043673 |
2020-05-21 06:33:27,492 - root - INFO - | Epoch: 149/150 | Train Time: 1.545s | Train Loss: 0.046176 |
2020-05-21 06:33:29,150 - root - INFO - | Epoch: 150/150 | Train Time: 1.658s | Train Loss: 0.042916 |
2020-05-21 06:33:29,150 - root - INFO - Training Time: 257.263s
2020-05-21 06:33:29,150 - root - INFO - Finished training.
2020-05-21 06:33:29,152 - root - INFO - Starting testing...
2020-05-21 06:33:30,921 - root - INFO - Test Loss: 0.435802
2020-05-21 06:33:30,921 - root - INFO - Test AUC: 89.51%
2020-05-21 06:33:30,921 - root - INFO - Test Time: 1.754s
2020-05-21 06:33:30,922 - root - INFO - Finished testing.
