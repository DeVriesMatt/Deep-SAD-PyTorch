2020-05-29 23:06:41,071 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_1_4_001.txt
2020-05-29 23:06:41,071 - root - INFO - Data path is ../data
2020-05-29 23:06:41,071 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-29 23:06:41,071 - root - INFO - Dataset: mnist
2020-05-29 23:06:41,071 - root - INFO - Normal class: 1
2020-05-29 23:06:41,071 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-29 23:06:41,071 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-29 23:06:41,072 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-29 23:06:41,072 - root - INFO - Scenario Running: 1
2020-05-29 23:06:41,072 - root - INFO - Train only the network: True
2020-05-29 23:06:41,072 - root - INFO - Output and AE dimensions: 128
2020-05-29 23:06:41,072 - root - INFO - Known anomaly class: 4
2020-05-29 23:06:41,072 - root - INFO - Network: mnist_LeNet
2020-05-29 23:06:41,072 - root - INFO - Eta-parameter: 1.00
2020-05-29 23:06:41,091 - root - INFO - Set seed to 0.
2020-05-29 23:06:41,129 - root - INFO - Computation device: cuda
2020-05-29 23:06:41,129 - root - INFO - Number of threads: 0
2020-05-29 23:06:41,129 - root - INFO - Number of dataloader workers: 6
2020-05-29 23:06:50,170 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-29 23:06:50,177 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-29 23:06:50,178 - root - INFO - Training optimizer: adam
2020-05-29 23:06:50,178 - root - INFO - Training learning rate: 0.0001
2020-05-29 23:06:50,178 - root - INFO - Training epochs: 150
2020-05-29 23:06:50,179 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-29 23:06:50,179 - root - INFO - Training batch size: 200
2020-05-29 23:06:50,179 - root - INFO - Training weight decay: 5e-07
2020-05-29 23:06:50,191 - root - INFO - Starting training...
2020-05-29 23:06:57,255 - root - INFO - | Epoch: 001/150 | Train Time: 7.058s | Train Loss: 0.262574 |
2020-05-29 23:07:00,131 - root - INFO - | Epoch: 002/150 | Train Time: 2.875s | Train Loss: 0.124270 |
2020-05-29 23:07:02,788 - root - INFO - | Epoch: 003/150 | Train Time: 2.657s | Train Loss: 0.098768 |
2020-05-29 23:07:05,473 - root - INFO - | Epoch: 004/150 | Train Time: 2.684s | Train Loss: 0.086401 |
2020-05-29 23:07:07,527 - root - INFO - | Epoch: 005/150 | Train Time: 2.053s | Train Loss: 0.078602 |
2020-05-29 23:07:09,821 - root - INFO - | Epoch: 006/150 | Train Time: 2.293s | Train Loss: 0.072933 |
2020-05-29 23:07:12,083 - root - INFO - | Epoch: 007/150 | Train Time: 2.261s | Train Loss: 0.068272 |
2020-05-29 23:07:14,263 - root - INFO - | Epoch: 008/150 | Train Time: 2.180s | Train Loss: 0.064892 |
2020-05-29 23:07:17,440 - root - INFO - | Epoch: 009/150 | Train Time: 3.176s | Train Loss: 0.062977 |
2020-05-29 23:07:19,707 - root - INFO - | Epoch: 010/150 | Train Time: 2.266s | Train Loss: 0.060097 |
2020-05-29 23:07:22,605 - root - INFO - | Epoch: 011/150 | Train Time: 2.897s | Train Loss: 0.058523 |
2020-05-29 23:07:24,798 - root - INFO - | Epoch: 012/150 | Train Time: 2.193s | Train Loss: 0.056242 |
2020-05-29 23:07:27,501 - root - INFO - | Epoch: 013/150 | Train Time: 2.702s | Train Loss: 0.053933 |
2020-05-29 23:07:30,267 - root - INFO - | Epoch: 014/150 | Train Time: 2.766s | Train Loss: 0.052764 |
2020-05-29 23:07:32,818 - root - INFO - | Epoch: 015/150 | Train Time: 2.551s | Train Loss: 0.052532 |
2020-05-29 23:07:35,715 - root - INFO - | Epoch: 016/150 | Train Time: 2.896s | Train Loss: 0.051121 |
2020-05-29 23:07:38,351 - root - INFO - | Epoch: 017/150 | Train Time: 2.635s | Train Loss: 0.049791 |
2020-05-29 23:07:41,258 - root - INFO - | Epoch: 018/150 | Train Time: 2.906s | Train Loss: 0.049859 |
2020-05-29 23:07:44,331 - root - INFO - | Epoch: 019/150 | Train Time: 3.073s | Train Loss: 0.048246 |
2020-05-29 23:07:47,588 - root - INFO - | Epoch: 020/150 | Train Time: 3.256s | Train Loss: 0.048009 |
2020-05-29 23:07:50,396 - root - INFO - | Epoch: 021/150 | Train Time: 2.807s | Train Loss: 0.047418 |
2020-05-29 23:07:53,251 - root - INFO - | Epoch: 022/150 | Train Time: 2.855s | Train Loss: 0.045829 |
2020-05-29 23:07:56,257 - root - INFO - | Epoch: 023/150 | Train Time: 3.005s | Train Loss: 0.045112 |
2020-05-29 23:07:59,463 - root - INFO - | Epoch: 024/150 | Train Time: 3.206s | Train Loss: 0.044211 |
2020-05-29 23:08:02,141 - root - INFO - | Epoch: 025/150 | Train Time: 2.677s | Train Loss: 0.044783 |
2020-05-29 23:08:05,396 - root - INFO - | Epoch: 026/150 | Train Time: 3.254s | Train Loss: 0.044734 |
2020-05-29 23:08:08,565 - root - INFO - | Epoch: 027/150 | Train Time: 3.168s | Train Loss: 0.043629 |
2020-05-29 23:08:11,439 - root - INFO - | Epoch: 028/150 | Train Time: 2.874s | Train Loss: 0.043626 |
2020-05-29 23:08:14,622 - root - INFO - | Epoch: 029/150 | Train Time: 3.182s | Train Loss: 0.042372 |
2020-05-29 23:08:17,831 - root - INFO - | Epoch: 030/150 | Train Time: 3.209s | Train Loss: 0.042739 |
2020-05-29 23:08:20,559 - root - INFO - | Epoch: 031/150 | Train Time: 2.727s | Train Loss: 0.042112 |
2020-05-29 23:08:23,394 - root - INFO - | Epoch: 032/150 | Train Time: 2.834s | Train Loss: 0.041276 |
2020-05-29 23:08:26,177 - root - INFO - | Epoch: 033/150 | Train Time: 2.782s | Train Loss: 0.040733 |
2020-05-29 23:08:28,897 - root - INFO - | Epoch: 034/150 | Train Time: 2.720s | Train Loss: 0.040381 |
2020-05-29 23:08:31,695 - root - INFO - | Epoch: 035/150 | Train Time: 2.797s | Train Loss: 0.041353 |
2020-05-29 23:08:33,783 - root - INFO - | Epoch: 036/150 | Train Time: 2.088s | Train Loss: 0.040087 |
2020-05-29 23:08:36,092 - root - INFO - | Epoch: 037/150 | Train Time: 2.308s | Train Loss: 0.039850 |
2020-05-29 23:08:38,601 - root - INFO - | Epoch: 038/150 | Train Time: 2.508s | Train Loss: 0.038587 |
2020-05-29 23:08:41,352 - root - INFO - | Epoch: 039/150 | Train Time: 2.750s | Train Loss: 0.038983 |
2020-05-29 23:08:43,705 - root - INFO - | Epoch: 040/150 | Train Time: 2.353s | Train Loss: 0.038750 |
2020-05-29 23:08:45,851 - root - INFO - | Epoch: 041/150 | Train Time: 2.146s | Train Loss: 0.038973 |
2020-05-29 23:08:48,198 - root - INFO - | Epoch: 042/150 | Train Time: 2.346s | Train Loss: 0.038553 |
2020-05-29 23:08:50,440 - root - INFO - | Epoch: 043/150 | Train Time: 2.240s | Train Loss: 0.038883 |
2020-05-29 23:08:52,378 - root - INFO - | Epoch: 044/150 | Train Time: 1.938s | Train Loss: 0.037766 |
2020-05-29 23:08:54,358 - root - INFO - | Epoch: 045/150 | Train Time: 1.979s | Train Loss: 0.037874 |
2020-05-29 23:08:56,778 - root - INFO - | Epoch: 046/150 | Train Time: 2.420s | Train Loss: 0.037528 |
2020-05-29 23:09:00,296 - root - INFO - | Epoch: 047/150 | Train Time: 3.517s | Train Loss: 0.037458 |
2020-05-29 23:09:03,548 - root - INFO - | Epoch: 048/150 | Train Time: 3.251s | Train Loss: 0.037209 |
2020-05-29 23:09:06,808 - root - INFO - | Epoch: 049/150 | Train Time: 3.260s | Train Loss: 0.036791 |
2020-05-29 23:09:09,750 - root - INFO - | Epoch: 050/150 | Train Time: 2.941s | Train Loss: 0.036279 |
2020-05-29 23:09:09,750 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-29 23:09:12,508 - root - INFO - | Epoch: 051/150 | Train Time: 2.758s | Train Loss: 0.035840 |
2020-05-29 23:09:15,429 - root - INFO - | Epoch: 052/150 | Train Time: 2.921s | Train Loss: 0.036107 |
2020-05-29 23:09:17,877 - root - INFO - | Epoch: 053/150 | Train Time: 2.448s | Train Loss: 0.035853 |
2020-05-29 23:09:20,272 - root - INFO - | Epoch: 054/150 | Train Time: 2.394s | Train Loss: 0.036211 |
2020-05-29 23:09:22,764 - root - INFO - | Epoch: 055/150 | Train Time: 2.492s | Train Loss: 0.036485 |
2020-05-29 23:09:25,572 - root - INFO - | Epoch: 056/150 | Train Time: 2.808s | Train Loss: 0.036415 |
2020-05-29 23:09:28,252 - root - INFO - | Epoch: 057/150 | Train Time: 2.680s | Train Loss: 0.036428 |
2020-05-29 23:09:30,661 - root - INFO - | Epoch: 058/150 | Train Time: 2.408s | Train Loss: 0.035452 |
2020-05-29 23:09:33,217 - root - INFO - | Epoch: 059/150 | Train Time: 2.555s | Train Loss: 0.035773 |
2020-05-29 23:09:35,591 - root - INFO - | Epoch: 060/150 | Train Time: 2.374s | Train Loss: 0.035773 |
2020-05-29 23:09:37,544 - root - INFO - | Epoch: 061/150 | Train Time: 1.953s | Train Loss: 0.034992 |
2020-05-29 23:09:39,517 - root - INFO - | Epoch: 062/150 | Train Time: 1.967s | Train Loss: 0.035412 |
2020-05-29 23:09:41,698 - root - INFO - | Epoch: 063/150 | Train Time: 2.180s | Train Loss: 0.035909 |
2020-05-29 23:09:44,501 - root - INFO - | Epoch: 064/150 | Train Time: 2.802s | Train Loss: 0.036144 |
2020-05-29 23:09:47,249 - root - INFO - | Epoch: 065/150 | Train Time: 2.748s | Train Loss: 0.035310 |
2020-05-29 23:09:49,790 - root - INFO - | Epoch: 066/150 | Train Time: 2.540s | Train Loss: 0.035326 |
2020-05-29 23:09:51,928 - root - INFO - | Epoch: 067/150 | Train Time: 2.138s | Train Loss: 0.036240 |
2020-05-29 23:09:54,073 - root - INFO - | Epoch: 068/150 | Train Time: 2.144s | Train Loss: 0.035311 |
2020-05-29 23:09:56,645 - root - INFO - | Epoch: 069/150 | Train Time: 2.572s | Train Loss: 0.035868 |
2020-05-29 23:09:59,275 - root - INFO - | Epoch: 070/150 | Train Time: 2.624s | Train Loss: 0.035770 |
2020-05-29 23:10:02,040 - root - INFO - | Epoch: 071/150 | Train Time: 2.764s | Train Loss: 0.036190 |
2020-05-29 23:10:05,005 - root - INFO - | Epoch: 072/150 | Train Time: 2.965s | Train Loss: 0.035904 |
2020-05-29 23:10:08,156 - root - INFO - | Epoch: 073/150 | Train Time: 3.150s | Train Loss: 0.035727 |
2020-05-29 23:10:10,961 - root - INFO - | Epoch: 074/150 | Train Time: 2.803s | Train Loss: 0.035843 |
2020-05-29 23:10:13,836 - root - INFO - | Epoch: 075/150 | Train Time: 2.875s | Train Loss: 0.036017 |
2020-05-29 23:10:16,419 - root - INFO - | Epoch: 076/150 | Train Time: 2.583s | Train Loss: 0.035812 |
2020-05-29 23:10:19,041 - root - INFO - | Epoch: 077/150 | Train Time: 2.621s | Train Loss: 0.035579 |
2020-05-29 23:10:21,470 - root - INFO - | Epoch: 078/150 | Train Time: 2.429s | Train Loss: 0.035938 |
2020-05-29 23:10:24,187 - root - INFO - | Epoch: 079/150 | Train Time: 2.717s | Train Loss: 0.035858 |
2020-05-29 23:10:26,484 - root - INFO - | Epoch: 080/150 | Train Time: 2.297s | Train Loss: 0.034723 |
2020-05-29 23:10:28,917 - root - INFO - | Epoch: 081/150 | Train Time: 2.432s | Train Loss: 0.034937 |
2020-05-29 23:10:31,337 - root - INFO - | Epoch: 082/150 | Train Time: 2.420s | Train Loss: 0.035653 |
2020-05-29 23:10:34,437 - root - INFO - | Epoch: 083/150 | Train Time: 3.099s | Train Loss: 0.035510 |
2020-05-29 23:10:37,171 - root - INFO - | Epoch: 084/150 | Train Time: 2.733s | Train Loss: 0.035155 |
2020-05-29 23:10:40,098 - root - INFO - | Epoch: 085/150 | Train Time: 2.927s | Train Loss: 0.035479 |
2020-05-29 23:10:42,591 - root - INFO - | Epoch: 086/150 | Train Time: 2.491s | Train Loss: 0.034847 |
2020-05-29 23:10:45,570 - root - INFO - | Epoch: 087/150 | Train Time: 2.978s | Train Loss: 0.035594 |
2020-05-29 23:10:48,677 - root - INFO - | Epoch: 088/150 | Train Time: 3.107s | Train Loss: 0.035156 |
2020-05-29 23:10:51,182 - root - INFO - | Epoch: 089/150 | Train Time: 2.504s | Train Loss: 0.035112 |
2020-05-29 23:10:53,760 - root - INFO - | Epoch: 090/150 | Train Time: 2.578s | Train Loss: 0.035330 |
2020-05-29 23:10:56,579 - root - INFO - | Epoch: 091/150 | Train Time: 2.817s | Train Loss: 0.034896 |
2020-05-29 23:10:59,525 - root - INFO - | Epoch: 092/150 | Train Time: 2.946s | Train Loss: 0.034999 |
2020-05-29 23:11:02,215 - root - INFO - | Epoch: 093/150 | Train Time: 2.689s | Train Loss: 0.035615 |
2020-05-29 23:11:05,284 - root - INFO - | Epoch: 094/150 | Train Time: 3.068s | Train Loss: 0.035597 |
2020-05-29 23:11:07,797 - root - INFO - | Epoch: 095/150 | Train Time: 2.513s | Train Loss: 0.035280 |
2020-05-29 23:11:10,630 - root - INFO - | Epoch: 096/150 | Train Time: 2.832s | Train Loss: 0.034992 |
2020-05-29 23:11:13,697 - root - INFO - | Epoch: 097/150 | Train Time: 3.066s | Train Loss: 0.035052 |
2020-05-29 23:11:16,338 - root - INFO - | Epoch: 098/150 | Train Time: 2.640s | Train Loss: 0.034794 |
2020-05-29 23:11:18,629 - root - INFO - | Epoch: 099/150 | Train Time: 2.290s | Train Loss: 0.034508 |
2020-05-29 23:11:20,977 - root - INFO - | Epoch: 100/150 | Train Time: 2.348s | Train Loss: 0.035293 |
2020-05-29 23:11:23,188 - root - INFO - | Epoch: 101/150 | Train Time: 2.211s | Train Loss: 0.035606 |
2020-05-29 23:11:25,582 - root - INFO - | Epoch: 102/150 | Train Time: 2.393s | Train Loss: 0.034763 |
2020-05-29 23:11:27,934 - root - INFO - | Epoch: 103/150 | Train Time: 2.352s | Train Loss: 0.034979 |
2020-05-29 23:11:30,330 - root - INFO - | Epoch: 104/150 | Train Time: 2.396s | Train Loss: 0.034721 |
2020-05-29 23:11:32,514 - root - INFO - | Epoch: 105/150 | Train Time: 2.183s | Train Loss: 0.035011 |
2020-05-29 23:11:35,281 - root - INFO - | Epoch: 106/150 | Train Time: 2.766s | Train Loss: 0.035243 |
2020-05-29 23:11:38,456 - root - INFO - | Epoch: 107/150 | Train Time: 3.175s | Train Loss: 0.033908 |
2020-05-29 23:11:41,474 - root - INFO - | Epoch: 108/150 | Train Time: 3.018s | Train Loss: 0.035094 |
2020-05-29 23:11:43,997 - root - INFO - | Epoch: 109/150 | Train Time: 2.522s | Train Loss: 0.035055 |
2020-05-29 23:11:46,271 - root - INFO - | Epoch: 110/150 | Train Time: 2.274s | Train Loss: 0.034876 |
2020-05-29 23:11:48,758 - root - INFO - | Epoch: 111/150 | Train Time: 2.486s | Train Loss: 0.034929 |
2020-05-29 23:11:51,044 - root - INFO - | Epoch: 112/150 | Train Time: 2.286s | Train Loss: 0.034309 |
2020-05-29 23:11:53,305 - root - INFO - | Epoch: 113/150 | Train Time: 2.261s | Train Loss: 0.034764 |
2020-05-29 23:11:55,911 - root - INFO - | Epoch: 114/150 | Train Time: 2.605s | Train Loss: 0.034848 |
2020-05-29 23:11:58,589 - root - INFO - | Epoch: 115/150 | Train Time: 2.678s | Train Loss: 0.034686 |
2020-05-29 23:12:01,343 - root - INFO - | Epoch: 116/150 | Train Time: 2.754s | Train Loss: 0.034544 |
2020-05-29 23:12:03,818 - root - INFO - | Epoch: 117/150 | Train Time: 2.475s | Train Loss: 0.033885 |
2020-05-29 23:12:06,310 - root - INFO - | Epoch: 118/150 | Train Time: 2.492s | Train Loss: 0.034308 |
2020-05-29 23:12:08,993 - root - INFO - | Epoch: 119/150 | Train Time: 2.682s | Train Loss: 0.035010 |
2020-05-29 23:12:11,725 - root - INFO - | Epoch: 120/150 | Train Time: 2.731s | Train Loss: 0.034686 |
2020-05-29 23:12:14,586 - root - INFO - | Epoch: 121/150 | Train Time: 2.861s | Train Loss: 0.034877 |
2020-05-29 23:12:17,115 - root - INFO - | Epoch: 122/150 | Train Time: 2.529s | Train Loss: 0.034653 |
2020-05-29 23:12:19,880 - root - INFO - | Epoch: 123/150 | Train Time: 2.764s | Train Loss: 0.034940 |
2020-05-29 23:12:22,418 - root - INFO - | Epoch: 124/150 | Train Time: 2.538s | Train Loss: 0.034276 |
2020-05-29 23:12:25,241 - root - INFO - | Epoch: 125/150 | Train Time: 2.822s | Train Loss: 0.034729 |
2020-05-29 23:12:28,106 - root - INFO - | Epoch: 126/150 | Train Time: 2.865s | Train Loss: 0.034234 |
2020-05-29 23:12:30,738 - root - INFO - | Epoch: 127/150 | Train Time: 2.631s | Train Loss: 0.035141 |
2020-05-29 23:12:33,732 - root - INFO - | Epoch: 128/150 | Train Time: 2.993s | Train Loss: 0.034664 |
2020-05-29 23:12:35,748 - root - INFO - | Epoch: 129/150 | Train Time: 2.016s | Train Loss: 0.034653 |
2020-05-29 23:12:38,097 - root - INFO - | Epoch: 130/150 | Train Time: 2.347s | Train Loss: 0.034722 |
2020-05-29 23:12:40,631 - root - INFO - | Epoch: 131/150 | Train Time: 2.534s | Train Loss: 0.034116 |
2020-05-29 23:12:43,164 - root - INFO - | Epoch: 132/150 | Train Time: 2.533s | Train Loss: 0.033711 |
2020-05-29 23:12:45,455 - root - INFO - | Epoch: 133/150 | Train Time: 2.290s | Train Loss: 0.034275 |
2020-05-29 23:12:47,666 - root - INFO - | Epoch: 134/150 | Train Time: 2.211s | Train Loss: 0.034978 |
2020-05-29 23:12:49,891 - root - INFO - | Epoch: 135/150 | Train Time: 2.225s | Train Loss: 0.034492 |
2020-05-29 23:12:51,924 - root - INFO - | Epoch: 136/150 | Train Time: 2.032s | Train Loss: 0.034356 |
2020-05-29 23:12:54,084 - root - INFO - | Epoch: 137/150 | Train Time: 2.159s | Train Loss: 0.034613 |
2020-05-29 23:12:56,591 - root - INFO - | Epoch: 138/150 | Train Time: 2.507s | Train Loss: 0.034405 |
2020-05-29 23:12:59,091 - root - INFO - | Epoch: 139/150 | Train Time: 2.499s | Train Loss: 0.034046 |
2020-05-29 23:13:01,593 - root - INFO - | Epoch: 140/150 | Train Time: 2.502s | Train Loss: 0.034596 |
2020-05-29 23:13:04,051 - root - INFO - | Epoch: 141/150 | Train Time: 2.457s | Train Loss: 0.034189 |
2020-05-29 23:13:06,656 - root - INFO - | Epoch: 142/150 | Train Time: 2.605s | Train Loss: 0.033869 |
2020-05-29 23:13:08,850 - root - INFO - | Epoch: 143/150 | Train Time: 2.193s | Train Loss: 0.034379 |
2020-05-29 23:13:11,191 - root - INFO - | Epoch: 144/150 | Train Time: 2.340s | Train Loss: 0.034541 |
2020-05-29 23:13:13,629 - root - INFO - | Epoch: 145/150 | Train Time: 2.432s | Train Loss: 0.033943 |
2020-05-29 23:13:15,747 - root - INFO - | Epoch: 146/150 | Train Time: 2.117s | Train Loss: 0.033435 |
2020-05-29 23:13:18,124 - root - INFO - | Epoch: 147/150 | Train Time: 2.376s | Train Loss: 0.034451 |
2020-05-29 23:13:20,728 - root - INFO - | Epoch: 148/150 | Train Time: 2.604s | Train Loss: 0.033625 |
2020-05-29 23:13:23,070 - root - INFO - | Epoch: 149/150 | Train Time: 2.341s | Train Loss: 0.033853 |
2020-05-29 23:13:25,665 - root - INFO - | Epoch: 150/150 | Train Time: 2.595s | Train Loss: 0.034399 |
2020-05-29 23:13:25,665 - root - INFO - Training Time: 395.473s
2020-05-29 23:13:25,665 - root - INFO - Finished training.
2020-05-29 23:13:25,667 - root - INFO - Starting testing...
2020-05-29 23:13:28,125 - root - INFO - Test Loss: 0.120556
2020-05-29 23:13:28,126 - root - INFO - Test AUC: 99.15%
2020-05-29 23:13:28,126 - root - INFO - Test Time: 2.444s
2020-05-29 23:13:28,126 - root - INFO - Finished testing.
