2020-05-30 15:39:49,494 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_4_2_01.txt
2020-05-30 15:39:49,494 - root - INFO - Data path is ../data
2020-05-30 15:39:49,494 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-30 15:39:49,494 - root - INFO - Dataset: mnist
2020-05-30 15:39:49,494 - root - INFO - Normal class: 4
2020-05-30 15:39:49,494 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 15:39:49,494 - root - INFO - Ratio of labeled anomalous samples: 0.10
2020-05-30 15:39:49,494 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 15:39:49,494 - root - INFO - Scenario Running: 1
2020-05-30 15:39:49,494 - root - INFO - Train only the network: True
2020-05-30 15:39:49,494 - root - INFO - Output and AE dimensions: 128
2020-05-30 15:39:49,495 - root - INFO - Known anomaly class: 2
2020-05-30 15:39:49,495 - root - INFO - Network: mnist_LeNet
2020-05-30 15:39:49,495 - root - INFO - Eta-parameter: 1.00
2020-05-30 15:39:49,502 - root - INFO - Set seed to 0.
2020-05-30 15:39:49,571 - root - INFO - Computation device: cuda
2020-05-30 15:39:49,571 - root - INFO - Number of threads: 0
2020-05-30 15:39:49,571 - root - INFO - Number of dataloader workers: 6
2020-05-30 15:39:59,502 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-30 15:39:59,505 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 15:39:59,505 - root - INFO - Training optimizer: adam
2020-05-30 15:39:59,505 - root - INFO - Training learning rate: 0.0001
2020-05-30 15:39:59,506 - root - INFO - Training epochs: 150
2020-05-30 15:39:59,506 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 15:39:59,506 - root - INFO - Training batch size: 200
2020-05-30 15:39:59,506 - root - INFO - Training weight decay: 5e-07
2020-05-30 15:39:59,508 - root - INFO - Starting training...
2020-05-30 15:40:08,248 - root - INFO - | Epoch: 001/150 | Train Time: 8.725s | Train Loss: 0.478451 |
2020-05-30 15:40:11,799 - root - INFO - | Epoch: 002/150 | Train Time: 3.549s | Train Loss: 0.326482 |
2020-05-30 15:40:15,143 - root - INFO - | Epoch: 003/150 | Train Time: 3.343s | Train Loss: 0.275845 |
2020-05-30 15:40:18,500 - root - INFO - | Epoch: 004/150 | Train Time: 3.357s | Train Loss: 0.250268 |
2020-05-30 15:40:22,034 - root - INFO - | Epoch: 005/150 | Train Time: 3.532s | Train Loss: 0.234553 |
2020-05-30 15:40:26,012 - root - INFO - | Epoch: 006/150 | Train Time: 3.977s | Train Loss: 0.223513 |
2020-05-30 15:40:28,979 - root - INFO - | Epoch: 007/150 | Train Time: 2.967s | Train Loss: 0.213899 |
2020-05-30 15:40:32,281 - root - INFO - | Epoch: 008/150 | Train Time: 3.302s | Train Loss: 0.206225 |
2020-05-30 15:40:35,401 - root - INFO - | Epoch: 009/150 | Train Time: 3.119s | Train Loss: 0.200347 |
2020-05-30 15:40:39,583 - root - INFO - | Epoch: 010/150 | Train Time: 4.182s | Train Loss: 0.194964 |
2020-05-30 15:40:43,756 - root - INFO - | Epoch: 011/150 | Train Time: 4.091s | Train Loss: 0.189592 |
2020-05-30 15:40:47,350 - root - INFO - | Epoch: 012/150 | Train Time: 3.593s | Train Loss: 0.184560 |
2020-05-30 15:40:50,792 - root - INFO - | Epoch: 013/150 | Train Time: 3.442s | Train Loss: 0.180529 |
2020-05-30 15:40:53,781 - root - INFO - | Epoch: 014/150 | Train Time: 2.988s | Train Loss: 0.175932 |
2020-05-30 15:40:57,173 - root - INFO - | Epoch: 015/150 | Train Time: 3.392s | Train Loss: 0.172097 |
2020-05-30 15:41:00,309 - root - INFO - | Epoch: 016/150 | Train Time: 3.135s | Train Loss: 0.168653 |
2020-05-30 15:41:03,647 - root - INFO - | Epoch: 017/150 | Train Time: 3.338s | Train Loss: 0.164839 |
2020-05-30 15:41:07,172 - root - INFO - | Epoch: 018/150 | Train Time: 3.525s | Train Loss: 0.161863 |
2020-05-30 15:41:10,704 - root - INFO - | Epoch: 019/150 | Train Time: 3.531s | Train Loss: 0.158712 |
2020-05-30 15:41:13,877 - root - INFO - | Epoch: 020/150 | Train Time: 3.172s | Train Loss: 0.155241 |
2020-05-30 15:41:16,979 - root - INFO - | Epoch: 021/150 | Train Time: 3.101s | Train Loss: 0.152250 |
2020-05-30 15:41:20,311 - root - INFO - | Epoch: 022/150 | Train Time: 3.332s | Train Loss: 0.149354 |
2020-05-30 15:41:24,114 - root - INFO - | Epoch: 023/150 | Train Time: 3.803s | Train Loss: 0.146684 |
2020-05-30 15:41:27,631 - root - INFO - | Epoch: 024/150 | Train Time: 3.517s | Train Loss: 0.144438 |
2020-05-30 15:41:30,857 - root - INFO - | Epoch: 025/150 | Train Time: 3.225s | Train Loss: 0.141805 |
2020-05-30 15:41:34,798 - root - INFO - | Epoch: 026/150 | Train Time: 3.941s | Train Loss: 0.139351 |
2020-05-30 15:41:38,101 - root - INFO - | Epoch: 027/150 | Train Time: 3.302s | Train Loss: 0.136480 |
2020-05-30 15:41:41,356 - root - INFO - | Epoch: 028/150 | Train Time: 3.254s | Train Loss: 0.135122 |
2020-05-30 15:41:44,918 - root - INFO - | Epoch: 029/150 | Train Time: 3.561s | Train Loss: 0.132833 |
2020-05-30 15:41:48,222 - root - INFO - | Epoch: 030/150 | Train Time: 3.303s | Train Loss: 0.131754 |
2020-05-30 15:41:51,693 - root - INFO - | Epoch: 031/150 | Train Time: 3.471s | Train Loss: 0.129063 |
2020-05-30 15:41:55,001 - root - INFO - | Epoch: 032/150 | Train Time: 3.308s | Train Loss: 0.127392 |
2020-05-30 15:41:58,616 - root - INFO - | Epoch: 033/150 | Train Time: 3.613s | Train Loss: 0.125969 |
2020-05-30 15:42:02,372 - root - INFO - | Epoch: 034/150 | Train Time: 3.756s | Train Loss: 0.124792 |
2020-05-30 15:42:05,471 - root - INFO - | Epoch: 035/150 | Train Time: 3.098s | Train Loss: 0.122927 |
2020-05-30 15:42:08,109 - root - INFO - | Epoch: 036/150 | Train Time: 2.637s | Train Loss: 0.121446 |
2020-05-30 15:42:10,801 - root - INFO - | Epoch: 037/150 | Train Time: 2.692s | Train Loss: 0.119532 |
2020-05-30 15:42:14,356 - root - INFO - | Epoch: 038/150 | Train Time: 3.555s | Train Loss: 0.119433 |
2020-05-30 15:42:17,755 - root - INFO - | Epoch: 039/150 | Train Time: 3.399s | Train Loss: 0.118103 |
2020-05-30 15:42:20,519 - root - INFO - | Epoch: 040/150 | Train Time: 2.763s | Train Loss: 0.117189 |
2020-05-30 15:42:23,525 - root - INFO - | Epoch: 041/150 | Train Time: 3.005s | Train Loss: 0.116277 |
2020-05-30 15:42:26,777 - root - INFO - | Epoch: 042/150 | Train Time: 3.252s | Train Loss: 0.115228 |
2020-05-30 15:42:29,692 - root - INFO - | Epoch: 043/150 | Train Time: 2.914s | Train Loss: 0.114569 |
2020-05-30 15:42:32,812 - root - INFO - | Epoch: 044/150 | Train Time: 3.119s | Train Loss: 0.113809 |
2020-05-30 15:42:35,873 - root - INFO - | Epoch: 045/150 | Train Time: 3.061s | Train Loss: 0.112931 |
2020-05-30 15:42:38,876 - root - INFO - | Epoch: 046/150 | Train Time: 3.003s | Train Loss: 0.112147 |
2020-05-30 15:42:42,245 - root - INFO - | Epoch: 047/150 | Train Time: 3.368s | Train Loss: 0.111462 |
2020-05-30 15:42:45,446 - root - INFO - | Epoch: 048/150 | Train Time: 3.200s | Train Loss: 0.110966 |
2020-05-30 15:42:48,974 - root - INFO - | Epoch: 049/150 | Train Time: 3.527s | Train Loss: 0.110402 |
2020-05-30 15:42:52,004 - root - INFO - | Epoch: 050/150 | Train Time: 3.029s | Train Loss: 0.109207 |
2020-05-30 15:42:52,004 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 15:42:54,808 - root - INFO - | Epoch: 051/150 | Train Time: 2.803s | Train Loss: 0.109018 |
2020-05-30 15:42:57,802 - root - INFO - | Epoch: 052/150 | Train Time: 2.994s | Train Loss: 0.108253 |
2020-05-30 15:43:01,095 - root - INFO - | Epoch: 053/150 | Train Time: 3.292s | Train Loss: 0.108839 |
2020-05-30 15:43:04,317 - root - INFO - | Epoch: 054/150 | Train Time: 3.222s | Train Loss: 0.108308 |
2020-05-30 15:43:07,448 - root - INFO - | Epoch: 055/150 | Train Time: 3.131s | Train Loss: 0.108726 |
2020-05-30 15:43:10,439 - root - INFO - | Epoch: 056/150 | Train Time: 2.991s | Train Loss: 0.108542 |
2020-05-30 15:43:13,920 - root - INFO - | Epoch: 057/150 | Train Time: 3.480s | Train Loss: 0.107954 |
2020-05-30 15:43:16,809 - root - INFO - | Epoch: 058/150 | Train Time: 2.888s | Train Loss: 0.108636 |
2020-05-30 15:43:20,933 - root - INFO - | Epoch: 059/150 | Train Time: 4.123s | Train Loss: 0.108449 |
2020-05-30 15:43:23,996 - root - INFO - | Epoch: 060/150 | Train Time: 3.063s | Train Loss: 0.108531 |
2020-05-30 15:43:27,339 - root - INFO - | Epoch: 061/150 | Train Time: 3.343s | Train Loss: 0.108024 |
2020-05-30 15:43:30,645 - root - INFO - | Epoch: 062/150 | Train Time: 3.305s | Train Loss: 0.108332 |
2020-05-30 15:43:33,462 - root - INFO - | Epoch: 063/150 | Train Time: 2.817s | Train Loss: 0.108491 |
2020-05-30 15:43:36,459 - root - INFO - | Epoch: 064/150 | Train Time: 2.996s | Train Loss: 0.108426 |
2020-05-30 15:43:39,510 - root - INFO - | Epoch: 065/150 | Train Time: 3.051s | Train Loss: 0.108113 |
2020-05-30 15:43:42,638 - root - INFO - | Epoch: 066/150 | Train Time: 3.128s | Train Loss: 0.107996 |
2020-05-30 15:43:46,252 - root - INFO - | Epoch: 067/150 | Train Time: 3.613s | Train Loss: 0.108158 |
2020-05-30 15:43:49,637 - root - INFO - | Epoch: 068/150 | Train Time: 3.384s | Train Loss: 0.107998 |
2020-05-30 15:43:53,072 - root - INFO - | Epoch: 069/150 | Train Time: 3.434s | Train Loss: 0.108005 |
2020-05-30 15:43:55,958 - root - INFO - | Epoch: 070/150 | Train Time: 2.886s | Train Loss: 0.107783 |
2020-05-30 15:43:58,702 - root - INFO - | Epoch: 071/150 | Train Time: 2.743s | Train Loss: 0.107002 |
2020-05-30 15:44:01,460 - root - INFO - | Epoch: 072/150 | Train Time: 2.758s | Train Loss: 0.107863 |
2020-05-30 15:44:04,363 - root - INFO - | Epoch: 073/150 | Train Time: 2.903s | Train Loss: 0.107670 |
2020-05-30 15:44:07,199 - root - INFO - | Epoch: 074/150 | Train Time: 2.835s | Train Loss: 0.107621 |
2020-05-30 15:44:10,299 - root - INFO - | Epoch: 075/150 | Train Time: 3.099s | Train Loss: 0.107502 |
2020-05-30 15:44:13,429 - root - INFO - | Epoch: 076/150 | Train Time: 3.130s | Train Loss: 0.107143 |
2020-05-30 15:44:16,308 - root - INFO - | Epoch: 077/150 | Train Time: 2.878s | Train Loss: 0.107235 |
2020-05-30 15:44:19,474 - root - INFO - | Epoch: 078/150 | Train Time: 3.166s | Train Loss: 0.107211 |
2020-05-30 15:44:22,177 - root - INFO - | Epoch: 079/150 | Train Time: 2.702s | Train Loss: 0.107240 |
2020-05-30 15:44:25,189 - root - INFO - | Epoch: 080/150 | Train Time: 3.012s | Train Loss: 0.107044 |
2020-05-30 15:44:28,387 - root - INFO - | Epoch: 081/150 | Train Time: 3.198s | Train Loss: 0.106856 |
2020-05-30 15:44:32,004 - root - INFO - | Epoch: 082/150 | Train Time: 3.616s | Train Loss: 0.106723 |
2020-05-30 15:44:35,890 - root - INFO - | Epoch: 083/150 | Train Time: 3.885s | Train Loss: 0.106876 |
2020-05-30 15:44:39,815 - root - INFO - | Epoch: 084/150 | Train Time: 3.924s | Train Loss: 0.106964 |
2020-05-30 15:44:43,206 - root - INFO - | Epoch: 085/150 | Train Time: 3.391s | Train Loss: 0.106829 |
2020-05-30 15:44:46,401 - root - INFO - | Epoch: 086/150 | Train Time: 3.194s | Train Loss: 0.106798 |
2020-05-30 15:44:49,817 - root - INFO - | Epoch: 087/150 | Train Time: 3.416s | Train Loss: 0.106651 |
2020-05-30 15:44:53,156 - root - INFO - | Epoch: 088/150 | Train Time: 3.338s | Train Loss: 0.106383 |
2020-05-30 15:44:56,693 - root - INFO - | Epoch: 089/150 | Train Time: 3.536s | Train Loss: 0.106288 |
2020-05-30 15:45:00,226 - root - INFO - | Epoch: 090/150 | Train Time: 3.533s | Train Loss: 0.106573 |
2020-05-30 15:45:03,204 - root - INFO - | Epoch: 091/150 | Train Time: 2.978s | Train Loss: 0.106629 |
2020-05-30 15:45:05,891 - root - INFO - | Epoch: 092/150 | Train Time: 2.687s | Train Loss: 0.106199 |
2020-05-30 15:45:08,752 - root - INFO - | Epoch: 093/150 | Train Time: 2.860s | Train Loss: 0.106129 |
2020-05-30 15:45:11,566 - root - INFO - | Epoch: 094/150 | Train Time: 2.813s | Train Loss: 0.106144 |
2020-05-30 15:45:13,980 - root - INFO - | Epoch: 095/150 | Train Time: 2.414s | Train Loss: 0.106384 |
2020-05-30 15:45:16,532 - root - INFO - | Epoch: 096/150 | Train Time: 2.551s | Train Loss: 0.106079 |
2020-05-30 15:45:19,672 - root - INFO - | Epoch: 097/150 | Train Time: 3.140s | Train Loss: 0.106075 |
2020-05-30 15:45:23,670 - root - INFO - | Epoch: 098/150 | Train Time: 3.997s | Train Loss: 0.105981 |
2020-05-30 15:45:27,350 - root - INFO - | Epoch: 099/150 | Train Time: 3.680s | Train Loss: 0.105884 |
2020-05-30 15:45:30,505 - root - INFO - | Epoch: 100/150 | Train Time: 3.154s | Train Loss: 0.105572 |
2020-05-30 15:45:33,430 - root - INFO - | Epoch: 101/150 | Train Time: 2.925s | Train Loss: 0.105881 |
2020-05-30 15:45:36,369 - root - INFO - | Epoch: 102/150 | Train Time: 2.938s | Train Loss: 0.105682 |
2020-05-30 15:45:39,441 - root - INFO - | Epoch: 103/150 | Train Time: 3.072s | Train Loss: 0.105626 |
2020-05-30 15:45:43,005 - root - INFO - | Epoch: 104/150 | Train Time: 3.562s | Train Loss: 0.105690 |
2020-05-30 15:45:46,883 - root - INFO - | Epoch: 105/150 | Train Time: 3.878s | Train Loss: 0.105557 |
2020-05-30 15:45:50,607 - root - INFO - | Epoch: 106/150 | Train Time: 3.723s | Train Loss: 0.105531 |
2020-05-30 15:45:54,058 - root - INFO - | Epoch: 107/150 | Train Time: 3.450s | Train Loss: 0.105451 |
2020-05-30 15:45:57,629 - root - INFO - | Epoch: 108/150 | Train Time: 3.570s | Train Loss: 0.105425 |
2020-05-30 15:46:01,327 - root - INFO - | Epoch: 109/150 | Train Time: 3.697s | Train Loss: 0.105241 |
2020-05-30 15:46:04,853 - root - INFO - | Epoch: 110/150 | Train Time: 3.526s | Train Loss: 0.105277 |
2020-05-30 15:46:08,463 - root - INFO - | Epoch: 111/150 | Train Time: 3.609s | Train Loss: 0.105268 |
2020-05-30 15:46:12,162 - root - INFO - | Epoch: 112/150 | Train Time: 3.699s | Train Loss: 0.105096 |
2020-05-30 15:46:15,365 - root - INFO - | Epoch: 113/150 | Train Time: 3.202s | Train Loss: 0.105132 |
2020-05-30 15:46:18,212 - root - INFO - | Epoch: 114/150 | Train Time: 2.847s | Train Loss: 0.104402 |
2020-05-30 15:46:21,574 - root - INFO - | Epoch: 115/150 | Train Time: 3.361s | Train Loss: 0.104445 |
2020-05-30 15:46:25,121 - root - INFO - | Epoch: 116/150 | Train Time: 3.546s | Train Loss: 0.104823 |
2020-05-30 15:46:28,758 - root - INFO - | Epoch: 117/150 | Train Time: 3.637s | Train Loss: 0.104925 |
2020-05-30 15:46:31,483 - root - INFO - | Epoch: 118/150 | Train Time: 2.724s | Train Loss: 0.104871 |
2020-05-30 15:46:34,580 - root - INFO - | Epoch: 119/150 | Train Time: 3.096s | Train Loss: 0.104655 |
2020-05-30 15:46:38,032 - root - INFO - | Epoch: 120/150 | Train Time: 3.452s | Train Loss: 0.104761 |
2020-05-30 15:46:40,605 - root - INFO - | Epoch: 121/150 | Train Time: 2.571s | Train Loss: 0.104591 |
2020-05-30 15:46:43,782 - root - INFO - | Epoch: 122/150 | Train Time: 3.177s | Train Loss: 0.104504 |
2020-05-30 15:46:47,032 - root - INFO - | Epoch: 123/150 | Train Time: 3.250s | Train Loss: 0.104454 |
2020-05-30 15:46:50,761 - root - INFO - | Epoch: 124/150 | Train Time: 3.728s | Train Loss: 0.104354 |
2020-05-30 15:46:53,867 - root - INFO - | Epoch: 125/150 | Train Time: 3.105s | Train Loss: 0.104023 |
2020-05-30 15:46:57,278 - root - INFO - | Epoch: 126/150 | Train Time: 3.411s | Train Loss: 0.104319 |
2020-05-30 15:47:00,265 - root - INFO - | Epoch: 127/150 | Train Time: 2.986s | Train Loss: 0.104146 |
2020-05-30 15:47:02,865 - root - INFO - | Epoch: 128/150 | Train Time: 2.599s | Train Loss: 0.104274 |
2020-05-30 15:47:05,845 - root - INFO - | Epoch: 129/150 | Train Time: 2.979s | Train Loss: 0.104134 |
2020-05-30 15:47:09,315 - root - INFO - | Epoch: 130/150 | Train Time: 3.470s | Train Loss: 0.103948 |
2020-05-30 15:47:13,177 - root - INFO - | Epoch: 131/150 | Train Time: 3.861s | Train Loss: 0.104050 |
2020-05-30 15:47:16,551 - root - INFO - | Epoch: 132/150 | Train Time: 3.374s | Train Loss: 0.103493 |
2020-05-30 15:47:20,163 - root - INFO - | Epoch: 133/150 | Train Time: 3.611s | Train Loss: 0.103864 |
2020-05-30 15:47:23,533 - root - INFO - | Epoch: 134/150 | Train Time: 3.369s | Train Loss: 0.103444 |
2020-05-30 15:47:26,893 - root - INFO - | Epoch: 135/150 | Train Time: 3.360s | Train Loss: 0.103821 |
2020-05-30 15:47:30,138 - root - INFO - | Epoch: 136/150 | Train Time: 3.244s | Train Loss: 0.103741 |
2020-05-30 15:47:33,283 - root - INFO - | Epoch: 137/150 | Train Time: 3.144s | Train Loss: 0.103501 |
2020-05-30 15:47:36,049 - root - INFO - | Epoch: 138/150 | Train Time: 2.766s | Train Loss: 0.103574 |
2020-05-30 15:47:39,054 - root - INFO - | Epoch: 139/150 | Train Time: 3.004s | Train Loss: 0.103471 |
2020-05-30 15:47:41,907 - root - INFO - | Epoch: 140/150 | Train Time: 2.853s | Train Loss: 0.102987 |
2020-05-30 15:47:45,022 - root - INFO - | Epoch: 141/150 | Train Time: 3.115s | Train Loss: 0.103379 |
2020-05-30 15:47:47,893 - root - INFO - | Epoch: 142/150 | Train Time: 2.870s | Train Loss: 0.103108 |
2020-05-30 15:47:50,690 - root - INFO - | Epoch: 143/150 | Train Time: 2.797s | Train Loss: 0.103536 |
2020-05-30 15:47:53,560 - root - INFO - | Epoch: 144/150 | Train Time: 2.869s | Train Loss: 0.103215 |
2020-05-30 15:47:56,259 - root - INFO - | Epoch: 145/150 | Train Time: 2.699s | Train Loss: 0.103176 |
2020-05-30 15:47:58,859 - root - INFO - | Epoch: 146/150 | Train Time: 2.599s | Train Loss: 0.102846 |
2020-05-30 15:48:01,500 - root - INFO - | Epoch: 147/150 | Train Time: 2.639s | Train Loss: 0.103075 |
2020-05-30 15:48:05,019 - root - INFO - | Epoch: 148/150 | Train Time: 3.519s | Train Loss: 0.103025 |
2020-05-30 15:48:08,563 - root - INFO - | Epoch: 149/150 | Train Time: 3.543s | Train Loss: 0.102622 |
2020-05-30 15:48:12,373 - root - INFO - | Epoch: 150/150 | Train Time: 3.810s | Train Loss: 0.102751 |
2020-05-30 15:48:12,373 - root - INFO - Training Time: 492.863s
2020-05-30 15:48:12,374 - root - INFO - Finished training.
2020-05-30 15:48:12,375 - root - INFO - Starting testing...
2020-05-30 15:48:16,876 - root - INFO - Test Loss: 0.434733
2020-05-30 15:48:16,877 - root - INFO - Test AUC: 91.83%
2020-05-30 15:48:16,877 - root - INFO - Test Time: 4.487s
2020-05-30 15:48:16,877 - root - INFO - Finished testing.
