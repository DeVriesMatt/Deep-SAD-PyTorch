2020-05-30 23:27:10,086 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_5_7_005.txt
2020-05-30 23:27:10,086 - root - INFO - Data path is ../data
2020-05-30 23:27:10,087 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-30 23:27:10,087 - root - INFO - Dataset: mnist
2020-05-30 23:27:10,087 - root - INFO - Normal class: 5
2020-05-30 23:27:10,087 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-30 23:27:10,087 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-30 23:27:10,087 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-30 23:27:10,087 - root - INFO - Scenario Running: 1
2020-05-30 23:27:10,087 - root - INFO - Train only the network: True
2020-05-30 23:27:10,087 - root - INFO - Output and AE dimensions: 128
2020-05-30 23:27:10,087 - root - INFO - Known anomaly class: 7
2020-05-30 23:27:10,087 - root - INFO - Network: mnist_LeNet
2020-05-30 23:27:10,087 - root - INFO - Eta-parameter: 1.00
2020-05-30 23:27:10,094 - root - INFO - Set seed to 0.
2020-05-30 23:27:10,157 - root - INFO - Computation device: cuda
2020-05-30 23:27:10,157 - root - INFO - Number of threads: 0
2020-05-30 23:27:10,157 - root - INFO - Number of dataloader workers: 6
2020-05-30 23:27:20,817 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-30 23:27:20,842 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-30 23:27:20,842 - root - INFO - Training optimizer: adam
2020-05-30 23:27:20,842 - root - INFO - Training learning rate: 0.0001
2020-05-30 23:27:20,842 - root - INFO - Training epochs: 150
2020-05-30 23:27:20,842 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-30 23:27:20,842 - root - INFO - Training batch size: 200
2020-05-30 23:27:20,843 - root - INFO - Training weight decay: 5e-07
2020-05-30 23:27:20,845 - root - INFO - Starting training...
2020-05-30 23:27:30,709 - root - INFO - | Epoch: 001/150 | Train Time: 9.853s | Train Loss: 0.339850 |
2020-05-30 23:27:33,616 - root - INFO - | Epoch: 002/150 | Train Time: 2.906s | Train Loss: 0.251344 |
2020-05-30 23:27:36,408 - root - INFO - | Epoch: 003/150 | Train Time: 2.792s | Train Loss: 0.217574 |
2020-05-30 23:27:40,040 - root - INFO - | Epoch: 004/150 | Train Time: 3.631s | Train Loss: 0.199223 |
2020-05-30 23:27:43,188 - root - INFO - | Epoch: 005/150 | Train Time: 3.148s | Train Loss: 0.185180 |
2020-05-30 23:27:46,177 - root - INFO - | Epoch: 006/150 | Train Time: 2.988s | Train Loss: 0.175488 |
2020-05-30 23:27:49,150 - root - INFO - | Epoch: 007/150 | Train Time: 2.972s | Train Loss: 0.168861 |
2020-05-30 23:27:52,279 - root - INFO - | Epoch: 008/150 | Train Time: 3.129s | Train Loss: 0.162064 |
2020-05-30 23:27:55,098 - root - INFO - | Epoch: 009/150 | Train Time: 2.819s | Train Loss: 0.156269 |
2020-05-30 23:27:58,253 - root - INFO - | Epoch: 010/150 | Train Time: 3.154s | Train Loss: 0.152512 |
2020-05-30 23:28:00,826 - root - INFO - | Epoch: 011/150 | Train Time: 2.573s | Train Loss: 0.147208 |
2020-05-30 23:28:03,393 - root - INFO - | Epoch: 012/150 | Train Time: 2.567s | Train Loss: 0.143685 |
2020-05-30 23:28:06,122 - root - INFO - | Epoch: 013/150 | Train Time: 2.728s | Train Loss: 0.140235 |
2020-05-30 23:28:09,118 - root - INFO - | Epoch: 014/150 | Train Time: 2.995s | Train Loss: 0.137342 |
2020-05-30 23:28:11,984 - root - INFO - | Epoch: 015/150 | Train Time: 2.866s | Train Loss: 0.135421 |
2020-05-30 23:28:14,859 - root - INFO - | Epoch: 016/150 | Train Time: 2.875s | Train Loss: 0.132988 |
2020-05-30 23:28:17,467 - root - INFO - | Epoch: 017/150 | Train Time: 2.607s | Train Loss: 0.129451 |
2020-05-30 23:28:19,790 - root - INFO - | Epoch: 018/150 | Train Time: 2.322s | Train Loss: 0.127916 |
2020-05-30 23:28:22,160 - root - INFO - | Epoch: 019/150 | Train Time: 2.370s | Train Loss: 0.124964 |
2020-05-30 23:28:25,051 - root - INFO - | Epoch: 020/150 | Train Time: 2.891s | Train Loss: 0.123237 |
2020-05-30 23:28:28,053 - root - INFO - | Epoch: 021/150 | Train Time: 3.001s | Train Loss: 0.122761 |
2020-05-30 23:28:31,163 - root - INFO - | Epoch: 022/150 | Train Time: 3.109s | Train Loss: 0.120534 |
2020-05-30 23:28:34,451 - root - INFO - | Epoch: 023/150 | Train Time: 3.287s | Train Loss: 0.118835 |
2020-05-30 23:28:37,889 - root - INFO - | Epoch: 024/150 | Train Time: 3.437s | Train Loss: 0.117504 |
2020-05-30 23:28:41,380 - root - INFO - | Epoch: 025/150 | Train Time: 3.490s | Train Loss: 0.116289 |
2020-05-30 23:28:44,561 - root - INFO - | Epoch: 026/150 | Train Time: 3.180s | Train Loss: 0.116189 |
2020-05-30 23:28:47,830 - root - INFO - | Epoch: 027/150 | Train Time: 3.269s | Train Loss: 0.114549 |
2020-05-30 23:28:50,928 - root - INFO - | Epoch: 028/150 | Train Time: 3.097s | Train Loss: 0.113955 |
2020-05-30 23:28:54,308 - root - INFO - | Epoch: 029/150 | Train Time: 3.379s | Train Loss: 0.111500 |
2020-05-30 23:28:57,614 - root - INFO - | Epoch: 030/150 | Train Time: 3.306s | Train Loss: 0.111682 |
2020-05-30 23:29:00,876 - root - INFO - | Epoch: 031/150 | Train Time: 3.261s | Train Loss: 0.109766 |
2020-05-30 23:29:03,836 - root - INFO - | Epoch: 032/150 | Train Time: 2.960s | Train Loss: 0.109279 |
2020-05-30 23:29:07,051 - root - INFO - | Epoch: 033/150 | Train Time: 3.214s | Train Loss: 0.108263 |
2020-05-30 23:29:09,809 - root - INFO - | Epoch: 034/150 | Train Time: 2.757s | Train Loss: 0.106585 |
2020-05-30 23:29:13,231 - root - INFO - | Epoch: 035/150 | Train Time: 3.422s | Train Loss: 0.105939 |
2020-05-30 23:29:16,158 - root - INFO - | Epoch: 036/150 | Train Time: 2.927s | Train Loss: 0.106376 |
2020-05-30 23:29:19,363 - root - INFO - | Epoch: 037/150 | Train Time: 3.205s | Train Loss: 0.104961 |
2020-05-30 23:29:22,575 - root - INFO - | Epoch: 038/150 | Train Time: 3.211s | Train Loss: 0.103848 |
2020-05-30 23:29:25,362 - root - INFO - | Epoch: 039/150 | Train Time: 2.787s | Train Loss: 0.103572 |
2020-05-30 23:29:28,584 - root - INFO - | Epoch: 040/150 | Train Time: 3.221s | Train Loss: 0.103251 |
2020-05-30 23:29:31,805 - root - INFO - | Epoch: 041/150 | Train Time: 3.221s | Train Loss: 0.101378 |
2020-05-30 23:29:34,753 - root - INFO - | Epoch: 042/150 | Train Time: 2.947s | Train Loss: 0.101340 |
2020-05-30 23:29:37,530 - root - INFO - | Epoch: 043/150 | Train Time: 2.777s | Train Loss: 0.101216 |
2020-05-30 23:29:40,040 - root - INFO - | Epoch: 044/150 | Train Time: 2.509s | Train Loss: 0.101224 |
2020-05-30 23:29:42,348 - root - INFO - | Epoch: 045/150 | Train Time: 2.307s | Train Loss: 0.098447 |
2020-05-30 23:29:44,734 - root - INFO - | Epoch: 046/150 | Train Time: 2.386s | Train Loss: 0.099892 |
2020-05-30 23:29:47,381 - root - INFO - | Epoch: 047/150 | Train Time: 2.646s | Train Loss: 0.099142 |
2020-05-30 23:29:50,140 - root - INFO - | Epoch: 048/150 | Train Time: 2.758s | Train Loss: 0.098103 |
2020-05-30 23:29:52,444 - root - INFO - | Epoch: 049/150 | Train Time: 2.304s | Train Loss: 0.096539 |
2020-05-30 23:29:55,437 - root - INFO - | Epoch: 050/150 | Train Time: 2.993s | Train Loss: 0.096782 |
2020-05-30 23:29:55,438 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-30 23:29:57,666 - root - INFO - | Epoch: 051/150 | Train Time: 2.228s | Train Loss: 0.096487 |
2020-05-30 23:29:59,766 - root - INFO - | Epoch: 052/150 | Train Time: 2.099s | Train Loss: 0.095199 |
2020-05-30 23:30:01,671 - root - INFO - | Epoch: 053/150 | Train Time: 1.904s | Train Loss: 0.096491 |
2020-05-30 23:30:04,022 - root - INFO - | Epoch: 054/150 | Train Time: 2.350s | Train Loss: 0.096988 |
2020-05-30 23:30:06,333 - root - INFO - | Epoch: 055/150 | Train Time: 2.310s | Train Loss: 0.096975 |
2020-05-30 23:30:09,121 - root - INFO - | Epoch: 056/150 | Train Time: 2.788s | Train Loss: 0.096777 |
2020-05-30 23:30:12,158 - root - INFO - | Epoch: 057/150 | Train Time: 3.036s | Train Loss: 0.096454 |
2020-05-30 23:30:15,081 - root - INFO - | Epoch: 058/150 | Train Time: 2.923s | Train Loss: 0.096212 |
2020-05-30 23:30:18,092 - root - INFO - | Epoch: 059/150 | Train Time: 3.010s | Train Loss: 0.096080 |
2020-05-30 23:30:20,932 - root - INFO - | Epoch: 060/150 | Train Time: 2.840s | Train Loss: 0.096589 |
2020-05-30 23:30:24,330 - root - INFO - | Epoch: 061/150 | Train Time: 3.397s | Train Loss: 0.095919 |
2020-05-30 23:30:27,032 - root - INFO - | Epoch: 062/150 | Train Time: 2.701s | Train Loss: 0.094781 |
2020-05-30 23:30:29,646 - root - INFO - | Epoch: 063/150 | Train Time: 2.614s | Train Loss: 0.096010 |
2020-05-30 23:30:32,635 - root - INFO - | Epoch: 064/150 | Train Time: 2.989s | Train Loss: 0.096203 |
2020-05-30 23:30:35,123 - root - INFO - | Epoch: 065/150 | Train Time: 2.488s | Train Loss: 0.095818 |
2020-05-30 23:30:37,797 - root - INFO - | Epoch: 066/150 | Train Time: 2.673s | Train Loss: 0.096395 |
2020-05-30 23:30:40,445 - root - INFO - | Epoch: 067/150 | Train Time: 2.648s | Train Loss: 0.095596 |
2020-05-30 23:30:43,338 - root - INFO - | Epoch: 068/150 | Train Time: 2.892s | Train Loss: 0.095276 |
2020-05-30 23:30:45,969 - root - INFO - | Epoch: 069/150 | Train Time: 2.630s | Train Loss: 0.094966 |
2020-05-30 23:30:48,927 - root - INFO - | Epoch: 070/150 | Train Time: 2.958s | Train Loss: 0.095420 |
2020-05-30 23:30:51,850 - root - INFO - | Epoch: 071/150 | Train Time: 2.922s | Train Loss: 0.095774 |
2020-05-30 23:30:54,477 - root - INFO - | Epoch: 072/150 | Train Time: 2.627s | Train Loss: 0.095404 |
2020-05-30 23:30:57,531 - root - INFO - | Epoch: 073/150 | Train Time: 3.053s | Train Loss: 0.095852 |
2020-05-30 23:31:00,319 - root - INFO - | Epoch: 074/150 | Train Time: 2.788s | Train Loss: 0.095775 |
2020-05-30 23:31:03,042 - root - INFO - | Epoch: 075/150 | Train Time: 2.722s | Train Loss: 0.095988 |
2020-05-30 23:31:06,510 - root - INFO - | Epoch: 076/150 | Train Time: 3.467s | Train Loss: 0.094113 |
2020-05-30 23:31:09,894 - root - INFO - | Epoch: 077/150 | Train Time: 3.384s | Train Loss: 0.095217 |
2020-05-30 23:31:13,209 - root - INFO - | Epoch: 078/150 | Train Time: 3.314s | Train Loss: 0.095207 |
2020-05-30 23:31:16,171 - root - INFO - | Epoch: 079/150 | Train Time: 2.961s | Train Loss: 0.095284 |
2020-05-30 23:31:19,435 - root - INFO - | Epoch: 080/150 | Train Time: 3.264s | Train Loss: 0.095045 |
2020-05-30 23:31:22,388 - root - INFO - | Epoch: 081/150 | Train Time: 2.953s | Train Loss: 0.095312 |
2020-05-30 23:31:25,482 - root - INFO - | Epoch: 082/150 | Train Time: 3.093s | Train Loss: 0.095130 |
2020-05-30 23:31:28,430 - root - INFO - | Epoch: 083/150 | Train Time: 2.948s | Train Loss: 0.093570 |
2020-05-30 23:31:31,440 - root - INFO - | Epoch: 084/150 | Train Time: 3.009s | Train Loss: 0.094844 |
2020-05-30 23:31:34,837 - root - INFO - | Epoch: 085/150 | Train Time: 3.397s | Train Loss: 0.094124 |
2020-05-30 23:31:37,759 - root - INFO - | Epoch: 086/150 | Train Time: 2.921s | Train Loss: 0.094824 |
2020-05-30 23:31:40,389 - root - INFO - | Epoch: 087/150 | Train Time: 2.630s | Train Loss: 0.094525 |
2020-05-30 23:31:43,235 - root - INFO - | Epoch: 088/150 | Train Time: 2.846s | Train Loss: 0.095115 |
2020-05-30 23:31:46,611 - root - INFO - | Epoch: 089/150 | Train Time: 3.375s | Train Loss: 0.094223 |
2020-05-30 23:31:49,425 - root - INFO - | Epoch: 090/150 | Train Time: 2.814s | Train Loss: 0.093641 |
2020-05-30 23:31:51,854 - root - INFO - | Epoch: 091/150 | Train Time: 2.428s | Train Loss: 0.094881 |
2020-05-30 23:31:54,183 - root - INFO - | Epoch: 092/150 | Train Time: 2.327s | Train Loss: 0.094616 |
2020-05-30 23:31:56,695 - root - INFO - | Epoch: 093/150 | Train Time: 2.512s | Train Loss: 0.094847 |
2020-05-30 23:32:00,027 - root - INFO - | Epoch: 094/150 | Train Time: 3.331s | Train Loss: 0.094731 |
2020-05-30 23:32:03,222 - root - INFO - | Epoch: 095/150 | Train Time: 3.195s | Train Loss: 0.094678 |
2020-05-30 23:32:06,671 - root - INFO - | Epoch: 096/150 | Train Time: 3.448s | Train Loss: 0.093644 |
2020-05-30 23:32:10,030 - root - INFO - | Epoch: 097/150 | Train Time: 3.359s | Train Loss: 0.094335 |
2020-05-30 23:32:13,024 - root - INFO - | Epoch: 098/150 | Train Time: 2.993s | Train Loss: 0.093761 |
2020-05-30 23:32:16,246 - root - INFO - | Epoch: 099/150 | Train Time: 3.221s | Train Loss: 0.093536 |
2020-05-30 23:32:19,190 - root - INFO - | Epoch: 100/150 | Train Time: 2.944s | Train Loss: 0.094220 |
2020-05-30 23:32:21,887 - root - INFO - | Epoch: 101/150 | Train Time: 2.696s | Train Loss: 0.094298 |
2020-05-30 23:32:24,861 - root - INFO - | Epoch: 102/150 | Train Time: 2.973s | Train Loss: 0.094547 |
2020-05-30 23:32:27,458 - root - INFO - | Epoch: 103/150 | Train Time: 2.597s | Train Loss: 0.094661 |
2020-05-30 23:32:30,117 - root - INFO - | Epoch: 104/150 | Train Time: 2.659s | Train Loss: 0.094136 |
2020-05-30 23:32:33,685 - root - INFO - | Epoch: 105/150 | Train Time: 3.568s | Train Loss: 0.092774 |
2020-05-30 23:32:36,990 - root - INFO - | Epoch: 106/150 | Train Time: 3.304s | Train Loss: 0.094093 |
2020-05-30 23:32:40,394 - root - INFO - | Epoch: 107/150 | Train Time: 3.404s | Train Loss: 0.093760 |
2020-05-30 23:32:43,316 - root - INFO - | Epoch: 108/150 | Train Time: 2.922s | Train Loss: 0.093314 |
2020-05-30 23:32:46,365 - root - INFO - | Epoch: 109/150 | Train Time: 3.049s | Train Loss: 0.093123 |
2020-05-30 23:32:48,851 - root - INFO - | Epoch: 110/150 | Train Time: 2.486s | Train Loss: 0.094356 |
2020-05-30 23:32:52,013 - root - INFO - | Epoch: 111/150 | Train Time: 3.161s | Train Loss: 0.093531 |
2020-05-30 23:32:54,820 - root - INFO - | Epoch: 112/150 | Train Time: 2.806s | Train Loss: 0.093039 |
2020-05-30 23:32:57,983 - root - INFO - | Epoch: 113/150 | Train Time: 3.163s | Train Loss: 0.093470 |
2020-05-30 23:33:00,614 - root - INFO - | Epoch: 114/150 | Train Time: 2.630s | Train Loss: 0.093184 |
2020-05-30 23:33:03,473 - root - INFO - | Epoch: 115/150 | Train Time: 2.859s | Train Loss: 0.093704 |
2020-05-30 23:33:05,890 - root - INFO - | Epoch: 116/150 | Train Time: 2.416s | Train Loss: 0.093114 |
2020-05-30 23:33:07,866 - root - INFO - | Epoch: 117/150 | Train Time: 1.975s | Train Loss: 0.093342 |
2020-05-30 23:33:10,419 - root - INFO - | Epoch: 118/150 | Train Time: 2.553s | Train Loss: 0.093561 |
2020-05-30 23:33:12,863 - root - INFO - | Epoch: 119/150 | Train Time: 2.443s | Train Loss: 0.093130 |
2020-05-30 23:33:15,673 - root - INFO - | Epoch: 120/150 | Train Time: 2.809s | Train Loss: 0.092992 |
2020-05-30 23:33:18,340 - root - INFO - | Epoch: 121/150 | Train Time: 2.666s | Train Loss: 0.092936 |
2020-05-30 23:33:20,814 - root - INFO - | Epoch: 122/150 | Train Time: 2.473s | Train Loss: 0.092120 |
2020-05-30 23:33:23,651 - root - INFO - | Epoch: 123/150 | Train Time: 2.837s | Train Loss: 0.092381 |
2020-05-30 23:33:26,717 - root - INFO - | Epoch: 124/150 | Train Time: 3.065s | Train Loss: 0.092820 |
2020-05-30 23:33:29,116 - root - INFO - | Epoch: 125/150 | Train Time: 2.398s | Train Loss: 0.091835 |
2020-05-30 23:33:31,646 - root - INFO - | Epoch: 126/150 | Train Time: 2.530s | Train Loss: 0.092772 |
2020-05-30 23:33:34,424 - root - INFO - | Epoch: 127/150 | Train Time: 2.778s | Train Loss: 0.093442 |
2020-05-30 23:33:37,181 - root - INFO - | Epoch: 128/150 | Train Time: 2.756s | Train Loss: 0.092729 |
2020-05-30 23:33:39,759 - root - INFO - | Epoch: 129/150 | Train Time: 2.578s | Train Loss: 0.092243 |
2020-05-30 23:33:42,362 - root - INFO - | Epoch: 130/150 | Train Time: 2.603s | Train Loss: 0.092262 |
2020-05-30 23:33:45,236 - root - INFO - | Epoch: 131/150 | Train Time: 2.873s | Train Loss: 0.093287 |
2020-05-30 23:33:47,897 - root - INFO - | Epoch: 132/150 | Train Time: 2.661s | Train Loss: 0.092634 |
2020-05-30 23:33:50,850 - root - INFO - | Epoch: 133/150 | Train Time: 2.952s | Train Loss: 0.092623 |
2020-05-30 23:33:54,014 - root - INFO - | Epoch: 134/150 | Train Time: 3.164s | Train Loss: 0.091785 |
2020-05-30 23:33:56,759 - root - INFO - | Epoch: 135/150 | Train Time: 2.745s | Train Loss: 0.092097 |
2020-05-30 23:33:59,602 - root - INFO - | Epoch: 136/150 | Train Time: 2.842s | Train Loss: 0.090004 |
2020-05-30 23:34:01,729 - root - INFO - | Epoch: 137/150 | Train Time: 2.127s | Train Loss: 0.092015 |
2020-05-30 23:34:04,944 - root - INFO - | Epoch: 138/150 | Train Time: 3.215s | Train Loss: 0.090719 |
2020-05-30 23:34:07,383 - root - INFO - | Epoch: 139/150 | Train Time: 2.438s | Train Loss: 0.092123 |
2020-05-30 23:34:09,798 - root - INFO - | Epoch: 140/150 | Train Time: 2.414s | Train Loss: 0.092213 |
2020-05-30 23:34:12,443 - root - INFO - | Epoch: 141/150 | Train Time: 2.644s | Train Loss: 0.091429 |
2020-05-30 23:34:15,558 - root - INFO - | Epoch: 142/150 | Train Time: 3.114s | Train Loss: 0.090934 |
2020-05-30 23:34:18,755 - root - INFO - | Epoch: 143/150 | Train Time: 3.197s | Train Loss: 0.092113 |
2020-05-30 23:34:21,795 - root - INFO - | Epoch: 144/150 | Train Time: 3.040s | Train Loss: 0.092380 |
2020-05-30 23:34:24,803 - root - INFO - | Epoch: 145/150 | Train Time: 3.007s | Train Loss: 0.091526 |
2020-05-30 23:34:28,121 - root - INFO - | Epoch: 146/150 | Train Time: 3.318s | Train Loss: 0.091542 |
2020-05-30 23:34:31,384 - root - INFO - | Epoch: 147/150 | Train Time: 3.262s | Train Loss: 0.090386 |
2020-05-30 23:34:34,415 - root - INFO - | Epoch: 148/150 | Train Time: 3.030s | Train Loss: 0.091749 |
2020-05-30 23:34:37,824 - root - INFO - | Epoch: 149/150 | Train Time: 3.408s | Train Loss: 0.090835 |
2020-05-30 23:34:40,969 - root - INFO - | Epoch: 150/150 | Train Time: 3.145s | Train Loss: 0.091116 |
2020-05-30 23:34:40,970 - root - INFO - Training Time: 440.125s
2020-05-30 23:34:40,970 - root - INFO - Finished training.
2020-05-30 23:34:40,971 - root - INFO - Starting testing...
2020-05-30 23:34:44,104 - root - INFO - Test Loss: 0.282754
2020-05-30 23:34:44,105 - root - INFO - Test AUC: 91.28%
2020-05-30 23:34:44,105 - root - INFO - Test Time: 3.121s
2020-05-30 23:34:44,105 - root - INFO - Finished testing.
