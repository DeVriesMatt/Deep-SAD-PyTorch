2020-05-31 03:33:46,561 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_6_7_001.txt
2020-05-31 03:33:46,562 - root - INFO - Data path is ../data
2020-05-31 03:33:46,562 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 03:33:46,562 - root - INFO - Dataset: mnist
2020-05-31 03:33:46,562 - root - INFO - Normal class: 6
2020-05-31 03:33:46,562 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 03:33:46,562 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-31 03:33:46,562 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 03:33:46,562 - root - INFO - Scenario Running: 1
2020-05-31 03:33:46,562 - root - INFO - Train only the network: True
2020-05-31 03:33:46,562 - root - INFO - Output and AE dimensions: 128
2020-05-31 03:33:46,562 - root - INFO - Known anomaly class: 7
2020-05-31 03:33:46,562 - root - INFO - Network: mnist_LeNet
2020-05-31 03:33:46,563 - root - INFO - Eta-parameter: 1.00
2020-05-31 03:33:46,579 - root - INFO - Set seed to 0.
2020-05-31 03:33:46,614 - root - INFO - Computation device: cuda
2020-05-31 03:33:46,614 - root - INFO - Number of threads: 0
2020-05-31 03:33:46,614 - root - INFO - Number of dataloader workers: 6
2020-05-31 03:33:52,321 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 03:33:52,322 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 03:33:52,322 - root - INFO - Training optimizer: adam
2020-05-31 03:33:52,322 - root - INFO - Training learning rate: 0.0001
2020-05-31 03:33:52,323 - root - INFO - Training epochs: 150
2020-05-31 03:33:52,323 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 03:33:52,323 - root - INFO - Training batch size: 200
2020-05-31 03:33:52,323 - root - INFO - Training weight decay: 5e-07
2020-05-31 03:33:52,325 - root - INFO - Starting training...
2020-05-31 03:33:56,975 - root - INFO - | Epoch: 001/150 | Train Time: 4.647s | Train Loss: 0.167550 |
2020-05-31 03:33:59,478 - root - INFO - | Epoch: 002/150 | Train Time: 2.502s | Train Loss: 0.123021 |
2020-05-31 03:34:01,887 - root - INFO - | Epoch: 003/150 | Train Time: 2.409s | Train Loss: 0.103740 |
2020-05-31 03:34:04,402 - root - INFO - | Epoch: 004/150 | Train Time: 2.515s | Train Loss: 0.091581 |
2020-05-31 03:34:06,665 - root - INFO - | Epoch: 005/150 | Train Time: 2.262s | Train Loss: 0.085156 |
2020-05-31 03:34:08,886 - root - INFO - | Epoch: 006/150 | Train Time: 2.221s | Train Loss: 0.078003 |
2020-05-31 03:34:11,283 - root - INFO - | Epoch: 007/150 | Train Time: 2.396s | Train Loss: 0.074640 |
2020-05-31 03:34:13,637 - root - INFO - | Epoch: 008/150 | Train Time: 2.354s | Train Loss: 0.070898 |
2020-05-31 03:34:15,974 - root - INFO - | Epoch: 009/150 | Train Time: 2.336s | Train Loss: 0.068458 |
2020-05-31 03:34:18,509 - root - INFO - | Epoch: 010/150 | Train Time: 2.534s | Train Loss: 0.064922 |
2020-05-31 03:34:20,992 - root - INFO - | Epoch: 011/150 | Train Time: 2.482s | Train Loss: 0.063350 |
2020-05-31 03:34:23,230 - root - INFO - | Epoch: 012/150 | Train Time: 2.238s | Train Loss: 0.061651 |
2020-05-31 03:34:25,907 - root - INFO - | Epoch: 013/150 | Train Time: 2.676s | Train Loss: 0.059480 |
2020-05-31 03:34:28,400 - root - INFO - | Epoch: 014/150 | Train Time: 2.493s | Train Loss: 0.058198 |
2020-05-31 03:34:30,762 - root - INFO - | Epoch: 015/150 | Train Time: 2.362s | Train Loss: 0.056999 |
2020-05-31 03:34:32,757 - root - INFO - | Epoch: 016/150 | Train Time: 1.994s | Train Loss: 0.055965 |
2020-05-31 03:34:34,938 - root - INFO - | Epoch: 017/150 | Train Time: 2.181s | Train Loss: 0.054220 |
2020-05-31 03:34:37,404 - root - INFO - | Epoch: 018/150 | Train Time: 2.466s | Train Loss: 0.053038 |
2020-05-31 03:34:40,144 - root - INFO - | Epoch: 019/150 | Train Time: 2.740s | Train Loss: 0.052645 |
2020-05-31 03:34:42,709 - root - INFO - | Epoch: 020/150 | Train Time: 2.564s | Train Loss: 0.051741 |
2020-05-31 03:34:44,995 - root - INFO - | Epoch: 021/150 | Train Time: 2.285s | Train Loss: 0.051038 |
2020-05-31 03:34:47,406 - root - INFO - | Epoch: 022/150 | Train Time: 2.411s | Train Loss: 0.050256 |
2020-05-31 03:34:49,579 - root - INFO - | Epoch: 023/150 | Train Time: 2.172s | Train Loss: 0.049159 |
2020-05-31 03:34:51,614 - root - INFO - | Epoch: 024/150 | Train Time: 2.034s | Train Loss: 0.048630 |
2020-05-31 03:34:53,640 - root - INFO - | Epoch: 025/150 | Train Time: 2.026s | Train Loss: 0.048233 |
2020-05-31 03:34:55,775 - root - INFO - | Epoch: 026/150 | Train Time: 2.135s | Train Loss: 0.047910 |
2020-05-31 03:34:57,849 - root - INFO - | Epoch: 027/150 | Train Time: 2.072s | Train Loss: 0.047125 |
2020-05-31 03:35:00,630 - root - INFO - | Epoch: 028/150 | Train Time: 2.781s | Train Loss: 0.046969 |
2020-05-31 03:35:03,394 - root - INFO - | Epoch: 029/150 | Train Time: 2.764s | Train Loss: 0.046108 |
2020-05-31 03:35:06,223 - root - INFO - | Epoch: 030/150 | Train Time: 2.828s | Train Loss: 0.045927 |
2020-05-31 03:35:08,864 - root - INFO - | Epoch: 031/150 | Train Time: 2.640s | Train Loss: 0.045289 |
2020-05-31 03:35:11,141 - root - INFO - | Epoch: 032/150 | Train Time: 2.277s | Train Loss: 0.045253 |
2020-05-31 03:35:13,234 - root - INFO - | Epoch: 033/150 | Train Time: 2.092s | Train Loss: 0.044537 |
2020-05-31 03:35:15,436 - root - INFO - | Epoch: 034/150 | Train Time: 2.202s | Train Loss: 0.044125 |
2020-05-31 03:35:17,143 - root - INFO - | Epoch: 035/150 | Train Time: 1.706s | Train Loss: 0.043905 |
2020-05-31 03:35:19,136 - root - INFO - | Epoch: 036/150 | Train Time: 1.992s | Train Loss: 0.043309 |
2020-05-31 03:35:21,528 - root - INFO - | Epoch: 037/150 | Train Time: 2.391s | Train Loss: 0.042978 |
2020-05-31 03:35:24,026 - root - INFO - | Epoch: 038/150 | Train Time: 2.497s | Train Loss: 0.042268 |
2020-05-31 03:35:26,717 - root - INFO - | Epoch: 039/150 | Train Time: 2.691s | Train Loss: 0.042453 |
2020-05-31 03:35:29,785 - root - INFO - | Epoch: 040/150 | Train Time: 3.068s | Train Loss: 0.042198 |
2020-05-31 03:35:32,385 - root - INFO - | Epoch: 041/150 | Train Time: 2.599s | Train Loss: 0.041693 |
2020-05-31 03:35:34,301 - root - INFO - | Epoch: 042/150 | Train Time: 1.916s | Train Loss: 0.041137 |
2020-05-31 03:35:36,351 - root - INFO - | Epoch: 043/150 | Train Time: 2.048s | Train Loss: 0.041106 |
2020-05-31 03:35:38,691 - root - INFO - | Epoch: 044/150 | Train Time: 2.340s | Train Loss: 0.041097 |
2020-05-31 03:35:40,719 - root - INFO - | Epoch: 045/150 | Train Time: 2.027s | Train Loss: 0.040978 |
2020-05-31 03:35:42,614 - root - INFO - | Epoch: 046/150 | Train Time: 1.894s | Train Loss: 0.040542 |
2020-05-31 03:35:44,843 - root - INFO - | Epoch: 047/150 | Train Time: 2.229s | Train Loss: 0.040557 |
2020-05-31 03:35:47,085 - root - INFO - | Epoch: 048/150 | Train Time: 2.241s | Train Loss: 0.040969 |
2020-05-31 03:35:49,476 - root - INFO - | Epoch: 049/150 | Train Time: 2.391s | Train Loss: 0.039799 |
2020-05-31 03:35:52,083 - root - INFO - | Epoch: 050/150 | Train Time: 2.607s | Train Loss: 0.039497 |
2020-05-31 03:35:52,084 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 03:35:54,299 - root - INFO - | Epoch: 051/150 | Train Time: 2.215s | Train Loss: 0.039280 |
2020-05-31 03:35:56,411 - root - INFO - | Epoch: 052/150 | Train Time: 2.111s | Train Loss: 0.038937 |
2020-05-31 03:35:59,065 - root - INFO - | Epoch: 053/150 | Train Time: 2.653s | Train Loss: 0.039032 |
2020-05-31 03:36:01,694 - root - INFO - | Epoch: 054/150 | Train Time: 2.624s | Train Loss: 0.039017 |
2020-05-31 03:36:04,427 - root - INFO - | Epoch: 055/150 | Train Time: 2.733s | Train Loss: 0.039103 |
2020-05-31 03:36:07,048 - root - INFO - | Epoch: 056/150 | Train Time: 2.620s | Train Loss: 0.039213 |
2020-05-31 03:36:10,070 - root - INFO - | Epoch: 057/150 | Train Time: 3.021s | Train Loss: 0.039319 |
2020-05-31 03:36:12,764 - root - INFO - | Epoch: 058/150 | Train Time: 2.694s | Train Loss: 0.038827 |
2020-05-31 03:36:15,070 - root - INFO - | Epoch: 059/150 | Train Time: 2.306s | Train Loss: 0.039151 |
2020-05-31 03:36:17,512 - root - INFO - | Epoch: 060/150 | Train Time: 2.441s | Train Loss: 0.039106 |
2020-05-31 03:36:19,965 - root - INFO - | Epoch: 061/150 | Train Time: 2.452s | Train Loss: 0.038961 |
2020-05-31 03:36:22,218 - root - INFO - | Epoch: 062/150 | Train Time: 2.253s | Train Loss: 0.038435 |
2020-05-31 03:36:24,830 - root - INFO - | Epoch: 063/150 | Train Time: 2.611s | Train Loss: 0.038914 |
2020-05-31 03:36:27,398 - root - INFO - | Epoch: 064/150 | Train Time: 2.567s | Train Loss: 0.039073 |
2020-05-31 03:36:29,608 - root - INFO - | Epoch: 065/150 | Train Time: 2.210s | Train Loss: 0.039039 |
2020-05-31 03:36:32,109 - root - INFO - | Epoch: 066/150 | Train Time: 2.500s | Train Loss: 0.038822 |
2020-05-31 03:36:34,580 - root - INFO - | Epoch: 067/150 | Train Time: 2.470s | Train Loss: 0.038832 |
2020-05-31 03:36:37,179 - root - INFO - | Epoch: 068/150 | Train Time: 2.599s | Train Loss: 0.039113 |
2020-05-31 03:36:39,386 - root - INFO - | Epoch: 069/150 | Train Time: 2.207s | Train Loss: 0.039073 |
2020-05-31 03:36:42,084 - root - INFO - | Epoch: 070/150 | Train Time: 2.697s | Train Loss: 0.038936 |
2020-05-31 03:36:44,301 - root - INFO - | Epoch: 071/150 | Train Time: 2.216s | Train Loss: 0.038850 |
2020-05-31 03:36:46,442 - root - INFO - | Epoch: 072/150 | Train Time: 2.140s | Train Loss: 0.038994 |
2020-05-31 03:36:49,054 - root - INFO - | Epoch: 073/150 | Train Time: 2.611s | Train Loss: 0.038834 |
2020-05-31 03:36:51,776 - root - INFO - | Epoch: 074/150 | Train Time: 2.722s | Train Loss: 0.038944 |
2020-05-31 03:36:54,197 - root - INFO - | Epoch: 075/150 | Train Time: 2.421s | Train Loss: 0.038713 |
2020-05-31 03:36:56,972 - root - INFO - | Epoch: 076/150 | Train Time: 2.774s | Train Loss: 0.038897 |
2020-05-31 03:36:59,657 - root - INFO - | Epoch: 077/150 | Train Time: 2.684s | Train Loss: 0.038664 |
2020-05-31 03:37:02,315 - root - INFO - | Epoch: 078/150 | Train Time: 2.658s | Train Loss: 0.038885 |
2020-05-31 03:37:05,125 - root - INFO - | Epoch: 079/150 | Train Time: 2.809s | Train Loss: 0.038393 |
2020-05-31 03:37:07,485 - root - INFO - | Epoch: 080/150 | Train Time: 2.359s | Train Loss: 0.038327 |
2020-05-31 03:37:10,020 - root - INFO - | Epoch: 081/150 | Train Time: 2.534s | Train Loss: 0.038813 |
2020-05-31 03:37:12,127 - root - INFO - | Epoch: 082/150 | Train Time: 2.106s | Train Loss: 0.038763 |
2020-05-31 03:37:14,363 - root - INFO - | Epoch: 083/150 | Train Time: 2.235s | Train Loss: 0.038340 |
2020-05-31 03:37:16,108 - root - INFO - | Epoch: 084/150 | Train Time: 1.744s | Train Loss: 0.038572 |
2020-05-31 03:37:18,687 - root - INFO - | Epoch: 085/150 | Train Time: 2.578s | Train Loss: 0.038753 |
2020-05-31 03:37:20,597 - root - INFO - | Epoch: 086/150 | Train Time: 1.910s | Train Loss: 0.038621 |
2020-05-31 03:37:23,173 - root - INFO - | Epoch: 087/150 | Train Time: 2.576s | Train Loss: 0.038689 |
2020-05-31 03:37:25,652 - root - INFO - | Epoch: 088/150 | Train Time: 2.478s | Train Loss: 0.038475 |
2020-05-31 03:37:28,761 - root - INFO - | Epoch: 089/150 | Train Time: 3.108s | Train Loss: 0.038429 |
2020-05-31 03:37:31,015 - root - INFO - | Epoch: 090/150 | Train Time: 2.254s | Train Loss: 0.038447 |
2020-05-31 03:37:33,477 - root - INFO - | Epoch: 091/150 | Train Time: 2.462s | Train Loss: 0.038693 |
2020-05-31 03:37:35,975 - root - INFO - | Epoch: 092/150 | Train Time: 2.497s | Train Loss: 0.038267 |
2020-05-31 03:37:38,567 - root - INFO - | Epoch: 093/150 | Train Time: 2.592s | Train Loss: 0.038066 |
2020-05-31 03:37:41,268 - root - INFO - | Epoch: 094/150 | Train Time: 2.700s | Train Loss: 0.038344 |
2020-05-31 03:37:43,727 - root - INFO - | Epoch: 095/150 | Train Time: 2.458s | Train Loss: 0.038286 |
2020-05-31 03:37:46,206 - root - INFO - | Epoch: 096/150 | Train Time: 2.478s | Train Loss: 0.038295 |
2020-05-31 03:37:48,587 - root - INFO - | Epoch: 097/150 | Train Time: 2.381s | Train Loss: 0.038050 |
2020-05-31 03:37:50,692 - root - INFO - | Epoch: 098/150 | Train Time: 2.104s | Train Loss: 0.037667 |
2020-05-31 03:37:52,936 - root - INFO - | Epoch: 099/150 | Train Time: 2.244s | Train Loss: 0.038079 |
2020-05-31 03:37:54,887 - root - INFO - | Epoch: 100/150 | Train Time: 1.950s | Train Loss: 0.038290 |
2020-05-31 03:37:57,039 - root - INFO - | Epoch: 101/150 | Train Time: 2.152s | Train Loss: 0.037914 |
2020-05-31 03:37:59,030 - root - INFO - | Epoch: 102/150 | Train Time: 1.991s | Train Loss: 0.038346 |
2020-05-31 03:38:01,531 - root - INFO - | Epoch: 103/150 | Train Time: 2.500s | Train Loss: 0.037954 |
2020-05-31 03:38:03,956 - root - INFO - | Epoch: 104/150 | Train Time: 2.424s | Train Loss: 0.038273 |
2020-05-31 03:38:05,609 - root - INFO - | Epoch: 105/150 | Train Time: 1.653s | Train Loss: 0.037939 |
2020-05-31 03:38:07,712 - root - INFO - | Epoch: 106/150 | Train Time: 2.102s | Train Loss: 0.038182 |
2020-05-31 03:38:09,945 - root - INFO - | Epoch: 107/150 | Train Time: 2.232s | Train Loss: 0.038310 |
2020-05-31 03:38:11,825 - root - INFO - | Epoch: 108/150 | Train Time: 1.880s | Train Loss: 0.038202 |
2020-05-31 03:38:14,437 - root - INFO - | Epoch: 109/150 | Train Time: 2.611s | Train Loss: 0.037857 |
2020-05-31 03:38:16,755 - root - INFO - | Epoch: 110/150 | Train Time: 2.318s | Train Loss: 0.037851 |
2020-05-31 03:38:19,365 - root - INFO - | Epoch: 111/150 | Train Time: 2.610s | Train Loss: 0.038172 |
2020-05-31 03:38:22,099 - root - INFO - | Epoch: 112/150 | Train Time: 2.734s | Train Loss: 0.037977 |
2020-05-31 03:38:24,623 - root - INFO - | Epoch: 113/150 | Train Time: 2.523s | Train Loss: 0.038019 |
2020-05-31 03:38:26,397 - root - INFO - | Epoch: 114/150 | Train Time: 1.774s | Train Loss: 0.038031 |
2020-05-31 03:38:28,833 - root - INFO - | Epoch: 115/150 | Train Time: 2.436s | Train Loss: 0.037703 |
2020-05-31 03:38:31,104 - root - INFO - | Epoch: 116/150 | Train Time: 2.270s | Train Loss: 0.038070 |
2020-05-31 03:38:33,046 - root - INFO - | Epoch: 117/150 | Train Time: 1.940s | Train Loss: 0.037470 |
2020-05-31 03:38:35,407 - root - INFO - | Epoch: 118/150 | Train Time: 2.360s | Train Loss: 0.037630 |
2020-05-31 03:38:37,643 - root - INFO - | Epoch: 119/150 | Train Time: 2.236s | Train Loss: 0.037868 |
2020-05-31 03:38:40,196 - root - INFO - | Epoch: 120/150 | Train Time: 2.552s | Train Loss: 0.037747 |
2020-05-31 03:38:42,652 - root - INFO - | Epoch: 121/150 | Train Time: 2.456s | Train Loss: 0.037414 |
2020-05-31 03:38:45,215 - root - INFO - | Epoch: 122/150 | Train Time: 2.562s | Train Loss: 0.037396 |
2020-05-31 03:38:47,850 - root - INFO - | Epoch: 123/150 | Train Time: 2.635s | Train Loss: 0.037763 |
2020-05-31 03:38:50,911 - root - INFO - | Epoch: 124/150 | Train Time: 3.061s | Train Loss: 0.037838 |
2020-05-31 03:38:53,583 - root - INFO - | Epoch: 125/150 | Train Time: 2.672s | Train Loss: 0.037652 |
2020-05-31 03:38:56,035 - root - INFO - | Epoch: 126/150 | Train Time: 2.451s | Train Loss: 0.037757 |
2020-05-31 03:38:58,469 - root - INFO - | Epoch: 127/150 | Train Time: 2.434s | Train Loss: 0.037699 |
2020-05-31 03:39:01,327 - root - INFO - | Epoch: 128/150 | Train Time: 2.857s | Train Loss: 0.037212 |
2020-05-31 03:39:03,586 - root - INFO - | Epoch: 129/150 | Train Time: 2.258s | Train Loss: 0.037717 |
2020-05-31 03:39:06,201 - root - INFO - | Epoch: 130/150 | Train Time: 2.615s | Train Loss: 0.037359 |
2020-05-31 03:39:09,136 - root - INFO - | Epoch: 131/150 | Train Time: 2.934s | Train Loss: 0.037554 |
2020-05-31 03:39:12,099 - root - INFO - | Epoch: 132/150 | Train Time: 2.963s | Train Loss: 0.037473 |
2020-05-31 03:39:14,595 - root - INFO - | Epoch: 133/150 | Train Time: 2.495s | Train Loss: 0.037103 |
2020-05-31 03:39:17,424 - root - INFO - | Epoch: 134/150 | Train Time: 2.829s | Train Loss: 0.037585 |
2020-05-31 03:39:20,381 - root - INFO - | Epoch: 135/150 | Train Time: 2.956s | Train Loss: 0.036819 |
2020-05-31 03:39:23,338 - root - INFO - | Epoch: 136/150 | Train Time: 2.955s | Train Loss: 0.037604 |
2020-05-31 03:39:26,116 - root - INFO - | Epoch: 137/150 | Train Time: 2.777s | Train Loss: 0.037404 |
2020-05-31 03:39:28,907 - root - INFO - | Epoch: 138/150 | Train Time: 2.791s | Train Loss: 0.037528 |
2020-05-31 03:39:31,430 - root - INFO - | Epoch: 139/150 | Train Time: 2.522s | Train Loss: 0.037199 |
2020-05-31 03:39:33,839 - root - INFO - | Epoch: 140/150 | Train Time: 2.408s | Train Loss: 0.037105 |
2020-05-31 03:39:36,353 - root - INFO - | Epoch: 141/150 | Train Time: 2.514s | Train Loss: 0.037384 |
2020-05-31 03:39:38,953 - root - INFO - | Epoch: 142/150 | Train Time: 2.599s | Train Loss: 0.037086 |
2020-05-31 03:39:42,007 - root - INFO - | Epoch: 143/150 | Train Time: 3.054s | Train Loss: 0.037347 |
2020-05-31 03:39:44,670 - root - INFO - | Epoch: 144/150 | Train Time: 2.662s | Train Loss: 0.037231 |
2020-05-31 03:39:47,304 - root - INFO - | Epoch: 145/150 | Train Time: 2.633s | Train Loss: 0.037398 |
2020-05-31 03:39:49,716 - root - INFO - | Epoch: 146/150 | Train Time: 2.412s | Train Loss: 0.037424 |
2020-05-31 03:39:52,434 - root - INFO - | Epoch: 147/150 | Train Time: 2.717s | Train Loss: 0.037415 |
2020-05-31 03:39:55,295 - root - INFO - | Epoch: 148/150 | Train Time: 2.861s | Train Loss: 0.037094 |
2020-05-31 03:39:57,716 - root - INFO - | Epoch: 149/150 | Train Time: 2.420s | Train Loss: 0.037326 |
2020-05-31 03:39:59,801 - root - INFO - | Epoch: 150/150 | Train Time: 2.085s | Train Loss: 0.036938 |
2020-05-31 03:39:59,802 - root - INFO - Training Time: 367.477s
2020-05-31 03:39:59,802 - root - INFO - Finished training.
2020-05-31 03:39:59,803 - root - INFO - Starting testing...
2020-05-31 03:40:02,371 - root - INFO - Test Loss: 0.128323
2020-05-31 03:40:02,371 - root - INFO - Test AUC: 97.28%
2020-05-31 03:40:02,371 - root - INFO - Test Time: 2.550s
2020-05-31 03:40:02,371 - root - INFO - Finished testing.
