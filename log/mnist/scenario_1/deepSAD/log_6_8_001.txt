2020-05-31 04:02:05,910 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_6_8_001.txt
2020-05-31 04:02:05,910 - root - INFO - Data path is ../data
2020-05-31 04:02:05,910 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 04:02:05,910 - root - INFO - Dataset: mnist
2020-05-31 04:02:05,911 - root - INFO - Normal class: 6
2020-05-31 04:02:05,911 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 04:02:05,911 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-31 04:02:05,911 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 04:02:05,911 - root - INFO - Scenario Running: 1
2020-05-31 04:02:05,911 - root - INFO - Train only the network: True
2020-05-31 04:02:05,911 - root - INFO - Output and AE dimensions: 128
2020-05-31 04:02:05,911 - root - INFO - Known anomaly class: 8
2020-05-31 04:02:05,911 - root - INFO - Network: mnist_LeNet
2020-05-31 04:02:05,911 - root - INFO - Eta-parameter: 1.00
2020-05-31 04:02:05,972 - root - INFO - Set seed to 0.
2020-05-31 04:02:06,042 - root - INFO - Computation device: cuda
2020-05-31 04:02:06,042 - root - INFO - Number of threads: 0
2020-05-31 04:02:06,043 - root - INFO - Number of dataloader workers: 6
2020-05-31 04:02:13,824 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 04:02:13,833 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 04:02:13,833 - root - INFO - Training optimizer: adam
2020-05-31 04:02:13,833 - root - INFO - Training learning rate: 0.0001
2020-05-31 04:02:13,833 - root - INFO - Training epochs: 150
2020-05-31 04:02:13,833 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 04:02:13,833 - root - INFO - Training batch size: 200
2020-05-31 04:02:13,834 - root - INFO - Training weight decay: 5e-07
2020-05-31 04:02:13,835 - root - INFO - Starting training...
2020-05-31 04:02:21,431 - root - INFO - | Epoch: 001/150 | Train Time: 7.576s | Train Loss: 0.181092 |
2020-05-31 04:02:24,192 - root - INFO - | Epoch: 002/150 | Train Time: 2.759s | Train Loss: 0.140102 |
2020-05-31 04:02:26,778 - root - INFO - | Epoch: 003/150 | Train Time: 2.585s | Train Loss: 0.121484 |
2020-05-31 04:02:29,605 - root - INFO - | Epoch: 004/150 | Train Time: 2.826s | Train Loss: 0.110841 |
2020-05-31 04:02:32,438 - root - INFO - | Epoch: 005/150 | Train Time: 2.832s | Train Loss: 0.104458 |
2020-05-31 04:02:35,302 - root - INFO - | Epoch: 006/150 | Train Time: 2.863s | Train Loss: 0.097031 |
2020-05-31 04:02:37,795 - root - INFO - | Epoch: 007/150 | Train Time: 2.493s | Train Loss: 0.093759 |
2020-05-31 04:02:40,748 - root - INFO - | Epoch: 008/150 | Train Time: 2.952s | Train Loss: 0.089586 |
2020-05-31 04:02:43,261 - root - INFO - | Epoch: 009/150 | Train Time: 2.511s | Train Loss: 0.088179 |
2020-05-31 04:02:45,715 - root - INFO - | Epoch: 010/150 | Train Time: 2.453s | Train Loss: 0.084241 |
2020-05-31 04:02:49,252 - root - INFO - | Epoch: 011/150 | Train Time: 3.537s | Train Loss: 0.082512 |
2020-05-31 04:02:51,640 - root - INFO - | Epoch: 012/150 | Train Time: 2.387s | Train Loss: 0.080136 |
2020-05-31 04:02:54,009 - root - INFO - | Epoch: 013/150 | Train Time: 2.369s | Train Loss: 0.077985 |
2020-05-31 04:02:56,418 - root - INFO - | Epoch: 014/150 | Train Time: 2.397s | Train Loss: 0.077052 |
2020-05-31 04:02:59,089 - root - INFO - | Epoch: 015/150 | Train Time: 2.671s | Train Loss: 0.075737 |
2020-05-31 04:03:02,017 - root - INFO - | Epoch: 016/150 | Train Time: 2.927s | Train Loss: 0.075398 |
2020-05-31 04:03:05,061 - root - INFO - | Epoch: 017/150 | Train Time: 3.043s | Train Loss: 0.072853 |
2020-05-31 04:03:07,606 - root - INFO - | Epoch: 018/150 | Train Time: 2.545s | Train Loss: 0.070795 |
2020-05-31 04:03:10,481 - root - INFO - | Epoch: 019/150 | Train Time: 2.873s | Train Loss: 0.070024 |
2020-05-31 04:03:13,221 - root - INFO - | Epoch: 020/150 | Train Time: 2.740s | Train Loss: 0.068671 |
2020-05-31 04:03:16,107 - root - INFO - | Epoch: 021/150 | Train Time: 2.885s | Train Loss: 0.068069 |
2020-05-31 04:03:18,981 - root - INFO - | Epoch: 022/150 | Train Time: 2.873s | Train Loss: 0.066859 |
2020-05-31 04:03:21,490 - root - INFO - | Epoch: 023/150 | Train Time: 2.509s | Train Loss: 0.066065 |
2020-05-31 04:03:24,424 - root - INFO - | Epoch: 024/150 | Train Time: 2.933s | Train Loss: 0.065058 |
2020-05-31 04:03:27,281 - root - INFO - | Epoch: 025/150 | Train Time: 2.857s | Train Loss: 0.064636 |
2020-05-31 04:03:30,172 - root - INFO - | Epoch: 026/150 | Train Time: 2.890s | Train Loss: 0.064170 |
2020-05-31 04:03:32,425 - root - INFO - | Epoch: 027/150 | Train Time: 2.253s | Train Loss: 0.063083 |
2020-05-31 04:03:34,641 - root - INFO - | Epoch: 028/150 | Train Time: 2.216s | Train Loss: 0.062780 |
2020-05-31 04:03:37,197 - root - INFO - | Epoch: 029/150 | Train Time: 2.555s | Train Loss: 0.061471 |
2020-05-31 04:03:39,926 - root - INFO - | Epoch: 030/150 | Train Time: 2.728s | Train Loss: 0.062105 |
2020-05-31 04:03:43,198 - root - INFO - | Epoch: 031/150 | Train Time: 3.271s | Train Loss: 0.061019 |
2020-05-31 04:03:46,314 - root - INFO - | Epoch: 032/150 | Train Time: 3.116s | Train Loss: 0.059852 |
2020-05-31 04:03:48,920 - root - INFO - | Epoch: 033/150 | Train Time: 2.605s | Train Loss: 0.059650 |
2020-05-31 04:03:51,122 - root - INFO - | Epoch: 034/150 | Train Time: 2.201s | Train Loss: 0.058547 |
2020-05-31 04:03:53,327 - root - INFO - | Epoch: 035/150 | Train Time: 2.203s | Train Loss: 0.058148 |
2020-05-31 04:03:56,242 - root - INFO - | Epoch: 036/150 | Train Time: 2.915s | Train Loss: 0.057690 |
2020-05-31 04:03:58,943 - root - INFO - | Epoch: 037/150 | Train Time: 2.701s | Train Loss: 0.057056 |
2020-05-31 04:04:01,723 - root - INFO - | Epoch: 038/150 | Train Time: 2.779s | Train Loss: 0.056812 |
2020-05-31 04:04:03,699 - root - INFO - | Epoch: 039/150 | Train Time: 1.975s | Train Loss: 0.056505 |
2020-05-31 04:04:05,899 - root - INFO - | Epoch: 040/150 | Train Time: 2.200s | Train Loss: 0.056059 |
2020-05-31 04:04:08,268 - root - INFO - | Epoch: 041/150 | Train Time: 2.368s | Train Loss: 0.055432 |
2020-05-31 04:04:11,171 - root - INFO - | Epoch: 042/150 | Train Time: 2.903s | Train Loss: 0.054629 |
2020-05-31 04:04:14,074 - root - INFO - | Epoch: 043/150 | Train Time: 2.902s | Train Loss: 0.054879 |
2020-05-31 04:04:16,769 - root - INFO - | Epoch: 044/150 | Train Time: 2.694s | Train Loss: 0.054370 |
2020-05-31 04:04:19,289 - root - INFO - | Epoch: 045/150 | Train Time: 2.519s | Train Loss: 0.054133 |
2020-05-31 04:04:21,946 - root - INFO - | Epoch: 046/150 | Train Time: 2.657s | Train Loss: 0.053648 |
2020-05-31 04:04:24,482 - root - INFO - | Epoch: 047/150 | Train Time: 2.535s | Train Loss: 0.053121 |
2020-05-31 04:04:27,402 - root - INFO - | Epoch: 048/150 | Train Time: 2.919s | Train Loss: 0.052858 |
2020-05-31 04:04:30,097 - root - INFO - | Epoch: 049/150 | Train Time: 2.694s | Train Loss: 0.052356 |
2020-05-31 04:04:32,696 - root - INFO - | Epoch: 050/150 | Train Time: 2.598s | Train Loss: 0.051584 |
2020-05-31 04:04:32,696 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 04:04:35,430 - root - INFO - | Epoch: 051/150 | Train Time: 2.734s | Train Loss: 0.051432 |
2020-05-31 04:04:38,687 - root - INFO - | Epoch: 052/150 | Train Time: 3.256s | Train Loss: 0.051334 |
2020-05-31 04:04:41,448 - root - INFO - | Epoch: 053/150 | Train Time: 2.755s | Train Loss: 0.051366 |
2020-05-31 04:04:44,793 - root - INFO - | Epoch: 054/150 | Train Time: 3.344s | Train Loss: 0.050723 |
2020-05-31 04:04:47,672 - root - INFO - | Epoch: 055/150 | Train Time: 2.878s | Train Loss: 0.051111 |
2020-05-31 04:04:50,457 - root - INFO - | Epoch: 056/150 | Train Time: 2.784s | Train Loss: 0.051470 |
2020-05-31 04:04:53,408 - root - INFO - | Epoch: 057/150 | Train Time: 2.951s | Train Loss: 0.051288 |
2020-05-31 04:04:56,434 - root - INFO - | Epoch: 058/150 | Train Time: 3.025s | Train Loss: 0.051033 |
2020-05-31 04:04:59,108 - root - INFO - | Epoch: 059/150 | Train Time: 2.673s | Train Loss: 0.050934 |
2020-05-31 04:05:01,932 - root - INFO - | Epoch: 060/150 | Train Time: 2.824s | Train Loss: 0.051244 |
2020-05-31 04:05:04,613 - root - INFO - | Epoch: 061/150 | Train Time: 2.680s | Train Loss: 0.051190 |
2020-05-31 04:05:07,097 - root - INFO - | Epoch: 062/150 | Train Time: 2.484s | Train Loss: 0.050854 |
2020-05-31 04:05:09,871 - root - INFO - | Epoch: 063/150 | Train Time: 2.773s | Train Loss: 0.050868 |
2020-05-31 04:05:12,372 - root - INFO - | Epoch: 064/150 | Train Time: 2.500s | Train Loss: 0.051229 |
2020-05-31 04:05:15,246 - root - INFO - | Epoch: 065/150 | Train Time: 2.874s | Train Loss: 0.051134 |
2020-05-31 04:05:18,330 - root - INFO - | Epoch: 066/150 | Train Time: 3.083s | Train Loss: 0.050661 |
2020-05-31 04:05:20,737 - root - INFO - | Epoch: 067/150 | Train Time: 2.407s | Train Loss: 0.050630 |
2020-05-31 04:05:23,272 - root - INFO - | Epoch: 068/150 | Train Time: 2.534s | Train Loss: 0.051020 |
2020-05-31 04:05:25,684 - root - INFO - | Epoch: 069/150 | Train Time: 2.411s | Train Loss: 0.051092 |
2020-05-31 04:05:28,072 - root - INFO - | Epoch: 070/150 | Train Time: 2.387s | Train Loss: 0.050967 |
2020-05-31 04:05:30,574 - root - INFO - | Epoch: 071/150 | Train Time: 2.498s | Train Loss: 0.050932 |
2020-05-31 04:05:33,092 - root - INFO - | Epoch: 072/150 | Train Time: 2.517s | Train Loss: 0.051004 |
2020-05-31 04:05:35,161 - root - INFO - | Epoch: 073/150 | Train Time: 2.069s | Train Loss: 0.050015 |
2020-05-31 04:05:37,302 - root - INFO - | Epoch: 074/150 | Train Time: 2.141s | Train Loss: 0.050744 |
2020-05-31 04:05:39,602 - root - INFO - | Epoch: 075/150 | Train Time: 2.299s | Train Loss: 0.050620 |
2020-05-31 04:05:41,629 - root - INFO - | Epoch: 076/150 | Train Time: 2.027s | Train Loss: 0.050777 |
2020-05-31 04:05:43,765 - root - INFO - | Epoch: 077/150 | Train Time: 2.136s | Train Loss: 0.050801 |
2020-05-31 04:05:45,774 - root - INFO - | Epoch: 078/150 | Train Time: 2.008s | Train Loss: 0.050707 |
2020-05-31 04:05:47,972 - root - INFO - | Epoch: 079/150 | Train Time: 2.198s | Train Loss: 0.050368 |
2020-05-31 04:05:50,602 - root - INFO - | Epoch: 080/150 | Train Time: 2.629s | Train Loss: 0.050158 |
2020-05-31 04:05:53,228 - root - INFO - | Epoch: 081/150 | Train Time: 2.626s | Train Loss: 0.050437 |
2020-05-31 04:05:55,525 - root - INFO - | Epoch: 082/150 | Train Time: 2.296s | Train Loss: 0.050680 |
2020-05-31 04:05:57,789 - root - INFO - | Epoch: 083/150 | Train Time: 2.263s | Train Loss: 0.049942 |
2020-05-31 04:05:59,942 - root - INFO - | Epoch: 084/150 | Train Time: 2.153s | Train Loss: 0.049842 |
2020-05-31 04:06:02,215 - root - INFO - | Epoch: 085/150 | Train Time: 2.272s | Train Loss: 0.050722 |
2020-05-31 04:06:04,442 - root - INFO - | Epoch: 086/150 | Train Time: 2.226s | Train Loss: 0.050292 |
2020-05-31 04:06:06,724 - root - INFO - | Epoch: 087/150 | Train Time: 2.282s | Train Loss: 0.050266 |
2020-05-31 04:06:09,734 - root - INFO - | Epoch: 088/150 | Train Time: 3.009s | Train Loss: 0.050220 |
2020-05-31 04:06:12,812 - root - INFO - | Epoch: 089/150 | Train Time: 3.077s | Train Loss: 0.050312 |
2020-05-31 04:06:15,160 - root - INFO - | Epoch: 090/150 | Train Time: 2.348s | Train Loss: 0.050226 |
2020-05-31 04:06:17,788 - root - INFO - | Epoch: 091/150 | Train Time: 2.628s | Train Loss: 0.050213 |
2020-05-31 04:06:20,587 - root - INFO - | Epoch: 092/150 | Train Time: 2.799s | Train Loss: 0.049916 |
2020-05-31 04:06:23,058 - root - INFO - | Epoch: 093/150 | Train Time: 2.470s | Train Loss: 0.049614 |
2020-05-31 04:06:25,753 - root - INFO - | Epoch: 094/150 | Train Time: 2.695s | Train Loss: 0.049762 |
2020-05-31 04:06:28,366 - root - INFO - | Epoch: 095/150 | Train Time: 2.612s | Train Loss: 0.050073 |
2020-05-31 04:06:31,457 - root - INFO - | Epoch: 096/150 | Train Time: 3.091s | Train Loss: 0.049842 |
2020-05-31 04:06:34,311 - root - INFO - | Epoch: 097/150 | Train Time: 2.853s | Train Loss: 0.049301 |
2020-05-31 04:06:36,948 - root - INFO - | Epoch: 098/150 | Train Time: 2.637s | Train Loss: 0.049684 |
2020-05-31 04:06:39,689 - root - INFO - | Epoch: 099/150 | Train Time: 2.740s | Train Loss: 0.049942 |
2020-05-31 04:06:42,152 - root - INFO - | Epoch: 100/150 | Train Time: 2.463s | Train Loss: 0.049825 |
2020-05-31 04:06:44,585 - root - INFO - | Epoch: 101/150 | Train Time: 2.432s | Train Loss: 0.049341 |
2020-05-31 04:06:47,323 - root - INFO - | Epoch: 102/150 | Train Time: 2.737s | Train Loss: 0.049716 |
2020-05-31 04:06:50,208 - root - INFO - | Epoch: 103/150 | Train Time: 2.885s | Train Loss: 0.049269 |
2020-05-31 04:06:53,206 - root - INFO - | Epoch: 104/150 | Train Time: 2.998s | Train Loss: 0.049769 |
2020-05-31 04:06:57,755 - root - INFO - | Epoch: 105/150 | Train Time: 4.549s | Train Loss: 0.049373 |
2020-05-31 04:07:00,132 - root - INFO - | Epoch: 106/150 | Train Time: 2.376s | Train Loss: 0.049724 |
2020-05-31 04:07:02,743 - root - INFO - | Epoch: 107/150 | Train Time: 2.610s | Train Loss: 0.049714 |
2020-05-31 04:07:05,298 - root - INFO - | Epoch: 108/150 | Train Time: 2.554s | Train Loss: 0.049620 |
2020-05-31 04:07:07,403 - root - INFO - | Epoch: 109/150 | Train Time: 2.104s | Train Loss: 0.049105 |
2020-05-31 04:07:09,770 - root - INFO - | Epoch: 110/150 | Train Time: 2.366s | Train Loss: 0.049087 |
2020-05-31 04:07:12,207 - root - INFO - | Epoch: 111/150 | Train Time: 2.437s | Train Loss: 0.049600 |
2020-05-31 04:07:15,043 - root - INFO - | Epoch: 112/150 | Train Time: 2.835s | Train Loss: 0.048876 |
2020-05-31 04:07:17,674 - root - INFO - | Epoch: 113/150 | Train Time: 2.630s | Train Loss: 0.049431 |
2020-05-31 04:07:20,540 - root - INFO - | Epoch: 114/150 | Train Time: 2.865s | Train Loss: 0.049271 |
2020-05-31 04:07:23,704 - root - INFO - | Epoch: 115/150 | Train Time: 3.163s | Train Loss: 0.048952 |
2020-05-31 04:07:26,416 - root - INFO - | Epoch: 116/150 | Train Time: 2.711s | Train Loss: 0.049312 |
2020-05-31 04:07:29,198 - root - INFO - | Epoch: 117/150 | Train Time: 2.781s | Train Loss: 0.048752 |
2020-05-31 04:07:31,857 - root - INFO - | Epoch: 118/150 | Train Time: 2.658s | Train Loss: 0.049015 |
2020-05-31 04:07:34,409 - root - INFO - | Epoch: 119/150 | Train Time: 2.552s | Train Loss: 0.049169 |
2020-05-31 04:07:36,649 - root - INFO - | Epoch: 120/150 | Train Time: 2.239s | Train Loss: 0.048820 |
2020-05-31 04:07:39,421 - root - INFO - | Epoch: 121/150 | Train Time: 2.771s | Train Loss: 0.048856 |
2020-05-31 04:07:42,465 - root - INFO - | Epoch: 122/150 | Train Time: 3.044s | Train Loss: 0.048175 |
2020-05-31 04:07:45,719 - root - INFO - | Epoch: 123/150 | Train Time: 3.244s | Train Loss: 0.049095 |
2020-05-31 04:07:48,789 - root - INFO - | Epoch: 124/150 | Train Time: 3.070s | Train Loss: 0.049042 |
2020-05-31 04:07:51,732 - root - INFO - | Epoch: 125/150 | Train Time: 2.942s | Train Loss: 0.048745 |
2020-05-31 04:07:54,828 - root - INFO - | Epoch: 126/150 | Train Time: 3.094s | Train Loss: 0.048842 |
2020-05-31 04:07:58,049 - root - INFO - | Epoch: 127/150 | Train Time: 3.221s | Train Loss: 0.048973 |
2020-05-31 04:08:01,156 - root - INFO - | Epoch: 128/150 | Train Time: 3.106s | Train Loss: 0.048144 |
2020-05-31 04:08:03,803 - root - INFO - | Epoch: 129/150 | Train Time: 2.642s | Train Loss: 0.048693 |
2020-05-31 04:08:06,831 - root - INFO - | Epoch: 130/150 | Train Time: 3.027s | Train Loss: 0.048441 |
2020-05-31 04:08:10,118 - root - INFO - | Epoch: 131/150 | Train Time: 3.287s | Train Loss: 0.048676 |
2020-05-31 04:08:12,900 - root - INFO - | Epoch: 132/150 | Train Time: 2.781s | Train Loss: 0.048550 |
2020-05-31 04:08:15,245 - root - INFO - | Epoch: 133/150 | Train Time: 2.345s | Train Loss: 0.048560 |
2020-05-31 04:08:17,740 - root - INFO - | Epoch: 134/150 | Train Time: 2.494s | Train Loss: 0.048620 |
2020-05-31 04:08:19,829 - root - INFO - | Epoch: 135/150 | Train Time: 2.089s | Train Loss: 0.047778 |
2020-05-31 04:08:22,152 - root - INFO - | Epoch: 136/150 | Train Time: 2.323s | Train Loss: 0.048685 |
2020-05-31 04:08:24,264 - root - INFO - | Epoch: 137/150 | Train Time: 2.112s | Train Loss: 0.048637 |
2020-05-31 04:08:26,470 - root - INFO - | Epoch: 138/150 | Train Time: 2.205s | Train Loss: 0.048550 |
2020-05-31 04:08:28,672 - root - INFO - | Epoch: 139/150 | Train Time: 2.202s | Train Loss: 0.048296 |
2020-05-31 04:08:30,850 - root - INFO - | Epoch: 140/150 | Train Time: 2.177s | Train Loss: 0.048248 |
2020-05-31 04:08:33,826 - root - INFO - | Epoch: 141/150 | Train Time: 2.975s | Train Loss: 0.048133 |
2020-05-31 04:08:36,466 - root - INFO - | Epoch: 142/150 | Train Time: 2.640s | Train Loss: 0.048161 |
2020-05-31 04:08:39,392 - root - INFO - | Epoch: 143/150 | Train Time: 2.925s | Train Loss: 0.048273 |
2020-05-31 04:08:42,034 - root - INFO - | Epoch: 144/150 | Train Time: 2.642s | Train Loss: 0.048381 |
2020-05-31 04:08:44,060 - root - INFO - | Epoch: 145/150 | Train Time: 2.026s | Train Loss: 0.048161 |
2020-05-31 04:08:46,289 - root - INFO - | Epoch: 146/150 | Train Time: 2.228s | Train Loss: 0.048374 |
2020-05-31 04:08:48,732 - root - INFO - | Epoch: 147/150 | Train Time: 2.442s | Train Loss: 0.048305 |
2020-05-31 04:08:51,303 - root - INFO - | Epoch: 148/150 | Train Time: 2.571s | Train Loss: 0.048147 |
2020-05-31 04:08:53,508 - root - INFO - | Epoch: 149/150 | Train Time: 2.192s | Train Loss: 0.048168 |
2020-05-31 04:08:56,200 - root - INFO - | Epoch: 150/150 | Train Time: 2.691s | Train Loss: 0.047465 |
2020-05-31 04:08:56,200 - root - INFO - Training Time: 402.365s
2020-05-31 04:08:56,200 - root - INFO - Finished training.
2020-05-31 04:08:56,201 - root - INFO - Starting testing...
2020-05-31 04:08:59,177 - root - INFO - Test Loss: 0.112548
2020-05-31 04:08:59,177 - root - INFO - Test AUC: 95.93%
2020-05-31 04:08:59,177 - root - INFO - Test Time: 2.961s
2020-05-31 04:08:59,177 - root - INFO - Finished testing.
