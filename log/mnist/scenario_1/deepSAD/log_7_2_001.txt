2020-05-31 05:56:12,299 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_7_2_001.txt
2020-05-31 05:56:12,299 - root - INFO - Data path is ../data
2020-05-31 05:56:12,299 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 05:56:12,299 - root - INFO - Dataset: mnist
2020-05-31 05:56:12,299 - root - INFO - Normal class: 7
2020-05-31 05:56:12,299 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 05:56:12,299 - root - INFO - Ratio of labeled anomalous samples: 0.01
2020-05-31 05:56:12,299 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 05:56:12,299 - root - INFO - Scenario Running: 1
2020-05-31 05:56:12,300 - root - INFO - Train only the network: True
2020-05-31 05:56:12,300 - root - INFO - Output and AE dimensions: 128
2020-05-31 05:56:12,300 - root - INFO - Known anomaly class: 2
2020-05-31 05:56:12,300 - root - INFO - Network: mnist_LeNet
2020-05-31 05:56:12,300 - root - INFO - Eta-parameter: 1.00
2020-05-31 05:56:12,307 - root - INFO - Set seed to 0.
2020-05-31 05:56:12,356 - root - INFO - Computation device: cuda
2020-05-31 05:56:12,356 - root - INFO - Number of threads: 0
2020-05-31 05:56:12,356 - root - INFO - Number of dataloader workers: 6
2020-05-31 05:56:20,259 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 05:56:20,272 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 05:56:20,272 - root - INFO - Training optimizer: adam
2020-05-31 05:56:20,272 - root - INFO - Training learning rate: 0.0001
2020-05-31 05:56:20,272 - root - INFO - Training epochs: 150
2020-05-31 05:56:20,272 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 05:56:20,272 - root - INFO - Training batch size: 200
2020-05-31 05:56:20,272 - root - INFO - Training weight decay: 5e-07
2020-05-31 05:56:20,274 - root - INFO - Starting training...
2020-05-31 05:56:27,377 - root - INFO - | Epoch: 001/150 | Train Time: 7.087s | Train Loss: 0.172010 |
2020-05-31 05:56:29,860 - root - INFO - | Epoch: 002/150 | Train Time: 2.482s | Train Loss: 0.123397 |
2020-05-31 05:56:32,462 - root - INFO - | Epoch: 003/150 | Train Time: 2.602s | Train Loss: 0.104912 |
2020-05-31 05:56:35,601 - root - INFO - | Epoch: 004/150 | Train Time: 3.138s | Train Loss: 0.094241 |
2020-05-31 05:56:38,094 - root - INFO - | Epoch: 005/150 | Train Time: 2.492s | Train Loss: 0.087398 |
2020-05-31 05:56:40,367 - root - INFO - | Epoch: 006/150 | Train Time: 2.273s | Train Loss: 0.082481 |
2020-05-31 05:56:42,854 - root - INFO - | Epoch: 007/150 | Train Time: 2.486s | Train Loss: 0.078509 |
2020-05-31 05:56:45,485 - root - INFO - | Epoch: 008/150 | Train Time: 2.631s | Train Loss: 0.074969 |
2020-05-31 05:56:47,964 - root - INFO - | Epoch: 009/150 | Train Time: 2.479s | Train Loss: 0.071419 |
2020-05-31 05:56:50,241 - root - INFO - | Epoch: 010/150 | Train Time: 2.276s | Train Loss: 0.069406 |
2020-05-31 05:56:52,759 - root - INFO - | Epoch: 011/150 | Train Time: 2.518s | Train Loss: 0.067959 |
2020-05-31 05:56:55,323 - root - INFO - | Epoch: 012/150 | Train Time: 2.563s | Train Loss: 0.066077 |
2020-05-31 05:56:58,263 - root - INFO - | Epoch: 013/150 | Train Time: 2.939s | Train Loss: 0.064693 |
2020-05-31 05:57:00,912 - root - INFO - | Epoch: 014/150 | Train Time: 2.649s | Train Loss: 0.063247 |
2020-05-31 05:57:03,752 - root - INFO - | Epoch: 015/150 | Train Time: 2.839s | Train Loss: 0.061747 |
2020-05-31 05:57:06,429 - root - INFO - | Epoch: 016/150 | Train Time: 2.677s | Train Loss: 0.060836 |
2020-05-31 05:57:09,270 - root - INFO - | Epoch: 017/150 | Train Time: 2.840s | Train Loss: 0.060061 |
2020-05-31 05:57:12,407 - root - INFO - | Epoch: 018/150 | Train Time: 3.137s | Train Loss: 0.058500 |
2020-05-31 05:57:15,118 - root - INFO - | Epoch: 019/150 | Train Time: 2.711s | Train Loss: 0.058217 |
2020-05-31 05:57:17,695 - root - INFO - | Epoch: 020/150 | Train Time: 2.576s | Train Loss: 0.057391 |
2020-05-31 05:57:20,531 - root - INFO - | Epoch: 021/150 | Train Time: 2.835s | Train Loss: 0.055369 |
2020-05-31 05:57:23,373 - root - INFO - | Epoch: 022/150 | Train Time: 2.841s | Train Loss: 0.055454 |
2020-05-31 05:57:26,025 - root - INFO - | Epoch: 023/150 | Train Time: 2.651s | Train Loss: 0.054722 |
2020-05-31 05:57:28,606 - root - INFO - | Epoch: 024/150 | Train Time: 2.581s | Train Loss: 0.053620 |
2020-05-31 05:57:31,690 - root - INFO - | Epoch: 025/150 | Train Time: 3.083s | Train Loss: 0.053452 |
2020-05-31 05:57:34,623 - root - INFO - | Epoch: 026/150 | Train Time: 2.933s | Train Loss: 0.052514 |
2020-05-31 05:57:37,710 - root - INFO - | Epoch: 027/150 | Train Time: 3.086s | Train Loss: 0.052070 |
2020-05-31 05:57:40,566 - root - INFO - | Epoch: 028/150 | Train Time: 2.855s | Train Loss: 0.051205 |
2020-05-31 05:57:43,424 - root - INFO - | Epoch: 029/150 | Train Time: 2.858s | Train Loss: 0.051163 |
2020-05-31 05:57:45,946 - root - INFO - | Epoch: 030/150 | Train Time: 2.521s | Train Loss: 0.050896 |
2020-05-31 05:57:48,583 - root - INFO - | Epoch: 031/150 | Train Time: 2.637s | Train Loss: 0.050140 |
2020-05-31 05:57:51,377 - root - INFO - | Epoch: 032/150 | Train Time: 2.792s | Train Loss: 0.049182 |
2020-05-31 05:57:54,464 - root - INFO - | Epoch: 033/150 | Train Time: 3.087s | Train Loss: 0.049418 |
2020-05-31 05:57:57,005 - root - INFO - | Epoch: 034/150 | Train Time: 2.541s | Train Loss: 0.049058 |
2020-05-31 05:58:00,201 - root - INFO - | Epoch: 035/150 | Train Time: 3.195s | Train Loss: 0.048434 |
2020-05-31 05:58:02,829 - root - INFO - | Epoch: 036/150 | Train Time: 2.628s | Train Loss: 0.047260 |
2020-05-31 05:58:05,219 - root - INFO - | Epoch: 037/150 | Train Time: 2.390s | Train Loss: 0.047665 |
2020-05-31 05:58:07,174 - root - INFO - | Epoch: 038/150 | Train Time: 1.954s | Train Loss: 0.047128 |
2020-05-31 05:58:09,409 - root - INFO - | Epoch: 039/150 | Train Time: 2.234s | Train Loss: 0.046602 |
2020-05-31 05:58:11,813 - root - INFO - | Epoch: 040/150 | Train Time: 2.404s | Train Loss: 0.046122 |
2020-05-31 05:58:14,371 - root - INFO - | Epoch: 041/150 | Train Time: 2.558s | Train Loss: 0.045584 |
2020-05-31 05:58:18,033 - root - INFO - | Epoch: 042/150 | Train Time: 3.661s | Train Loss: 0.045191 |
2020-05-31 05:58:20,786 - root - INFO - | Epoch: 043/150 | Train Time: 2.752s | Train Loss: 0.044873 |
2020-05-31 05:58:24,029 - root - INFO - | Epoch: 044/150 | Train Time: 3.242s | Train Loss: 0.045245 |
2020-05-31 05:58:26,869 - root - INFO - | Epoch: 045/150 | Train Time: 2.840s | Train Loss: 0.044708 |
2020-05-31 05:58:30,097 - root - INFO - | Epoch: 046/150 | Train Time: 3.227s | Train Loss: 0.044381 |
2020-05-31 05:58:33,516 - root - INFO - | Epoch: 047/150 | Train Time: 3.418s | Train Loss: 0.044156 |
2020-05-31 05:58:36,390 - root - INFO - | Epoch: 048/150 | Train Time: 2.874s | Train Loss: 0.043866 |
2020-05-31 05:58:39,355 - root - INFO - | Epoch: 049/150 | Train Time: 2.964s | Train Loss: 0.043400 |
2020-05-31 05:58:42,740 - root - INFO - | Epoch: 050/150 | Train Time: 3.384s | Train Loss: 0.042286 |
2020-05-31 05:58:42,740 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 05:58:46,043 - root - INFO - | Epoch: 051/150 | Train Time: 3.302s | Train Loss: 0.042624 |
2020-05-31 05:58:48,951 - root - INFO - | Epoch: 052/150 | Train Time: 2.907s | Train Loss: 0.042658 |
2020-05-31 05:58:51,708 - root - INFO - | Epoch: 053/150 | Train Time: 2.757s | Train Loss: 0.042668 |
2020-05-31 05:58:54,764 - root - INFO - | Epoch: 054/150 | Train Time: 3.055s | Train Loss: 0.042153 |
2020-05-31 05:58:57,949 - root - INFO - | Epoch: 055/150 | Train Time: 3.185s | Train Loss: 0.042480 |
2020-05-31 05:59:01,217 - root - INFO - | Epoch: 056/150 | Train Time: 3.268s | Train Loss: 0.042390 |
2020-05-31 05:59:04,276 - root - INFO - | Epoch: 057/150 | Train Time: 3.058s | Train Loss: 0.042318 |
2020-05-31 05:59:06,866 - root - INFO - | Epoch: 058/150 | Train Time: 2.583s | Train Loss: 0.042345 |
2020-05-31 05:59:09,448 - root - INFO - | Epoch: 059/150 | Train Time: 2.581s | Train Loss: 0.042420 |
2020-05-31 05:59:12,372 - root - INFO - | Epoch: 060/150 | Train Time: 2.913s | Train Loss: 0.041919 |
2020-05-31 05:59:15,024 - root - INFO - | Epoch: 061/150 | Train Time: 2.651s | Train Loss: 0.042155 |
2020-05-31 05:59:17,526 - root - INFO - | Epoch: 062/150 | Train Time: 2.502s | Train Loss: 0.042305 |
2020-05-31 05:59:20,149 - root - INFO - | Epoch: 063/150 | Train Time: 2.622s | Train Loss: 0.041881 |
2020-05-31 05:59:22,819 - root - INFO - | Epoch: 064/150 | Train Time: 2.669s | Train Loss: 0.042151 |
2020-05-31 05:59:25,433 - root - INFO - | Epoch: 065/150 | Train Time: 2.614s | Train Loss: 0.042204 |
2020-05-31 05:59:27,978 - root - INFO - | Epoch: 066/150 | Train Time: 2.544s | Train Loss: 0.041810 |
2020-05-31 05:59:30,799 - root - INFO - | Epoch: 067/150 | Train Time: 2.820s | Train Loss: 0.042116 |
2020-05-31 05:59:33,436 - root - INFO - | Epoch: 068/150 | Train Time: 2.637s | Train Loss: 0.042089 |
2020-05-31 05:59:35,900 - root - INFO - | Epoch: 069/150 | Train Time: 2.462s | Train Loss: 0.041876 |
2020-05-31 05:59:38,673 - root - INFO - | Epoch: 070/150 | Train Time: 2.772s | Train Loss: 0.041824 |
2020-05-31 05:59:41,351 - root - INFO - | Epoch: 071/150 | Train Time: 2.677s | Train Loss: 0.041759 |
2020-05-31 05:59:44,107 - root - INFO - | Epoch: 072/150 | Train Time: 2.755s | Train Loss: 0.041886 |
2020-05-31 05:59:46,725 - root - INFO - | Epoch: 073/150 | Train Time: 2.618s | Train Loss: 0.041728 |
2020-05-31 05:59:48,993 - root - INFO - | Epoch: 074/150 | Train Time: 2.268s | Train Loss: 0.041804 |
2020-05-31 05:59:51,095 - root - INFO - | Epoch: 075/150 | Train Time: 2.102s | Train Loss: 0.041785 |
2020-05-31 05:59:53,462 - root - INFO - | Epoch: 076/150 | Train Time: 2.366s | Train Loss: 0.041713 |
2020-05-31 05:59:56,110 - root - INFO - | Epoch: 077/150 | Train Time: 2.647s | Train Loss: 0.041827 |
2020-05-31 05:59:59,122 - root - INFO - | Epoch: 078/150 | Train Time: 3.012s | Train Loss: 0.041826 |
2020-05-31 06:00:02,062 - root - INFO - | Epoch: 079/150 | Train Time: 2.939s | Train Loss: 0.041799 |
2020-05-31 06:00:04,883 - root - INFO - | Epoch: 080/150 | Train Time: 2.821s | Train Loss: 0.041358 |
2020-05-31 06:00:07,431 - root - INFO - | Epoch: 081/150 | Train Time: 2.547s | Train Loss: 0.041761 |
2020-05-31 06:00:09,914 - root - INFO - | Epoch: 082/150 | Train Time: 2.483s | Train Loss: 0.041788 |
2020-05-31 06:00:12,385 - root - INFO - | Epoch: 083/150 | Train Time: 2.471s | Train Loss: 0.041629 |
2020-05-31 06:00:14,873 - root - INFO - | Epoch: 084/150 | Train Time: 2.488s | Train Loss: 0.041544 |
2020-05-31 06:00:17,064 - root - INFO - | Epoch: 085/150 | Train Time: 2.191s | Train Loss: 0.041248 |
2020-05-31 06:00:20,052 - root - INFO - | Epoch: 086/150 | Train Time: 2.987s | Train Loss: 0.041438 |
2020-05-31 06:00:22,650 - root - INFO - | Epoch: 087/150 | Train Time: 2.597s | Train Loss: 0.041399 |
2020-05-31 06:00:25,533 - root - INFO - | Epoch: 088/150 | Train Time: 2.883s | Train Loss: 0.041100 |
2020-05-31 06:00:28,637 - root - INFO - | Epoch: 089/150 | Train Time: 3.104s | Train Loss: 0.040926 |
2020-05-31 06:00:31,844 - root - INFO - | Epoch: 090/150 | Train Time: 3.206s | Train Loss: 0.041428 |
2020-05-31 06:00:34,278 - root - INFO - | Epoch: 091/150 | Train Time: 2.433s | Train Loss: 0.040585 |
2020-05-31 06:00:37,024 - root - INFO - | Epoch: 092/150 | Train Time: 2.746s | Train Loss: 0.041301 |
2020-05-31 06:00:39,681 - root - INFO - | Epoch: 093/150 | Train Time: 2.656s | Train Loss: 0.040982 |
2020-05-31 06:00:42,767 - root - INFO - | Epoch: 094/150 | Train Time: 3.085s | Train Loss: 0.041288 |
2020-05-31 06:00:45,520 - root - INFO - | Epoch: 095/150 | Train Time: 2.752s | Train Loss: 0.041221 |
2020-05-31 06:00:48,538 - root - INFO - | Epoch: 096/150 | Train Time: 3.018s | Train Loss: 0.041103 |
2020-05-31 06:00:51,652 - root - INFO - | Epoch: 097/150 | Train Time: 3.113s | Train Loss: 0.041313 |
2020-05-31 06:00:54,335 - root - INFO - | Epoch: 098/150 | Train Time: 2.682s | Train Loss: 0.041209 |
2020-05-31 06:00:56,664 - root - INFO - | Epoch: 099/150 | Train Time: 2.329s | Train Loss: 0.041030 |
2020-05-31 06:00:59,153 - root - INFO - | Epoch: 100/150 | Train Time: 2.488s | Train Loss: 0.040984 |
2020-05-31 06:01:01,322 - root - INFO - | Epoch: 101/150 | Train Time: 2.169s | Train Loss: 0.040754 |
2020-05-31 06:01:03,371 - root - INFO - | Epoch: 102/150 | Train Time: 2.049s | Train Loss: 0.039898 |
2020-05-31 06:01:05,456 - root - INFO - | Epoch: 103/150 | Train Time: 2.084s | Train Loss: 0.040597 |
2020-05-31 06:01:07,577 - root - INFO - | Epoch: 104/150 | Train Time: 2.120s | Train Loss: 0.041025 |
2020-05-31 06:01:09,762 - root - INFO - | Epoch: 105/150 | Train Time: 2.185s | Train Loss: 0.041018 |
2020-05-31 06:01:12,017 - root - INFO - | Epoch: 106/150 | Train Time: 2.254s | Train Loss: 0.040977 |
2020-05-31 06:01:14,344 - root - INFO - | Epoch: 107/150 | Train Time: 2.327s | Train Loss: 0.041042 |
2020-05-31 06:01:16,920 - root - INFO - | Epoch: 108/150 | Train Time: 2.576s | Train Loss: 0.040562 |
2020-05-31 06:01:19,152 - root - INFO - | Epoch: 109/150 | Train Time: 2.232s | Train Loss: 0.040606 |
2020-05-31 06:01:21,858 - root - INFO - | Epoch: 110/150 | Train Time: 2.705s | Train Loss: 0.040422 |
2020-05-31 06:01:24,442 - root - INFO - | Epoch: 111/150 | Train Time: 2.583s | Train Loss: 0.040844 |
2020-05-31 06:01:27,297 - root - INFO - | Epoch: 112/150 | Train Time: 2.854s | Train Loss: 0.040839 |
2020-05-31 06:01:29,849 - root - INFO - | Epoch: 113/150 | Train Time: 2.552s | Train Loss: 0.040676 |
2020-05-31 06:01:32,146 - root - INFO - | Epoch: 114/150 | Train Time: 2.296s | Train Loss: 0.040646 |
2020-05-31 06:01:34,471 - root - INFO - | Epoch: 115/150 | Train Time: 2.324s | Train Loss: 0.040645 |
2020-05-31 06:01:36,784 - root - INFO - | Epoch: 116/150 | Train Time: 2.312s | Train Loss: 0.040651 |
2020-05-31 06:01:39,349 - root - INFO - | Epoch: 117/150 | Train Time: 2.564s | Train Loss: 0.040596 |
2020-05-31 06:01:41,587 - root - INFO - | Epoch: 118/150 | Train Time: 2.238s | Train Loss: 0.040565 |
2020-05-31 06:01:43,874 - root - INFO - | Epoch: 119/150 | Train Time: 2.286s | Train Loss: 0.040467 |
2020-05-31 06:01:46,167 - root - INFO - | Epoch: 120/150 | Train Time: 2.292s | Train Loss: 0.040519 |
2020-05-31 06:01:48,469 - root - INFO - | Epoch: 121/150 | Train Time: 2.302s | Train Loss: 0.040135 |
2020-05-31 06:01:50,743 - root - INFO - | Epoch: 122/150 | Train Time: 2.273s | Train Loss: 0.040412 |
2020-05-31 06:01:52,920 - root - INFO - | Epoch: 123/150 | Train Time: 2.176s | Train Loss: 0.040342 |
2020-05-31 06:01:55,155 - root - INFO - | Epoch: 124/150 | Train Time: 2.234s | Train Loss: 0.040306 |
2020-05-31 06:01:57,655 - root - INFO - | Epoch: 125/150 | Train Time: 2.500s | Train Loss: 0.040334 |
2020-05-31 06:01:59,619 - root - INFO - | Epoch: 126/150 | Train Time: 1.964s | Train Loss: 0.040315 |
2020-05-31 06:02:01,873 - root - INFO - | Epoch: 127/150 | Train Time: 2.253s | Train Loss: 0.040403 |
2020-05-31 06:02:04,453 - root - INFO - | Epoch: 128/150 | Train Time: 2.580s | Train Loss: 0.040039 |
2020-05-31 06:02:06,887 - root - INFO - | Epoch: 129/150 | Train Time: 2.433s | Train Loss: 0.040440 |
2020-05-31 06:02:08,797 - root - INFO - | Epoch: 130/150 | Train Time: 1.909s | Train Loss: 0.040153 |
2020-05-31 06:02:10,887 - root - INFO - | Epoch: 131/150 | Train Time: 2.090s | Train Loss: 0.040403 |
2020-05-31 06:02:12,945 - root - INFO - | Epoch: 132/150 | Train Time: 2.057s | Train Loss: 0.040345 |
2020-05-31 06:02:15,461 - root - INFO - | Epoch: 133/150 | Train Time: 2.515s | Train Loss: 0.039544 |
2020-05-31 06:02:18,294 - root - INFO - | Epoch: 134/150 | Train Time: 2.832s | Train Loss: 0.040008 |
2020-05-31 06:02:20,651 - root - INFO - | Epoch: 135/150 | Train Time: 2.357s | Train Loss: 0.040155 |
2020-05-31 06:02:23,313 - root - INFO - | Epoch: 136/150 | Train Time: 2.661s | Train Loss: 0.040158 |
2020-05-31 06:02:25,739 - root - INFO - | Epoch: 137/150 | Train Time: 2.426s | Train Loss: 0.039794 |
2020-05-31 06:02:29,008 - root - INFO - | Epoch: 138/150 | Train Time: 3.269s | Train Loss: 0.040018 |
2020-05-31 06:02:31,573 - root - INFO - | Epoch: 139/150 | Train Time: 2.559s | Train Loss: 0.039976 |
2020-05-31 06:02:34,458 - root - INFO - | Epoch: 140/150 | Train Time: 2.884s | Train Loss: 0.039983 |
2020-05-31 06:02:37,735 - root - INFO - | Epoch: 141/150 | Train Time: 3.277s | Train Loss: 0.039942 |
2020-05-31 06:02:40,493 - root - INFO - | Epoch: 142/150 | Train Time: 2.758s | Train Loss: 0.039805 |
2020-05-31 06:02:43,341 - root - INFO - | Epoch: 143/150 | Train Time: 2.847s | Train Loss: 0.039983 |
2020-05-31 06:02:46,037 - root - INFO - | Epoch: 144/150 | Train Time: 2.695s | Train Loss: 0.039866 |
2020-05-31 06:02:48,745 - root - INFO - | Epoch: 145/150 | Train Time: 2.707s | Train Loss: 0.039738 |
2020-05-31 06:02:51,504 - root - INFO - | Epoch: 146/150 | Train Time: 2.759s | Train Loss: 0.039815 |
2020-05-31 06:02:54,029 - root - INFO - | Epoch: 147/150 | Train Time: 2.525s | Train Loss: 0.039431 |
2020-05-31 06:02:56,415 - root - INFO - | Epoch: 148/150 | Train Time: 2.386s | Train Loss: 0.039550 |
2020-05-31 06:02:58,952 - root - INFO - | Epoch: 149/150 | Train Time: 2.536s | Train Loss: 0.039795 |
2020-05-31 06:03:01,384 - root - INFO - | Epoch: 150/150 | Train Time: 2.431s | Train Loss: 0.039712 |
2020-05-31 06:03:01,385 - root - INFO - Training Time: 401.111s
2020-05-31 06:03:01,385 - root - INFO - Finished training.
2020-05-31 06:03:01,386 - root - INFO - Starting testing...
2020-05-31 06:03:04,530 - root - INFO - Test Loss: 0.115146
2020-05-31 06:03:04,531 - root - INFO - Test AUC: 91.63%
2020-05-31 06:03:04,531 - root - INFO - Test Time: 3.128s
2020-05-31 06:03:04,531 - root - INFO - Finished testing.
