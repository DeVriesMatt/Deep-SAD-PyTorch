2020-05-31 08:03:17,056 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_7_6_01.txt
2020-05-31 08:03:17,056 - root - INFO - Data path is ../data
2020-05-31 08:03:17,056 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 08:03:17,056 - root - INFO - Dataset: mnist
2020-05-31 08:03:17,056 - root - INFO - Normal class: 7
2020-05-31 08:03:17,056 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 08:03:17,056 - root - INFO - Ratio of labeled anomalous samples: 0.10
2020-05-31 08:03:17,057 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 08:03:17,057 - root - INFO - Scenario Running: 1
2020-05-31 08:03:17,057 - root - INFO - Train only the network: True
2020-05-31 08:03:17,057 - root - INFO - Output and AE dimensions: 128
2020-05-31 08:03:17,057 - root - INFO - Known anomaly class: 6
2020-05-31 08:03:17,057 - root - INFO - Network: mnist_LeNet
2020-05-31 08:03:17,057 - root - INFO - Eta-parameter: 1.00
2020-05-31 08:03:17,072 - root - INFO - Set seed to 0.
2020-05-31 08:03:17,152 - root - INFO - Computation device: cuda
2020-05-31 08:03:17,152 - root - INFO - Number of threads: 0
2020-05-31 08:03:17,152 - root - INFO - Number of dataloader workers: 6
2020-05-31 08:03:24,536 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 08:03:24,546 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 08:03:24,546 - root - INFO - Training optimizer: adam
2020-05-31 08:03:24,547 - root - INFO - Training learning rate: 0.0001
2020-05-31 08:03:24,547 - root - INFO - Training epochs: 150
2020-05-31 08:03:24,547 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 08:03:24,548 - root - INFO - Training batch size: 200
2020-05-31 08:03:24,548 - root - INFO - Training weight decay: 5e-07
2020-05-31 08:03:24,549 - root - INFO - Starting training...
2020-05-31 08:03:30,953 - root - INFO - | Epoch: 001/150 | Train Time: 6.374s | Train Loss: 0.447086 |
2020-05-31 08:03:33,121 - root - INFO - | Epoch: 002/150 | Train Time: 2.167s | Train Loss: 0.290801 |
2020-05-31 08:03:35,875 - root - INFO - | Epoch: 003/150 | Train Time: 2.754s | Train Loss: 0.238727 |
2020-05-31 08:03:38,958 - root - INFO - | Epoch: 004/150 | Train Time: 3.083s | Train Loss: 0.212485 |
2020-05-31 08:03:42,223 - root - INFO - | Epoch: 005/150 | Train Time: 3.264s | Train Loss: 0.194662 |
2020-05-31 08:03:44,520 - root - INFO - | Epoch: 006/150 | Train Time: 2.296s | Train Loss: 0.181997 |
2020-05-31 08:03:46,741 - root - INFO - | Epoch: 007/150 | Train Time: 2.220s | Train Loss: 0.172562 |
2020-05-31 08:03:48,733 - root - INFO - | Epoch: 008/150 | Train Time: 1.991s | Train Loss: 0.164138 |
2020-05-31 08:03:50,784 - root - INFO - | Epoch: 009/150 | Train Time: 2.051s | Train Loss: 0.156729 |
2020-05-31 08:03:53,362 - root - INFO - | Epoch: 010/150 | Train Time: 2.577s | Train Loss: 0.150840 |
2020-05-31 08:03:55,961 - root - INFO - | Epoch: 011/150 | Train Time: 2.598s | Train Loss: 0.145365 |
2020-05-31 08:03:58,054 - root - INFO - | Epoch: 012/150 | Train Time: 2.093s | Train Loss: 0.141254 |
2020-05-31 08:04:00,349 - root - INFO - | Epoch: 013/150 | Train Time: 2.293s | Train Loss: 0.136749 |
2020-05-31 08:04:02,595 - root - INFO - | Epoch: 014/150 | Train Time: 2.246s | Train Loss: 0.132582 |
2020-05-31 08:04:04,859 - root - INFO - | Epoch: 015/150 | Train Time: 2.264s | Train Loss: 0.129854 |
2020-05-31 08:04:07,656 - root - INFO - | Epoch: 016/150 | Train Time: 2.796s | Train Loss: 0.125410 |
2020-05-31 08:04:10,175 - root - INFO - | Epoch: 017/150 | Train Time: 2.518s | Train Loss: 0.123534 |
2020-05-31 08:04:12,988 - root - INFO - | Epoch: 018/150 | Train Time: 2.813s | Train Loss: 0.120741 |
2020-05-31 08:04:15,692 - root - INFO - | Epoch: 019/150 | Train Time: 2.703s | Train Loss: 0.118253 |
2020-05-31 08:04:18,640 - root - INFO - | Epoch: 020/150 | Train Time: 2.948s | Train Loss: 0.115556 |
2020-05-31 08:04:21,379 - root - INFO - | Epoch: 021/150 | Train Time: 2.738s | Train Loss: 0.113860 |
2020-05-31 08:04:24,147 - root - INFO - | Epoch: 022/150 | Train Time: 2.767s | Train Loss: 0.112512 |
2020-05-31 08:04:27,119 - root - INFO - | Epoch: 023/150 | Train Time: 2.971s | Train Loss: 0.109914 |
2020-05-31 08:04:29,929 - root - INFO - | Epoch: 024/150 | Train Time: 2.809s | Train Loss: 0.108179 |
2020-05-31 08:04:32,588 - root - INFO - | Epoch: 025/150 | Train Time: 2.659s | Train Loss: 0.107495 |
2020-05-31 08:04:35,512 - root - INFO - | Epoch: 026/150 | Train Time: 2.922s | Train Loss: 0.104961 |
2020-05-31 08:04:38,792 - root - INFO - | Epoch: 027/150 | Train Time: 3.279s | Train Loss: 0.104626 |
2020-05-31 08:04:41,282 - root - INFO - | Epoch: 028/150 | Train Time: 2.489s | Train Loss: 0.103001 |
2020-05-31 08:04:44,163 - root - INFO - | Epoch: 029/150 | Train Time: 2.880s | Train Loss: 0.100963 |
2020-05-31 08:04:47,065 - root - INFO - | Epoch: 030/150 | Train Time: 2.902s | Train Loss: 0.100519 |
2020-05-31 08:04:49,731 - root - INFO - | Epoch: 031/150 | Train Time: 2.666s | Train Loss: 0.098883 |
2020-05-31 08:04:52,731 - root - INFO - | Epoch: 032/150 | Train Time: 2.999s | Train Loss: 0.098269 |
2020-05-31 08:04:55,731 - root - INFO - | Epoch: 033/150 | Train Time: 2.999s | Train Loss: 0.097166 |
2020-05-31 08:04:58,677 - root - INFO - | Epoch: 034/150 | Train Time: 2.946s | Train Loss: 0.095501 |
2020-05-31 08:05:01,416 - root - INFO - | Epoch: 035/150 | Train Time: 2.738s | Train Loss: 0.095975 |
2020-05-31 08:05:04,339 - root - INFO - | Epoch: 036/150 | Train Time: 2.922s | Train Loss: 0.093599 |
2020-05-31 08:05:06,997 - root - INFO - | Epoch: 037/150 | Train Time: 2.657s | Train Loss: 0.093836 |
2020-05-31 08:05:09,612 - root - INFO - | Epoch: 038/150 | Train Time: 2.615s | Train Loss: 0.092195 |
2020-05-31 08:05:12,379 - root - INFO - | Epoch: 039/150 | Train Time: 2.766s | Train Loss: 0.092256 |
2020-05-31 08:05:15,228 - root - INFO - | Epoch: 040/150 | Train Time: 2.848s | Train Loss: 0.091507 |
2020-05-31 08:05:17,377 - root - INFO - | Epoch: 041/150 | Train Time: 2.149s | Train Loss: 0.090749 |
2020-05-31 08:05:19,736 - root - INFO - | Epoch: 042/150 | Train Time: 2.358s | Train Loss: 0.089636 |
2020-05-31 08:05:21,698 - root - INFO - | Epoch: 043/150 | Train Time: 1.962s | Train Loss: 0.089139 |
2020-05-31 08:05:24,044 - root - INFO - | Epoch: 044/150 | Train Time: 2.345s | Train Loss: 0.088629 |
2020-05-31 08:05:27,813 - root - INFO - | Epoch: 045/150 | Train Time: 3.768s | Train Loss: 0.088791 |
2020-05-31 08:05:30,416 - root - INFO - | Epoch: 046/150 | Train Time: 2.593s | Train Loss: 0.088027 |
2020-05-31 08:05:32,913 - root - INFO - | Epoch: 047/150 | Train Time: 2.496s | Train Loss: 0.088165 |
2020-05-31 08:05:36,151 - root - INFO - | Epoch: 048/150 | Train Time: 3.237s | Train Loss: 0.087391 |
2020-05-31 08:05:39,029 - root - INFO - | Epoch: 049/150 | Train Time: 2.877s | Train Loss: 0.085949 |
2020-05-31 08:05:41,751 - root - INFO - | Epoch: 050/150 | Train Time: 2.721s | Train Loss: 0.085873 |
2020-05-31 08:05:41,751 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 08:05:44,551 - root - INFO - | Epoch: 051/150 | Train Time: 2.800s | Train Loss: 0.085295 |
2020-05-31 08:05:46,864 - root - INFO - | Epoch: 052/150 | Train Time: 2.312s | Train Loss: 0.086653 |
2020-05-31 08:05:48,837 - root - INFO - | Epoch: 053/150 | Train Time: 1.972s | Train Loss: 0.085156 |
2020-05-31 08:05:51,070 - root - INFO - | Epoch: 054/150 | Train Time: 2.232s | Train Loss: 0.086498 |
2020-05-31 08:05:53,537 - root - INFO - | Epoch: 055/150 | Train Time: 2.467s | Train Loss: 0.086323 |
2020-05-31 08:05:55,696 - root - INFO - | Epoch: 056/150 | Train Time: 2.159s | Train Loss: 0.085746 |
2020-05-31 08:05:57,828 - root - INFO - | Epoch: 057/150 | Train Time: 2.132s | Train Loss: 0.084703 |
2020-05-31 08:06:00,259 - root - INFO - | Epoch: 058/150 | Train Time: 2.430s | Train Loss: 0.085855 |
2020-05-31 08:06:02,378 - root - INFO - | Epoch: 059/150 | Train Time: 2.118s | Train Loss: 0.085916 |
2020-05-31 08:06:04,552 - root - INFO - | Epoch: 060/150 | Train Time: 2.174s | Train Loss: 0.084671 |
2020-05-31 08:06:06,562 - root - INFO - | Epoch: 061/150 | Train Time: 2.009s | Train Loss: 0.084968 |
2020-05-31 08:06:09,009 - root - INFO - | Epoch: 062/150 | Train Time: 2.447s | Train Loss: 0.085293 |
2020-05-31 08:06:11,243 - root - INFO - | Epoch: 063/150 | Train Time: 2.233s | Train Loss: 0.085242 |
2020-05-31 08:06:13,676 - root - INFO - | Epoch: 064/150 | Train Time: 2.433s | Train Loss: 0.085543 |
2020-05-31 08:06:16,144 - root - INFO - | Epoch: 065/150 | Train Time: 2.466s | Train Loss: 0.085097 |
2020-05-31 08:06:18,544 - root - INFO - | Epoch: 066/150 | Train Time: 2.400s | Train Loss: 0.084818 |
2020-05-31 08:06:20,958 - root - INFO - | Epoch: 067/150 | Train Time: 2.414s | Train Loss: 0.085592 |
2020-05-31 08:06:23,501 - root - INFO - | Epoch: 068/150 | Train Time: 2.542s | Train Loss: 0.085346 |
2020-05-31 08:06:26,394 - root - INFO - | Epoch: 069/150 | Train Time: 2.892s | Train Loss: 0.085676 |
2020-05-31 08:06:28,990 - root - INFO - | Epoch: 070/150 | Train Time: 2.595s | Train Loss: 0.085790 |
2020-05-31 08:06:31,171 - root - INFO - | Epoch: 071/150 | Train Time: 2.180s | Train Loss: 0.085911 |
2020-05-31 08:06:34,127 - root - INFO - | Epoch: 072/150 | Train Time: 2.956s | Train Loss: 0.084872 |
2020-05-31 08:06:36,561 - root - INFO - | Epoch: 073/150 | Train Time: 2.434s | Train Loss: 0.085624 |
2020-05-31 08:06:39,238 - root - INFO - | Epoch: 074/150 | Train Time: 2.676s | Train Loss: 0.084821 |
2020-05-31 08:06:42,419 - root - INFO - | Epoch: 075/150 | Train Time: 3.180s | Train Loss: 0.084501 |
2020-05-31 08:06:45,266 - root - INFO - | Epoch: 076/150 | Train Time: 2.846s | Train Loss: 0.085434 |
2020-05-31 08:06:47,663 - root - INFO - | Epoch: 077/150 | Train Time: 2.396s | Train Loss: 0.084673 |
2020-05-31 08:06:50,213 - root - INFO - | Epoch: 078/150 | Train Time: 2.549s | Train Loss: 0.084382 |
2020-05-31 08:06:52,683 - root - INFO - | Epoch: 079/150 | Train Time: 2.470s | Train Loss: 0.084156 |
2020-05-31 08:06:55,097 - root - INFO - | Epoch: 080/150 | Train Time: 2.413s | Train Loss: 0.084881 |
2020-05-31 08:06:57,907 - root - INFO - | Epoch: 081/150 | Train Time: 2.810s | Train Loss: 0.084807 |
2020-05-31 08:07:00,584 - root - INFO - | Epoch: 082/150 | Train Time: 2.677s | Train Loss: 0.084718 |
2020-05-31 08:07:02,948 - root - INFO - | Epoch: 083/150 | Train Time: 2.363s | Train Loss: 0.084712 |
2020-05-31 08:07:05,200 - root - INFO - | Epoch: 084/150 | Train Time: 2.252s | Train Loss: 0.084417 |
2020-05-31 08:07:07,387 - root - INFO - | Epoch: 085/150 | Train Time: 2.187s | Train Loss: 0.085132 |
2020-05-31 08:07:09,750 - root - INFO - | Epoch: 086/150 | Train Time: 2.362s | Train Loss: 0.084561 |
2020-05-31 08:07:11,994 - root - INFO - | Epoch: 087/150 | Train Time: 2.244s | Train Loss: 0.083253 |
2020-05-31 08:07:14,446 - root - INFO - | Epoch: 088/150 | Train Time: 2.451s | Train Loss: 0.083779 |
2020-05-31 08:07:16,727 - root - INFO - | Epoch: 089/150 | Train Time: 2.280s | Train Loss: 0.083924 |
2020-05-31 08:07:18,976 - root - INFO - | Epoch: 090/150 | Train Time: 2.249s | Train Loss: 0.083687 |
2020-05-31 08:07:21,610 - root - INFO - | Epoch: 091/150 | Train Time: 2.633s | Train Loss: 0.084244 |
2020-05-31 08:07:23,609 - root - INFO - | Epoch: 092/150 | Train Time: 1.999s | Train Loss: 0.083540 |
2020-05-31 08:07:26,207 - root - INFO - | Epoch: 093/150 | Train Time: 2.597s | Train Loss: 0.084258 |
2020-05-31 08:07:28,976 - root - INFO - | Epoch: 094/150 | Train Time: 2.769s | Train Loss: 0.083701 |
2020-05-31 08:07:31,697 - root - INFO - | Epoch: 095/150 | Train Time: 2.720s | Train Loss: 0.083949 |
2020-05-31 08:07:34,219 - root - INFO - | Epoch: 096/150 | Train Time: 2.522s | Train Loss: 0.083714 |
2020-05-31 08:07:36,962 - root - INFO - | Epoch: 097/150 | Train Time: 2.742s | Train Loss: 0.084401 |
2020-05-31 08:07:39,948 - root - INFO - | Epoch: 098/150 | Train Time: 2.985s | Train Loss: 0.083402 |
2020-05-31 08:07:42,343 - root - INFO - | Epoch: 099/150 | Train Time: 2.395s | Train Loss: 0.083666 |
2020-05-31 08:07:44,610 - root - INFO - | Epoch: 100/150 | Train Time: 2.266s | Train Loss: 0.083701 |
2020-05-31 08:07:47,339 - root - INFO - | Epoch: 101/150 | Train Time: 2.728s | Train Loss: 0.083406 |
2020-05-31 08:07:50,259 - root - INFO - | Epoch: 102/150 | Train Time: 2.919s | Train Loss: 0.083576 |
2020-05-31 08:07:53,005 - root - INFO - | Epoch: 103/150 | Train Time: 2.746s | Train Loss: 0.083455 |
2020-05-31 08:07:55,579 - root - INFO - | Epoch: 104/150 | Train Time: 2.574s | Train Loss: 0.084016 |
2020-05-31 08:07:58,601 - root - INFO - | Epoch: 105/150 | Train Time: 3.021s | Train Loss: 0.083694 |
2020-05-31 08:08:02,071 - root - INFO - | Epoch: 106/150 | Train Time: 3.469s | Train Loss: 0.083323 |
2020-05-31 08:08:05,196 - root - INFO - | Epoch: 107/150 | Train Time: 3.125s | Train Loss: 0.082974 |
2020-05-31 08:08:08,052 - root - INFO - | Epoch: 108/150 | Train Time: 2.855s | Train Loss: 0.082947 |
2020-05-31 08:08:11,003 - root - INFO - | Epoch: 109/150 | Train Time: 2.951s | Train Loss: 0.082752 |
2020-05-31 08:08:13,534 - root - INFO - | Epoch: 110/150 | Train Time: 2.530s | Train Loss: 0.082294 |
2020-05-31 08:08:15,925 - root - INFO - | Epoch: 111/150 | Train Time: 2.390s | Train Loss: 0.083350 |
2020-05-31 08:08:18,031 - root - INFO - | Epoch: 112/150 | Train Time: 2.106s | Train Loss: 0.083649 |
2020-05-31 08:08:20,200 - root - INFO - | Epoch: 113/150 | Train Time: 2.169s | Train Loss: 0.082488 |
2020-05-31 08:08:22,210 - root - INFO - | Epoch: 114/150 | Train Time: 2.009s | Train Loss: 0.082562 |
2020-05-31 08:08:24,838 - root - INFO - | Epoch: 115/150 | Train Time: 2.627s | Train Loss: 0.083339 |
2020-05-31 08:08:26,898 - root - INFO - | Epoch: 116/150 | Train Time: 2.059s | Train Loss: 0.082812 |
2020-05-31 08:08:29,247 - root - INFO - | Epoch: 117/150 | Train Time: 2.349s | Train Loss: 0.083104 |
2020-05-31 08:08:31,521 - root - INFO - | Epoch: 118/150 | Train Time: 2.273s | Train Loss: 0.082794 |
2020-05-31 08:08:33,869 - root - INFO - | Epoch: 119/150 | Train Time: 2.348s | Train Loss: 0.082945 |
2020-05-31 08:08:36,365 - root - INFO - | Epoch: 120/150 | Train Time: 2.495s | Train Loss: 0.082739 |
2020-05-31 08:08:38,984 - root - INFO - | Epoch: 121/150 | Train Time: 2.619s | Train Loss: 0.082336 |
2020-05-31 08:08:42,053 - root - INFO - | Epoch: 122/150 | Train Time: 3.068s | Train Loss: 0.082957 |
2020-05-31 08:08:44,916 - root - INFO - | Epoch: 123/150 | Train Time: 2.862s | Train Loss: 0.082718 |
2020-05-31 08:08:47,807 - root - INFO - | Epoch: 124/150 | Train Time: 2.891s | Train Loss: 0.082885 |
2020-05-31 08:08:51,079 - root - INFO - | Epoch: 125/150 | Train Time: 3.271s | Train Loss: 0.082617 |
2020-05-31 08:08:53,647 - root - INFO - | Epoch: 126/150 | Train Time: 2.568s | Train Loss: 0.082374 |
2020-05-31 08:08:56,509 - root - INFO - | Epoch: 127/150 | Train Time: 2.860s | Train Loss: 0.081086 |
2020-05-31 08:08:59,052 - root - INFO - | Epoch: 128/150 | Train Time: 2.542s | Train Loss: 0.082902 |
2020-05-31 08:09:01,245 - root - INFO - | Epoch: 129/150 | Train Time: 2.184s | Train Loss: 0.082592 |
2020-05-31 08:09:03,407 - root - INFO - | Epoch: 130/150 | Train Time: 2.162s | Train Loss: 0.082220 |
2020-05-31 08:09:05,713 - root - INFO - | Epoch: 131/150 | Train Time: 2.305s | Train Loss: 0.082401 |
2020-05-31 08:09:08,057 - root - INFO - | Epoch: 132/150 | Train Time: 2.343s | Train Loss: 0.082107 |
2020-05-31 08:09:10,285 - root - INFO - | Epoch: 133/150 | Train Time: 2.227s | Train Loss: 0.082148 |
2020-05-31 08:09:12,475 - root - INFO - | Epoch: 134/150 | Train Time: 2.189s | Train Loss: 0.082208 |
2020-05-31 08:09:14,899 - root - INFO - | Epoch: 135/150 | Train Time: 2.424s | Train Loss: 0.082462 |
2020-05-31 08:09:17,212 - root - INFO - | Epoch: 136/150 | Train Time: 2.313s | Train Loss: 0.081916 |
2020-05-31 08:09:20,045 - root - INFO - | Epoch: 137/150 | Train Time: 2.832s | Train Loss: 0.082187 |
2020-05-31 08:09:22,981 - root - INFO - | Epoch: 138/150 | Train Time: 2.936s | Train Loss: 0.082396 |
2020-05-31 08:09:25,984 - root - INFO - | Epoch: 139/150 | Train Time: 3.003s | Train Loss: 0.081937 |
2020-05-31 08:09:28,687 - root - INFO - | Epoch: 140/150 | Train Time: 2.701s | Train Loss: 0.082364 |
2020-05-31 08:09:31,479 - root - INFO - | Epoch: 141/150 | Train Time: 2.791s | Train Loss: 0.081566 |
2020-05-31 08:09:34,328 - root - INFO - | Epoch: 142/150 | Train Time: 2.849s | Train Loss: 0.082036 |
2020-05-31 08:09:37,271 - root - INFO - | Epoch: 143/150 | Train Time: 2.942s | Train Loss: 0.082154 |
2020-05-31 08:09:39,879 - root - INFO - | Epoch: 144/150 | Train Time: 2.607s | Train Loss: 0.081578 |
2020-05-31 08:09:42,484 - root - INFO - | Epoch: 145/150 | Train Time: 2.605s | Train Loss: 0.081359 |
2020-05-31 08:09:46,286 - root - INFO - | Epoch: 146/150 | Train Time: 3.801s | Train Loss: 0.081335 |
2020-05-31 08:09:49,343 - root - INFO - | Epoch: 147/150 | Train Time: 3.057s | Train Loss: 0.081114 |
2020-05-31 08:09:52,207 - root - INFO - | Epoch: 148/150 | Train Time: 2.864s | Train Loss: 0.082123 |
2020-05-31 08:09:54,822 - root - INFO - | Epoch: 149/150 | Train Time: 2.614s | Train Loss: 0.082038 |
2020-05-31 08:09:57,407 - root - INFO - | Epoch: 150/150 | Train Time: 2.585s | Train Loss: 0.081683 |
2020-05-31 08:09:57,408 - root - INFO - Training Time: 392.855s
2020-05-31 08:09:57,408 - root - INFO - Finished training.
2020-05-31 08:09:57,409 - root - INFO - Starting testing...
2020-05-31 08:10:00,129 - root - INFO - Test Loss: 0.441559
2020-05-31 08:10:00,129 - root - INFO - Test AUC: 94.11%
2020-05-31 08:10:00,129 - root - INFO - Test Time: 2.706s
2020-05-31 08:10:00,129 - root - INFO - Finished testing.
