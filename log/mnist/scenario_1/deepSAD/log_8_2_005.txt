2020-05-31 10:18:56,691 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_8_2_005.txt
2020-05-31 10:18:56,691 - root - INFO - Data path is ../data
2020-05-31 10:18:56,691 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 10:18:56,692 - root - INFO - Dataset: mnist
2020-05-31 10:18:56,692 - root - INFO - Normal class: 8
2020-05-31 10:18:56,692 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 10:18:56,692 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-31 10:18:56,692 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 10:18:56,692 - root - INFO - Scenario Running: 1
2020-05-31 10:18:56,692 - root - INFO - Train only the network: True
2020-05-31 10:18:56,692 - root - INFO - Output and AE dimensions: 128
2020-05-31 10:18:56,692 - root - INFO - Known anomaly class: 2
2020-05-31 10:18:56,692 - root - INFO - Network: mnist_LeNet
2020-05-31 10:18:56,692 - root - INFO - Eta-parameter: 1.00
2020-05-31 10:18:56,782 - root - INFO - Set seed to 0.
2020-05-31 10:18:56,853 - root - INFO - Computation device: cuda
2020-05-31 10:18:56,854 - root - INFO - Number of threads: 0
2020-05-31 10:18:56,854 - root - INFO - Number of dataloader workers: 6
2020-05-31 10:19:04,431 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 10:19:04,434 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 10:19:04,435 - root - INFO - Training optimizer: adam
2020-05-31 10:19:04,435 - root - INFO - Training learning rate: 0.0001
2020-05-31 10:19:04,435 - root - INFO - Training epochs: 150
2020-05-31 10:19:04,436 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 10:19:04,436 - root - INFO - Training batch size: 200
2020-05-31 10:19:04,436 - root - INFO - Training weight decay: 5e-07
2020-05-31 10:19:04,438 - root - INFO - Starting training...
2020-05-31 10:19:12,319 - root - INFO - | Epoch: 001/150 | Train Time: 7.875s | Train Loss: 0.401635 |
2020-05-31 10:19:14,935 - root - INFO - | Epoch: 002/150 | Train Time: 2.615s | Train Loss: 0.302454 |
2020-05-31 10:19:17,945 - root - INFO - | Epoch: 003/150 | Train Time: 3.009s | Train Loss: 0.257138 |
2020-05-31 10:19:20,649 - root - INFO - | Epoch: 004/150 | Train Time: 2.704s | Train Loss: 0.229559 |
2020-05-31 10:19:23,638 - root - INFO - | Epoch: 005/150 | Train Time: 2.988s | Train Loss: 0.210552 |
2020-05-31 10:19:26,231 - root - INFO - | Epoch: 006/150 | Train Time: 2.593s | Train Loss: 0.198027 |
2020-05-31 10:19:28,570 - root - INFO - | Epoch: 007/150 | Train Time: 2.338s | Train Loss: 0.188392 |
2020-05-31 10:19:30,942 - root - INFO - | Epoch: 008/150 | Train Time: 2.372s | Train Loss: 0.181076 |
2020-05-31 10:19:32,918 - root - INFO - | Epoch: 009/150 | Train Time: 1.976s | Train Loss: 0.176282 |
2020-05-31 10:19:35,218 - root - INFO - | Epoch: 010/150 | Train Time: 2.299s | Train Loss: 0.168602 |
2020-05-31 10:19:37,540 - root - INFO - | Epoch: 011/150 | Train Time: 2.322s | Train Loss: 0.164764 |
2020-05-31 10:19:39,875 - root - INFO - | Epoch: 012/150 | Train Time: 2.334s | Train Loss: 0.161079 |
2020-05-31 10:19:42,217 - root - INFO - | Epoch: 013/150 | Train Time: 2.341s | Train Loss: 0.157067 |
2020-05-31 10:19:44,759 - root - INFO - | Epoch: 014/150 | Train Time: 2.542s | Train Loss: 0.154098 |
2020-05-31 10:19:47,355 - root - INFO - | Epoch: 015/150 | Train Time: 2.596s | Train Loss: 0.150070 |
2020-05-31 10:19:49,781 - root - INFO - | Epoch: 016/150 | Train Time: 2.425s | Train Loss: 0.148159 |
2020-05-31 10:19:52,200 - root - INFO - | Epoch: 017/150 | Train Time: 2.419s | Train Loss: 0.144968 |
2020-05-31 10:19:54,778 - root - INFO - | Epoch: 018/150 | Train Time: 2.577s | Train Loss: 0.141738 |
2020-05-31 10:19:57,429 - root - INFO - | Epoch: 019/150 | Train Time: 2.650s | Train Loss: 0.139648 |
2020-05-31 10:20:00,011 - root - INFO - | Epoch: 020/150 | Train Time: 2.581s | Train Loss: 0.136271 |
2020-05-31 10:20:02,971 - root - INFO - | Epoch: 021/150 | Train Time: 2.959s | Train Loss: 0.134606 |
2020-05-31 10:20:05,934 - root - INFO - | Epoch: 022/150 | Train Time: 2.963s | Train Loss: 0.132561 |
2020-05-31 10:20:08,669 - root - INFO - | Epoch: 023/150 | Train Time: 2.734s | Train Loss: 0.130648 |
2020-05-31 10:20:11,456 - root - INFO - | Epoch: 024/150 | Train Time: 2.786s | Train Loss: 0.128339 |
2020-05-31 10:20:13,977 - root - INFO - | Epoch: 025/150 | Train Time: 2.520s | Train Loss: 0.126924 |
2020-05-31 10:20:16,709 - root - INFO - | Epoch: 026/150 | Train Time: 2.731s | Train Loss: 0.125085 |
2020-05-31 10:20:18,925 - root - INFO - | Epoch: 027/150 | Train Time: 2.215s | Train Loss: 0.123102 |
2020-05-31 10:20:20,930 - root - INFO - | Epoch: 028/150 | Train Time: 2.005s | Train Loss: 0.120958 |
2020-05-31 10:20:23,154 - root - INFO - | Epoch: 029/150 | Train Time: 2.223s | Train Loss: 0.120226 |
2020-05-31 10:20:25,720 - root - INFO - | Epoch: 030/150 | Train Time: 2.565s | Train Loss: 0.118869 |
2020-05-31 10:20:27,941 - root - INFO - | Epoch: 031/150 | Train Time: 2.220s | Train Loss: 0.116555 |
2020-05-31 10:20:30,541 - root - INFO - | Epoch: 032/150 | Train Time: 2.600s | Train Loss: 0.115631 |
2020-05-31 10:20:33,172 - root - INFO - | Epoch: 033/150 | Train Time: 2.631s | Train Loss: 0.114935 |
2020-05-31 10:20:35,976 - root - INFO - | Epoch: 034/150 | Train Time: 2.803s | Train Loss: 0.112708 |
2020-05-31 10:20:38,547 - root - INFO - | Epoch: 035/150 | Train Time: 2.571s | Train Loss: 0.111127 |
2020-05-31 10:20:40,866 - root - INFO - | Epoch: 036/150 | Train Time: 2.318s | Train Loss: 0.110191 |
2020-05-31 10:20:43,136 - root - INFO - | Epoch: 037/150 | Train Time: 2.270s | Train Loss: 0.109354 |
2020-05-31 10:20:45,350 - root - INFO - | Epoch: 038/150 | Train Time: 2.213s | Train Loss: 0.108143 |
2020-05-31 10:20:47,629 - root - INFO - | Epoch: 039/150 | Train Time: 2.279s | Train Loss: 0.106658 |
2020-05-31 10:20:50,233 - root - INFO - | Epoch: 040/150 | Train Time: 2.603s | Train Loss: 0.105176 |
2020-05-31 10:20:52,659 - root - INFO - | Epoch: 041/150 | Train Time: 2.425s | Train Loss: 0.104117 |
2020-05-31 10:20:55,165 - root - INFO - | Epoch: 042/150 | Train Time: 2.506s | Train Loss: 0.102638 |
2020-05-31 10:20:57,557 - root - INFO - | Epoch: 043/150 | Train Time: 2.391s | Train Loss: 0.101937 |
2020-05-31 10:21:00,209 - root - INFO - | Epoch: 044/150 | Train Time: 2.651s | Train Loss: 0.101567 |
2020-05-31 10:21:02,871 - root - INFO - | Epoch: 045/150 | Train Time: 2.661s | Train Loss: 0.099773 |
2020-05-31 10:21:05,506 - root - INFO - | Epoch: 046/150 | Train Time: 2.635s | Train Loss: 0.099643 |
2020-05-31 10:21:08,413 - root - INFO - | Epoch: 047/150 | Train Time: 2.906s | Train Loss: 0.098348 |
2020-05-31 10:21:11,336 - root - INFO - | Epoch: 048/150 | Train Time: 2.923s | Train Loss: 0.097062 |
2020-05-31 10:21:14,093 - root - INFO - | Epoch: 049/150 | Train Time: 2.757s | Train Loss: 0.096207 |
2020-05-31 10:21:16,629 - root - INFO - | Epoch: 050/150 | Train Time: 2.535s | Train Loss: 0.095508 |
2020-05-31 10:21:16,630 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 10:21:19,402 - root - INFO - | Epoch: 051/150 | Train Time: 2.771s | Train Loss: 0.094610 |
2020-05-31 10:21:22,198 - root - INFO - | Epoch: 052/150 | Train Time: 2.796s | Train Loss: 0.094585 |
2020-05-31 10:21:25,013 - root - INFO - | Epoch: 053/150 | Train Time: 2.814s | Train Loss: 0.094908 |
2020-05-31 10:21:27,868 - root - INFO - | Epoch: 054/150 | Train Time: 2.855s | Train Loss: 0.094564 |
2020-05-31 10:21:31,030 - root - INFO - | Epoch: 055/150 | Train Time: 3.161s | Train Loss: 0.094595 |
2020-05-31 10:21:33,639 - root - INFO - | Epoch: 056/150 | Train Time: 2.609s | Train Loss: 0.094587 |
2020-05-31 10:21:36,093 - root - INFO - | Epoch: 057/150 | Train Time: 2.453s | Train Loss: 0.093912 |
2020-05-31 10:21:38,982 - root - INFO - | Epoch: 058/150 | Train Time: 2.889s | Train Loss: 0.093866 |
2020-05-31 10:21:42,152 - root - INFO - | Epoch: 059/150 | Train Time: 3.169s | Train Loss: 0.094253 |
2020-05-31 10:21:45,107 - root - INFO - | Epoch: 060/150 | Train Time: 2.954s | Train Loss: 0.093915 |
2020-05-31 10:21:48,521 - root - INFO - | Epoch: 061/150 | Train Time: 3.414s | Train Loss: 0.094556 |
2020-05-31 10:21:51,492 - root - INFO - | Epoch: 062/150 | Train Time: 2.969s | Train Loss: 0.094046 |
2020-05-31 10:21:54,485 - root - INFO - | Epoch: 063/150 | Train Time: 2.992s | Train Loss: 0.093469 |
2020-05-31 10:21:57,426 - root - INFO - | Epoch: 064/150 | Train Time: 2.941s | Train Loss: 0.093507 |
2020-05-31 10:22:00,677 - root - INFO - | Epoch: 065/150 | Train Time: 3.250s | Train Loss: 0.094021 |
2020-05-31 10:22:03,037 - root - INFO - | Epoch: 066/150 | Train Time: 2.360s | Train Loss: 0.093974 |
2020-05-31 10:22:05,568 - root - INFO - | Epoch: 067/150 | Train Time: 2.531s | Train Loss: 0.093214 |
2020-05-31 10:22:07,437 - root - INFO - | Epoch: 068/150 | Train Time: 1.869s | Train Loss: 0.093873 |
2020-05-31 10:22:09,884 - root - INFO - | Epoch: 069/150 | Train Time: 2.447s | Train Loss: 0.093840 |
2020-05-31 10:22:11,459 - root - INFO - | Epoch: 070/150 | Train Time: 1.574s | Train Loss: 0.093013 |
2020-05-31 10:22:13,953 - root - INFO - | Epoch: 071/150 | Train Time: 2.493s | Train Loss: 0.093515 |
2020-05-31 10:22:16,262 - root - INFO - | Epoch: 072/150 | Train Time: 2.308s | Train Loss: 0.092722 |
2020-05-31 10:22:18,549 - root - INFO - | Epoch: 073/150 | Train Time: 2.287s | Train Loss: 0.093280 |
2020-05-31 10:22:20,914 - root - INFO - | Epoch: 074/150 | Train Time: 2.364s | Train Loss: 0.092742 |
2020-05-31 10:22:23,200 - root - INFO - | Epoch: 075/150 | Train Time: 2.285s | Train Loss: 0.092361 |
2020-05-31 10:22:25,845 - root - INFO - | Epoch: 076/150 | Train Time: 2.644s | Train Loss: 0.092900 |
2020-05-31 10:22:28,176 - root - INFO - | Epoch: 077/150 | Train Time: 2.330s | Train Loss: 0.092697 |
2020-05-31 10:22:30,555 - root - INFO - | Epoch: 078/150 | Train Time: 2.378s | Train Loss: 0.092966 |
2020-05-31 10:22:33,198 - root - INFO - | Epoch: 079/150 | Train Time: 2.643s | Train Loss: 0.091948 |
2020-05-31 10:22:36,057 - root - INFO - | Epoch: 080/150 | Train Time: 2.859s | Train Loss: 0.092461 |
2020-05-31 10:22:38,381 - root - INFO - | Epoch: 081/150 | Train Time: 2.324s | Train Loss: 0.092264 |
2020-05-31 10:22:40,719 - root - INFO - | Epoch: 082/150 | Train Time: 2.337s | Train Loss: 0.092524 |
2020-05-31 10:22:43,187 - root - INFO - | Epoch: 083/150 | Train Time: 2.467s | Train Loss: 0.092120 |
2020-05-31 10:22:45,794 - root - INFO - | Epoch: 084/150 | Train Time: 2.595s | Train Loss: 0.091970 |
2020-05-31 10:22:48,577 - root - INFO - | Epoch: 085/150 | Train Time: 2.782s | Train Loss: 0.092113 |
2020-05-31 10:22:51,010 - root - INFO - | Epoch: 086/150 | Train Time: 2.432s | Train Loss: 0.092129 |
2020-05-31 10:22:53,526 - root - INFO - | Epoch: 087/150 | Train Time: 2.516s | Train Loss: 0.091998 |
2020-05-31 10:22:55,318 - root - INFO - | Epoch: 088/150 | Train Time: 1.791s | Train Loss: 0.091722 |
2020-05-31 10:22:57,334 - root - INFO - | Epoch: 089/150 | Train Time: 2.015s | Train Loss: 0.091992 |
2020-05-31 10:22:59,727 - root - INFO - | Epoch: 090/150 | Train Time: 2.392s | Train Loss: 0.091974 |
2020-05-31 10:23:02,467 - root - INFO - | Epoch: 091/150 | Train Time: 2.739s | Train Loss: 0.091694 |
2020-05-31 10:23:05,373 - root - INFO - | Epoch: 092/150 | Train Time: 2.906s | Train Loss: 0.091599 |
2020-05-31 10:23:07,643 - root - INFO - | Epoch: 093/150 | Train Time: 2.270s | Train Loss: 0.091294 |
2020-05-31 10:23:10,112 - root - INFO - | Epoch: 094/150 | Train Time: 2.468s | Train Loss: 0.091609 |
2020-05-31 10:23:12,628 - root - INFO - | Epoch: 095/150 | Train Time: 2.516s | Train Loss: 0.091286 |
2020-05-31 10:23:15,011 - root - INFO - | Epoch: 096/150 | Train Time: 2.382s | Train Loss: 0.091153 |
2020-05-31 10:23:17,324 - root - INFO - | Epoch: 097/150 | Train Time: 2.312s | Train Loss: 0.091361 |
2020-05-31 10:23:20,087 - root - INFO - | Epoch: 098/150 | Train Time: 2.762s | Train Loss: 0.090614 |
2020-05-31 10:23:22,544 - root - INFO - | Epoch: 099/150 | Train Time: 2.456s | Train Loss: 0.090736 |
2020-05-31 10:23:25,264 - root - INFO - | Epoch: 100/150 | Train Time: 2.720s | Train Loss: 0.090756 |
2020-05-31 10:23:27,418 - root - INFO - | Epoch: 101/150 | Train Time: 2.153s | Train Loss: 0.090375 |
2020-05-31 10:23:29,927 - root - INFO - | Epoch: 102/150 | Train Time: 2.509s | Train Loss: 0.090301 |
2020-05-31 10:23:32,493 - root - INFO - | Epoch: 103/150 | Train Time: 2.565s | Train Loss: 0.090736 |
2020-05-31 10:23:34,951 - root - INFO - | Epoch: 104/150 | Train Time: 2.458s | Train Loss: 0.090626 |
2020-05-31 10:23:37,350 - root - INFO - | Epoch: 105/150 | Train Time: 2.398s | Train Loss: 0.090704 |
2020-05-31 10:23:39,523 - root - INFO - | Epoch: 106/150 | Train Time: 2.172s | Train Loss: 0.090189 |
2020-05-31 10:23:41,588 - root - INFO - | Epoch: 107/150 | Train Time: 2.065s | Train Loss: 0.090360 |
2020-05-31 10:23:43,620 - root - INFO - | Epoch: 108/150 | Train Time: 2.031s | Train Loss: 0.090155 |
2020-05-31 10:23:45,962 - root - INFO - | Epoch: 109/150 | Train Time: 2.341s | Train Loss: 0.090143 |
2020-05-31 10:23:48,160 - root - INFO - | Epoch: 110/150 | Train Time: 2.198s | Train Loss: 0.090273 |
2020-05-31 10:23:50,816 - root - INFO - | Epoch: 111/150 | Train Time: 2.655s | Train Loss: 0.089992 |
2020-05-31 10:23:53,788 - root - INFO - | Epoch: 112/150 | Train Time: 2.971s | Train Loss: 0.090099 |
2020-05-31 10:23:56,755 - root - INFO - | Epoch: 113/150 | Train Time: 2.965s | Train Loss: 0.089787 |
2020-05-31 10:23:59,673 - root - INFO - | Epoch: 114/150 | Train Time: 2.917s | Train Loss: 0.089684 |
2020-05-31 10:24:02,412 - root - INFO - | Epoch: 115/150 | Train Time: 2.739s | Train Loss: 0.089494 |
2020-05-31 10:24:04,781 - root - INFO - | Epoch: 116/150 | Train Time: 2.368s | Train Loss: 0.089401 |
2020-05-31 10:24:08,131 - root - INFO - | Epoch: 117/150 | Train Time: 3.349s | Train Loss: 0.089368 |
2020-05-31 10:24:10,619 - root - INFO - | Epoch: 118/150 | Train Time: 2.488s | Train Loss: 0.089141 |
2020-05-31 10:24:13,276 - root - INFO - | Epoch: 119/150 | Train Time: 2.656s | Train Loss: 0.089507 |
2020-05-31 10:24:16,011 - root - INFO - | Epoch: 120/150 | Train Time: 2.735s | Train Loss: 0.089595 |
2020-05-31 10:24:18,640 - root - INFO - | Epoch: 121/150 | Train Time: 2.628s | Train Loss: 0.088798 |
2020-05-31 10:24:20,734 - root - INFO - | Epoch: 122/150 | Train Time: 2.093s | Train Loss: 0.088847 |
2020-05-31 10:24:23,327 - root - INFO - | Epoch: 123/150 | Train Time: 2.593s | Train Loss: 0.088784 |
2020-05-31 10:24:25,893 - root - INFO - | Epoch: 124/150 | Train Time: 2.565s | Train Loss: 0.088706 |
2020-05-31 10:24:28,079 - root - INFO - | Epoch: 125/150 | Train Time: 2.186s | Train Loss: 0.089079 |
2020-05-31 10:24:29,894 - root - INFO - | Epoch: 126/150 | Train Time: 1.814s | Train Loss: 0.088386 |
2020-05-31 10:24:31,889 - root - INFO - | Epoch: 127/150 | Train Time: 1.994s | Train Loss: 0.088869 |
2020-05-31 10:24:33,802 - root - INFO - | Epoch: 128/150 | Train Time: 1.913s | Train Loss: 0.088055 |
2020-05-31 10:24:35,925 - root - INFO - | Epoch: 129/150 | Train Time: 2.122s | Train Loss: 0.088638 |
2020-05-31 10:24:37,877 - root - INFO - | Epoch: 130/150 | Train Time: 1.951s | Train Loss: 0.088230 |
2020-05-31 10:24:40,150 - root - INFO - | Epoch: 131/150 | Train Time: 2.273s | Train Loss: 0.088489 |
2020-05-31 10:24:42,689 - root - INFO - | Epoch: 132/150 | Train Time: 2.538s | Train Loss: 0.087890 |
2020-05-31 10:24:45,112 - root - INFO - | Epoch: 133/150 | Train Time: 2.422s | Train Loss: 0.088033 |
2020-05-31 10:24:47,579 - root - INFO - | Epoch: 134/150 | Train Time: 2.466s | Train Loss: 0.087907 |
2020-05-31 10:24:49,932 - root - INFO - | Epoch: 135/150 | Train Time: 2.353s | Train Loss: 0.088076 |
2020-05-31 10:24:52,461 - root - INFO - | Epoch: 136/150 | Train Time: 2.529s | Train Loss: 0.087805 |
2020-05-31 10:24:54,724 - root - INFO - | Epoch: 137/150 | Train Time: 2.263s | Train Loss: 0.087868 |
2020-05-31 10:24:57,104 - root - INFO - | Epoch: 138/150 | Train Time: 2.380s | Train Loss: 0.087906 |
2020-05-31 10:24:59,285 - root - INFO - | Epoch: 139/150 | Train Time: 2.180s | Train Loss: 0.087932 |
2020-05-31 10:25:02,080 - root - INFO - | Epoch: 140/150 | Train Time: 2.794s | Train Loss: 0.087528 |
2020-05-31 10:25:04,621 - root - INFO - | Epoch: 141/150 | Train Time: 2.541s | Train Loss: 0.087093 |
2020-05-31 10:25:07,640 - root - INFO - | Epoch: 142/150 | Train Time: 3.019s | Train Loss: 0.087687 |
2020-05-31 10:25:10,176 - root - INFO - | Epoch: 143/150 | Train Time: 2.535s | Train Loss: 0.086977 |
2020-05-31 10:25:12,554 - root - INFO - | Epoch: 144/150 | Train Time: 2.377s | Train Loss: 0.087473 |
2020-05-31 10:25:14,843 - root - INFO - | Epoch: 145/150 | Train Time: 2.289s | Train Loss: 0.086833 |
2020-05-31 10:25:17,694 - root - INFO - | Epoch: 146/150 | Train Time: 2.850s | Train Loss: 0.086755 |
2020-05-31 10:25:20,194 - root - INFO - | Epoch: 147/150 | Train Time: 2.500s | Train Loss: 0.087197 |
2020-05-31 10:25:22,639 - root - INFO - | Epoch: 148/150 | Train Time: 2.444s | Train Loss: 0.086658 |
2020-05-31 10:25:25,293 - root - INFO - | Epoch: 149/150 | Train Time: 2.654s | Train Loss: 0.087057 |
2020-05-31 10:25:27,694 - root - INFO - | Epoch: 150/150 | Train Time: 2.401s | Train Loss: 0.086882 |
2020-05-31 10:25:27,695 - root - INFO - Training Time: 383.255s
2020-05-31 10:25:27,695 - root - INFO - Finished training.
2020-05-31 10:25:27,696 - root - INFO - Starting testing...
2020-05-31 10:25:30,853 - root - INFO - Test Loss: 0.254676
2020-05-31 10:25:30,853 - root - INFO - Test AUC: 86.29%
2020-05-31 10:25:30,853 - root - INFO - Test Time: 3.142s
2020-05-31 10:25:30,853 - root - INFO - Finished testing.
