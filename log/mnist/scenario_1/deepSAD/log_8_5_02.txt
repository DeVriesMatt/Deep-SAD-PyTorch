2020-05-31 11:56:04,902 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_8_5_02.txt
2020-05-31 11:56:04,902 - root - INFO - Data path is ../data
2020-05-31 11:56:04,902 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 11:56:04,902 - root - INFO - Dataset: mnist
2020-05-31 11:56:04,902 - root - INFO - Normal class: 8
2020-05-31 11:56:04,902 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 11:56:04,903 - root - INFO - Ratio of labeled anomalous samples: 0.20
2020-05-31 11:56:04,903 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 11:56:04,903 - root - INFO - Scenario Running: 1
2020-05-31 11:56:04,903 - root - INFO - Train only the network: True
2020-05-31 11:56:04,903 - root - INFO - Output and AE dimensions: 128
2020-05-31 11:56:04,903 - root - INFO - Known anomaly class: 5
2020-05-31 11:56:04,903 - root - INFO - Network: mnist_LeNet
2020-05-31 11:56:04,903 - root - INFO - Eta-parameter: 1.00
2020-05-31 11:56:04,910 - root - INFO - Set seed to 0.
2020-05-31 11:56:05,000 - root - INFO - Computation device: cuda
2020-05-31 11:56:05,000 - root - INFO - Number of threads: 0
2020-05-31 11:56:05,000 - root - INFO - Number of dataloader workers: 6
2020-05-31 11:56:14,374 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 11:56:14,470 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 11:56:14,470 - root - INFO - Training optimizer: adam
2020-05-31 11:56:14,470 - root - INFO - Training learning rate: 0.0001
2020-05-31 11:56:14,470 - root - INFO - Training epochs: 150
2020-05-31 11:56:14,470 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 11:56:14,470 - root - INFO - Training batch size: 200
2020-05-31 11:56:14,470 - root - INFO - Training weight decay: 5e-07
2020-05-31 11:56:14,472 - root - INFO - Starting training...
2020-05-31 11:56:22,786 - root - INFO - | Epoch: 001/150 | Train Time: 8.310s | Train Loss: 0.889752 |
2020-05-31 11:56:25,370 - root - INFO - | Epoch: 002/150 | Train Time: 2.573s | Train Loss: 0.693731 |
2020-05-31 11:56:28,206 - root - INFO - | Epoch: 003/150 | Train Time: 2.835s | Train Loss: 0.621749 |
2020-05-31 11:56:31,161 - root - INFO - | Epoch: 004/150 | Train Time: 2.955s | Train Loss: 0.549865 |
2020-05-31 11:56:33,892 - root - INFO - | Epoch: 005/150 | Train Time: 2.730s | Train Loss: 0.483045 |
2020-05-31 11:56:36,788 - root - INFO - | Epoch: 006/150 | Train Time: 2.896s | Train Loss: 0.414928 |
2020-05-31 11:56:39,321 - root - INFO - | Epoch: 007/150 | Train Time: 2.532s | Train Loss: 0.364314 |
2020-05-31 11:56:42,598 - root - INFO - | Epoch: 008/150 | Train Time: 3.272s | Train Loss: 0.331896 |
2020-05-31 11:56:45,342 - root - INFO - | Epoch: 009/150 | Train Time: 2.743s | Train Loss: 0.309168 |
2020-05-31 11:56:48,518 - root - INFO - | Epoch: 010/150 | Train Time: 3.176s | Train Loss: 0.293264 |
2020-05-31 11:56:51,634 - root - INFO - | Epoch: 011/150 | Train Time: 3.116s | Train Loss: 0.279745 |
2020-05-31 11:56:54,359 - root - INFO - | Epoch: 012/150 | Train Time: 2.724s | Train Loss: 0.267705 |
2020-05-31 11:56:57,003 - root - INFO - | Epoch: 013/150 | Train Time: 2.644s | Train Loss: 0.257867 |
2020-05-31 11:56:59,198 - root - INFO - | Epoch: 014/150 | Train Time: 2.194s | Train Loss: 0.249572 |
2020-05-31 11:57:02,085 - root - INFO - | Epoch: 015/150 | Train Time: 2.887s | Train Loss: 0.242700 |
2020-05-31 11:57:04,576 - root - INFO - | Epoch: 016/150 | Train Time: 2.490s | Train Loss: 0.235264 |
2020-05-31 11:57:07,322 - root - INFO - | Epoch: 017/150 | Train Time: 2.746s | Train Loss: 0.229929 |
2020-05-31 11:57:10,078 - root - INFO - | Epoch: 018/150 | Train Time: 2.755s | Train Loss: 0.224276 |
2020-05-31 11:57:12,763 - root - INFO - | Epoch: 019/150 | Train Time: 2.685s | Train Loss: 0.219261 |
2020-05-31 11:57:15,841 - root - INFO - | Epoch: 020/150 | Train Time: 3.077s | Train Loss: 0.215289 |
2020-05-31 11:57:18,048 - root - INFO - | Epoch: 021/150 | Train Time: 2.207s | Train Loss: 0.210918 |
2020-05-31 11:57:20,774 - root - INFO - | Epoch: 022/150 | Train Time: 2.725s | Train Loss: 0.207326 |
2020-05-31 11:57:23,804 - root - INFO - | Epoch: 023/150 | Train Time: 3.030s | Train Loss: 0.203794 |
2020-05-31 11:57:27,271 - root - INFO - | Epoch: 024/150 | Train Time: 3.466s | Train Loss: 0.200942 |
2020-05-31 11:57:30,477 - root - INFO - | Epoch: 025/150 | Train Time: 3.205s | Train Loss: 0.197063 |
2020-05-31 11:57:33,288 - root - INFO - | Epoch: 026/150 | Train Time: 2.810s | Train Loss: 0.194082 |
2020-05-31 11:57:35,979 - root - INFO - | Epoch: 027/150 | Train Time: 2.691s | Train Loss: 0.192083 |
2020-05-31 11:57:38,296 - root - INFO - | Epoch: 028/150 | Train Time: 2.316s | Train Loss: 0.188856 |
2020-05-31 11:57:40,787 - root - INFO - | Epoch: 029/150 | Train Time: 2.491s | Train Loss: 0.185433 |
2020-05-31 11:57:43,332 - root - INFO - | Epoch: 030/150 | Train Time: 2.544s | Train Loss: 0.183395 |
2020-05-31 11:57:46,113 - root - INFO - | Epoch: 031/150 | Train Time: 2.779s | Train Loss: 0.182000 |
2020-05-31 11:57:48,607 - root - INFO - | Epoch: 032/150 | Train Time: 2.494s | Train Loss: 0.179923 |
2020-05-31 11:57:51,390 - root - INFO - | Epoch: 033/150 | Train Time: 2.782s | Train Loss: 0.177205 |
2020-05-31 11:57:54,037 - root - INFO - | Epoch: 034/150 | Train Time: 2.646s | Train Loss: 0.175642 |
2020-05-31 11:57:56,879 - root - INFO - | Epoch: 035/150 | Train Time: 2.842s | Train Loss: 0.174001 |
2020-05-31 11:57:59,720 - root - INFO - | Epoch: 036/150 | Train Time: 2.840s | Train Loss: 0.172679 |
2020-05-31 11:58:02,567 - root - INFO - | Epoch: 037/150 | Train Time: 2.846s | Train Loss: 0.170507 |
2020-05-31 11:58:06,127 - root - INFO - | Epoch: 038/150 | Train Time: 3.559s | Train Loss: 0.168572 |
2020-05-31 11:58:09,337 - root - INFO - | Epoch: 039/150 | Train Time: 3.209s | Train Loss: 0.166960 |
2020-05-31 11:58:12,109 - root - INFO - | Epoch: 040/150 | Train Time: 2.771s | Train Loss: 0.164342 |
2020-05-31 11:58:15,413 - root - INFO - | Epoch: 041/150 | Train Time: 3.304s | Train Loss: 0.164570 |
2020-05-31 11:58:18,687 - root - INFO - | Epoch: 042/150 | Train Time: 3.273s | Train Loss: 0.162894 |
2020-05-31 11:58:21,497 - root - INFO - | Epoch: 043/150 | Train Time: 2.810s | Train Loss: 0.160286 |
2020-05-31 11:58:24,618 - root - INFO - | Epoch: 044/150 | Train Time: 3.120s | Train Loss: 0.160118 |
2020-05-31 11:58:27,502 - root - INFO - | Epoch: 045/150 | Train Time: 2.884s | Train Loss: 0.159393 |
2020-05-31 11:58:31,052 - root - INFO - | Epoch: 046/150 | Train Time: 3.550s | Train Loss: 0.158032 |
2020-05-31 11:58:33,572 - root - INFO - | Epoch: 047/150 | Train Time: 2.518s | Train Loss: 0.157031 |
2020-05-31 11:58:35,838 - root - INFO - | Epoch: 048/150 | Train Time: 2.265s | Train Loss: 0.155421 |
2020-05-31 11:58:38,257 - root - INFO - | Epoch: 049/150 | Train Time: 2.418s | Train Loss: 0.153728 |
2020-05-31 11:58:40,994 - root - INFO - | Epoch: 050/150 | Train Time: 2.737s | Train Loss: 0.152577 |
2020-05-31 11:58:40,994 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 11:58:43,719 - root - INFO - | Epoch: 051/150 | Train Time: 2.725s | Train Loss: 0.152629 |
2020-05-31 11:58:46,511 - root - INFO - | Epoch: 052/150 | Train Time: 2.790s | Train Loss: 0.152263 |
2020-05-31 11:58:49,652 - root - INFO - | Epoch: 053/150 | Train Time: 3.141s | Train Loss: 0.152012 |
2020-05-31 11:58:52,554 - root - INFO - | Epoch: 054/150 | Train Time: 2.901s | Train Loss: 0.152684 |
2020-05-31 11:58:55,491 - root - INFO - | Epoch: 055/150 | Train Time: 2.937s | Train Loss: 0.152461 |
2020-05-31 11:58:58,605 - root - INFO - | Epoch: 056/150 | Train Time: 3.113s | Train Loss: 0.151986 |
2020-05-31 11:59:02,019 - root - INFO - | Epoch: 057/150 | Train Time: 3.414s | Train Loss: 0.151625 |
2020-05-31 11:59:05,121 - root - INFO - | Epoch: 058/150 | Train Time: 3.101s | Train Loss: 0.151492 |
2020-05-31 11:59:07,952 - root - INFO - | Epoch: 059/150 | Train Time: 2.831s | Train Loss: 0.151873 |
2020-05-31 11:59:10,371 - root - INFO - | Epoch: 060/150 | Train Time: 2.418s | Train Loss: 0.152050 |
2020-05-31 11:59:13,788 - root - INFO - | Epoch: 061/150 | Train Time: 3.417s | Train Loss: 0.151007 |
2020-05-31 11:59:16,566 - root - INFO - | Epoch: 062/150 | Train Time: 2.777s | Train Loss: 0.150137 |
2020-05-31 11:59:19,073 - root - INFO - | Epoch: 063/150 | Train Time: 2.507s | Train Loss: 0.150362 |
2020-05-31 11:59:21,800 - root - INFO - | Epoch: 064/150 | Train Time: 2.726s | Train Loss: 0.151237 |
2020-05-31 11:59:24,424 - root - INFO - | Epoch: 065/150 | Train Time: 2.623s | Train Loss: 0.151225 |
2020-05-31 11:59:28,046 - root - INFO - | Epoch: 066/150 | Train Time: 3.622s | Train Loss: 0.151193 |
2020-05-31 11:59:30,895 - root - INFO - | Epoch: 067/150 | Train Time: 2.849s | Train Loss: 0.150405 |
2020-05-31 11:59:33,945 - root - INFO - | Epoch: 068/150 | Train Time: 3.050s | Train Loss: 0.150873 |
2020-05-31 11:59:36,877 - root - INFO - | Epoch: 069/150 | Train Time: 2.931s | Train Loss: 0.149782 |
2020-05-31 11:59:39,561 - root - INFO - | Epoch: 070/150 | Train Time: 2.684s | Train Loss: 0.150670 |
2020-05-31 11:59:41,760 - root - INFO - | Epoch: 071/150 | Train Time: 2.198s | Train Loss: 0.150757 |
2020-05-31 11:59:44,373 - root - INFO - | Epoch: 072/150 | Train Time: 2.613s | Train Loss: 0.149589 |
2020-05-31 11:59:47,067 - root - INFO - | Epoch: 073/150 | Train Time: 2.693s | Train Loss: 0.149150 |
2020-05-31 11:59:50,286 - root - INFO - | Epoch: 074/150 | Train Time: 3.218s | Train Loss: 0.150059 |
2020-05-31 11:59:53,484 - root - INFO - | Epoch: 075/150 | Train Time: 3.197s | Train Loss: 0.149368 |
2020-05-31 11:59:56,269 - root - INFO - | Epoch: 076/150 | Train Time: 2.776s | Train Loss: 0.149596 |
2020-05-31 11:59:59,067 - root - INFO - | Epoch: 077/150 | Train Time: 2.798s | Train Loss: 0.149011 |
2020-05-31 12:00:01,850 - root - INFO - | Epoch: 078/150 | Train Time: 2.782s | Train Loss: 0.150359 |
2020-05-31 12:00:04,369 - root - INFO - | Epoch: 079/150 | Train Time: 2.519s | Train Loss: 0.149674 |
2020-05-31 12:00:07,229 - root - INFO - | Epoch: 080/150 | Train Time: 2.860s | Train Loss: 0.149453 |
2020-05-31 12:00:09,897 - root - INFO - | Epoch: 081/150 | Train Time: 2.667s | Train Loss: 0.149117 |
2020-05-31 12:00:12,791 - root - INFO - | Epoch: 082/150 | Train Time: 2.894s | Train Loss: 0.149353 |
2020-05-31 12:00:15,333 - root - INFO - | Epoch: 083/150 | Train Time: 2.541s | Train Loss: 0.147666 |
2020-05-31 12:00:18,086 - root - INFO - | Epoch: 084/150 | Train Time: 2.753s | Train Loss: 0.148185 |
2020-05-31 12:00:20,967 - root - INFO - | Epoch: 085/150 | Train Time: 2.880s | Train Loss: 0.148461 |
2020-05-31 12:00:23,658 - root - INFO - | Epoch: 086/150 | Train Time: 2.690s | Train Loss: 0.148265 |
2020-05-31 12:00:26,546 - root - INFO - | Epoch: 087/150 | Train Time: 2.888s | Train Loss: 0.146992 |
2020-05-31 12:00:29,206 - root - INFO - | Epoch: 088/150 | Train Time: 2.659s | Train Loss: 0.148562 |
2020-05-31 12:00:32,463 - root - INFO - | Epoch: 089/150 | Train Time: 3.256s | Train Loss: 0.147872 |
2020-05-31 12:00:35,195 - root - INFO - | Epoch: 090/150 | Train Time: 2.731s | Train Loss: 0.148224 |
2020-05-31 12:00:37,818 - root - INFO - | Epoch: 091/150 | Train Time: 2.623s | Train Loss: 0.148152 |
2020-05-31 12:00:40,776 - root - INFO - | Epoch: 092/150 | Train Time: 2.957s | Train Loss: 0.148220 |
2020-05-31 12:00:43,465 - root - INFO - | Epoch: 093/150 | Train Time: 2.688s | Train Loss: 0.147130 |
2020-05-31 12:00:46,549 - root - INFO - | Epoch: 094/150 | Train Time: 3.084s | Train Loss: 0.147926 |
2020-05-31 12:00:48,833 - root - INFO - | Epoch: 095/150 | Train Time: 2.283s | Train Loss: 0.147537 |
2020-05-31 12:00:51,583 - root - INFO - | Epoch: 096/150 | Train Time: 2.749s | Train Loss: 0.147005 |
2020-05-31 12:00:53,910 - root - INFO - | Epoch: 097/150 | Train Time: 2.327s | Train Loss: 0.147287 |
2020-05-31 12:00:56,377 - root - INFO - | Epoch: 098/150 | Train Time: 2.466s | Train Loss: 0.146820 |
2020-05-31 12:00:59,036 - root - INFO - | Epoch: 099/150 | Train Time: 2.659s | Train Loss: 0.147188 |
2020-05-31 12:01:01,180 - root - INFO - | Epoch: 100/150 | Train Time: 2.143s | Train Loss: 0.147310 |
2020-05-31 12:01:03,430 - root - INFO - | Epoch: 101/150 | Train Time: 2.250s | Train Loss: 0.146777 |
2020-05-31 12:01:05,819 - root - INFO - | Epoch: 102/150 | Train Time: 2.388s | Train Loss: 0.146599 |
2020-05-31 12:01:08,304 - root - INFO - | Epoch: 103/150 | Train Time: 2.485s | Train Loss: 0.146683 |
2020-05-31 12:01:10,925 - root - INFO - | Epoch: 104/150 | Train Time: 2.621s | Train Loss: 0.146139 |
2020-05-31 12:01:13,885 - root - INFO - | Epoch: 105/150 | Train Time: 2.959s | Train Loss: 0.146124 |
2020-05-31 12:01:16,282 - root - INFO - | Epoch: 106/150 | Train Time: 2.397s | Train Loss: 0.146562 |
2020-05-31 12:01:18,803 - root - INFO - | Epoch: 107/150 | Train Time: 2.520s | Train Loss: 0.145538 |
2020-05-31 12:01:21,130 - root - INFO - | Epoch: 108/150 | Train Time: 2.326s | Train Loss: 0.145363 |
2020-05-31 12:01:23,981 - root - INFO - | Epoch: 109/150 | Train Time: 2.851s | Train Loss: 0.146051 |
2020-05-31 12:01:26,587 - root - INFO - | Epoch: 110/150 | Train Time: 2.606s | Train Loss: 0.145268 |
2020-05-31 12:01:29,291 - root - INFO - | Epoch: 111/150 | Train Time: 2.703s | Train Loss: 0.144173 |
2020-05-31 12:01:31,889 - root - INFO - | Epoch: 112/150 | Train Time: 2.598s | Train Loss: 0.145302 |
2020-05-31 12:01:34,662 - root - INFO - | Epoch: 113/150 | Train Time: 2.772s | Train Loss: 0.144900 |
2020-05-31 12:01:36,998 - root - INFO - | Epoch: 114/150 | Train Time: 2.336s | Train Loss: 0.145146 |
2020-05-31 12:01:39,080 - root - INFO - | Epoch: 115/150 | Train Time: 2.081s | Train Loss: 0.145104 |
2020-05-31 12:01:41,706 - root - INFO - | Epoch: 116/150 | Train Time: 2.625s | Train Loss: 0.145025 |
2020-05-31 12:01:44,709 - root - INFO - | Epoch: 117/150 | Train Time: 3.003s | Train Loss: 0.144497 |
2020-05-31 12:01:47,379 - root - INFO - | Epoch: 118/150 | Train Time: 2.669s | Train Loss: 0.144388 |
2020-05-31 12:01:50,329 - root - INFO - | Epoch: 119/150 | Train Time: 2.950s | Train Loss: 0.144556 |
2020-05-31 12:01:53,715 - root - INFO - | Epoch: 120/150 | Train Time: 3.385s | Train Loss: 0.144176 |
2020-05-31 12:01:56,406 - root - INFO - | Epoch: 121/150 | Train Time: 2.691s | Train Loss: 0.144590 |
2020-05-31 12:01:59,027 - root - INFO - | Epoch: 122/150 | Train Time: 2.620s | Train Loss: 0.143769 |
2020-05-31 12:02:01,875 - root - INFO - | Epoch: 123/150 | Train Time: 2.847s | Train Loss: 0.144293 |
2020-05-31 12:02:04,892 - root - INFO - | Epoch: 124/150 | Train Time: 3.016s | Train Loss: 0.144018 |
2020-05-31 12:02:07,443 - root - INFO - | Epoch: 125/150 | Train Time: 2.550s | Train Loss: 0.143568 |
2020-05-31 12:02:10,401 - root - INFO - | Epoch: 126/150 | Train Time: 2.958s | Train Loss: 0.143582 |
2020-05-31 12:02:12,956 - root - INFO - | Epoch: 127/150 | Train Time: 2.554s | Train Loss: 0.143481 |
2020-05-31 12:02:15,263 - root - INFO - | Epoch: 128/150 | Train Time: 2.307s | Train Loss: 0.143391 |
2020-05-31 12:02:17,071 - root - INFO - | Epoch: 129/150 | Train Time: 1.806s | Train Loss: 0.142344 |
2020-05-31 12:02:19,540 - root - INFO - | Epoch: 130/150 | Train Time: 2.469s | Train Loss: 0.142926 |
2020-05-31 12:02:22,044 - root - INFO - | Epoch: 131/150 | Train Time: 2.503s | Train Loss: 0.142876 |
2020-05-31 12:02:24,061 - root - INFO - | Epoch: 132/150 | Train Time: 2.017s | Train Loss: 0.143742 |
2020-05-31 12:02:25,997 - root - INFO - | Epoch: 133/150 | Train Time: 1.935s | Train Loss: 0.143269 |
2020-05-31 12:02:28,134 - root - INFO - | Epoch: 134/150 | Train Time: 2.137s | Train Loss: 0.143004 |
2020-05-31 12:02:30,002 - root - INFO - | Epoch: 135/150 | Train Time: 1.868s | Train Loss: 0.142167 |
2020-05-31 12:02:32,850 - root - INFO - | Epoch: 136/150 | Train Time: 2.847s | Train Loss: 0.142806 |
2020-05-31 12:02:35,366 - root - INFO - | Epoch: 137/150 | Train Time: 2.515s | Train Loss: 0.142059 |
2020-05-31 12:02:38,421 - root - INFO - | Epoch: 138/150 | Train Time: 3.054s | Train Loss: 0.142093 |
2020-05-31 12:02:40,836 - root - INFO - | Epoch: 139/150 | Train Time: 2.415s | Train Loss: 0.142240 |
2020-05-31 12:02:43,360 - root - INFO - | Epoch: 140/150 | Train Time: 2.523s | Train Loss: 0.142216 |
2020-05-31 12:02:46,012 - root - INFO - | Epoch: 141/150 | Train Time: 2.652s | Train Loss: 0.141147 |
2020-05-31 12:02:48,567 - root - INFO - | Epoch: 142/150 | Train Time: 2.554s | Train Loss: 0.141981 |
2020-05-31 12:02:51,543 - root - INFO - | Epoch: 143/150 | Train Time: 2.976s | Train Loss: 0.141993 |
2020-05-31 12:02:54,297 - root - INFO - | Epoch: 144/150 | Train Time: 2.753s | Train Loss: 0.140674 |
2020-05-31 12:02:57,140 - root - INFO - | Epoch: 145/150 | Train Time: 2.842s | Train Loss: 0.141693 |
2020-05-31 12:02:59,696 - root - INFO - | Epoch: 146/150 | Train Time: 2.555s | Train Loss: 0.141226 |
2020-05-31 12:03:02,718 - root - INFO - | Epoch: 147/150 | Train Time: 3.021s | Train Loss: 0.141033 |
2020-05-31 12:03:05,228 - root - INFO - | Epoch: 148/150 | Train Time: 2.510s | Train Loss: 0.141650 |
2020-05-31 12:03:09,064 - root - INFO - | Epoch: 149/150 | Train Time: 3.836s | Train Loss: 0.140635 |
2020-05-31 12:03:12,241 - root - INFO - | Epoch: 150/150 | Train Time: 3.177s | Train Loss: 0.140099 |
2020-05-31 12:03:12,241 - root - INFO - Training Time: 417.769s
2020-05-31 12:03:12,242 - root - INFO - Finished training.
2020-05-31 12:03:12,243 - root - INFO - Starting testing...
2020-05-31 12:03:15,212 - root - INFO - Test Loss: 0.595058
2020-05-31 12:03:15,212 - root - INFO - Test AUC: 84.69%
2020-05-31 12:03:15,212 - root - INFO - Test Time: 2.945s
2020-05-31 12:03:15,212 - root - INFO - Finished testing.
