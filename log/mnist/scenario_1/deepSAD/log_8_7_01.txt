2020-05-31 12:43:57,720 - root - INFO - Log file is ../log/mnist/scenario_1/deepSAD//log_8_7_01.txt
2020-05-31 12:43:57,721 - root - INFO - Data path is ../data
2020-05-31 12:43:57,721 - root - INFO - Export path is ../log/mnist/scenario_1/deepSAD/
2020-05-31 12:43:57,721 - root - INFO - Dataset: mnist
2020-05-31 12:43:57,721 - root - INFO - Normal class: 8
2020-05-31 12:43:57,721 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-31 12:43:57,721 - root - INFO - Ratio of labeled anomalous samples: 0.10
2020-05-31 12:43:57,721 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-31 12:43:57,721 - root - INFO - Scenario Running: 1
2020-05-31 12:43:57,721 - root - INFO - Train only the network: True
2020-05-31 12:43:57,721 - root - INFO - Output and AE dimensions: 128
2020-05-31 12:43:57,721 - root - INFO - Known anomaly class: 7
2020-05-31 12:43:57,721 - root - INFO - Network: mnist_LeNet
2020-05-31 12:43:57,721 - root - INFO - Eta-parameter: 1.00
2020-05-31 12:43:57,733 - root - INFO - Set seed to 0.
2020-05-31 12:43:57,818 - root - INFO - Computation device: cuda
2020-05-31 12:43:57,819 - root - INFO - Number of threads: 0
2020-05-31 12:43:57,819 - root - INFO - Number of dataloader workers: 6
2020-05-31 12:44:06,931 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-31 12:44:06,947 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-31 12:44:06,947 - root - INFO - Training optimizer: adam
2020-05-31 12:44:06,948 - root - INFO - Training learning rate: 0.0001
2020-05-31 12:44:06,948 - root - INFO - Training epochs: 150
2020-05-31 12:44:06,959 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-31 12:44:06,959 - root - INFO - Training batch size: 200
2020-05-31 12:44:06,960 - root - INFO - Training weight decay: 5e-07
2020-05-31 12:44:06,961 - root - INFO - Starting training...
2020-05-31 12:44:14,882 - root - INFO - | Epoch: 001/150 | Train Time: 7.916s | Train Loss: 0.515953 |
2020-05-31 12:44:17,089 - root - INFO - | Epoch: 002/150 | Train Time: 2.206s | Train Loss: 0.353441 |
2020-05-31 12:44:19,105 - root - INFO - | Epoch: 003/150 | Train Time: 2.016s | Train Loss: 0.289870 |
2020-05-31 12:44:21,509 - root - INFO - | Epoch: 004/150 | Train Time: 2.403s | Train Loss: 0.257633 |
2020-05-31 12:44:23,939 - root - INFO - | Epoch: 005/150 | Train Time: 2.430s | Train Loss: 0.238429 |
2020-05-31 12:44:26,080 - root - INFO - | Epoch: 006/150 | Train Time: 2.140s | Train Loss: 0.224922 |
2020-05-31 12:44:28,318 - root - INFO - | Epoch: 007/150 | Train Time: 2.238s | Train Loss: 0.214158 |
2020-05-31 12:44:30,708 - root - INFO - | Epoch: 008/150 | Train Time: 2.389s | Train Loss: 0.206067 |
2020-05-31 12:44:33,014 - root - INFO - | Epoch: 009/150 | Train Time: 2.305s | Train Loss: 0.199409 |
2020-05-31 12:44:34,789 - root - INFO - | Epoch: 010/150 | Train Time: 1.775s | Train Loss: 0.193108 |
2020-05-31 12:44:37,330 - root - INFO - | Epoch: 011/150 | Train Time: 2.540s | Train Loss: 0.187983 |
2020-05-31 12:44:39,795 - root - INFO - | Epoch: 012/150 | Train Time: 2.464s | Train Loss: 0.182661 |
2020-05-31 12:44:41,782 - root - INFO - | Epoch: 013/150 | Train Time: 1.987s | Train Loss: 0.179568 |
2020-05-31 12:44:44,208 - root - INFO - | Epoch: 014/150 | Train Time: 2.426s | Train Loss: 0.176808 |
2020-05-31 12:44:46,672 - root - INFO - | Epoch: 015/150 | Train Time: 2.463s | Train Loss: 0.172501 |
2020-05-31 12:44:49,065 - root - INFO - | Epoch: 016/150 | Train Time: 2.393s | Train Loss: 0.170048 |
2020-05-31 12:44:51,770 - root - INFO - | Epoch: 017/150 | Train Time: 2.705s | Train Loss: 0.166855 |
2020-05-31 12:44:54,303 - root - INFO - | Epoch: 018/150 | Train Time: 2.532s | Train Loss: 0.164616 |
2020-05-31 12:44:56,841 - root - INFO - | Epoch: 019/150 | Train Time: 2.538s | Train Loss: 0.161501 |
2020-05-31 12:44:59,362 - root - INFO - | Epoch: 020/150 | Train Time: 2.520s | Train Loss: 0.160147 |
2020-05-31 12:45:01,475 - root - INFO - | Epoch: 021/150 | Train Time: 2.113s | Train Loss: 0.158681 |
2020-05-31 12:45:03,575 - root - INFO - | Epoch: 022/150 | Train Time: 2.100s | Train Loss: 0.157001 |
2020-05-31 12:45:05,928 - root - INFO - | Epoch: 023/150 | Train Time: 2.353s | Train Loss: 0.155121 |
2020-05-31 12:45:08,554 - root - INFO - | Epoch: 024/150 | Train Time: 2.624s | Train Loss: 0.153463 |
2020-05-31 12:45:10,998 - root - INFO - | Epoch: 025/150 | Train Time: 2.443s | Train Loss: 0.151741 |
2020-05-31 12:45:13,731 - root - INFO - | Epoch: 026/150 | Train Time: 2.732s | Train Loss: 0.150810 |
2020-05-31 12:45:16,050 - root - INFO - | Epoch: 027/150 | Train Time: 2.319s | Train Loss: 0.148568 |
2020-05-31 12:45:18,098 - root - INFO - | Epoch: 028/150 | Train Time: 2.047s | Train Loss: 0.147123 |
2020-05-31 12:45:20,381 - root - INFO - | Epoch: 029/150 | Train Time: 2.282s | Train Loss: 0.146177 |
2020-05-31 12:45:22,770 - root - INFO - | Epoch: 030/150 | Train Time: 2.388s | Train Loss: 0.145001 |
2020-05-31 12:45:24,851 - root - INFO - | Epoch: 031/150 | Train Time: 2.081s | Train Loss: 0.144008 |
2020-05-31 12:45:27,183 - root - INFO - | Epoch: 032/150 | Train Time: 2.331s | Train Loss: 0.142371 |
2020-05-31 12:45:29,715 - root - INFO - | Epoch: 033/150 | Train Time: 2.532s | Train Loss: 0.141764 |
2020-05-31 12:45:32,126 - root - INFO - | Epoch: 034/150 | Train Time: 2.411s | Train Loss: 0.140560 |
2020-05-31 12:45:34,375 - root - INFO - | Epoch: 035/150 | Train Time: 2.248s | Train Loss: 0.139209 |
2020-05-31 12:45:37,063 - root - INFO - | Epoch: 036/150 | Train Time: 2.688s | Train Loss: 0.138677 |
2020-05-31 12:45:39,629 - root - INFO - | Epoch: 037/150 | Train Time: 2.566s | Train Loss: 0.137750 |
2020-05-31 12:45:42,421 - root - INFO - | Epoch: 038/150 | Train Time: 2.791s | Train Loss: 0.137234 |
2020-05-31 12:45:44,666 - root - INFO - | Epoch: 039/150 | Train Time: 2.244s | Train Loss: 0.136012 |
2020-05-31 12:45:47,076 - root - INFO - | Epoch: 040/150 | Train Time: 2.410s | Train Loss: 0.135182 |
2020-05-31 12:45:49,534 - root - INFO - | Epoch: 041/150 | Train Time: 2.457s | Train Loss: 0.134169 |
2020-05-31 12:45:51,889 - root - INFO - | Epoch: 042/150 | Train Time: 2.354s | Train Loss: 0.133326 |
2020-05-31 12:45:54,248 - root - INFO - | Epoch: 043/150 | Train Time: 2.358s | Train Loss: 0.132769 |
2020-05-31 12:45:56,774 - root - INFO - | Epoch: 044/150 | Train Time: 2.526s | Train Loss: 0.131865 |
2020-05-31 12:45:59,387 - root - INFO - | Epoch: 045/150 | Train Time: 2.612s | Train Loss: 0.131079 |
2020-05-31 12:46:01,953 - root - INFO - | Epoch: 046/150 | Train Time: 2.565s | Train Loss: 0.130861 |
2020-05-31 12:46:04,661 - root - INFO - | Epoch: 047/150 | Train Time: 2.707s | Train Loss: 0.129492 |
2020-05-31 12:46:07,015 - root - INFO - | Epoch: 048/150 | Train Time: 2.354s | Train Loss: 0.128220 |
2020-05-31 12:46:09,250 - root - INFO - | Epoch: 049/150 | Train Time: 2.235s | Train Loss: 0.127494 |
2020-05-31 12:46:11,446 - root - INFO - | Epoch: 050/150 | Train Time: 2.195s | Train Loss: 0.127180 |
2020-05-31 12:46:11,446 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-31 12:46:13,899 - root - INFO - | Epoch: 051/150 | Train Time: 2.453s | Train Loss: 0.126545 |
2020-05-31 12:46:16,229 - root - INFO - | Epoch: 052/150 | Train Time: 2.329s | Train Loss: 0.126649 |
2020-05-31 12:46:18,538 - root - INFO - | Epoch: 053/150 | Train Time: 2.309s | Train Loss: 0.126726 |
2020-05-31 12:46:20,927 - root - INFO - | Epoch: 054/150 | Train Time: 2.388s | Train Loss: 0.126328 |
2020-05-31 12:46:23,504 - root - INFO - | Epoch: 055/150 | Train Time: 2.576s | Train Loss: 0.126733 |
2020-05-31 12:46:26,026 - root - INFO - | Epoch: 056/150 | Train Time: 2.521s | Train Loss: 0.126585 |
2020-05-31 12:46:28,261 - root - INFO - | Epoch: 057/150 | Train Time: 2.234s | Train Loss: 0.126550 |
2020-05-31 12:46:30,609 - root - INFO - | Epoch: 058/150 | Train Time: 2.348s | Train Loss: 0.126305 |
2020-05-31 12:46:32,667 - root - INFO - | Epoch: 059/150 | Train Time: 2.057s | Train Loss: 0.126468 |
2020-05-31 12:46:34,513 - root - INFO - | Epoch: 060/150 | Train Time: 1.845s | Train Loss: 0.126120 |
2020-05-31 12:46:36,391 - root - INFO - | Epoch: 061/150 | Train Time: 1.878s | Train Loss: 0.126420 |
2020-05-31 12:46:38,894 - root - INFO - | Epoch: 062/150 | Train Time: 2.502s | Train Loss: 0.125801 |
2020-05-31 12:46:41,336 - root - INFO - | Epoch: 063/150 | Train Time: 2.442s | Train Loss: 0.125596 |
2020-05-31 12:46:43,664 - root - INFO - | Epoch: 064/150 | Train Time: 2.327s | Train Loss: 0.125601 |
2020-05-31 12:46:45,936 - root - INFO - | Epoch: 065/150 | Train Time: 2.271s | Train Loss: 0.125464 |
2020-05-31 12:46:48,050 - root - INFO - | Epoch: 066/150 | Train Time: 2.113s | Train Loss: 0.125068 |
2020-05-31 12:46:50,259 - root - INFO - | Epoch: 067/150 | Train Time: 2.209s | Train Loss: 0.125850 |
2020-05-31 12:46:52,533 - root - INFO - | Epoch: 068/150 | Train Time: 2.273s | Train Loss: 0.125659 |
2020-05-31 12:46:54,733 - root - INFO - | Epoch: 069/150 | Train Time: 2.199s | Train Loss: 0.125019 |
2020-05-31 12:46:56,718 - root - INFO - | Epoch: 070/150 | Train Time: 1.984s | Train Loss: 0.125172 |
2020-05-31 12:46:59,019 - root - INFO - | Epoch: 071/150 | Train Time: 2.301s | Train Loss: 0.125579 |
2020-05-31 12:47:01,505 - root - INFO - | Epoch: 072/150 | Train Time: 2.485s | Train Loss: 0.125367 |
2020-05-31 12:47:03,892 - root - INFO - | Epoch: 073/150 | Train Time: 2.387s | Train Loss: 0.124999 |
2020-05-31 12:47:06,434 - root - INFO - | Epoch: 074/150 | Train Time: 2.541s | Train Loss: 0.124675 |
2020-05-31 12:47:08,936 - root - INFO - | Epoch: 075/150 | Train Time: 2.501s | Train Loss: 0.125094 |
2020-05-31 12:47:11,474 - root - INFO - | Epoch: 076/150 | Train Time: 2.538s | Train Loss: 0.125105 |
2020-05-31 12:47:14,169 - root - INFO - | Epoch: 077/150 | Train Time: 2.694s | Train Loss: 0.124974 |
2020-05-31 12:47:16,713 - root - INFO - | Epoch: 078/150 | Train Time: 2.544s | Train Loss: 0.124612 |
2020-05-31 12:47:19,041 - root - INFO - | Epoch: 079/150 | Train Time: 2.328s | Train Loss: 0.124817 |
2020-05-31 12:47:21,910 - root - INFO - | Epoch: 080/150 | Train Time: 2.868s | Train Loss: 0.124499 |
2020-05-31 12:47:24,378 - root - INFO - | Epoch: 081/150 | Train Time: 2.467s | Train Loss: 0.123967 |
2020-05-31 12:47:27,173 - root - INFO - | Epoch: 082/150 | Train Time: 2.794s | Train Loss: 0.124201 |
2020-05-31 12:47:29,567 - root - INFO - | Epoch: 083/150 | Train Time: 2.393s | Train Loss: 0.123954 |
2020-05-31 12:47:32,154 - root - INFO - | Epoch: 084/150 | Train Time: 2.586s | Train Loss: 0.123874 |
2020-05-31 12:47:34,431 - root - INFO - | Epoch: 085/150 | Train Time: 2.277s | Train Loss: 0.124252 |
2020-05-31 12:47:36,995 - root - INFO - | Epoch: 086/150 | Train Time: 2.562s | Train Loss: 0.124249 |
2020-05-31 12:47:39,601 - root - INFO - | Epoch: 087/150 | Train Time: 2.606s | Train Loss: 0.123631 |
2020-05-31 12:47:42,435 - root - INFO - | Epoch: 088/150 | Train Time: 2.834s | Train Loss: 0.124014 |
2020-05-31 12:47:45,051 - root - INFO - | Epoch: 089/150 | Train Time: 2.615s | Train Loss: 0.123775 |
2020-05-31 12:47:47,707 - root - INFO - | Epoch: 090/150 | Train Time: 2.656s | Train Loss: 0.123434 |
2020-05-31 12:47:50,156 - root - INFO - | Epoch: 091/150 | Train Time: 2.447s | Train Loss: 0.123433 |
2020-05-31 12:47:53,202 - root - INFO - | Epoch: 092/150 | Train Time: 3.046s | Train Loss: 0.123457 |
2020-05-31 12:47:55,657 - root - INFO - | Epoch: 093/150 | Train Time: 2.454s | Train Loss: 0.123264 |
2020-05-31 12:47:58,242 - root - INFO - | Epoch: 094/150 | Train Time: 2.584s | Train Loss: 0.123136 |
2020-05-31 12:48:00,887 - root - INFO - | Epoch: 095/150 | Train Time: 2.644s | Train Loss: 0.122903 |
2020-05-31 12:48:03,570 - root - INFO - | Epoch: 096/150 | Train Time: 2.682s | Train Loss: 0.123275 |
2020-05-31 12:48:06,368 - root - INFO - | Epoch: 097/150 | Train Time: 2.798s | Train Loss: 0.123253 |
2020-05-31 12:48:09,053 - root - INFO - | Epoch: 098/150 | Train Time: 2.684s | Train Loss: 0.122292 |
2020-05-31 12:48:11,860 - root - INFO - | Epoch: 099/150 | Train Time: 2.806s | Train Loss: 0.122828 |
2020-05-31 12:48:15,228 - root - INFO - | Epoch: 100/150 | Train Time: 3.367s | Train Loss: 0.122809 |
2020-05-31 12:48:18,027 - root - INFO - | Epoch: 101/150 | Train Time: 2.798s | Train Loss: 0.122374 |
2020-05-31 12:48:21,230 - root - INFO - | Epoch: 102/150 | Train Time: 3.202s | Train Loss: 0.122603 |
2020-05-31 12:48:23,763 - root - INFO - | Epoch: 103/150 | Train Time: 2.527s | Train Loss: 0.122418 |
2020-05-31 12:48:26,682 - root - INFO - | Epoch: 104/150 | Train Time: 2.919s | Train Loss: 0.121998 |
2020-05-31 12:48:29,327 - root - INFO - | Epoch: 105/150 | Train Time: 2.644s | Train Loss: 0.121491 |
2020-05-31 12:48:32,027 - root - INFO - | Epoch: 106/150 | Train Time: 2.700s | Train Loss: 0.122173 |
2020-05-31 12:48:34,786 - root - INFO - | Epoch: 107/150 | Train Time: 2.758s | Train Loss: 0.121712 |
2020-05-31 12:48:37,530 - root - INFO - | Epoch: 108/150 | Train Time: 2.743s | Train Loss: 0.122020 |
2020-05-31 12:48:40,026 - root - INFO - | Epoch: 109/150 | Train Time: 2.495s | Train Loss: 0.121723 |
2020-05-31 12:48:42,967 - root - INFO - | Epoch: 110/150 | Train Time: 2.941s | Train Loss: 0.121860 |
2020-05-31 12:48:46,072 - root - INFO - | Epoch: 111/150 | Train Time: 3.104s | Train Loss: 0.121818 |
2020-05-31 12:48:49,151 - root - INFO - | Epoch: 112/150 | Train Time: 3.078s | Train Loss: 0.121818 |
2020-05-31 12:48:51,585 - root - INFO - | Epoch: 113/150 | Train Time: 2.434s | Train Loss: 0.121674 |
2020-05-31 12:48:54,072 - root - INFO - | Epoch: 114/150 | Train Time: 2.486s | Train Loss: 0.121702 |
2020-05-31 12:48:56,658 - root - INFO - | Epoch: 115/150 | Train Time: 2.586s | Train Loss: 0.121309 |
2020-05-31 12:48:59,097 - root - INFO - | Epoch: 116/150 | Train Time: 2.438s | Train Loss: 0.121544 |
2020-05-31 12:49:01,529 - root - INFO - | Epoch: 117/150 | Train Time: 2.431s | Train Loss: 0.121167 |
2020-05-31 12:49:03,682 - root - INFO - | Epoch: 118/150 | Train Time: 2.153s | Train Loss: 0.120895 |
2020-05-31 12:49:06,484 - root - INFO - | Epoch: 119/150 | Train Time: 2.802s | Train Loss: 0.120843 |
2020-05-31 12:49:09,275 - root - INFO - | Epoch: 120/150 | Train Time: 2.790s | Train Loss: 0.121169 |
2020-05-31 12:49:12,718 - root - INFO - | Epoch: 121/150 | Train Time: 3.442s | Train Loss: 0.121321 |
2020-05-31 12:49:15,520 - root - INFO - | Epoch: 122/150 | Train Time: 2.801s | Train Loss: 0.120260 |
2020-05-31 12:49:18,102 - root - INFO - | Epoch: 123/150 | Train Time: 2.582s | Train Loss: 0.120629 |
2020-05-31 12:49:20,765 - root - INFO - | Epoch: 124/150 | Train Time: 2.661s | Train Loss: 0.120731 |
2020-05-31 12:49:23,663 - root - INFO - | Epoch: 125/150 | Train Time: 2.897s | Train Loss: 0.120726 |
2020-05-31 12:49:26,939 - root - INFO - | Epoch: 126/150 | Train Time: 3.276s | Train Loss: 0.119836 |
2020-05-31 12:49:29,532 - root - INFO - | Epoch: 127/150 | Train Time: 2.592s | Train Loss: 0.120210 |
2020-05-31 12:49:32,552 - root - INFO - | Epoch: 128/150 | Train Time: 3.019s | Train Loss: 0.120636 |
2020-05-31 12:49:35,782 - root - INFO - | Epoch: 129/150 | Train Time: 3.229s | Train Loss: 0.119836 |
2020-05-31 12:49:38,313 - root - INFO - | Epoch: 130/150 | Train Time: 2.531s | Train Loss: 0.120334 |
2020-05-31 12:49:40,729 - root - INFO - | Epoch: 131/150 | Train Time: 2.416s | Train Loss: 0.120178 |
2020-05-31 12:49:43,077 - root - INFO - | Epoch: 132/150 | Train Time: 2.347s | Train Loss: 0.119563 |
2020-05-31 12:49:45,545 - root - INFO - | Epoch: 133/150 | Train Time: 2.468s | Train Loss: 0.119665 |
2020-05-31 12:49:48,065 - root - INFO - | Epoch: 134/150 | Train Time: 2.520s | Train Loss: 0.120105 |
2020-05-31 12:49:50,566 - root - INFO - | Epoch: 135/150 | Train Time: 2.501s | Train Loss: 0.119523 |
2020-05-31 12:49:52,807 - root - INFO - | Epoch: 136/150 | Train Time: 2.240s | Train Loss: 0.119274 |
2020-05-31 12:49:55,321 - root - INFO - | Epoch: 137/150 | Train Time: 2.513s | Train Loss: 0.119381 |
2020-05-31 12:49:57,650 - root - INFO - | Epoch: 138/150 | Train Time: 2.328s | Train Loss: 0.119719 |
2020-05-31 12:50:00,350 - root - INFO - | Epoch: 139/150 | Train Time: 2.698s | Train Loss: 0.119540 |
2020-05-31 12:50:02,692 - root - INFO - | Epoch: 140/150 | Train Time: 2.342s | Train Loss: 0.119425 |
2020-05-31 12:50:05,101 - root - INFO - | Epoch: 141/150 | Train Time: 2.403s | Train Loss: 0.118896 |
2020-05-31 12:50:07,227 - root - INFO - | Epoch: 142/150 | Train Time: 2.125s | Train Loss: 0.119072 |
2020-05-31 12:50:09,853 - root - INFO - | Epoch: 143/150 | Train Time: 2.625s | Train Loss: 0.118933 |
2020-05-31 12:50:12,726 - root - INFO - | Epoch: 144/150 | Train Time: 2.873s | Train Loss: 0.118587 |
2020-05-31 12:50:15,085 - root - INFO - | Epoch: 145/150 | Train Time: 2.359s | Train Loss: 0.119271 |
2020-05-31 12:50:17,943 - root - INFO - | Epoch: 146/150 | Train Time: 2.858s | Train Loss: 0.119021 |
2020-05-31 12:50:20,438 - root - INFO - | Epoch: 147/150 | Train Time: 2.494s | Train Loss: 0.118578 |
2020-05-31 12:50:23,072 - root - INFO - | Epoch: 148/150 | Train Time: 2.634s | Train Loss: 0.118837 |
2020-05-31 12:50:25,659 - root - INFO - | Epoch: 149/150 | Train Time: 2.586s | Train Loss: 0.118608 |
2020-05-31 12:50:28,645 - root - INFO - | Epoch: 150/150 | Train Time: 2.985s | Train Loss: 0.118592 |
2020-05-31 12:50:28,645 - root - INFO - Training Time: 381.682s
2020-05-31 12:50:28,645 - root - INFO - Finished training.
2020-05-31 12:50:28,647 - root - INFO - Starting testing...
2020-05-31 12:50:31,254 - root - INFO - Test Loss: 0.392418
2020-05-31 12:50:31,254 - root - INFO - Test AUC: 90.17%
2020-05-31 12:50:31,254 - root - INFO - Test Time: 2.593s
2020-05-31 12:50:31,254 - root - INFO - Finished testing.
