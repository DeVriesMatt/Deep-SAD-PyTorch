2020-05-16 21:33:55,828 - root - INFO - Log file is ../log/mnist/scenario_2/deepSAD//log_5_2_02.txt
2020-05-16 21:33:55,828 - root - INFO - Data path is ../data
2020-05-16 21:33:55,829 - root - INFO - Export path is ../log/mnist/scenario_2/deepSAD/
2020-05-16 21:33:55,829 - root - INFO - Dataset: mnist
2020-05-16 21:33:55,829 - root - INFO - Normal class: 5
2020-05-16 21:33:55,829 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-16 21:33:55,829 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-16 21:33:55,829 - root - INFO - Pollution ratio of unlabeled train data: 0.20
2020-05-16 21:33:55,829 - root - INFO - Scenario Running: 2
2020-05-16 21:33:55,829 - root - INFO - Train only the network: True
2020-05-16 21:33:55,829 - root - INFO - Output and AE dimensions: 128
2020-05-16 21:33:55,829 - root - INFO - Known anomaly class: 2
2020-05-16 21:33:55,829 - root - INFO - Network: mnist_LeNet
2020-05-16 21:33:55,829 - root - INFO - Eta-parameter: 1.00
2020-05-16 21:33:55,837 - root - INFO - Set seed to 0.
2020-05-16 21:33:55,863 - root - INFO - Computation device: cuda
2020-05-16 21:33:55,863 - root - INFO - Number of threads: 0
2020-05-16 21:33:55,864 - root - INFO - Number of dataloader workers: 6
2020-05-16 21:33:58,579 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-16 21:33:58,579 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-16 21:33:58,579 - root - INFO - Training optimizer: adam
2020-05-16 21:33:58,579 - root - INFO - Training learning rate: 0.0001
2020-05-16 21:33:58,579 - root - INFO - Training epochs: 150
2020-05-16 21:33:58,579 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-16 21:33:58,579 - root - INFO - Training batch size: 200
2020-05-16 21:33:58,579 - root - INFO - Training weight decay: 5e-07
2020-05-16 21:33:58,601 - root - INFO - Starting training...
2020-05-16 21:34:01,590 - root - INFO - | Epoch: 001/150 | Train Time: 2.986s | Train Loss: 0.361506 |
2020-05-16 21:34:02,633 - root - INFO - | Epoch: 002/150 | Train Time: 1.042s | Train Loss: 0.274337 |
2020-05-16 21:34:03,573 - root - INFO - | Epoch: 003/150 | Train Time: 0.940s | Train Loss: 0.237405 |
2020-05-16 21:34:04,508 - root - INFO - | Epoch: 004/150 | Train Time: 0.935s | Train Loss: 0.217378 |
2020-05-16 21:34:05,522 - root - INFO - | Epoch: 005/150 | Train Time: 1.014s | Train Loss: 0.201516 |
2020-05-16 21:34:06,451 - root - INFO - | Epoch: 006/150 | Train Time: 0.929s | Train Loss: 0.192055 |
2020-05-16 21:34:07,389 - root - INFO - | Epoch: 007/150 | Train Time: 0.937s | Train Loss: 0.184205 |
2020-05-16 21:34:08,385 - root - INFO - | Epoch: 008/150 | Train Time: 0.996s | Train Loss: 0.178134 |
2020-05-16 21:34:09,333 - root - INFO - | Epoch: 009/150 | Train Time: 0.948s | Train Loss: 0.172703 |
2020-05-16 21:34:10,305 - root - INFO - | Epoch: 010/150 | Train Time: 0.972s | Train Loss: 0.167390 |
2020-05-16 21:34:11,270 - root - INFO - | Epoch: 011/150 | Train Time: 0.964s | Train Loss: 0.162486 |
2020-05-16 21:34:12,179 - root - INFO - | Epoch: 012/150 | Train Time: 0.909s | Train Loss: 0.158507 |
2020-05-16 21:34:13,262 - root - INFO - | Epoch: 013/150 | Train Time: 1.083s | Train Loss: 0.155217 |
2020-05-16 21:34:14,272 - root - INFO - | Epoch: 014/150 | Train Time: 1.009s | Train Loss: 0.152168 |
2020-05-16 21:34:15,297 - root - INFO - | Epoch: 015/150 | Train Time: 1.025s | Train Loss: 0.150278 |
2020-05-16 21:34:16,262 - root - INFO - | Epoch: 016/150 | Train Time: 0.964s | Train Loss: 0.147614 |
2020-05-16 21:34:17,245 - root - INFO - | Epoch: 017/150 | Train Time: 0.983s | Train Loss: 0.144257 |
2020-05-16 21:34:18,183 - root - INFO - | Epoch: 018/150 | Train Time: 0.937s | Train Loss: 0.142532 |
2020-05-16 21:34:19,258 - root - INFO - | Epoch: 019/150 | Train Time: 1.074s | Train Loss: 0.139856 |
2020-05-16 21:34:20,260 - root - INFO - | Epoch: 020/150 | Train Time: 1.001s | Train Loss: 0.136766 |
2020-05-16 21:34:21,202 - root - INFO - | Epoch: 021/150 | Train Time: 0.942s | Train Loss: 0.135542 |
2020-05-16 21:34:22,137 - root - INFO - | Epoch: 022/150 | Train Time: 0.934s | Train Loss: 0.132418 |
2020-05-16 21:34:23,074 - root - INFO - | Epoch: 023/150 | Train Time: 0.937s | Train Loss: 0.131641 |
2020-05-16 21:34:24,075 - root - INFO - | Epoch: 024/150 | Train Time: 1.000s | Train Loss: 0.129264 |
2020-05-16 21:34:25,136 - root - INFO - | Epoch: 025/150 | Train Time: 1.060s | Train Loss: 0.128446 |
2020-05-16 21:34:26,197 - root - INFO - | Epoch: 026/150 | Train Time: 1.061s | Train Loss: 0.126795 |
2020-05-16 21:34:27,166 - root - INFO - | Epoch: 027/150 | Train Time: 0.969s | Train Loss: 0.124407 |
2020-05-16 21:34:28,169 - root - INFO - | Epoch: 028/150 | Train Time: 1.002s | Train Loss: 0.124152 |
2020-05-16 21:34:29,175 - root - INFO - | Epoch: 029/150 | Train Time: 1.005s | Train Loss: 0.122525 |
2020-05-16 21:34:30,181 - root - INFO - | Epoch: 030/150 | Train Time: 1.005s | Train Loss: 0.120822 |
2020-05-16 21:34:31,133 - root - INFO - | Epoch: 031/150 | Train Time: 0.951s | Train Loss: 0.119474 |
2020-05-16 21:34:32,029 - root - INFO - | Epoch: 032/150 | Train Time: 0.895s | Train Loss: 0.118885 |
2020-05-16 21:34:33,066 - root - INFO - | Epoch: 033/150 | Train Time: 1.037s | Train Loss: 0.117000 |
2020-05-16 21:34:34,061 - root - INFO - | Epoch: 034/150 | Train Time: 0.994s | Train Loss: 0.116517 |
2020-05-16 21:34:34,974 - root - INFO - | Epoch: 035/150 | Train Time: 0.913s | Train Loss: 0.115652 |
2020-05-16 21:34:35,921 - root - INFO - | Epoch: 036/150 | Train Time: 0.946s | Train Loss: 0.114049 |
2020-05-16 21:34:36,930 - root - INFO - | Epoch: 037/150 | Train Time: 1.009s | Train Loss: 0.113442 |
2020-05-16 21:34:37,855 - root - INFO - | Epoch: 038/150 | Train Time: 0.924s | Train Loss: 0.112288 |
2020-05-16 21:34:38,855 - root - INFO - | Epoch: 039/150 | Train Time: 1.000s | Train Loss: 0.110998 |
2020-05-16 21:34:39,878 - root - INFO - | Epoch: 040/150 | Train Time: 1.022s | Train Loss: 0.109800 |
2020-05-16 21:34:40,914 - root - INFO - | Epoch: 041/150 | Train Time: 1.036s | Train Loss: 0.108862 |
2020-05-16 21:34:41,983 - root - INFO - | Epoch: 042/150 | Train Time: 1.068s | Train Loss: 0.108302 |
2020-05-16 21:34:42,996 - root - INFO - | Epoch: 043/150 | Train Time: 1.013s | Train Loss: 0.108220 |
2020-05-16 21:34:44,006 - root - INFO - | Epoch: 044/150 | Train Time: 1.009s | Train Loss: 0.106439 |
2020-05-16 21:34:44,949 - root - INFO - | Epoch: 045/150 | Train Time: 0.943s | Train Loss: 0.106862 |
2020-05-16 21:34:45,934 - root - INFO - | Epoch: 046/150 | Train Time: 0.985s | Train Loss: 0.105331 |
2020-05-16 21:34:46,983 - root - INFO - | Epoch: 047/150 | Train Time: 1.049s | Train Loss: 0.104865 |
2020-05-16 21:34:48,001 - root - INFO - | Epoch: 048/150 | Train Time: 1.017s | Train Loss: 0.104149 |
2020-05-16 21:34:49,017 - root - INFO - | Epoch: 049/150 | Train Time: 1.016s | Train Loss: 0.102837 |
2020-05-16 21:34:49,945 - root - INFO - | Epoch: 050/150 | Train Time: 0.928s | Train Loss: 0.102418 |
2020-05-16 21:34:49,946 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-16 21:34:50,910 - root - INFO - | Epoch: 051/150 | Train Time: 0.964s | Train Loss: 0.102999 |
2020-05-16 21:34:51,810 - root - INFO - | Epoch: 052/150 | Train Time: 0.900s | Train Loss: 0.102807 |
2020-05-16 21:34:52,744 - root - INFO - | Epoch: 053/150 | Train Time: 0.933s | Train Loss: 0.102335 |
2020-05-16 21:34:53,695 - root - INFO - | Epoch: 054/150 | Train Time: 0.951s | Train Loss: 0.102591 |
2020-05-16 21:34:54,672 - root - INFO - | Epoch: 055/150 | Train Time: 0.976s | Train Loss: 0.101937 |
2020-05-16 21:34:55,692 - root - INFO - | Epoch: 056/150 | Train Time: 1.020s | Train Loss: 0.102907 |
2020-05-16 21:34:56,759 - root - INFO - | Epoch: 057/150 | Train Time: 1.066s | Train Loss: 0.102334 |
2020-05-16 21:34:57,695 - root - INFO - | Epoch: 058/150 | Train Time: 0.936s | Train Loss: 0.101874 |
2020-05-16 21:34:58,790 - root - INFO - | Epoch: 059/150 | Train Time: 1.094s | Train Loss: 0.102163 |
2020-05-16 21:34:59,797 - root - INFO - | Epoch: 060/150 | Train Time: 1.007s | Train Loss: 0.102271 |
2020-05-16 21:35:00,821 - root - INFO - | Epoch: 061/150 | Train Time: 1.023s | Train Loss: 0.101194 |
2020-05-16 21:35:01,817 - root - INFO - | Epoch: 062/150 | Train Time: 0.996s | Train Loss: 0.101208 |
2020-05-16 21:35:02,740 - root - INFO - | Epoch: 063/150 | Train Time: 0.923s | Train Loss: 0.101641 |
2020-05-16 21:35:03,709 - root - INFO - | Epoch: 064/150 | Train Time: 0.968s | Train Loss: 0.101183 |
2020-05-16 21:35:04,800 - root - INFO - | Epoch: 065/150 | Train Time: 1.091s | Train Loss: 0.102237 |
2020-05-16 21:35:05,779 - root - INFO - | Epoch: 066/150 | Train Time: 0.978s | Train Loss: 0.100795 |
2020-05-16 21:35:06,755 - root - INFO - | Epoch: 067/150 | Train Time: 0.976s | Train Loss: 0.101337 |
2020-05-16 21:35:07,829 - root - INFO - | Epoch: 068/150 | Train Time: 1.073s | Train Loss: 0.101209 |
2020-05-16 21:35:08,838 - root - INFO - | Epoch: 069/150 | Train Time: 1.008s | Train Loss: 0.100259 |
2020-05-16 21:35:09,871 - root - INFO - | Epoch: 070/150 | Train Time: 1.032s | Train Loss: 0.100391 |
2020-05-16 21:35:10,962 - root - INFO - | Epoch: 071/150 | Train Time: 1.091s | Train Loss: 0.100503 |
2020-05-16 21:35:12,013 - root - INFO - | Epoch: 072/150 | Train Time: 1.050s | Train Loss: 0.101413 |
2020-05-16 21:35:12,972 - root - INFO - | Epoch: 073/150 | Train Time: 0.958s | Train Loss: 0.101226 |
2020-05-16 21:35:13,901 - root - INFO - | Epoch: 074/150 | Train Time: 0.929s | Train Loss: 0.100724 |
2020-05-16 21:35:14,890 - root - INFO - | Epoch: 075/150 | Train Time: 0.989s | Train Loss: 0.100839 |
2020-05-16 21:35:15,889 - root - INFO - | Epoch: 076/150 | Train Time: 0.998s | Train Loss: 0.101240 |
2020-05-16 21:35:16,895 - root - INFO - | Epoch: 077/150 | Train Time: 1.006s | Train Loss: 0.100578 |
2020-05-16 21:35:17,842 - root - INFO - | Epoch: 078/150 | Train Time: 0.946s | Train Loss: 0.101159 |
2020-05-16 21:35:18,821 - root - INFO - | Epoch: 079/150 | Train Time: 0.979s | Train Loss: 0.101140 |
2020-05-16 21:35:19,807 - root - INFO - | Epoch: 080/150 | Train Time: 0.986s | Train Loss: 0.101094 |
2020-05-16 21:35:20,744 - root - INFO - | Epoch: 081/150 | Train Time: 0.936s | Train Loss: 0.100823 |
2020-05-16 21:35:21,652 - root - INFO - | Epoch: 082/150 | Train Time: 0.908s | Train Loss: 0.100850 |
2020-05-16 21:35:22,616 - root - INFO - | Epoch: 083/150 | Train Time: 0.963s | Train Loss: 0.099954 |
2020-05-16 21:35:23,624 - root - INFO - | Epoch: 084/150 | Train Time: 1.008s | Train Loss: 0.100543 |
2020-05-16 21:35:24,565 - root - INFO - | Epoch: 085/150 | Train Time: 0.940s | Train Loss: 0.100523 |
2020-05-16 21:35:25,606 - root - INFO - | Epoch: 086/150 | Train Time: 1.040s | Train Loss: 0.100602 |
2020-05-16 21:35:26,668 - root - INFO - | Epoch: 087/150 | Train Time: 1.062s | Train Loss: 0.100067 |
2020-05-16 21:35:27,756 - root - INFO - | Epoch: 088/150 | Train Time: 1.087s | Train Loss: 0.100220 |
2020-05-16 21:35:28,870 - root - INFO - | Epoch: 089/150 | Train Time: 1.113s | Train Loss: 0.099221 |
2020-05-16 21:35:29,838 - root - INFO - | Epoch: 090/150 | Train Time: 0.968s | Train Loss: 0.100424 |
2020-05-16 21:35:30,770 - root - INFO - | Epoch: 091/150 | Train Time: 0.932s | Train Loss: 0.100360 |
2020-05-16 21:35:31,739 - root - INFO - | Epoch: 092/150 | Train Time: 0.969s | Train Loss: 0.101088 |
2020-05-16 21:35:32,739 - root - INFO - | Epoch: 093/150 | Train Time: 0.999s | Train Loss: 0.099231 |
2020-05-16 21:35:33,728 - root - INFO - | Epoch: 094/150 | Train Time: 0.988s | Train Loss: 0.099669 |
2020-05-16 21:35:34,757 - root - INFO - | Epoch: 095/150 | Train Time: 1.029s | Train Loss: 0.100123 |
2020-05-16 21:35:35,745 - root - INFO - | Epoch: 096/150 | Train Time: 0.987s | Train Loss: 0.097766 |
2020-05-16 21:35:36,718 - root - INFO - | Epoch: 097/150 | Train Time: 0.972s | Train Loss: 0.100002 |
2020-05-16 21:35:37,709 - root - INFO - | Epoch: 098/150 | Train Time: 0.991s | Train Loss: 0.099232 |
2020-05-16 21:35:38,689 - root - INFO - | Epoch: 099/150 | Train Time: 0.979s | Train Loss: 0.099137 |
2020-05-16 21:35:39,742 - root - INFO - | Epoch: 100/150 | Train Time: 1.053s | Train Loss: 0.098913 |
2020-05-16 21:35:40,821 - root - INFO - | Epoch: 101/150 | Train Time: 1.078s | Train Loss: 0.098594 |
2020-05-16 21:35:41,879 - root - INFO - | Epoch: 102/150 | Train Time: 1.057s | Train Loss: 0.098946 |
2020-05-16 21:35:42,873 - root - INFO - | Epoch: 103/150 | Train Time: 0.994s | Train Loss: 0.099135 |
2020-05-16 21:35:43,803 - root - INFO - | Epoch: 104/150 | Train Time: 0.930s | Train Loss: 0.099134 |
2020-05-16 21:35:44,759 - root - INFO - | Epoch: 105/150 | Train Time: 0.956s | Train Loss: 0.098809 |
2020-05-16 21:35:45,707 - root - INFO - | Epoch: 106/150 | Train Time: 0.947s | Train Loss: 0.099200 |
2020-05-16 21:35:46,771 - root - INFO - | Epoch: 107/150 | Train Time: 1.064s | Train Loss: 0.099545 |
2020-05-16 21:35:47,897 - root - INFO - | Epoch: 108/150 | Train Time: 1.125s | Train Loss: 0.098946 |
2020-05-16 21:35:48,900 - root - INFO - | Epoch: 109/150 | Train Time: 1.003s | Train Loss: 0.098697 |
2020-05-16 21:35:49,973 - root - INFO - | Epoch: 110/150 | Train Time: 1.072s | Train Loss: 0.099009 |
2020-05-16 21:35:50,932 - root - INFO - | Epoch: 111/150 | Train Time: 0.958s | Train Loss: 0.098009 |
2020-05-16 21:35:51,896 - root - INFO - | Epoch: 112/150 | Train Time: 0.964s | Train Loss: 0.098601 |
2020-05-16 21:35:52,938 - root - INFO - | Epoch: 113/150 | Train Time: 1.042s | Train Loss: 0.098769 |
2020-05-16 21:35:53,897 - root - INFO - | Epoch: 114/150 | Train Time: 0.958s | Train Loss: 0.097875 |
2020-05-16 21:35:54,801 - root - INFO - | Epoch: 115/150 | Train Time: 0.904s | Train Loss: 0.098908 |
2020-05-16 21:35:55,796 - root - INFO - | Epoch: 116/150 | Train Time: 0.994s | Train Loss: 0.098207 |
2020-05-16 21:35:56,874 - root - INFO - | Epoch: 117/150 | Train Time: 1.077s | Train Loss: 0.098048 |
2020-05-16 21:35:57,881 - root - INFO - | Epoch: 118/150 | Train Time: 1.007s | Train Loss: 0.097504 |
2020-05-16 21:35:58,818 - root - INFO - | Epoch: 119/150 | Train Time: 0.937s | Train Loss: 0.098185 |
2020-05-16 21:35:59,817 - root - INFO - | Epoch: 120/150 | Train Time: 0.998s | Train Loss: 0.098045 |
2020-05-16 21:36:00,831 - root - INFO - | Epoch: 121/150 | Train Time: 1.013s | Train Loss: 0.097549 |
2020-05-16 21:36:01,766 - root - INFO - | Epoch: 122/150 | Train Time: 0.935s | Train Loss: 0.096471 |
2020-05-16 21:36:02,720 - root - INFO - | Epoch: 123/150 | Train Time: 0.954s | Train Loss: 0.098367 |
2020-05-16 21:36:03,768 - root - INFO - | Epoch: 124/150 | Train Time: 1.047s | Train Loss: 0.097957 |
2020-05-16 21:36:04,796 - root - INFO - | Epoch: 125/150 | Train Time: 1.028s | Train Loss: 0.097329 |
2020-05-16 21:36:05,798 - root - INFO - | Epoch: 126/150 | Train Time: 1.001s | Train Loss: 0.098209 |
2020-05-16 21:36:06,822 - root - INFO - | Epoch: 127/150 | Train Time: 1.024s | Train Loss: 0.097216 |
2020-05-16 21:36:07,734 - root - INFO - | Epoch: 128/150 | Train Time: 0.912s | Train Loss: 0.097361 |
2020-05-16 21:36:08,691 - root - INFO - | Epoch: 129/150 | Train Time: 0.956s | Train Loss: 0.097545 |
2020-05-16 21:36:09,561 - root - INFO - | Epoch: 130/150 | Train Time: 0.870s | Train Loss: 0.097482 |
2020-05-16 21:36:10,535 - root - INFO - | Epoch: 131/150 | Train Time: 0.974s | Train Loss: 0.097297 |
2020-05-16 21:36:11,474 - root - INFO - | Epoch: 132/150 | Train Time: 0.938s | Train Loss: 0.096346 |
2020-05-16 21:36:12,480 - root - INFO - | Epoch: 133/150 | Train Time: 1.006s | Train Loss: 0.096754 |
2020-05-16 21:36:13,394 - root - INFO - | Epoch: 134/150 | Train Time: 0.913s | Train Loss: 0.097495 |
2020-05-16 21:36:14,389 - root - INFO - | Epoch: 135/150 | Train Time: 0.994s | Train Loss: 0.097530 |
2020-05-16 21:36:15,302 - root - INFO - | Epoch: 136/150 | Train Time: 0.913s | Train Loss: 0.096954 |
2020-05-16 21:36:16,240 - root - INFO - | Epoch: 137/150 | Train Time: 0.937s | Train Loss: 0.096577 |
2020-05-16 21:36:17,224 - root - INFO - | Epoch: 138/150 | Train Time: 0.983s | Train Loss: 0.097432 |
2020-05-16 21:36:18,259 - root - INFO - | Epoch: 139/150 | Train Time: 1.034s | Train Loss: 0.096432 |
2020-05-16 21:36:19,241 - root - INFO - | Epoch: 140/150 | Train Time: 0.981s | Train Loss: 0.096314 |
2020-05-16 21:36:20,340 - root - INFO - | Epoch: 141/150 | Train Time: 1.098s | Train Loss: 0.096878 |
2020-05-16 21:36:21,464 - root - INFO - | Epoch: 142/150 | Train Time: 1.123s | Train Loss: 0.095804 |
2020-05-16 21:36:22,525 - root - INFO - | Epoch: 143/150 | Train Time: 1.060s | Train Loss: 0.096524 |
2020-05-16 21:36:23,511 - root - INFO - | Epoch: 144/150 | Train Time: 0.986s | Train Loss: 0.096117 |
2020-05-16 21:36:24,478 - root - INFO - | Epoch: 145/150 | Train Time: 0.966s | Train Loss: 0.096370 |
2020-05-16 21:36:25,525 - root - INFO - | Epoch: 146/150 | Train Time: 1.046s | Train Loss: 0.096047 |
2020-05-16 21:36:26,469 - root - INFO - | Epoch: 147/150 | Train Time: 0.943s | Train Loss: 0.095479 |
2020-05-16 21:36:27,429 - root - INFO - | Epoch: 148/150 | Train Time: 0.960s | Train Loss: 0.096693 |
2020-05-16 21:36:28,441 - root - INFO - | Epoch: 149/150 | Train Time: 1.011s | Train Loss: 0.096693 |
2020-05-16 21:36:29,450 - root - INFO - | Epoch: 150/150 | Train Time: 1.008s | Train Loss: 0.096432 |
2020-05-16 21:36:29,451 - root - INFO - Training Time: 150.849s
2020-05-16 21:36:29,451 - root - INFO - Finished training.
2020-05-16 21:36:29,452 - root - INFO - Starting testing...
2020-05-16 21:36:30,377 - root - INFO - Test Loss: 0.209272
2020-05-16 21:36:30,377 - root - INFO - Test AUC: 84.27%
2020-05-16 21:36:30,377 - root - INFO - Test Time: 0.913s
2020-05-16 21:36:30,377 - root - INFO - Finished testing.
