2020-05-17 09:26:22,101 - root - INFO - Log file is ../log/mnist/scenario_2/deepSAD//log_7_2_001.txt
2020-05-17 09:26:22,101 - root - INFO - Data path is ../data
2020-05-17 09:26:22,102 - root - INFO - Export path is ../log/mnist/scenario_2/deepSAD/
2020-05-17 09:26:22,102 - root - INFO - Dataset: mnist
2020-05-17 09:26:22,102 - root - INFO - Normal class: 7
2020-05-17 09:26:22,102 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-17 09:26:22,102 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-17 09:26:22,102 - root - INFO - Pollution ratio of unlabeled train data: 0.01
2020-05-17 09:26:22,102 - root - INFO - Scenario Running: 2
2020-05-17 09:26:22,102 - root - INFO - Train only the network: True
2020-05-17 09:26:22,102 - root - INFO - Output and AE dimensions: 128
2020-05-17 09:26:22,102 - root - INFO - Known anomaly class: 2
2020-05-17 09:26:22,102 - root - INFO - Network: mnist_LeNet
2020-05-17 09:26:22,103 - root - INFO - Eta-parameter: 1.00
2020-05-17 09:26:22,111 - root - INFO - Set seed to 0.
2020-05-17 09:26:22,135 - root - INFO - Computation device: cuda
2020-05-17 09:26:22,135 - root - INFO - Number of threads: 0
2020-05-17 09:26:22,135 - root - INFO - Number of dataloader workers: 6
2020-05-17 09:26:24,247 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-17 09:26:24,247 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-17 09:26:24,247 - root - INFO - Training optimizer: adam
2020-05-17 09:26:24,247 - root - INFO - Training learning rate: 0.0001
2020-05-17 09:26:24,247 - root - INFO - Training epochs: 150
2020-05-17 09:26:24,247 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-17 09:26:24,248 - root - INFO - Training batch size: 200
2020-05-17 09:26:24,248 - root - INFO - Training weight decay: 5e-07
2020-05-17 09:26:24,249 - root - INFO - Starting training...
2020-05-17 09:26:26,342 - root - INFO - | Epoch: 001/150 | Train Time: 2.091s | Train Loss: 0.319097 |
2020-05-17 09:26:27,005 - root - INFO - | Epoch: 002/150 | Train Time: 0.662s | Train Loss: 0.203456 |
2020-05-17 09:26:27,829 - root - INFO - | Epoch: 003/150 | Train Time: 0.824s | Train Loss: 0.164982 |
2020-05-17 09:26:28,664 - root - INFO - | Epoch: 004/150 | Train Time: 0.834s | Train Loss: 0.143000 |
2020-05-17 09:26:29,515 - root - INFO - | Epoch: 005/150 | Train Time: 0.850s | Train Loss: 0.130301 |
2020-05-17 09:26:30,386 - root - INFO - | Epoch: 006/150 | Train Time: 0.871s | Train Loss: 0.121266 |
2020-05-17 09:26:31,302 - root - INFO - | Epoch: 007/150 | Train Time: 0.915s | Train Loss: 0.113728 |
2020-05-17 09:26:32,163 - root - INFO - | Epoch: 008/150 | Train Time: 0.861s | Train Loss: 0.107444 |
2020-05-17 09:26:33,082 - root - INFO - | Epoch: 009/150 | Train Time: 0.917s | Train Loss: 0.103867 |
2020-05-17 09:26:33,935 - root - INFO - | Epoch: 010/150 | Train Time: 0.853s | Train Loss: 0.099343 |
2020-05-17 09:26:34,757 - root - INFO - | Epoch: 011/150 | Train Time: 0.821s | Train Loss: 0.096374 |
2020-05-17 09:26:35,599 - root - INFO - | Epoch: 012/150 | Train Time: 0.841s | Train Loss: 0.092948 |
2020-05-17 09:26:36,422 - root - INFO - | Epoch: 013/150 | Train Time: 0.822s | Train Loss: 0.090210 |
2020-05-17 09:26:37,277 - root - INFO - | Epoch: 014/150 | Train Time: 0.854s | Train Loss: 0.087259 |
2020-05-17 09:26:38,070 - root - INFO - | Epoch: 015/150 | Train Time: 0.792s | Train Loss: 0.085844 |
2020-05-17 09:26:38,884 - root - INFO - | Epoch: 016/150 | Train Time: 0.813s | Train Loss: 0.083540 |
2020-05-17 09:26:39,808 - root - INFO - | Epoch: 017/150 | Train Time: 0.923s | Train Loss: 0.081366 |
2020-05-17 09:26:40,658 - root - INFO - | Epoch: 018/150 | Train Time: 0.849s | Train Loss: 0.079842 |
2020-05-17 09:26:41,495 - root - INFO - | Epoch: 019/150 | Train Time: 0.837s | Train Loss: 0.078091 |
2020-05-17 09:26:42,321 - root - INFO - | Epoch: 020/150 | Train Time: 0.825s | Train Loss: 0.076601 |
2020-05-17 09:26:43,117 - root - INFO - | Epoch: 021/150 | Train Time: 0.795s | Train Loss: 0.074951 |
2020-05-17 09:26:43,984 - root - INFO - | Epoch: 022/150 | Train Time: 0.866s | Train Loss: 0.073169 |
2020-05-17 09:26:44,795 - root - INFO - | Epoch: 023/150 | Train Time: 0.811s | Train Loss: 0.072614 |
2020-05-17 09:26:45,570 - root - INFO - | Epoch: 024/150 | Train Time: 0.775s | Train Loss: 0.071591 |
2020-05-17 09:26:46,440 - root - INFO - | Epoch: 025/150 | Train Time: 0.869s | Train Loss: 0.070349 |
2020-05-17 09:26:47,297 - root - INFO - | Epoch: 026/150 | Train Time: 0.856s | Train Loss: 0.069108 |
2020-05-17 09:26:48,168 - root - INFO - | Epoch: 027/150 | Train Time: 0.871s | Train Loss: 0.068069 |
2020-05-17 09:26:49,046 - root - INFO - | Epoch: 028/150 | Train Time: 0.877s | Train Loss: 0.067014 |
2020-05-17 09:26:49,939 - root - INFO - | Epoch: 029/150 | Train Time: 0.892s | Train Loss: 0.066639 |
2020-05-17 09:26:50,795 - root - INFO - | Epoch: 030/150 | Train Time: 0.855s | Train Loss: 0.065418 |
2020-05-17 09:26:51,680 - root - INFO - | Epoch: 031/150 | Train Time: 0.885s | Train Loss: 0.064408 |
2020-05-17 09:26:52,528 - root - INFO - | Epoch: 032/150 | Train Time: 0.847s | Train Loss: 0.064246 |
2020-05-17 09:26:53,354 - root - INFO - | Epoch: 033/150 | Train Time: 0.825s | Train Loss: 0.063150 |
2020-05-17 09:26:54,195 - root - INFO - | Epoch: 034/150 | Train Time: 0.841s | Train Loss: 0.062643 |
2020-05-17 09:26:55,066 - root - INFO - | Epoch: 035/150 | Train Time: 0.870s | Train Loss: 0.061751 |
2020-05-17 09:26:55,911 - root - INFO - | Epoch: 036/150 | Train Time: 0.844s | Train Loss: 0.061138 |
2020-05-17 09:26:56,805 - root - INFO - | Epoch: 037/150 | Train Time: 0.893s | Train Loss: 0.060226 |
2020-05-17 09:26:57,742 - root - INFO - | Epoch: 038/150 | Train Time: 0.936s | Train Loss: 0.059664 |
2020-05-17 09:26:58,632 - root - INFO - | Epoch: 039/150 | Train Time: 0.889s | Train Loss: 0.059141 |
2020-05-17 09:26:59,483 - root - INFO - | Epoch: 040/150 | Train Time: 0.851s | Train Loss: 0.057807 |
2020-05-17 09:27:00,260 - root - INFO - | Epoch: 041/150 | Train Time: 0.777s | Train Loss: 0.058275 |
2020-05-17 09:27:01,086 - root - INFO - | Epoch: 042/150 | Train Time: 0.825s | Train Loss: 0.057733 |
2020-05-17 09:27:01,941 - root - INFO - | Epoch: 043/150 | Train Time: 0.853s | Train Loss: 0.056905 |
2020-05-17 09:27:02,837 - root - INFO - | Epoch: 044/150 | Train Time: 0.895s | Train Loss: 0.056846 |
2020-05-17 09:27:03,727 - root - INFO - | Epoch: 045/150 | Train Time: 0.889s | Train Loss: 0.055956 |
2020-05-17 09:27:04,593 - root - INFO - | Epoch: 046/150 | Train Time: 0.865s | Train Loss: 0.055471 |
2020-05-17 09:27:05,401 - root - INFO - | Epoch: 047/150 | Train Time: 0.807s | Train Loss: 0.055328 |
2020-05-17 09:27:06,291 - root - INFO - | Epoch: 048/150 | Train Time: 0.889s | Train Loss: 0.055207 |
2020-05-17 09:27:07,130 - root - INFO - | Epoch: 049/150 | Train Time: 0.838s | Train Loss: 0.053992 |
2020-05-17 09:27:07,929 - root - INFO - | Epoch: 050/150 | Train Time: 0.798s | Train Loss: 0.053482 |
2020-05-17 09:27:07,930 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-17 09:27:08,712 - root - INFO - | Epoch: 051/150 | Train Time: 0.781s | Train Loss: 0.053603 |
2020-05-17 09:27:09,587 - root - INFO - | Epoch: 052/150 | Train Time: 0.875s | Train Loss: 0.053617 |
2020-05-17 09:27:10,436 - root - INFO - | Epoch: 053/150 | Train Time: 0.849s | Train Loss: 0.053377 |
2020-05-17 09:27:11,283 - root - INFO - | Epoch: 054/150 | Train Time: 0.846s | Train Loss: 0.053602 |
2020-05-17 09:27:12,154 - root - INFO - | Epoch: 055/150 | Train Time: 0.870s | Train Loss: 0.052993 |
2020-05-17 09:27:13,059 - root - INFO - | Epoch: 056/150 | Train Time: 0.905s | Train Loss: 0.053552 |
2020-05-17 09:27:13,892 - root - INFO - | Epoch: 057/150 | Train Time: 0.832s | Train Loss: 0.052872 |
2020-05-17 09:27:14,694 - root - INFO - | Epoch: 058/150 | Train Time: 0.802s | Train Loss: 0.053404 |
2020-05-17 09:27:15,590 - root - INFO - | Epoch: 059/150 | Train Time: 0.895s | Train Loss: 0.052918 |
2020-05-17 09:27:16,419 - root - INFO - | Epoch: 060/150 | Train Time: 0.828s | Train Loss: 0.052763 |
2020-05-17 09:27:17,311 - root - INFO - | Epoch: 061/150 | Train Time: 0.891s | Train Loss: 0.053013 |
2020-05-17 09:27:18,147 - root - INFO - | Epoch: 062/150 | Train Time: 0.835s | Train Loss: 0.052935 |
2020-05-17 09:27:18,996 - root - INFO - | Epoch: 063/150 | Train Time: 0.848s | Train Loss: 0.052996 |
2020-05-17 09:27:19,832 - root - INFO - | Epoch: 064/150 | Train Time: 0.835s | Train Loss: 0.053075 |
2020-05-17 09:27:20,669 - root - INFO - | Epoch: 065/150 | Train Time: 0.836s | Train Loss: 0.053201 |
2020-05-17 09:27:21,456 - root - INFO - | Epoch: 066/150 | Train Time: 0.786s | Train Loss: 0.052893 |
2020-05-17 09:27:22,305 - root - INFO - | Epoch: 067/150 | Train Time: 0.849s | Train Loss: 0.052640 |
2020-05-17 09:27:23,227 - root - INFO - | Epoch: 068/150 | Train Time: 0.921s | Train Loss: 0.052975 |
2020-05-17 09:27:24,062 - root - INFO - | Epoch: 069/150 | Train Time: 0.835s | Train Loss: 0.052513 |
2020-05-17 09:27:24,865 - root - INFO - | Epoch: 070/150 | Train Time: 0.802s | Train Loss: 0.052736 |
2020-05-17 09:27:25,647 - root - INFO - | Epoch: 071/150 | Train Time: 0.782s | Train Loss: 0.052199 |
2020-05-17 09:27:26,491 - root - INFO - | Epoch: 072/150 | Train Time: 0.842s | Train Loss: 0.052433 |
2020-05-17 09:27:27,368 - root - INFO - | Epoch: 073/150 | Train Time: 0.877s | Train Loss: 0.052644 |
2020-05-17 09:27:28,228 - root - INFO - | Epoch: 074/150 | Train Time: 0.858s | Train Loss: 0.052476 |
2020-05-17 09:27:29,080 - root - INFO - | Epoch: 075/150 | Train Time: 0.852s | Train Loss: 0.051945 |
2020-05-17 09:27:29,782 - root - INFO - | Epoch: 076/150 | Train Time: 0.702s | Train Loss: 0.052415 |
2020-05-17 09:27:30,675 - root - INFO - | Epoch: 077/150 | Train Time: 0.892s | Train Loss: 0.052386 |
2020-05-17 09:27:31,588 - root - INFO - | Epoch: 078/150 | Train Time: 0.912s | Train Loss: 0.052104 |
2020-05-17 09:27:32,476 - root - INFO - | Epoch: 079/150 | Train Time: 0.887s | Train Loss: 0.051889 |
2020-05-17 09:27:33,340 - root - INFO - | Epoch: 080/150 | Train Time: 0.864s | Train Loss: 0.052354 |
2020-05-17 09:27:34,235 - root - INFO - | Epoch: 081/150 | Train Time: 0.894s | Train Loss: 0.051743 |
2020-05-17 09:27:35,083 - root - INFO - | Epoch: 082/150 | Train Time: 0.847s | Train Loss: 0.051751 |
2020-05-17 09:27:36,001 - root - INFO - | Epoch: 083/150 | Train Time: 0.917s | Train Loss: 0.051578 |
2020-05-17 09:27:36,865 - root - INFO - | Epoch: 084/150 | Train Time: 0.864s | Train Loss: 0.052293 |
2020-05-17 09:27:37,766 - root - INFO - | Epoch: 085/150 | Train Time: 0.900s | Train Loss: 0.052135 |
2020-05-17 09:27:38,655 - root - INFO - | Epoch: 086/150 | Train Time: 0.888s | Train Loss: 0.052076 |
2020-05-17 09:27:39,515 - root - INFO - | Epoch: 087/150 | Train Time: 0.859s | Train Loss: 0.051752 |
2020-05-17 09:27:40,295 - root - INFO - | Epoch: 088/150 | Train Time: 0.778s | Train Loss: 0.051554 |
2020-05-17 09:27:41,032 - root - INFO - | Epoch: 089/150 | Train Time: 0.736s | Train Loss: 0.051938 |
2020-05-17 09:27:41,895 - root - INFO - | Epoch: 090/150 | Train Time: 0.863s | Train Loss: 0.051682 |
2020-05-17 09:27:42,761 - root - INFO - | Epoch: 091/150 | Train Time: 0.865s | Train Loss: 0.051989 |
2020-05-17 09:27:43,571 - root - INFO - | Epoch: 092/150 | Train Time: 0.809s | Train Loss: 0.051618 |
2020-05-17 09:27:44,400 - root - INFO - | Epoch: 093/150 | Train Time: 0.828s | Train Loss: 0.051801 |
2020-05-17 09:27:45,238 - root - INFO - | Epoch: 094/150 | Train Time: 0.838s | Train Loss: 0.051814 |
2020-05-17 09:27:46,113 - root - INFO - | Epoch: 095/150 | Train Time: 0.874s | Train Loss: 0.051652 |
2020-05-17 09:27:46,960 - root - INFO - | Epoch: 096/150 | Train Time: 0.845s | Train Loss: 0.051014 |
2020-05-17 09:27:47,780 - root - INFO - | Epoch: 097/150 | Train Time: 0.819s | Train Loss: 0.051327 |
2020-05-17 09:27:48,672 - root - INFO - | Epoch: 098/150 | Train Time: 0.891s | Train Loss: 0.051462 |
2020-05-17 09:27:49,513 - root - INFO - | Epoch: 099/150 | Train Time: 0.840s | Train Loss: 0.051580 |
2020-05-17 09:27:50,349 - root - INFO - | Epoch: 100/150 | Train Time: 0.836s | Train Loss: 0.051083 |
2020-05-17 09:27:51,216 - root - INFO - | Epoch: 101/150 | Train Time: 0.866s | Train Loss: 0.051288 |
2020-05-17 09:27:52,083 - root - INFO - | Epoch: 102/150 | Train Time: 0.866s | Train Loss: 0.050954 |
2020-05-17 09:27:52,859 - root - INFO - | Epoch: 103/150 | Train Time: 0.774s | Train Loss: 0.051085 |
2020-05-17 09:27:53,742 - root - INFO - | Epoch: 104/150 | Train Time: 0.882s | Train Loss: 0.051458 |
2020-05-17 09:27:54,622 - root - INFO - | Epoch: 105/150 | Train Time: 0.879s | Train Loss: 0.051110 |
2020-05-17 09:27:55,490 - root - INFO - | Epoch: 106/150 | Train Time: 0.868s | Train Loss: 0.050970 |
2020-05-17 09:27:56,351 - root - INFO - | Epoch: 107/150 | Train Time: 0.860s | Train Loss: 0.050889 |
2020-05-17 09:27:57,210 - root - INFO - | Epoch: 108/150 | Train Time: 0.859s | Train Loss: 0.051155 |
2020-05-17 09:27:58,050 - root - INFO - | Epoch: 109/150 | Train Time: 0.839s | Train Loss: 0.050355 |
2020-05-17 09:27:58,911 - root - INFO - | Epoch: 110/150 | Train Time: 0.861s | Train Loss: 0.050480 |
2020-05-17 09:27:59,808 - root - INFO - | Epoch: 111/150 | Train Time: 0.896s | Train Loss: 0.050795 |
2020-05-17 09:28:00,549 - root - INFO - | Epoch: 112/150 | Train Time: 0.740s | Train Loss: 0.050717 |
2020-05-17 09:28:01,368 - root - INFO - | Epoch: 113/150 | Train Time: 0.818s | Train Loss: 0.050393 |
2020-05-17 09:28:02,253 - root - INFO - | Epoch: 114/150 | Train Time: 0.885s | Train Loss: 0.050765 |
2020-05-17 09:28:03,128 - root - INFO - | Epoch: 115/150 | Train Time: 0.874s | Train Loss: 0.050712 |
2020-05-17 09:28:03,922 - root - INFO - | Epoch: 116/150 | Train Time: 0.794s | Train Loss: 0.050165 |
2020-05-17 09:28:04,790 - root - INFO - | Epoch: 117/150 | Train Time: 0.867s | Train Loss: 0.050693 |
2020-05-17 09:28:05,666 - root - INFO - | Epoch: 118/150 | Train Time: 0.875s | Train Loss: 0.050318 |
2020-05-17 09:28:06,423 - root - INFO - | Epoch: 119/150 | Train Time: 0.756s | Train Loss: 0.050518 |
2020-05-17 09:28:07,283 - root - INFO - | Epoch: 120/150 | Train Time: 0.860s | Train Loss: 0.050479 |
2020-05-17 09:28:08,202 - root - INFO - | Epoch: 121/150 | Train Time: 0.918s | Train Loss: 0.050207 |
2020-05-17 09:28:09,098 - root - INFO - | Epoch: 122/150 | Train Time: 0.894s | Train Loss: 0.050586 |
2020-05-17 09:28:09,979 - root - INFO - | Epoch: 123/150 | Train Time: 0.881s | Train Loss: 0.050418 |
2020-05-17 09:28:10,895 - root - INFO - | Epoch: 124/150 | Train Time: 0.914s | Train Loss: 0.050383 |
2020-05-17 09:28:11,707 - root - INFO - | Epoch: 125/150 | Train Time: 0.811s | Train Loss: 0.050224 |
2020-05-17 09:28:12,621 - root - INFO - | Epoch: 126/150 | Train Time: 0.913s | Train Loss: 0.049977 |
2020-05-17 09:28:13,515 - root - INFO - | Epoch: 127/150 | Train Time: 0.893s | Train Loss: 0.050056 |
2020-05-17 09:28:14,364 - root - INFO - | Epoch: 128/150 | Train Time: 0.848s | Train Loss: 0.050045 |
2020-05-17 09:28:15,171 - root - INFO - | Epoch: 129/150 | Train Time: 0.806s | Train Loss: 0.050118 |
2020-05-17 09:28:16,079 - root - INFO - | Epoch: 130/150 | Train Time: 0.906s | Train Loss: 0.049939 |
2020-05-17 09:28:16,952 - root - INFO - | Epoch: 131/150 | Train Time: 0.873s | Train Loss: 0.049997 |
2020-05-17 09:28:17,805 - root - INFO - | Epoch: 132/150 | Train Time: 0.851s | Train Loss: 0.048742 |
2020-05-17 09:28:18,680 - root - INFO - | Epoch: 133/150 | Train Time: 0.874s | Train Loss: 0.049604 |
2020-05-17 09:28:19,575 - root - INFO - | Epoch: 134/150 | Train Time: 0.894s | Train Loss: 0.049991 |
2020-05-17 09:28:20,500 - root - INFO - | Epoch: 135/150 | Train Time: 0.925s | Train Loss: 0.049963 |
2020-05-17 09:28:21,381 - root - INFO - | Epoch: 136/150 | Train Time: 0.880s | Train Loss: 0.049609 |
2020-05-17 09:28:22,186 - root - INFO - | Epoch: 137/150 | Train Time: 0.804s | Train Loss: 0.049813 |
2020-05-17 09:28:23,076 - root - INFO - | Epoch: 138/150 | Train Time: 0.889s | Train Loss: 0.049417 |
2020-05-17 09:28:23,915 - root - INFO - | Epoch: 139/150 | Train Time: 0.838s | Train Loss: 0.049590 |
2020-05-17 09:28:24,837 - root - INFO - | Epoch: 140/150 | Train Time: 0.921s | Train Loss: 0.049432 |
2020-05-17 09:28:25,644 - root - INFO - | Epoch: 141/150 | Train Time: 0.805s | Train Loss: 0.048982 |
2020-05-17 09:28:26,442 - root - INFO - | Epoch: 142/150 | Train Time: 0.798s | Train Loss: 0.049339 |
2020-05-17 09:28:27,289 - root - INFO - | Epoch: 143/150 | Train Time: 0.846s | Train Loss: 0.048619 |
2020-05-17 09:28:28,221 - root - INFO - | Epoch: 144/150 | Train Time: 0.930s | Train Loss: 0.049231 |
2020-05-17 09:28:29,094 - root - INFO - | Epoch: 145/150 | Train Time: 0.872s | Train Loss: 0.049320 |
2020-05-17 09:28:29,963 - root - INFO - | Epoch: 146/150 | Train Time: 0.868s | Train Loss: 0.049166 |
2020-05-17 09:28:30,771 - root - INFO - | Epoch: 147/150 | Train Time: 0.808s | Train Loss: 0.049224 |
2020-05-17 09:28:31,645 - root - INFO - | Epoch: 148/150 | Train Time: 0.872s | Train Loss: 0.048997 |
2020-05-17 09:28:32,505 - root - INFO - | Epoch: 149/150 | Train Time: 0.859s | Train Loss: 0.048863 |
2020-05-17 09:28:33,264 - root - INFO - | Epoch: 150/150 | Train Time: 0.758s | Train Loss: 0.049299 |
2020-05-17 09:28:33,265 - root - INFO - Training Time: 129.016s
2020-05-17 09:28:33,265 - root - INFO - Finished training.
2020-05-17 09:28:33,266 - root - INFO - Starting testing...
2020-05-17 09:28:34,091 - root - INFO - Test Loss: 1.138178
2020-05-17 09:28:34,092 - root - INFO - Test AUC: 95.34%
2020-05-17 09:28:34,092 - root - INFO - Test Time: 0.797s
2020-05-17 09:28:34,092 - root - INFO - Finished testing.
