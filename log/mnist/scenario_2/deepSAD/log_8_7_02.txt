2020-05-17 15:47:00,460 - root - INFO - Log file is ../log/mnist/scenario_2/deepSAD//log_8_7_02.txt
2020-05-17 15:47:00,460 - root - INFO - Data path is ../data
2020-05-17 15:47:00,461 - root - INFO - Export path is ../log/mnist/scenario_2/deepSAD/
2020-05-17 15:47:00,461 - root - INFO - Dataset: mnist
2020-05-17 15:47:00,461 - root - INFO - Normal class: 8
2020-05-17 15:47:00,461 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-17 15:47:00,461 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-17 15:47:00,461 - root - INFO - Pollution ratio of unlabeled train data: 0.20
2020-05-17 15:47:00,461 - root - INFO - Scenario Running: 2
2020-05-17 15:47:00,461 - root - INFO - Train only the network: True
2020-05-17 15:47:00,461 - root - INFO - Output and AE dimensions: 128
2020-05-17 15:47:00,461 - root - INFO - Known anomaly class: 7
2020-05-17 15:47:00,461 - root - INFO - Network: mnist_LeNet
2020-05-17 15:47:00,461 - root - INFO - Eta-parameter: 1.00
2020-05-17 15:47:00,469 - root - INFO - Set seed to 0.
2020-05-17 15:47:00,535 - root - INFO - Computation device: cuda
2020-05-17 15:47:00,535 - root - INFO - Number of threads: 0
2020-05-17 15:47:00,535 - root - INFO - Number of dataloader workers: 6
2020-05-17 15:47:02,832 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-17 15:47:02,833 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-17 15:47:02,833 - root - INFO - Training optimizer: adam
2020-05-17 15:47:02,833 - root - INFO - Training learning rate: 0.0001
2020-05-17 15:47:02,833 - root - INFO - Training epochs: 150
2020-05-17 15:47:02,833 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-17 15:47:02,833 - root - INFO - Training batch size: 200
2020-05-17 15:47:02,833 - root - INFO - Training weight decay: 5e-07
2020-05-17 15:47:02,834 - root - INFO - Starting training...
2020-05-17 15:47:04,885 - root - INFO - | Epoch: 001/150 | Train Time: 2.048s | Train Loss: 0.375976 |
2020-05-17 15:47:05,695 - root - INFO - | Epoch: 002/150 | Train Time: 0.809s | Train Loss: 0.266655 |
2020-05-17 15:47:06,501 - root - INFO - | Epoch: 003/150 | Train Time: 0.806s | Train Loss: 0.226147 |
2020-05-17 15:47:07,233 - root - INFO - | Epoch: 004/150 | Train Time: 0.731s | Train Loss: 0.204975 |
2020-05-17 15:47:07,964 - root - INFO - | Epoch: 005/150 | Train Time: 0.731s | Train Loss: 0.192531 |
2020-05-17 15:47:08,719 - root - INFO - | Epoch: 006/150 | Train Time: 0.755s | Train Loss: 0.182439 |
2020-05-17 15:47:09,649 - root - INFO - | Epoch: 007/150 | Train Time: 0.930s | Train Loss: 0.175158 |
2020-05-17 15:47:10,529 - root - INFO - | Epoch: 008/150 | Train Time: 0.879s | Train Loss: 0.168697 |
2020-05-17 15:47:11,309 - root - INFO - | Epoch: 009/150 | Train Time: 0.779s | Train Loss: 0.164851 |
2020-05-17 15:47:11,969 - root - INFO - | Epoch: 010/150 | Train Time: 0.660s | Train Loss: 0.159840 |
2020-05-17 15:47:12,684 - root - INFO - | Epoch: 011/150 | Train Time: 0.714s | Train Loss: 0.155443 |
2020-05-17 15:47:13,403 - root - INFO - | Epoch: 012/150 | Train Time: 0.718s | Train Loss: 0.153105 |
2020-05-17 15:47:14,133 - root - INFO - | Epoch: 013/150 | Train Time: 0.730s | Train Loss: 0.149927 |
2020-05-17 15:47:14,863 - root - INFO - | Epoch: 014/150 | Train Time: 0.729s | Train Loss: 0.146278 |
2020-05-17 15:47:15,562 - root - INFO - | Epoch: 015/150 | Train Time: 0.699s | Train Loss: 0.144844 |
2020-05-17 15:47:16,209 - root - INFO - | Epoch: 016/150 | Train Time: 0.646s | Train Loss: 0.142616 |
2020-05-17 15:47:16,903 - root - INFO - | Epoch: 017/150 | Train Time: 0.693s | Train Loss: 0.140622 |
2020-05-17 15:47:17,652 - root - INFO - | Epoch: 018/150 | Train Time: 0.749s | Train Loss: 0.138687 |
2020-05-17 15:47:18,468 - root - INFO - | Epoch: 019/150 | Train Time: 0.816s | Train Loss: 0.137039 |
2020-05-17 15:47:19,262 - root - INFO - | Epoch: 020/150 | Train Time: 0.793s | Train Loss: 0.135162 |
2020-05-17 15:47:19,972 - root - INFO - | Epoch: 021/150 | Train Time: 0.709s | Train Loss: 0.133065 |
2020-05-17 15:47:20,715 - root - INFO - | Epoch: 022/150 | Train Time: 0.742s | Train Loss: 0.131889 |
2020-05-17 15:47:21,468 - root - INFO - | Epoch: 023/150 | Train Time: 0.753s | Train Loss: 0.131255 |
2020-05-17 15:47:22,283 - root - INFO - | Epoch: 024/150 | Train Time: 0.814s | Train Loss: 0.130303 |
2020-05-17 15:47:23,119 - root - INFO - | Epoch: 025/150 | Train Time: 0.835s | Train Loss: 0.128930 |
2020-05-17 15:47:23,989 - root - INFO - | Epoch: 026/150 | Train Time: 0.869s | Train Loss: 0.127030 |
2020-05-17 15:47:24,803 - root - INFO - | Epoch: 027/150 | Train Time: 0.814s | Train Loss: 0.126783 |
2020-05-17 15:47:25,503 - root - INFO - | Epoch: 028/150 | Train Time: 0.699s | Train Loss: 0.125108 |
2020-05-17 15:47:26,221 - root - INFO - | Epoch: 029/150 | Train Time: 0.718s | Train Loss: 0.124684 |
2020-05-17 15:47:26,942 - root - INFO - | Epoch: 030/150 | Train Time: 0.721s | Train Loss: 0.123993 |
2020-05-17 15:47:27,571 - root - INFO - | Epoch: 031/150 | Train Time: 0.628s | Train Loss: 0.120983 |
2020-05-17 15:47:28,249 - root - INFO - | Epoch: 032/150 | Train Time: 0.677s | Train Loss: 0.120537 |
2020-05-17 15:47:29,018 - root - INFO - | Epoch: 033/150 | Train Time: 0.769s | Train Loss: 0.121024 |
2020-05-17 15:47:29,796 - root - INFO - | Epoch: 034/150 | Train Time: 0.777s | Train Loss: 0.119102 |
2020-05-17 15:47:30,583 - root - INFO - | Epoch: 035/150 | Train Time: 0.786s | Train Loss: 0.119139 |
2020-05-17 15:47:31,371 - root - INFO - | Epoch: 036/150 | Train Time: 0.787s | Train Loss: 0.117620 |
2020-05-17 15:47:32,103 - root - INFO - | Epoch: 037/150 | Train Time: 0.732s | Train Loss: 0.117945 |
2020-05-17 15:47:32,861 - root - INFO - | Epoch: 038/150 | Train Time: 0.757s | Train Loss: 0.116194 |
2020-05-17 15:47:33,684 - root - INFO - | Epoch: 039/150 | Train Time: 0.823s | Train Loss: 0.116097 |
2020-05-17 15:47:34,432 - root - INFO - | Epoch: 040/150 | Train Time: 0.748s | Train Loss: 0.116260 |
2020-05-17 15:47:35,190 - root - INFO - | Epoch: 041/150 | Train Time: 0.758s | Train Loss: 0.114536 |
2020-05-17 15:47:35,910 - root - INFO - | Epoch: 042/150 | Train Time: 0.719s | Train Loss: 0.114888 |
2020-05-17 15:47:36,564 - root - INFO - | Epoch: 043/150 | Train Time: 0.653s | Train Loss: 0.113159 |
2020-05-17 15:47:37,211 - root - INFO - | Epoch: 044/150 | Train Time: 0.647s | Train Loss: 0.112902 |
2020-05-17 15:47:37,904 - root - INFO - | Epoch: 045/150 | Train Time: 0.693s | Train Loss: 0.112604 |
2020-05-17 15:47:38,499 - root - INFO - | Epoch: 046/150 | Train Time: 0.594s | Train Loss: 0.111806 |
2020-05-17 15:47:39,177 - root - INFO - | Epoch: 047/150 | Train Time: 0.678s | Train Loss: 0.111491 |
2020-05-17 15:47:39,904 - root - INFO - | Epoch: 048/150 | Train Time: 0.726s | Train Loss: 0.110784 |
2020-05-17 15:47:40,515 - root - INFO - | Epoch: 049/150 | Train Time: 0.611s | Train Loss: 0.109892 |
2020-05-17 15:47:41,176 - root - INFO - | Epoch: 050/150 | Train Time: 0.660s | Train Loss: 0.109535 |
2020-05-17 15:47:41,176 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-17 15:47:41,896 - root - INFO - | Epoch: 051/150 | Train Time: 0.720s | Train Loss: 0.108945 |
2020-05-17 15:47:42,618 - root - INFO - | Epoch: 052/150 | Train Time: 0.721s | Train Loss: 0.108567 |
2020-05-17 15:47:43,323 - root - INFO - | Epoch: 053/150 | Train Time: 0.704s | Train Loss: 0.108674 |
2020-05-17 15:47:44,155 - root - INFO - | Epoch: 054/150 | Train Time: 0.831s | Train Loss: 0.108982 |
2020-05-17 15:47:44,977 - root - INFO - | Epoch: 055/150 | Train Time: 0.822s | Train Loss: 0.108757 |
2020-05-17 15:47:45,724 - root - INFO - | Epoch: 056/150 | Train Time: 0.747s | Train Loss: 0.108555 |
2020-05-17 15:47:46,408 - root - INFO - | Epoch: 057/150 | Train Time: 0.683s | Train Loss: 0.108182 |
2020-05-17 15:47:47,094 - root - INFO - | Epoch: 058/150 | Train Time: 0.685s | Train Loss: 0.107961 |
2020-05-17 15:47:47,789 - root - INFO - | Epoch: 059/150 | Train Time: 0.695s | Train Loss: 0.108856 |
2020-05-17 15:47:48,499 - root - INFO - | Epoch: 060/150 | Train Time: 0.709s | Train Loss: 0.108385 |
2020-05-17 15:47:49,227 - root - INFO - | Epoch: 061/150 | Train Time: 0.728s | Train Loss: 0.108426 |
2020-05-17 15:47:49,904 - root - INFO - | Epoch: 062/150 | Train Time: 0.676s | Train Loss: 0.108384 |
2020-05-17 15:47:50,575 - root - INFO - | Epoch: 063/150 | Train Time: 0.670s | Train Loss: 0.108589 |
2020-05-17 15:47:51,346 - root - INFO - | Epoch: 064/150 | Train Time: 0.771s | Train Loss: 0.108541 |
2020-05-17 15:47:52,059 - root - INFO - | Epoch: 065/150 | Train Time: 0.713s | Train Loss: 0.108643 |
2020-05-17 15:47:52,841 - root - INFO - | Epoch: 066/150 | Train Time: 0.781s | Train Loss: 0.107291 |
2020-05-17 15:47:53,528 - root - INFO - | Epoch: 067/150 | Train Time: 0.686s | Train Loss: 0.108322 |
2020-05-17 15:47:54,337 - root - INFO - | Epoch: 068/150 | Train Time: 0.809s | Train Loss: 0.107867 |
2020-05-17 15:47:55,246 - root - INFO - | Epoch: 069/150 | Train Time: 0.908s | Train Loss: 0.107864 |
2020-05-17 15:47:56,041 - root - INFO - | Epoch: 070/150 | Train Time: 0.795s | Train Loss: 0.108379 |
2020-05-17 15:47:56,809 - root - INFO - | Epoch: 071/150 | Train Time: 0.768s | Train Loss: 0.107500 |
2020-05-17 15:47:57,638 - root - INFO - | Epoch: 072/150 | Train Time: 0.828s | Train Loss: 0.107963 |
2020-05-17 15:47:58,496 - root - INFO - | Epoch: 073/150 | Train Time: 0.857s | Train Loss: 0.108128 |
2020-05-17 15:47:59,218 - root - INFO - | Epoch: 074/150 | Train Time: 0.721s | Train Loss: 0.107922 |
2020-05-17 15:48:00,058 - root - INFO - | Epoch: 075/150 | Train Time: 0.840s | Train Loss: 0.107368 |
2020-05-17 15:48:00,826 - root - INFO - | Epoch: 076/150 | Train Time: 0.767s | Train Loss: 0.108042 |
2020-05-17 15:48:01,510 - root - INFO - | Epoch: 077/150 | Train Time: 0.684s | Train Loss: 0.106745 |
2020-05-17 15:48:02,308 - root - INFO - | Epoch: 078/150 | Train Time: 0.797s | Train Loss: 0.107299 |
2020-05-17 15:48:03,030 - root - INFO - | Epoch: 079/150 | Train Time: 0.721s | Train Loss: 0.107874 |
2020-05-17 15:48:03,821 - root - INFO - | Epoch: 080/150 | Train Time: 0.790s | Train Loss: 0.107737 |
2020-05-17 15:48:04,486 - root - INFO - | Epoch: 081/150 | Train Time: 0.666s | Train Loss: 0.107237 |
2020-05-17 15:48:05,150 - root - INFO - | Epoch: 082/150 | Train Time: 0.663s | Train Loss: 0.107234 |
2020-05-17 15:48:05,932 - root - INFO - | Epoch: 083/150 | Train Time: 0.781s | Train Loss: 0.107382 |
2020-05-17 15:48:06,643 - root - INFO - | Epoch: 084/150 | Train Time: 0.710s | Train Loss: 0.107013 |
2020-05-17 15:48:07,478 - root - INFO - | Epoch: 085/150 | Train Time: 0.835s | Train Loss: 0.107458 |
2020-05-17 15:48:08,116 - root - INFO - | Epoch: 086/150 | Train Time: 0.637s | Train Loss: 0.107441 |
2020-05-17 15:48:08,833 - root - INFO - | Epoch: 087/150 | Train Time: 0.717s | Train Loss: 0.106165 |
2020-05-17 15:48:09,488 - root - INFO - | Epoch: 088/150 | Train Time: 0.654s | Train Loss: 0.107232 |
2020-05-17 15:48:10,129 - root - INFO - | Epoch: 089/150 | Train Time: 0.641s | Train Loss: 0.107291 |
2020-05-17 15:48:10,847 - root - INFO - | Epoch: 090/150 | Train Time: 0.717s | Train Loss: 0.106873 |
2020-05-17 15:48:11,580 - root - INFO - | Epoch: 091/150 | Train Time: 0.733s | Train Loss: 0.106753 |
2020-05-17 15:48:12,229 - root - INFO - | Epoch: 092/150 | Train Time: 0.648s | Train Loss: 0.106120 |
2020-05-17 15:48:13,035 - root - INFO - | Epoch: 093/150 | Train Time: 0.806s | Train Loss: 0.106436 |
2020-05-17 15:48:13,750 - root - INFO - | Epoch: 094/150 | Train Time: 0.714s | Train Loss: 0.106874 |
2020-05-17 15:48:14,445 - root - INFO - | Epoch: 095/150 | Train Time: 0.694s | Train Loss: 0.106719 |
2020-05-17 15:48:15,226 - root - INFO - | Epoch: 096/150 | Train Time: 0.781s | Train Loss: 0.106824 |
2020-05-17 15:48:16,077 - root - INFO - | Epoch: 097/150 | Train Time: 0.851s | Train Loss: 0.105787 |
2020-05-17 15:48:16,901 - root - INFO - | Epoch: 098/150 | Train Time: 0.823s | Train Loss: 0.106493 |
2020-05-17 15:48:17,722 - root - INFO - | Epoch: 099/150 | Train Time: 0.821s | Train Loss: 0.106387 |
2020-05-17 15:48:18,615 - root - INFO - | Epoch: 100/150 | Train Time: 0.892s | Train Loss: 0.106670 |
2020-05-17 15:48:19,351 - root - INFO - | Epoch: 101/150 | Train Time: 0.735s | Train Loss: 0.105586 |
2020-05-17 15:48:20,100 - root - INFO - | Epoch: 102/150 | Train Time: 0.749s | Train Loss: 0.106538 |
2020-05-17 15:48:20,821 - root - INFO - | Epoch: 103/150 | Train Time: 0.720s | Train Loss: 0.106511 |
2020-05-17 15:48:21,576 - root - INFO - | Epoch: 104/150 | Train Time: 0.755s | Train Loss: 0.105944 |
2020-05-17 15:48:22,436 - root - INFO - | Epoch: 105/150 | Train Time: 0.859s | Train Loss: 0.106106 |
2020-05-17 15:48:23,140 - root - INFO - | Epoch: 106/150 | Train Time: 0.704s | Train Loss: 0.105566 |
2020-05-17 15:48:23,946 - root - INFO - | Epoch: 107/150 | Train Time: 0.806s | Train Loss: 0.105991 |
2020-05-17 15:48:24,686 - root - INFO - | Epoch: 108/150 | Train Time: 0.739s | Train Loss: 0.106102 |
2020-05-17 15:48:25,309 - root - INFO - | Epoch: 109/150 | Train Time: 0.622s | Train Loss: 0.105499 |
2020-05-17 15:48:26,019 - root - INFO - | Epoch: 110/150 | Train Time: 0.710s | Train Loss: 0.105823 |
2020-05-17 15:48:26,716 - root - INFO - | Epoch: 111/150 | Train Time: 0.696s | Train Loss: 0.104949 |
2020-05-17 15:48:27,509 - root - INFO - | Epoch: 112/150 | Train Time: 0.793s | Train Loss: 0.106246 |
2020-05-17 15:48:28,248 - root - INFO - | Epoch: 113/150 | Train Time: 0.738s | Train Loss: 0.104926 |
2020-05-17 15:48:28,949 - root - INFO - | Epoch: 114/150 | Train Time: 0.700s | Train Loss: 0.105238 |
2020-05-17 15:48:29,584 - root - INFO - | Epoch: 115/150 | Train Time: 0.635s | Train Loss: 0.105347 |
2020-05-17 15:48:30,287 - root - INFO - | Epoch: 116/150 | Train Time: 0.702s | Train Loss: 0.104919 |
2020-05-17 15:48:31,006 - root - INFO - | Epoch: 117/150 | Train Time: 0.719s | Train Loss: 0.105525 |
2020-05-17 15:48:31,702 - root - INFO - | Epoch: 118/150 | Train Time: 0.695s | Train Loss: 0.105021 |
2020-05-17 15:48:32,392 - root - INFO - | Epoch: 119/150 | Train Time: 0.690s | Train Loss: 0.104516 |
2020-05-17 15:48:33,011 - root - INFO - | Epoch: 120/150 | Train Time: 0.619s | Train Loss: 0.104700 |
2020-05-17 15:48:33,706 - root - INFO - | Epoch: 121/150 | Train Time: 0.694s | Train Loss: 0.105038 |
2020-05-17 15:48:34,448 - root - INFO - | Epoch: 122/150 | Train Time: 0.741s | Train Loss: 0.105061 |
2020-05-17 15:48:35,141 - root - INFO - | Epoch: 123/150 | Train Time: 0.692s | Train Loss: 0.104443 |
2020-05-17 15:48:35,754 - root - INFO - | Epoch: 124/150 | Train Time: 0.613s | Train Loss: 0.104342 |
2020-05-17 15:48:36,427 - root - INFO - | Epoch: 125/150 | Train Time: 0.672s | Train Loss: 0.104632 |
2020-05-17 15:48:37,077 - root - INFO - | Epoch: 126/150 | Train Time: 0.650s | Train Loss: 0.104815 |
2020-05-17 15:48:37,678 - root - INFO - | Epoch: 127/150 | Train Time: 0.601s | Train Loss: 0.104723 |
2020-05-17 15:48:38,283 - root - INFO - | Epoch: 128/150 | Train Time: 0.605s | Train Loss: 0.104324 |
2020-05-17 15:48:38,895 - root - INFO - | Epoch: 129/150 | Train Time: 0.611s | Train Loss: 0.104318 |
2020-05-17 15:48:39,498 - root - INFO - | Epoch: 130/150 | Train Time: 0.603s | Train Loss: 0.104514 |
2020-05-17 15:48:40,141 - root - INFO - | Epoch: 131/150 | Train Time: 0.642s | Train Loss: 0.103796 |
2020-05-17 15:48:40,772 - root - INFO - | Epoch: 132/150 | Train Time: 0.630s | Train Loss: 0.105232 |
2020-05-17 15:48:41,389 - root - INFO - | Epoch: 133/150 | Train Time: 0.616s | Train Loss: 0.103511 |
2020-05-17 15:48:42,015 - root - INFO - | Epoch: 134/150 | Train Time: 0.626s | Train Loss: 0.104301 |
2020-05-17 15:48:42,649 - root - INFO - | Epoch: 135/150 | Train Time: 0.633s | Train Loss: 0.104782 |
2020-05-17 15:48:43,259 - root - INFO - | Epoch: 136/150 | Train Time: 0.609s | Train Loss: 0.103726 |
2020-05-17 15:48:43,892 - root - INFO - | Epoch: 137/150 | Train Time: 0.633s | Train Loss: 0.103821 |
2020-05-17 15:48:44,455 - root - INFO - | Epoch: 138/150 | Train Time: 0.562s | Train Loss: 0.104505 |
2020-05-17 15:48:45,067 - root - INFO - | Epoch: 139/150 | Train Time: 0.612s | Train Loss: 0.103827 |
2020-05-17 15:48:45,647 - root - INFO - | Epoch: 140/150 | Train Time: 0.579s | Train Loss: 0.104498 |
2020-05-17 15:48:46,239 - root - INFO - | Epoch: 141/150 | Train Time: 0.592s | Train Loss: 0.103580 |
2020-05-17 15:48:46,862 - root - INFO - | Epoch: 142/150 | Train Time: 0.622s | Train Loss: 0.103738 |
2020-05-17 15:48:47,563 - root - INFO - | Epoch: 143/150 | Train Time: 0.700s | Train Loss: 0.103900 |
2020-05-17 15:48:48,208 - root - INFO - | Epoch: 144/150 | Train Time: 0.645s | Train Loss: 0.104207 |
2020-05-17 15:48:48,815 - root - INFO - | Epoch: 145/150 | Train Time: 0.607s | Train Loss: 0.103086 |
2020-05-17 15:48:49,398 - root - INFO - | Epoch: 146/150 | Train Time: 0.582s | Train Loss: 0.104121 |
2020-05-17 15:48:50,033 - root - INFO - | Epoch: 147/150 | Train Time: 0.635s | Train Loss: 0.103595 |
2020-05-17 15:48:50,697 - root - INFO - | Epoch: 148/150 | Train Time: 0.663s | Train Loss: 0.103760 |
2020-05-17 15:48:51,449 - root - INFO - | Epoch: 149/150 | Train Time: 0.752s | Train Loss: 0.103835 |
2020-05-17 15:48:52,076 - root - INFO - | Epoch: 150/150 | Train Time: 0.626s | Train Loss: 0.103845 |
2020-05-17 15:48:52,076 - root - INFO - Training Time: 109.242s
2020-05-17 15:48:52,076 - root - INFO - Finished training.
2020-05-17 15:48:52,077 - root - INFO - Starting testing...
2020-05-17 15:48:52,748 - root - INFO - Test Loss: 0.195303
2020-05-17 15:48:52,748 - root - INFO - Test AUC: 84.09%
2020-05-17 15:48:52,748 - root - INFO - Test Time: 0.662s
2020-05-17 15:48:52,748 - root - INFO - Finished testing.
