2020-05-17 20:49:50,394 - root - INFO - Log file is ../log/mnist/scenario_2/deepSAD//log_9_5_005.txt
2020-05-17 20:49:50,394 - root - INFO - Data path is ../data
2020-05-17 20:49:50,395 - root - INFO - Export path is ../log/mnist/scenario_2/deepSAD/
2020-05-17 20:49:50,395 - root - INFO - Dataset: mnist
2020-05-17 20:49:50,395 - root - INFO - Normal class: 9
2020-05-17 20:49:50,395 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-17 20:49:50,395 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-17 20:49:50,395 - root - INFO - Pollution ratio of unlabeled train data: 0.05
2020-05-17 20:49:50,395 - root - INFO - Scenario Running: 2
2020-05-17 20:49:50,395 - root - INFO - Train only the network: True
2020-05-17 20:49:50,395 - root - INFO - Output and AE dimensions: 128
2020-05-17 20:49:50,395 - root - INFO - Known anomaly class: 5
2020-05-17 20:49:50,396 - root - INFO - Network: mnist_LeNet
2020-05-17 20:49:50,396 - root - INFO - Eta-parameter: 1.00
2020-05-17 20:49:50,404 - root - INFO - Set seed to 0.
2020-05-17 20:49:50,429 - root - INFO - Computation device: cuda
2020-05-17 20:49:50,429 - root - INFO - Number of threads: 0
2020-05-17 20:49:50,429 - root - INFO - Number of dataloader workers: 6
2020-05-17 20:49:52,806 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-17 20:49:52,806 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-17 20:49:52,806 - root - INFO - Training optimizer: adam
2020-05-17 20:49:52,806 - root - INFO - Training learning rate: 0.0001
2020-05-17 20:49:52,807 - root - INFO - Training epochs: 150
2020-05-17 20:49:52,807 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-17 20:49:52,807 - root - INFO - Training batch size: 200
2020-05-17 20:49:52,807 - root - INFO - Training weight decay: 5e-07
2020-05-17 20:49:52,808 - root - INFO - Starting training...
2020-05-17 20:49:54,535 - root - INFO - | Epoch: 001/150 | Train Time: 1.724s | Train Loss: 0.364140 |
2020-05-17 20:49:55,413 - root - INFO - | Epoch: 002/150 | Train Time: 0.877s | Train Loss: 0.264430 |
2020-05-17 20:49:56,231 - root - INFO - | Epoch: 003/150 | Train Time: 0.818s | Train Loss: 0.225770 |
2020-05-17 20:49:57,070 - root - INFO - | Epoch: 004/150 | Train Time: 0.839s | Train Loss: 0.203540 |
2020-05-17 20:49:57,931 - root - INFO - | Epoch: 005/150 | Train Time: 0.860s | Train Loss: 0.186990 |
2020-05-17 20:49:58,764 - root - INFO - | Epoch: 006/150 | Train Time: 0.832s | Train Loss: 0.175752 |
2020-05-17 20:49:59,607 - root - INFO - | Epoch: 007/150 | Train Time: 0.842s | Train Loss: 0.167818 |
2020-05-17 20:50:00,490 - root - INFO - | Epoch: 008/150 | Train Time: 0.881s | Train Loss: 0.158963 |
2020-05-17 20:50:01,393 - root - INFO - | Epoch: 009/150 | Train Time: 0.903s | Train Loss: 0.154605 |
2020-05-17 20:50:02,278 - root - INFO - | Epoch: 010/150 | Train Time: 0.883s | Train Loss: 0.148161 |
2020-05-17 20:50:03,064 - root - INFO - | Epoch: 011/150 | Train Time: 0.785s | Train Loss: 0.142987 |
2020-05-17 20:50:03,888 - root - INFO - | Epoch: 012/150 | Train Time: 0.823s | Train Loss: 0.139633 |
2020-05-17 20:50:04,714 - root - INFO - | Epoch: 013/150 | Train Time: 0.825s | Train Loss: 0.135449 |
2020-05-17 20:50:05,550 - root - INFO - | Epoch: 014/150 | Train Time: 0.836s | Train Loss: 0.130262 |
2020-05-17 20:50:06,413 - root - INFO - | Epoch: 015/150 | Train Time: 0.862s | Train Loss: 0.127290 |
2020-05-17 20:50:07,263 - root - INFO - | Epoch: 016/150 | Train Time: 0.849s | Train Loss: 0.125235 |
2020-05-17 20:50:08,165 - root - INFO - | Epoch: 017/150 | Train Time: 0.901s | Train Loss: 0.121375 |
2020-05-17 20:50:09,085 - root - INFO - | Epoch: 018/150 | Train Time: 0.919s | Train Loss: 0.118191 |
2020-05-17 20:50:09,982 - root - INFO - | Epoch: 019/150 | Train Time: 0.896s | Train Loss: 0.116462 |
2020-05-17 20:50:10,837 - root - INFO - | Epoch: 020/150 | Train Time: 0.854s | Train Loss: 0.112429 |
2020-05-17 20:50:11,681 - root - INFO - | Epoch: 021/150 | Train Time: 0.843s | Train Loss: 0.110910 |
2020-05-17 20:50:12,532 - root - INFO - | Epoch: 022/150 | Train Time: 0.851s | Train Loss: 0.109033 |
2020-05-17 20:50:13,429 - root - INFO - | Epoch: 023/150 | Train Time: 0.896s | Train Loss: 0.107524 |
2020-05-17 20:50:14,255 - root - INFO - | Epoch: 024/150 | Train Time: 0.825s | Train Loss: 0.106344 |
2020-05-17 20:50:15,114 - root - INFO - | Epoch: 025/150 | Train Time: 0.858s | Train Loss: 0.104849 |
2020-05-17 20:50:15,978 - root - INFO - | Epoch: 026/150 | Train Time: 0.864s | Train Loss: 0.102234 |
2020-05-17 20:50:16,795 - root - INFO - | Epoch: 027/150 | Train Time: 0.817s | Train Loss: 0.099867 |
2020-05-17 20:50:17,539 - root - INFO - | Epoch: 028/150 | Train Time: 0.742s | Train Loss: 0.099105 |
2020-05-17 20:50:18,376 - root - INFO - | Epoch: 029/150 | Train Time: 0.836s | Train Loss: 0.097504 |
2020-05-17 20:50:19,264 - root - INFO - | Epoch: 030/150 | Train Time: 0.887s | Train Loss: 0.096049 |
2020-05-17 20:50:20,150 - root - INFO - | Epoch: 031/150 | Train Time: 0.885s | Train Loss: 0.095837 |
2020-05-17 20:50:21,045 - root - INFO - | Epoch: 032/150 | Train Time: 0.895s | Train Loss: 0.093611 |
2020-05-17 20:50:21,898 - root - INFO - | Epoch: 033/150 | Train Time: 0.852s | Train Loss: 0.092502 |
2020-05-17 20:50:22,770 - root - INFO - | Epoch: 034/150 | Train Time: 0.871s | Train Loss: 0.091544 |
2020-05-17 20:50:23,620 - root - INFO - | Epoch: 035/150 | Train Time: 0.849s | Train Loss: 0.089834 |
2020-05-17 20:50:24,478 - root - INFO - | Epoch: 036/150 | Train Time: 0.857s | Train Loss: 0.089864 |
2020-05-17 20:50:25,323 - root - INFO - | Epoch: 037/150 | Train Time: 0.844s | Train Loss: 0.088878 |
2020-05-17 20:50:26,088 - root - INFO - | Epoch: 038/150 | Train Time: 0.765s | Train Loss: 0.088681 |
2020-05-17 20:50:26,792 - root - INFO - | Epoch: 039/150 | Train Time: 0.703s | Train Loss: 0.086691 |
2020-05-17 20:50:27,602 - root - INFO - | Epoch: 040/150 | Train Time: 0.809s | Train Loss: 0.086093 |
2020-05-17 20:50:28,513 - root - INFO - | Epoch: 041/150 | Train Time: 0.911s | Train Loss: 0.085366 |
2020-05-17 20:50:29,353 - root - INFO - | Epoch: 042/150 | Train Time: 0.839s | Train Loss: 0.083498 |
2020-05-17 20:50:30,191 - root - INFO - | Epoch: 043/150 | Train Time: 0.837s | Train Loss: 0.084322 |
2020-05-17 20:50:31,045 - root - INFO - | Epoch: 044/150 | Train Time: 0.853s | Train Loss: 0.083229 |
2020-05-17 20:50:31,892 - root - INFO - | Epoch: 045/150 | Train Time: 0.846s | Train Loss: 0.081478 |
2020-05-17 20:50:32,758 - root - INFO - | Epoch: 046/150 | Train Time: 0.865s | Train Loss: 0.081593 |
2020-05-17 20:50:33,617 - root - INFO - | Epoch: 047/150 | Train Time: 0.857s | Train Loss: 0.079813 |
2020-05-17 20:50:34,416 - root - INFO - | Epoch: 048/150 | Train Time: 0.799s | Train Loss: 0.079558 |
2020-05-17 20:50:35,161 - root - INFO - | Epoch: 049/150 | Train Time: 0.745s | Train Loss: 0.080048 |
2020-05-17 20:50:36,031 - root - INFO - | Epoch: 050/150 | Train Time: 0.869s | Train Loss: 0.078128 |
2020-05-17 20:50:36,031 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-17 20:50:36,925 - root - INFO - | Epoch: 051/150 | Train Time: 0.893s | Train Loss: 0.078318 |
2020-05-17 20:50:37,813 - root - INFO - | Epoch: 052/150 | Train Time: 0.887s | Train Loss: 0.078817 |
2020-05-17 20:50:38,683 - root - INFO - | Epoch: 053/150 | Train Time: 0.869s | Train Loss: 0.078068 |
2020-05-17 20:50:39,548 - root - INFO - | Epoch: 054/150 | Train Time: 0.863s | Train Loss: 0.078095 |
2020-05-17 20:50:40,322 - root - INFO - | Epoch: 055/150 | Train Time: 0.773s | Train Loss: 0.078553 |
2020-05-17 20:50:41,156 - root - INFO - | Epoch: 056/150 | Train Time: 0.834s | Train Loss: 0.078829 |
2020-05-17 20:50:42,007 - root - INFO - | Epoch: 057/150 | Train Time: 0.850s | Train Loss: 0.077920 |
2020-05-17 20:50:42,874 - root - INFO - | Epoch: 058/150 | Train Time: 0.867s | Train Loss: 0.077939 |
2020-05-17 20:50:43,696 - root - INFO - | Epoch: 059/150 | Train Time: 0.821s | Train Loss: 0.078198 |
2020-05-17 20:50:44,520 - root - INFO - | Epoch: 060/150 | Train Time: 0.823s | Train Loss: 0.078129 |
2020-05-17 20:50:45,329 - root - INFO - | Epoch: 061/150 | Train Time: 0.809s | Train Loss: 0.078073 |
2020-05-17 20:50:46,174 - root - INFO - | Epoch: 062/150 | Train Time: 0.844s | Train Loss: 0.078270 |
2020-05-17 20:50:47,043 - root - INFO - | Epoch: 063/150 | Train Time: 0.868s | Train Loss: 0.077545 |
2020-05-17 20:50:47,905 - root - INFO - | Epoch: 064/150 | Train Time: 0.862s | Train Loss: 0.077714 |
2020-05-17 20:50:48,765 - root - INFO - | Epoch: 065/150 | Train Time: 0.859s | Train Loss: 0.077382 |
2020-05-17 20:50:49,601 - root - INFO - | Epoch: 066/150 | Train Time: 0.836s | Train Loss: 0.077452 |
2020-05-17 20:50:50,437 - root - INFO - | Epoch: 067/150 | Train Time: 0.835s | Train Loss: 0.077317 |
2020-05-17 20:50:51,309 - root - INFO - | Epoch: 068/150 | Train Time: 0.871s | Train Loss: 0.078075 |
2020-05-17 20:50:52,177 - root - INFO - | Epoch: 069/150 | Train Time: 0.867s | Train Loss: 0.077129 |
2020-05-17 20:50:53,053 - root - INFO - | Epoch: 070/150 | Train Time: 0.876s | Train Loss: 0.077563 |
2020-05-17 20:50:53,969 - root - INFO - | Epoch: 071/150 | Train Time: 0.915s | Train Loss: 0.077001 |
2020-05-17 20:50:54,873 - root - INFO - | Epoch: 072/150 | Train Time: 0.903s | Train Loss: 0.077665 |
2020-05-17 20:50:55,762 - root - INFO - | Epoch: 073/150 | Train Time: 0.888s | Train Loss: 0.077363 |
2020-05-17 20:50:56,648 - root - INFO - | Epoch: 074/150 | Train Time: 0.885s | Train Loss: 0.077466 |
2020-05-17 20:50:57,556 - root - INFO - | Epoch: 075/150 | Train Time: 0.907s | Train Loss: 0.076725 |
2020-05-17 20:50:58,477 - root - INFO - | Epoch: 076/150 | Train Time: 0.920s | Train Loss: 0.077554 |
2020-05-17 20:50:59,354 - root - INFO - | Epoch: 077/150 | Train Time: 0.876s | Train Loss: 0.076987 |
2020-05-17 20:51:00,290 - root - INFO - | Epoch: 078/150 | Train Time: 0.935s | Train Loss: 0.077680 |
2020-05-17 20:51:01,179 - root - INFO - | Epoch: 079/150 | Train Time: 0.888s | Train Loss: 0.076553 |
2020-05-17 20:51:02,074 - root - INFO - | Epoch: 080/150 | Train Time: 0.895s | Train Loss: 0.076685 |
2020-05-17 20:51:02,955 - root - INFO - | Epoch: 081/150 | Train Time: 0.880s | Train Loss: 0.076053 |
2020-05-17 20:51:03,832 - root - INFO - | Epoch: 082/150 | Train Time: 0.877s | Train Loss: 0.075882 |
2020-05-17 20:51:04,735 - root - INFO - | Epoch: 083/150 | Train Time: 0.902s | Train Loss: 0.075419 |
2020-05-17 20:51:05,620 - root - INFO - | Epoch: 084/150 | Train Time: 0.885s | Train Loss: 0.076563 |
2020-05-17 20:51:06,502 - root - INFO - | Epoch: 085/150 | Train Time: 0.881s | Train Loss: 0.076664 |
2020-05-17 20:51:07,370 - root - INFO - | Epoch: 086/150 | Train Time: 0.867s | Train Loss: 0.075939 |
2020-05-17 20:51:08,242 - root - INFO - | Epoch: 087/150 | Train Time: 0.871s | Train Loss: 0.076197 |
2020-05-17 20:51:09,102 - root - INFO - | Epoch: 088/150 | Train Time: 0.859s | Train Loss: 0.076214 |
2020-05-17 20:51:10,013 - root - INFO - | Epoch: 089/150 | Train Time: 0.911s | Train Loss: 0.075992 |
2020-05-17 20:51:10,846 - root - INFO - | Epoch: 090/150 | Train Time: 0.832s | Train Loss: 0.075815 |
2020-05-17 20:51:11,710 - root - INFO - | Epoch: 091/150 | Train Time: 0.863s | Train Loss: 0.075895 |
2020-05-17 20:51:12,439 - root - INFO - | Epoch: 092/150 | Train Time: 0.728s | Train Loss: 0.076443 |
2020-05-17 20:51:13,276 - root - INFO - | Epoch: 093/150 | Train Time: 0.836s | Train Loss: 0.076357 |
2020-05-17 20:51:14,119 - root - INFO - | Epoch: 094/150 | Train Time: 0.842s | Train Loss: 0.075537 |
2020-05-17 20:51:15,017 - root - INFO - | Epoch: 095/150 | Train Time: 0.897s | Train Loss: 0.076169 |
2020-05-17 20:51:15,869 - root - INFO - | Epoch: 096/150 | Train Time: 0.852s | Train Loss: 0.075543 |
2020-05-17 20:51:16,648 - root - INFO - | Epoch: 097/150 | Train Time: 0.778s | Train Loss: 0.075050 |
2020-05-17 20:51:17,486 - root - INFO - | Epoch: 098/150 | Train Time: 0.837s | Train Loss: 0.075549 |
2020-05-17 20:51:18,365 - root - INFO - | Epoch: 099/150 | Train Time: 0.879s | Train Loss: 0.076020 |
2020-05-17 20:51:19,260 - root - INFO - | Epoch: 100/150 | Train Time: 0.893s | Train Loss: 0.074515 |
2020-05-17 20:51:20,147 - root - INFO - | Epoch: 101/150 | Train Time: 0.886s | Train Loss: 0.075053 |
2020-05-17 20:51:21,049 - root - INFO - | Epoch: 102/150 | Train Time: 0.901s | Train Loss: 0.075550 |
2020-05-17 20:51:21,926 - root - INFO - | Epoch: 103/150 | Train Time: 0.876s | Train Loss: 0.075511 |
2020-05-17 20:51:22,812 - root - INFO - | Epoch: 104/150 | Train Time: 0.885s | Train Loss: 0.073820 |
2020-05-17 20:51:23,731 - root - INFO - | Epoch: 105/150 | Train Time: 0.918s | Train Loss: 0.074228 |
2020-05-17 20:51:24,616 - root - INFO - | Epoch: 106/150 | Train Time: 0.884s | Train Loss: 0.074605 |
2020-05-17 20:51:25,453 - root - INFO - | Epoch: 107/150 | Train Time: 0.836s | Train Loss: 0.075341 |
2020-05-17 20:51:26,313 - root - INFO - | Epoch: 108/150 | Train Time: 0.859s | Train Loss: 0.074259 |
2020-05-17 20:51:27,182 - root - INFO - | Epoch: 109/150 | Train Time: 0.869s | Train Loss: 0.074541 |
2020-05-17 20:51:28,045 - root - INFO - | Epoch: 110/150 | Train Time: 0.861s | Train Loss: 0.074746 |
2020-05-17 20:51:28,868 - root - INFO - | Epoch: 111/150 | Train Time: 0.822s | Train Loss: 0.074986 |
2020-05-17 20:51:29,742 - root - INFO - | Epoch: 112/150 | Train Time: 0.873s | Train Loss: 0.074191 |
2020-05-17 20:51:30,604 - root - INFO - | Epoch: 113/150 | Train Time: 0.862s | Train Loss: 0.074008 |
2020-05-17 20:51:31,494 - root - INFO - | Epoch: 114/150 | Train Time: 0.889s | Train Loss: 0.074928 |
2020-05-17 20:51:32,335 - root - INFO - | Epoch: 115/150 | Train Time: 0.841s | Train Loss: 0.074139 |
2020-05-17 20:51:33,201 - root - INFO - | Epoch: 116/150 | Train Time: 0.865s | Train Loss: 0.073209 |
2020-05-17 20:51:34,108 - root - INFO - | Epoch: 117/150 | Train Time: 0.906s | Train Loss: 0.074637 |
2020-05-17 20:51:35,019 - root - INFO - | Epoch: 118/150 | Train Time: 0.909s | Train Loss: 0.073636 |
2020-05-17 20:51:35,893 - root - INFO - | Epoch: 119/150 | Train Time: 0.873s | Train Loss: 0.073877 |
2020-05-17 20:51:36,779 - root - INFO - | Epoch: 120/150 | Train Time: 0.885s | Train Loss: 0.073140 |
2020-05-17 20:51:37,709 - root - INFO - | Epoch: 121/150 | Train Time: 0.929s | Train Loss: 0.074579 |
2020-05-17 20:51:38,601 - root - INFO - | Epoch: 122/150 | Train Time: 0.891s | Train Loss: 0.074013 |
2020-05-17 20:51:39,487 - root - INFO - | Epoch: 123/150 | Train Time: 0.886s | Train Loss: 0.073303 |
2020-05-17 20:51:40,375 - root - INFO - | Epoch: 124/150 | Train Time: 0.886s | Train Loss: 0.073513 |
2020-05-17 20:51:41,243 - root - INFO - | Epoch: 125/150 | Train Time: 0.868s | Train Loss: 0.073836 |
2020-05-17 20:51:42,108 - root - INFO - | Epoch: 126/150 | Train Time: 0.864s | Train Loss: 0.073792 |
2020-05-17 20:51:43,004 - root - INFO - | Epoch: 127/150 | Train Time: 0.894s | Train Loss: 0.072994 |
2020-05-17 20:51:43,850 - root - INFO - | Epoch: 128/150 | Train Time: 0.846s | Train Loss: 0.073175 |
2020-05-17 20:51:44,706 - root - INFO - | Epoch: 129/150 | Train Time: 0.855s | Train Loss: 0.073312 |
2020-05-17 20:51:45,594 - root - INFO - | Epoch: 130/150 | Train Time: 0.886s | Train Loss: 0.073065 |
2020-05-17 20:51:46,476 - root - INFO - | Epoch: 131/150 | Train Time: 0.881s | Train Loss: 0.073304 |
2020-05-17 20:51:47,347 - root - INFO - | Epoch: 132/150 | Train Time: 0.871s | Train Loss: 0.073500 |
2020-05-17 20:51:48,180 - root - INFO - | Epoch: 133/150 | Train Time: 0.832s | Train Loss: 0.073611 |
2020-05-17 20:51:49,060 - root - INFO - | Epoch: 134/150 | Train Time: 0.880s | Train Loss: 0.073365 |
2020-05-17 20:51:49,966 - root - INFO - | Epoch: 135/150 | Train Time: 0.905s | Train Loss: 0.073557 |
2020-05-17 20:51:50,768 - root - INFO - | Epoch: 136/150 | Train Time: 0.801s | Train Loss: 0.073203 |
2020-05-17 20:51:51,536 - root - INFO - | Epoch: 137/150 | Train Time: 0.768s | Train Loss: 0.071852 |
2020-05-17 20:51:52,398 - root - INFO - | Epoch: 138/150 | Train Time: 0.861s | Train Loss: 0.072434 |
2020-05-17 20:51:53,242 - root - INFO - | Epoch: 139/150 | Train Time: 0.843s | Train Loss: 0.073409 |
2020-05-17 20:51:54,096 - root - INFO - | Epoch: 140/150 | Train Time: 0.853s | Train Loss: 0.073196 |
2020-05-17 20:51:54,901 - root - INFO - | Epoch: 141/150 | Train Time: 0.805s | Train Loss: 0.072255 |
2020-05-17 20:51:55,751 - root - INFO - | Epoch: 142/150 | Train Time: 0.849s | Train Loss: 0.072926 |
2020-05-17 20:51:56,597 - root - INFO - | Epoch: 143/150 | Train Time: 0.845s | Train Loss: 0.072484 |
2020-05-17 20:51:57,445 - root - INFO - | Epoch: 144/150 | Train Time: 0.848s | Train Loss: 0.072629 |
2020-05-17 20:51:58,299 - root - INFO - | Epoch: 145/150 | Train Time: 0.853s | Train Loss: 0.072240 |
2020-05-17 20:51:59,151 - root - INFO - | Epoch: 146/150 | Train Time: 0.851s | Train Loss: 0.072728 |
2020-05-17 20:52:00,018 - root - INFO - | Epoch: 147/150 | Train Time: 0.866s | Train Loss: 0.071661 |
2020-05-17 20:52:00,863 - root - INFO - | Epoch: 148/150 | Train Time: 0.845s | Train Loss: 0.071902 |
2020-05-17 20:52:01,698 - root - INFO - | Epoch: 149/150 | Train Time: 0.834s | Train Loss: 0.072239 |
2020-05-17 20:52:02,533 - root - INFO - | Epoch: 150/150 | Train Time: 0.835s | Train Loss: 0.071775 |
2020-05-17 20:52:02,534 - root - INFO - Training Time: 129.726s
2020-05-17 20:52:02,534 - root - INFO - Finished training.
2020-05-17 20:52:02,536 - root - INFO - Starting testing...
2020-05-17 20:52:03,533 - root - INFO - Test Loss: 0.318010
2020-05-17 20:52:03,534 - root - INFO - Test AUC: 92.83%
2020-05-17 20:52:03,534 - root - INFO - Test Time: 0.977s
2020-05-17 20:52:03,534 - root - INFO - Finished testing.
