2020-05-16 19:04:36,896 - root - INFO - Log file is ../log/mnist/scenario_3/deepSAD//log_9_0_5_7.txt
2020-05-16 19:04:36,896 - root - INFO - Data path is ../data
2020-05-16 19:04:36,896 - root - INFO - Export path is ../log/mnist/scenario_3/deepSAD/
2020-05-16 19:04:36,896 - root - INFO - Dataset: mnist
2020-05-16 19:04:36,897 - root - INFO - Normal class: 9
2020-05-16 19:04:36,897 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-16 19:04:36,897 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-16 19:04:36,897 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-16 19:04:36,897 - root - INFO - Scenario Running: 3
2020-05-16 19:04:36,897 - root - INFO - Train only the network: True
2020-05-16 19:04:36,897 - root - INFO - Output and AE dimensions: 128
2020-05-16 19:04:36,897 - root - INFO - Number of known anomaly classes: 5
2020-05-16 19:04:36,897 - root - INFO - Network: mnist_LeNet
2020-05-16 19:04:36,897 - root - INFO - Eta-parameter: 1.00
2020-05-16 19:04:36,906 - root - INFO - Set seed to 7.
2020-05-16 19:04:36,934 - root - INFO - Computation device: cuda
2020-05-16 19:04:36,934 - root - INFO - Number of threads: 0
2020-05-16 19:04:36,934 - root - INFO - Number of dataloader workers: 6
2020-05-16 19:04:37,001 - root - INFO - Known anomaly classes: (5, 2, 3, 8, 0)
2020-05-16 19:04:39,003 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-16 19:04:39,003 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-16 19:04:39,003 - root - INFO - Training optimizer: adam
2020-05-16 19:04:39,003 - root - INFO - Training learning rate: 0.0001
2020-05-16 19:04:39,003 - root - INFO - Training epochs: 150
2020-05-16 19:04:39,003 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-16 19:04:39,004 - root - INFO - Training batch size: 200
2020-05-16 19:04:39,004 - root - INFO - Training weight decay: 5e-07
2020-05-16 19:04:39,005 - root - INFO - Starting training...
2020-05-16 19:04:40,832 - root - INFO - | Epoch: 001/150 | Train Time: 1.825s | Train Loss: 0.429758 |
2020-05-16 19:04:41,682 - root - INFO - | Epoch: 002/150 | Train Time: 0.849s | Train Loss: 0.308423 |
2020-05-16 19:04:42,489 - root - INFO - | Epoch: 003/150 | Train Time: 0.807s | Train Loss: 0.269495 |
2020-05-16 19:04:43,358 - root - INFO - | Epoch: 004/150 | Train Time: 0.869s | Train Loss: 0.246683 |
2020-05-16 19:04:44,194 - root - INFO - | Epoch: 005/150 | Train Time: 0.835s | Train Loss: 0.233088 |
2020-05-16 19:04:45,074 - root - INFO - | Epoch: 006/150 | Train Time: 0.880s | Train Loss: 0.221827 |
2020-05-16 19:04:45,891 - root - INFO - | Epoch: 007/150 | Train Time: 0.816s | Train Loss: 0.215433 |
2020-05-16 19:04:46,718 - root - INFO - | Epoch: 008/150 | Train Time: 0.827s | Train Loss: 0.208407 |
2020-05-16 19:04:47,474 - root - INFO - | Epoch: 009/150 | Train Time: 0.755s | Train Loss: 0.201461 |
2020-05-16 19:04:48,269 - root - INFO - | Epoch: 010/150 | Train Time: 0.795s | Train Loss: 0.200277 |
2020-05-16 19:04:49,206 - root - INFO - | Epoch: 011/150 | Train Time: 0.937s | Train Loss: 0.197502 |
2020-05-16 19:04:50,190 - root - INFO - | Epoch: 012/150 | Train Time: 0.983s | Train Loss: 0.193803 |
2020-05-16 19:04:50,904 - root - INFO - | Epoch: 013/150 | Train Time: 0.714s | Train Loss: 0.192291 |
2020-05-16 19:04:51,766 - root - INFO - | Epoch: 014/150 | Train Time: 0.861s | Train Loss: 0.188056 |
2020-05-16 19:04:52,721 - root - INFO - | Epoch: 015/150 | Train Time: 0.954s | Train Loss: 0.186356 |
2020-05-16 19:04:53,576 - root - INFO - | Epoch: 016/150 | Train Time: 0.855s | Train Loss: 0.182875 |
2020-05-16 19:04:54,633 - root - INFO - | Epoch: 017/150 | Train Time: 1.056s | Train Loss: 0.181973 |
2020-05-16 19:04:55,560 - root - INFO - | Epoch: 018/150 | Train Time: 0.927s | Train Loss: 0.179386 |
2020-05-16 19:04:56,230 - root - INFO - | Epoch: 019/150 | Train Time: 0.670s | Train Loss: 0.178338 |
2020-05-16 19:04:56,961 - root - INFO - | Epoch: 020/150 | Train Time: 0.731s | Train Loss: 0.176429 |
2020-05-16 19:04:57,639 - root - INFO - | Epoch: 021/150 | Train Time: 0.678s | Train Loss: 0.174819 |
2020-05-16 19:04:58,483 - root - INFO - | Epoch: 022/150 | Train Time: 0.843s | Train Loss: 0.174946 |
2020-05-16 19:04:59,292 - root - INFO - | Epoch: 023/150 | Train Time: 0.808s | Train Loss: 0.172291 |
2020-05-16 19:05:00,062 - root - INFO - | Epoch: 024/150 | Train Time: 0.770s | Train Loss: 0.170279 |
2020-05-16 19:05:00,775 - root - INFO - | Epoch: 025/150 | Train Time: 0.712s | Train Loss: 0.169347 |
2020-05-16 19:05:01,536 - root - INFO - | Epoch: 026/150 | Train Time: 0.760s | Train Loss: 0.168432 |
2020-05-16 19:05:02,393 - root - INFO - | Epoch: 027/150 | Train Time: 0.857s | Train Loss: 0.169170 |
2020-05-16 19:05:03,319 - root - INFO - | Epoch: 028/150 | Train Time: 0.925s | Train Loss: 0.166522 |
2020-05-16 19:05:04,200 - root - INFO - | Epoch: 029/150 | Train Time: 0.881s | Train Loss: 0.165738 |
2020-05-16 19:05:04,956 - root - INFO - | Epoch: 030/150 | Train Time: 0.755s | Train Loss: 0.164945 |
2020-05-16 19:05:05,863 - root - INFO - | Epoch: 031/150 | Train Time: 0.907s | Train Loss: 0.164229 |
2020-05-16 19:05:06,662 - root - INFO - | Epoch: 032/150 | Train Time: 0.798s | Train Loss: 0.163149 |
2020-05-16 19:05:07,584 - root - INFO - | Epoch: 033/150 | Train Time: 0.922s | Train Loss: 0.162947 |
2020-05-16 19:05:08,524 - root - INFO - | Epoch: 034/150 | Train Time: 0.939s | Train Loss: 0.161807 |
2020-05-16 19:05:09,306 - root - INFO - | Epoch: 035/150 | Train Time: 0.782s | Train Loss: 0.161007 |
2020-05-16 19:05:10,099 - root - INFO - | Epoch: 036/150 | Train Time: 0.793s | Train Loss: 0.157749 |
2020-05-16 19:05:10,968 - root - INFO - | Epoch: 037/150 | Train Time: 0.868s | Train Loss: 0.159858 |
2020-05-16 19:05:11,876 - root - INFO - | Epoch: 038/150 | Train Time: 0.908s | Train Loss: 0.157417 |
2020-05-16 19:05:12,659 - root - INFO - | Epoch: 039/150 | Train Time: 0.783s | Train Loss: 0.158114 |
2020-05-16 19:05:13,503 - root - INFO - | Epoch: 040/150 | Train Time: 0.843s | Train Loss: 0.156751 |
2020-05-16 19:05:14,313 - root - INFO - | Epoch: 041/150 | Train Time: 0.809s | Train Loss: 0.153950 |
2020-05-16 19:05:15,279 - root - INFO - | Epoch: 042/150 | Train Time: 0.966s | Train Loss: 0.155397 |
2020-05-16 19:05:16,165 - root - INFO - | Epoch: 043/150 | Train Time: 0.886s | Train Loss: 0.154726 |
2020-05-16 19:05:16,981 - root - INFO - | Epoch: 044/150 | Train Time: 0.816s | Train Loss: 0.153148 |
2020-05-16 19:05:17,893 - root - INFO - | Epoch: 045/150 | Train Time: 0.911s | Train Loss: 0.153262 |
2020-05-16 19:05:18,756 - root - INFO - | Epoch: 046/150 | Train Time: 0.862s | Train Loss: 0.152421 |
2020-05-16 19:05:19,592 - root - INFO - | Epoch: 047/150 | Train Time: 0.836s | Train Loss: 0.151626 |
2020-05-16 19:05:20,410 - root - INFO - | Epoch: 048/150 | Train Time: 0.817s | Train Loss: 0.151751 |
2020-05-16 19:05:21,340 - root - INFO - | Epoch: 049/150 | Train Time: 0.930s | Train Loss: 0.151282 |
2020-05-16 19:05:22,163 - root - INFO - | Epoch: 050/150 | Train Time: 0.823s | Train Loss: 0.149472 |
2020-05-16 19:05:22,164 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-16 19:05:23,073 - root - INFO - | Epoch: 051/150 | Train Time: 0.909s | Train Loss: 0.149597 |
2020-05-16 19:05:23,885 - root - INFO - | Epoch: 052/150 | Train Time: 0.811s | Train Loss: 0.149335 |
2020-05-16 19:05:24,736 - root - INFO - | Epoch: 053/150 | Train Time: 0.851s | Train Loss: 0.149212 |
2020-05-16 19:05:25,575 - root - INFO - | Epoch: 054/150 | Train Time: 0.838s | Train Loss: 0.149700 |
2020-05-16 19:05:26,580 - root - INFO - | Epoch: 055/150 | Train Time: 1.004s | Train Loss: 0.147765 |
2020-05-16 19:05:27,594 - root - INFO - | Epoch: 056/150 | Train Time: 1.014s | Train Loss: 0.147759 |
2020-05-16 19:05:28,635 - root - INFO - | Epoch: 057/150 | Train Time: 1.040s | Train Loss: 0.147768 |
2020-05-16 19:05:29,492 - root - INFO - | Epoch: 058/150 | Train Time: 0.856s | Train Loss: 0.149761 |
2020-05-16 19:05:30,567 - root - INFO - | Epoch: 059/150 | Train Time: 1.075s | Train Loss: 0.149852 |
2020-05-16 19:05:31,411 - root - INFO - | Epoch: 060/150 | Train Time: 0.844s | Train Loss: 0.147888 |
2020-05-16 19:05:32,219 - root - INFO - | Epoch: 061/150 | Train Time: 0.807s | Train Loss: 0.147770 |
2020-05-16 19:05:33,111 - root - INFO - | Epoch: 062/150 | Train Time: 0.892s | Train Loss: 0.148117 |
2020-05-16 19:05:33,939 - root - INFO - | Epoch: 063/150 | Train Time: 0.828s | Train Loss: 0.147535 |
2020-05-16 19:05:34,767 - root - INFO - | Epoch: 064/150 | Train Time: 0.828s | Train Loss: 0.148495 |
2020-05-16 19:05:35,624 - root - INFO - | Epoch: 065/150 | Train Time: 0.856s | Train Loss: 0.148987 |
2020-05-16 19:05:36,516 - root - INFO - | Epoch: 066/150 | Train Time: 0.892s | Train Loss: 0.148730 |
2020-05-16 19:05:37,388 - root - INFO - | Epoch: 067/150 | Train Time: 0.871s | Train Loss: 0.149618 |
2020-05-16 19:05:38,243 - root - INFO - | Epoch: 068/150 | Train Time: 0.855s | Train Loss: 0.147126 |
2020-05-16 19:05:39,123 - root - INFO - | Epoch: 069/150 | Train Time: 0.880s | Train Loss: 0.147108 |
2020-05-16 19:05:40,016 - root - INFO - | Epoch: 070/150 | Train Time: 0.892s | Train Loss: 0.148585 |
2020-05-16 19:05:40,898 - root - INFO - | Epoch: 071/150 | Train Time: 0.882s | Train Loss: 0.148073 |
2020-05-16 19:05:41,778 - root - INFO - | Epoch: 072/150 | Train Time: 0.879s | Train Loss: 0.147706 |
2020-05-16 19:05:42,642 - root - INFO - | Epoch: 073/150 | Train Time: 0.864s | Train Loss: 0.148440 |
2020-05-16 19:05:43,487 - root - INFO - | Epoch: 074/150 | Train Time: 0.844s | Train Loss: 0.147810 |
2020-05-16 19:05:44,280 - root - INFO - | Epoch: 075/150 | Train Time: 0.793s | Train Loss: 0.147377 |
2020-05-16 19:05:45,176 - root - INFO - | Epoch: 076/150 | Train Time: 0.896s | Train Loss: 0.148088 |
2020-05-16 19:05:46,077 - root - INFO - | Epoch: 077/150 | Train Time: 0.901s | Train Loss: 0.147658 |
2020-05-16 19:05:47,060 - root - INFO - | Epoch: 078/150 | Train Time: 0.982s | Train Loss: 0.147378 |
2020-05-16 19:05:47,864 - root - INFO - | Epoch: 079/150 | Train Time: 0.804s | Train Loss: 0.147890 |
2020-05-16 19:05:48,783 - root - INFO - | Epoch: 080/150 | Train Time: 0.918s | Train Loss: 0.147648 |
2020-05-16 19:05:49,593 - root - INFO - | Epoch: 081/150 | Train Time: 0.810s | Train Loss: 0.147431 |
2020-05-16 19:05:50,521 - root - INFO - | Epoch: 082/150 | Train Time: 0.927s | Train Loss: 0.146584 |
2020-05-16 19:05:51,379 - root - INFO - | Epoch: 083/150 | Train Time: 0.858s | Train Loss: 0.147543 |
2020-05-16 19:05:52,164 - root - INFO - | Epoch: 084/150 | Train Time: 0.784s | Train Loss: 0.146818 |
2020-05-16 19:05:52,982 - root - INFO - | Epoch: 085/150 | Train Time: 0.818s | Train Loss: 0.146987 |
2020-05-16 19:05:53,858 - root - INFO - | Epoch: 086/150 | Train Time: 0.875s | Train Loss: 0.147300 |
2020-05-16 19:05:54,698 - root - INFO - | Epoch: 087/150 | Train Time: 0.840s | Train Loss: 0.147459 |
2020-05-16 19:05:55,622 - root - INFO - | Epoch: 088/150 | Train Time: 0.924s | Train Loss: 0.146692 |
2020-05-16 19:05:56,453 - root - INFO - | Epoch: 089/150 | Train Time: 0.830s | Train Loss: 0.148136 |
2020-05-16 19:05:57,293 - root - INFO - | Epoch: 090/150 | Train Time: 0.840s | Train Loss: 0.146779 |
2020-05-16 19:05:58,094 - root - INFO - | Epoch: 091/150 | Train Time: 0.800s | Train Loss: 0.146765 |
2020-05-16 19:05:58,981 - root - INFO - | Epoch: 092/150 | Train Time: 0.887s | Train Loss: 0.147463 |
2020-05-16 19:05:59,965 - root - INFO - | Epoch: 093/150 | Train Time: 0.984s | Train Loss: 0.145493 |
2020-05-16 19:06:00,803 - root - INFO - | Epoch: 094/150 | Train Time: 0.838s | Train Loss: 0.145396 |
2020-05-16 19:06:01,582 - root - INFO - | Epoch: 095/150 | Train Time: 0.778s | Train Loss: 0.146891 |
2020-05-16 19:06:02,439 - root - INFO - | Epoch: 096/150 | Train Time: 0.857s | Train Loss: 0.147356 |
2020-05-16 19:06:03,188 - root - INFO - | Epoch: 097/150 | Train Time: 0.749s | Train Loss: 0.147256 |
2020-05-16 19:06:04,037 - root - INFO - | Epoch: 098/150 | Train Time: 0.848s | Train Loss: 0.146087 |
2020-05-16 19:06:04,781 - root - INFO - | Epoch: 099/150 | Train Time: 0.744s | Train Loss: 0.147116 |
2020-05-16 19:06:05,678 - root - INFO - | Epoch: 100/150 | Train Time: 0.896s | Train Loss: 0.146713 |
2020-05-16 19:06:06,609 - root - INFO - | Epoch: 101/150 | Train Time: 0.931s | Train Loss: 0.145364 |
2020-05-16 19:06:07,513 - root - INFO - | Epoch: 102/150 | Train Time: 0.904s | Train Loss: 0.146603 |
2020-05-16 19:06:08,450 - root - INFO - | Epoch: 103/150 | Train Time: 0.936s | Train Loss: 0.147110 |
2020-05-16 19:06:09,294 - root - INFO - | Epoch: 104/150 | Train Time: 0.844s | Train Loss: 0.146680 |
2020-05-16 19:06:10,098 - root - INFO - | Epoch: 105/150 | Train Time: 0.803s | Train Loss: 0.147018 |
2020-05-16 19:06:10,913 - root - INFO - | Epoch: 106/150 | Train Time: 0.815s | Train Loss: 0.146079 |
2020-05-16 19:06:11,810 - root - INFO - | Epoch: 107/150 | Train Time: 0.896s | Train Loss: 0.146028 |
2020-05-16 19:06:12,747 - root - INFO - | Epoch: 108/150 | Train Time: 0.937s | Train Loss: 0.144268 |
2020-05-16 19:06:13,585 - root - INFO - | Epoch: 109/150 | Train Time: 0.838s | Train Loss: 0.146316 |
2020-05-16 19:06:14,470 - root - INFO - | Epoch: 110/150 | Train Time: 0.885s | Train Loss: 0.145333 |
2020-05-16 19:06:15,430 - root - INFO - | Epoch: 111/150 | Train Time: 0.960s | Train Loss: 0.145009 |
2020-05-16 19:06:16,279 - root - INFO - | Epoch: 112/150 | Train Time: 0.848s | Train Loss: 0.144826 |
2020-05-16 19:06:17,200 - root - INFO - | Epoch: 113/150 | Train Time: 0.920s | Train Loss: 0.143495 |
2020-05-16 19:06:18,105 - root - INFO - | Epoch: 114/150 | Train Time: 0.905s | Train Loss: 0.145212 |
2020-05-16 19:06:18,932 - root - INFO - | Epoch: 115/150 | Train Time: 0.826s | Train Loss: 0.145542 |
2020-05-16 19:06:19,828 - root - INFO - | Epoch: 116/150 | Train Time: 0.895s | Train Loss: 0.144740 |
2020-05-16 19:06:20,585 - root - INFO - | Epoch: 117/150 | Train Time: 0.757s | Train Loss: 0.145915 |
2020-05-16 19:06:21,385 - root - INFO - | Epoch: 118/150 | Train Time: 0.800s | Train Loss: 0.144875 |
2020-05-16 19:06:22,269 - root - INFO - | Epoch: 119/150 | Train Time: 0.884s | Train Loss: 0.144838 |
2020-05-16 19:06:23,083 - root - INFO - | Epoch: 120/150 | Train Time: 0.813s | Train Loss: 0.145768 |
2020-05-16 19:06:23,970 - root - INFO - | Epoch: 121/150 | Train Time: 0.886s | Train Loss: 0.145255 |
2020-05-16 19:06:24,759 - root - INFO - | Epoch: 122/150 | Train Time: 0.788s | Train Loss: 0.144429 |
2020-05-16 19:06:25,666 - root - INFO - | Epoch: 123/150 | Train Time: 0.907s | Train Loss: 0.145498 |
2020-05-16 19:06:26,501 - root - INFO - | Epoch: 124/150 | Train Time: 0.835s | Train Loss: 0.144299 |
2020-05-16 19:06:27,448 - root - INFO - | Epoch: 125/150 | Train Time: 0.946s | Train Loss: 0.145037 |
2020-05-16 19:06:28,282 - root - INFO - | Epoch: 126/150 | Train Time: 0.834s | Train Loss: 0.144776 |
2020-05-16 19:06:29,050 - root - INFO - | Epoch: 127/150 | Train Time: 0.767s | Train Loss: 0.143720 |
2020-05-16 19:06:29,932 - root - INFO - | Epoch: 128/150 | Train Time: 0.882s | Train Loss: 0.144825 |
2020-05-16 19:06:30,865 - root - INFO - | Epoch: 129/150 | Train Time: 0.932s | Train Loss: 0.144380 |
2020-05-16 19:06:31,643 - root - INFO - | Epoch: 130/150 | Train Time: 0.778s | Train Loss: 0.144176 |
2020-05-16 19:06:32,505 - root - INFO - | Epoch: 131/150 | Train Time: 0.862s | Train Loss: 0.144554 |
2020-05-16 19:06:33,363 - root - INFO - | Epoch: 132/150 | Train Time: 0.857s | Train Loss: 0.144493 |
2020-05-16 19:06:34,259 - root - INFO - | Epoch: 133/150 | Train Time: 0.895s | Train Loss: 0.143176 |
2020-05-16 19:06:35,094 - root - INFO - | Epoch: 134/150 | Train Time: 0.835s | Train Loss: 0.144201 |
2020-05-16 19:06:35,940 - root - INFO - | Epoch: 135/150 | Train Time: 0.846s | Train Loss: 0.142083 |
2020-05-16 19:06:36,750 - root - INFO - | Epoch: 136/150 | Train Time: 0.810s | Train Loss: 0.142526 |
2020-05-16 19:06:37,625 - root - INFO - | Epoch: 137/150 | Train Time: 0.874s | Train Loss: 0.143875 |
2020-05-16 19:06:38,491 - root - INFO - | Epoch: 138/150 | Train Time: 0.865s | Train Loss: 0.144552 |
2020-05-16 19:06:39,326 - root - INFO - | Epoch: 139/150 | Train Time: 0.835s | Train Loss: 0.143673 |
2020-05-16 19:06:40,168 - root - INFO - | Epoch: 140/150 | Train Time: 0.841s | Train Loss: 0.144218 |
2020-05-16 19:06:40,993 - root - INFO - | Epoch: 141/150 | Train Time: 0.824s | Train Loss: 0.144650 |
2020-05-16 19:06:41,748 - root - INFO - | Epoch: 142/150 | Train Time: 0.755s | Train Loss: 0.143711 |
2020-05-16 19:06:42,701 - root - INFO - | Epoch: 143/150 | Train Time: 0.953s | Train Loss: 0.142313 |
2020-05-16 19:06:43,680 - root - INFO - | Epoch: 144/150 | Train Time: 0.978s | Train Loss: 0.141096 |
2020-05-16 19:06:44,462 - root - INFO - | Epoch: 145/150 | Train Time: 0.781s | Train Loss: 0.142192 |
2020-05-16 19:06:45,291 - root - INFO - | Epoch: 146/150 | Train Time: 0.829s | Train Loss: 0.143850 |
2020-05-16 19:06:46,153 - root - INFO - | Epoch: 147/150 | Train Time: 0.862s | Train Loss: 0.143394 |
2020-05-16 19:06:46,980 - root - INFO - | Epoch: 148/150 | Train Time: 0.826s | Train Loss: 0.143082 |
2020-05-16 19:06:47,816 - root - INFO - | Epoch: 149/150 | Train Time: 0.836s | Train Loss: 0.143199 |
2020-05-16 19:06:48,677 - root - INFO - | Epoch: 150/150 | Train Time: 0.861s | Train Loss: 0.141687 |
2020-05-16 19:06:48,677 - root - INFO - Training Time: 129.673s
2020-05-16 19:06:48,678 - root - INFO - Finished training.
2020-05-16 19:06:48,678 - root - INFO - Starting testing...
2020-05-16 19:06:49,579 - root - INFO - Test Loss: 0.434000
2020-05-16 19:06:49,579 - root - INFO - Test AUC: 93.93%
2020-05-16 19:06:49,579 - root - INFO - Test Time: 0.891s
2020-05-16 19:06:49,579 - root - INFO - Finished testing.
