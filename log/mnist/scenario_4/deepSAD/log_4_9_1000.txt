2020-05-16 13:27:22,611 - root - INFO - Log file is ../log/mnist/scenario_4/deepSAD//log_4_9_1000.txt
2020-05-16 13:27:22,611 - root - INFO - Data path is ../data
2020-05-16 13:27:22,611 - root - INFO - Export path is ../log/mnist/scenario_4/deepSAD/
2020-05-16 13:27:22,611 - root - INFO - Dataset: mnist
2020-05-16 13:27:22,612 - root - INFO - Normal class: 4
2020-05-16 13:27:22,612 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-16 13:27:22,612 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-16 13:27:22,612 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-16 13:27:22,612 - root - INFO - Scenario Running: 4
2020-05-16 13:27:22,612 - root - INFO - Train only the network: True
2020-05-16 13:27:22,612 - root - INFO - Output and AE dimensions: 128
2020-05-16 13:27:22,612 - root - INFO - Known anomaly class: 9
2020-05-16 13:27:22,612 - root - INFO - Network: mnist_LeNet
2020-05-16 13:27:22,612 - root - INFO - Eta-parameter: 100.00
2020-05-16 13:27:22,628 - root - INFO - Set seed to 0.
2020-05-16 13:27:22,646 - root - INFO - Computation device: cuda
2020-05-16 13:27:22,647 - root - INFO - Number of threads: 0
2020-05-16 13:27:22,647 - root - INFO - Number of dataloader workers: 6
2020-05-16 13:27:24,766 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-16 13:27:24,766 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-16 13:27:24,766 - root - INFO - Training optimizer: adam
2020-05-16 13:27:24,766 - root - INFO - Training learning rate: 0.0001
2020-05-16 13:27:24,766 - root - INFO - Training epochs: 150
2020-05-16 13:27:24,766 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-16 13:27:24,766 - root - INFO - Training batch size: 200
2020-05-16 13:27:24,767 - root - INFO - Training weight decay: 5e-07
2020-05-16 13:27:24,768 - root - INFO - Starting training...
2020-05-16 13:27:27,140 - root - INFO - | Epoch: 001/150 | Train Time: 2.369s | Train Loss: 10.549781 |
2020-05-16 13:27:28,288 - root - INFO - | Epoch: 002/150 | Train Time: 1.148s | Train Loss: 4.105850 |
2020-05-16 13:27:29,375 - root - INFO - | Epoch: 003/150 | Train Time: 1.087s | Train Loss: 3.995097 |
2020-05-16 13:27:30,362 - root - INFO - | Epoch: 004/150 | Train Time: 0.986s | Train Loss: 3.936666 |
2020-05-16 13:27:31,443 - root - INFO - | Epoch: 005/150 | Train Time: 1.081s | Train Loss: 3.870189 |
2020-05-16 13:27:32,386 - root - INFO - | Epoch: 006/150 | Train Time: 0.942s | Train Loss: 3.813103 |
2020-05-16 13:27:33,523 - root - INFO - | Epoch: 007/150 | Train Time: 1.136s | Train Loss: 3.742688 |
2020-05-16 13:27:34,550 - root - INFO - | Epoch: 008/150 | Train Time: 1.026s | Train Loss: 3.672706 |
2020-05-16 13:27:35,645 - root - INFO - | Epoch: 009/150 | Train Time: 1.095s | Train Loss: 3.593149 |
2020-05-16 13:27:36,737 - root - INFO - | Epoch: 010/150 | Train Time: 1.092s | Train Loss: 3.502738 |
2020-05-16 13:27:37,956 - root - INFO - | Epoch: 011/150 | Train Time: 1.218s | Train Loss: 3.447876 |
2020-05-16 13:27:38,969 - root - INFO - | Epoch: 012/150 | Train Time: 1.012s | Train Loss: 3.367922 |
2020-05-16 13:27:39,959 - root - INFO - | Epoch: 013/150 | Train Time: 0.989s | Train Loss: 3.271950 |
2020-05-16 13:27:41,041 - root - INFO - | Epoch: 014/150 | Train Time: 1.082s | Train Loss: 3.172069 |
2020-05-16 13:27:42,178 - root - INFO - | Epoch: 015/150 | Train Time: 1.136s | Train Loss: 3.088619 |
2020-05-16 13:27:43,271 - root - INFO - | Epoch: 016/150 | Train Time: 1.093s | Train Loss: 2.983403 |
2020-05-16 13:27:44,285 - root - INFO - | Epoch: 017/150 | Train Time: 1.013s | Train Loss: 2.887270 |
2020-05-16 13:27:45,300 - root - INFO - | Epoch: 018/150 | Train Time: 1.015s | Train Loss: 2.778500 |
2020-05-16 13:27:46,360 - root - INFO - | Epoch: 019/150 | Train Time: 1.060s | Train Loss: 2.688645 |
2020-05-16 13:27:47,399 - root - INFO - | Epoch: 020/150 | Train Time: 1.038s | Train Loss: 2.574245 |
2020-05-16 13:27:48,516 - root - INFO - | Epoch: 021/150 | Train Time: 1.117s | Train Loss: 2.465779 |
2020-05-16 13:27:49,634 - root - INFO - | Epoch: 022/150 | Train Time: 1.116s | Train Loss: 2.369858 |
2020-05-16 13:27:50,992 - root - INFO - | Epoch: 023/150 | Train Time: 1.358s | Train Loss: 2.262960 |
2020-05-16 13:27:52,091 - root - INFO - | Epoch: 024/150 | Train Time: 1.098s | Train Loss: 2.201020 |
2020-05-16 13:27:53,103 - root - INFO - | Epoch: 025/150 | Train Time: 1.011s | Train Loss: 2.138902 |
2020-05-16 13:27:54,081 - root - INFO - | Epoch: 026/150 | Train Time: 0.977s | Train Loss: 2.075596 |
2020-05-16 13:27:55,186 - root - INFO - | Epoch: 027/150 | Train Time: 1.105s | Train Loss: 2.026209 |
2020-05-16 13:27:56,084 - root - INFO - | Epoch: 028/150 | Train Time: 0.897s | Train Loss: 1.978759 |
2020-05-16 13:27:57,112 - root - INFO - | Epoch: 029/150 | Train Time: 1.028s | Train Loss: 1.930678 |
2020-05-16 13:27:58,187 - root - INFO - | Epoch: 030/150 | Train Time: 1.075s | Train Loss: 1.899735 |
2020-05-16 13:27:59,154 - root - INFO - | Epoch: 031/150 | Train Time: 0.967s | Train Loss: 1.863693 |
2020-05-16 13:28:00,286 - root - INFO - | Epoch: 032/150 | Train Time: 1.131s | Train Loss: 1.820666 |
2020-05-16 13:28:01,388 - root - INFO - | Epoch: 033/150 | Train Time: 1.101s | Train Loss: 1.797542 |
2020-05-16 13:28:02,431 - root - INFO - | Epoch: 034/150 | Train Time: 1.043s | Train Loss: 1.774929 |
2020-05-16 13:28:03,415 - root - INFO - | Epoch: 035/150 | Train Time: 0.983s | Train Loss: 1.745595 |
2020-05-16 13:28:04,435 - root - INFO - | Epoch: 036/150 | Train Time: 1.019s | Train Loss: 1.722552 |
2020-05-16 13:28:05,475 - root - INFO - | Epoch: 037/150 | Train Time: 1.040s | Train Loss: 1.695403 |
2020-05-16 13:28:06,383 - root - INFO - | Epoch: 038/150 | Train Time: 0.907s | Train Loss: 1.683579 |
2020-05-16 13:28:07,396 - root - INFO - | Epoch: 039/150 | Train Time: 1.012s | Train Loss: 1.655467 |
2020-05-16 13:28:08,392 - root - INFO - | Epoch: 040/150 | Train Time: 0.996s | Train Loss: 1.643876 |
2020-05-16 13:28:09,399 - root - INFO - | Epoch: 041/150 | Train Time: 1.006s | Train Loss: 1.617471 |
2020-05-16 13:28:10,386 - root - INFO - | Epoch: 042/150 | Train Time: 0.986s | Train Loss: 1.601052 |
2020-05-16 13:28:11,399 - root - INFO - | Epoch: 043/150 | Train Time: 1.013s | Train Loss: 1.592025 |
2020-05-16 13:28:12,410 - root - INFO - | Epoch: 044/150 | Train Time: 1.010s | Train Loss: 1.570949 |
2020-05-16 13:28:13,383 - root - INFO - | Epoch: 045/150 | Train Time: 0.973s | Train Loss: 1.557297 |
2020-05-16 13:28:14,427 - root - INFO - | Epoch: 046/150 | Train Time: 1.044s | Train Loss: 1.542127 |
2020-05-16 13:28:15,612 - root - INFO - | Epoch: 047/150 | Train Time: 1.184s | Train Loss: 1.528594 |
2020-05-16 13:28:16,634 - root - INFO - | Epoch: 048/150 | Train Time: 1.022s | Train Loss: 1.507080 |
2020-05-16 13:28:17,752 - root - INFO - | Epoch: 049/150 | Train Time: 1.117s | Train Loss: 1.505716 |
2020-05-16 13:28:18,754 - root - INFO - | Epoch: 050/150 | Train Time: 1.002s | Train Loss: 1.487966 |
2020-05-16 13:28:18,754 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-16 13:28:19,741 - root - INFO - | Epoch: 051/150 | Train Time: 0.987s | Train Loss: 1.480846 |
2020-05-16 13:28:20,935 - root - INFO - | Epoch: 052/150 | Train Time: 1.193s | Train Loss: 1.490070 |
2020-05-16 13:28:21,978 - root - INFO - | Epoch: 053/150 | Train Time: 1.043s | Train Loss: 1.489997 |
2020-05-16 13:28:23,007 - root - INFO - | Epoch: 054/150 | Train Time: 1.028s | Train Loss: 1.492729 |
2020-05-16 13:28:24,079 - root - INFO - | Epoch: 055/150 | Train Time: 1.072s | Train Loss: 1.486457 |
2020-05-16 13:28:25,219 - root - INFO - | Epoch: 056/150 | Train Time: 1.139s | Train Loss: 1.485166 |
2020-05-16 13:28:26,247 - root - INFO - | Epoch: 057/150 | Train Time: 1.028s | Train Loss: 1.487315 |
2020-05-16 13:28:27,265 - root - INFO - | Epoch: 058/150 | Train Time: 1.016s | Train Loss: 1.480404 |
2020-05-16 13:28:28,537 - root - INFO - | Epoch: 059/150 | Train Time: 1.272s | Train Loss: 1.483010 |
2020-05-16 13:28:29,602 - root - INFO - | Epoch: 060/150 | Train Time: 1.065s | Train Loss: 1.481874 |
2020-05-16 13:28:30,608 - root - INFO - | Epoch: 061/150 | Train Time: 1.005s | Train Loss: 1.479340 |
2020-05-16 13:28:31,580 - root - INFO - | Epoch: 062/150 | Train Time: 0.972s | Train Loss: 1.478662 |
2020-05-16 13:28:32,579 - root - INFO - | Epoch: 063/150 | Train Time: 0.998s | Train Loss: 1.478056 |
2020-05-16 13:28:33,662 - root - INFO - | Epoch: 064/150 | Train Time: 1.083s | Train Loss: 1.476848 |
2020-05-16 13:28:34,732 - root - INFO - | Epoch: 065/150 | Train Time: 1.069s | Train Loss: 1.477442 |
2020-05-16 13:28:35,767 - root - INFO - | Epoch: 066/150 | Train Time: 1.034s | Train Loss: 1.472604 |
2020-05-16 13:28:36,774 - root - INFO - | Epoch: 067/150 | Train Time: 1.007s | Train Loss: 1.468666 |
2020-05-16 13:28:37,853 - root - INFO - | Epoch: 068/150 | Train Time: 1.078s | Train Loss: 1.465419 |
2020-05-16 13:28:38,993 - root - INFO - | Epoch: 069/150 | Train Time: 1.140s | Train Loss: 1.465600 |
2020-05-16 13:28:39,869 - root - INFO - | Epoch: 070/150 | Train Time: 0.875s | Train Loss: 1.466620 |
2020-05-16 13:28:40,905 - root - INFO - | Epoch: 071/150 | Train Time: 1.036s | Train Loss: 1.460036 |
2020-05-16 13:28:41,946 - root - INFO - | Epoch: 072/150 | Train Time: 1.040s | Train Loss: 1.459797 |
2020-05-16 13:28:43,005 - root - INFO - | Epoch: 073/150 | Train Time: 1.059s | Train Loss: 1.460452 |
2020-05-16 13:28:44,009 - root - INFO - | Epoch: 074/150 | Train Time: 1.003s | Train Loss: 1.446282 |
2020-05-16 13:28:44,974 - root - INFO - | Epoch: 075/150 | Train Time: 0.965s | Train Loss: 1.457069 |
2020-05-16 13:28:46,131 - root - INFO - | Epoch: 076/150 | Train Time: 1.156s | Train Loss: 1.460816 |
2020-05-16 13:28:47,158 - root - INFO - | Epoch: 077/150 | Train Time: 1.027s | Train Loss: 1.458365 |
2020-05-16 13:28:48,132 - root - INFO - | Epoch: 078/150 | Train Time: 0.974s | Train Loss: 1.452304 |
2020-05-16 13:28:49,245 - root - INFO - | Epoch: 079/150 | Train Time: 1.113s | Train Loss: 1.454133 |
2020-05-16 13:28:50,477 - root - INFO - | Epoch: 080/150 | Train Time: 1.231s | Train Loss: 1.447407 |
2020-05-16 13:28:51,556 - root - INFO - | Epoch: 081/150 | Train Time: 1.078s | Train Loss: 1.452035 |
2020-05-16 13:28:52,555 - root - INFO - | Epoch: 082/150 | Train Time: 0.999s | Train Loss: 1.445535 |
2020-05-16 13:28:53,664 - root - INFO - | Epoch: 083/150 | Train Time: 1.108s | Train Loss: 1.447296 |
2020-05-16 13:28:54,685 - root - INFO - | Epoch: 084/150 | Train Time: 1.021s | Train Loss: 1.435063 |
2020-05-16 13:28:55,701 - root - INFO - | Epoch: 085/150 | Train Time: 1.015s | Train Loss: 1.437776 |
2020-05-16 13:28:56,867 - root - INFO - | Epoch: 086/150 | Train Time: 1.166s | Train Loss: 1.442610 |
2020-05-16 13:28:57,872 - root - INFO - | Epoch: 087/150 | Train Time: 1.005s | Train Loss: 1.429906 |
2020-05-16 13:28:58,912 - root - INFO - | Epoch: 088/150 | Train Time: 1.039s | Train Loss: 1.444502 |
2020-05-16 13:28:59,962 - root - INFO - | Epoch: 089/150 | Train Time: 1.049s | Train Loss: 1.436178 |
2020-05-16 13:29:00,961 - root - INFO - | Epoch: 090/150 | Train Time: 0.999s | Train Loss: 1.434687 |
2020-05-16 13:29:02,027 - root - INFO - | Epoch: 091/150 | Train Time: 1.065s | Train Loss: 1.431075 |
2020-05-16 13:29:03,045 - root - INFO - | Epoch: 092/150 | Train Time: 1.018s | Train Loss: 1.428962 |
2020-05-16 13:29:04,170 - root - INFO - | Epoch: 093/150 | Train Time: 1.124s | Train Loss: 1.424558 |
2020-05-16 13:29:05,247 - root - INFO - | Epoch: 094/150 | Train Time: 1.077s | Train Loss: 1.427591 |
2020-05-16 13:29:06,175 - root - INFO - | Epoch: 095/150 | Train Time: 0.928s | Train Loss: 1.430386 |
2020-05-16 13:29:07,177 - root - INFO - | Epoch: 096/150 | Train Time: 1.001s | Train Loss: 1.428054 |
2020-05-16 13:29:08,197 - root - INFO - | Epoch: 097/150 | Train Time: 1.019s | Train Loss: 1.428424 |
2020-05-16 13:29:09,231 - root - INFO - | Epoch: 098/150 | Train Time: 1.033s | Train Loss: 1.414030 |
2020-05-16 13:29:10,292 - root - INFO - | Epoch: 099/150 | Train Time: 1.060s | Train Loss: 1.426497 |
2020-05-16 13:29:11,262 - root - INFO - | Epoch: 100/150 | Train Time: 0.970s | Train Loss: 1.424729 |
2020-05-16 13:29:12,279 - root - INFO - | Epoch: 101/150 | Train Time: 1.016s | Train Loss: 1.412529 |
2020-05-16 13:29:13,245 - root - INFO - | Epoch: 102/150 | Train Time: 0.966s | Train Loss: 1.416567 |
2020-05-16 13:29:14,238 - root - INFO - | Epoch: 103/150 | Train Time: 0.993s | Train Loss: 1.413251 |
2020-05-16 13:29:15,194 - root - INFO - | Epoch: 104/150 | Train Time: 0.955s | Train Loss: 1.414509 |
2020-05-16 13:29:16,269 - root - INFO - | Epoch: 105/150 | Train Time: 1.075s | Train Loss: 1.414164 |
2020-05-16 13:29:17,250 - root - INFO - | Epoch: 106/150 | Train Time: 0.981s | Train Loss: 1.409783 |
2020-05-16 13:29:18,352 - root - INFO - | Epoch: 107/150 | Train Time: 1.102s | Train Loss: 1.408538 |
2020-05-16 13:29:19,557 - root - INFO - | Epoch: 108/150 | Train Time: 1.204s | Train Loss: 1.408211 |
2020-05-16 13:29:20,639 - root - INFO - | Epoch: 109/150 | Train Time: 1.082s | Train Loss: 1.404181 |
2020-05-16 13:29:21,780 - root - INFO - | Epoch: 110/150 | Train Time: 1.140s | Train Loss: 1.404957 |
2020-05-16 13:29:22,787 - root - INFO - | Epoch: 111/150 | Train Time: 1.007s | Train Loss: 1.399304 |
2020-05-16 13:29:23,847 - root - INFO - | Epoch: 112/150 | Train Time: 1.059s | Train Loss: 1.401235 |
2020-05-16 13:29:24,862 - root - INFO - | Epoch: 113/150 | Train Time: 1.014s | Train Loss: 1.397036 |
2020-05-16 13:29:25,962 - root - INFO - | Epoch: 114/150 | Train Time: 1.100s | Train Loss: 1.398051 |
2020-05-16 13:29:27,054 - root - INFO - | Epoch: 115/150 | Train Time: 1.092s | Train Loss: 1.398140 |
2020-05-16 13:29:28,008 - root - INFO - | Epoch: 116/150 | Train Time: 0.953s | Train Loss: 1.386862 |
2020-05-16 13:29:29,074 - root - INFO - | Epoch: 117/150 | Train Time: 1.066s | Train Loss: 1.395197 |
2020-05-16 13:29:30,086 - root - INFO - | Epoch: 118/150 | Train Time: 1.012s | Train Loss: 1.393679 |
2020-05-16 13:29:31,119 - root - INFO - | Epoch: 119/150 | Train Time: 1.033s | Train Loss: 1.390544 |
2020-05-16 13:29:32,212 - root - INFO - | Epoch: 120/150 | Train Time: 1.091s | Train Loss: 1.389135 |
2020-05-16 13:29:33,258 - root - INFO - | Epoch: 121/150 | Train Time: 1.046s | Train Loss: 1.389626 |
2020-05-16 13:29:34,122 - root - INFO - | Epoch: 122/150 | Train Time: 0.864s | Train Loss: 1.385062 |
2020-05-16 13:29:35,093 - root - INFO - | Epoch: 123/150 | Train Time: 0.970s | Train Loss: 1.379586 |
2020-05-16 13:29:36,183 - root - INFO - | Epoch: 124/150 | Train Time: 1.089s | Train Loss: 1.380780 |
2020-05-16 13:29:37,250 - root - INFO - | Epoch: 125/150 | Train Time: 1.067s | Train Loss: 1.374703 |
2020-05-16 13:29:38,397 - root - INFO - | Epoch: 126/150 | Train Time: 1.147s | Train Loss: 1.380322 |
2020-05-16 13:29:39,466 - root - INFO - | Epoch: 127/150 | Train Time: 1.068s | Train Loss: 1.373006 |
2020-05-16 13:29:40,476 - root - INFO - | Epoch: 128/150 | Train Time: 1.009s | Train Loss: 1.373410 |
2020-05-16 13:29:41,451 - root - INFO - | Epoch: 129/150 | Train Time: 0.975s | Train Loss: 1.373100 |
2020-05-16 13:29:42,433 - root - INFO - | Epoch: 130/150 | Train Time: 0.981s | Train Loss: 1.375136 |
2020-05-16 13:29:43,389 - root - INFO - | Epoch: 131/150 | Train Time: 0.956s | Train Loss: 1.374165 |
2020-05-16 13:29:44,323 - root - INFO - | Epoch: 132/150 | Train Time: 0.933s | Train Loss: 1.371962 |
2020-05-16 13:29:45,330 - root - INFO - | Epoch: 133/150 | Train Time: 1.006s | Train Loss: 1.363325 |
2020-05-16 13:29:46,351 - root - INFO - | Epoch: 134/150 | Train Time: 1.021s | Train Loss: 1.364924 |
2020-05-16 13:29:47,371 - root - INFO - | Epoch: 135/150 | Train Time: 1.019s | Train Loss: 1.364903 |
2020-05-16 13:29:48,585 - root - INFO - | Epoch: 136/150 | Train Time: 1.213s | Train Loss: 1.364341 |
2020-05-16 13:29:49,707 - root - INFO - | Epoch: 137/150 | Train Time: 1.122s | Train Loss: 1.361441 |
2020-05-16 13:29:50,653 - root - INFO - | Epoch: 138/150 | Train Time: 0.946s | Train Loss: 1.361932 |
2020-05-16 13:29:51,478 - root - INFO - | Epoch: 139/150 | Train Time: 0.824s | Train Loss: 1.359561 |
2020-05-16 13:29:52,444 - root - INFO - | Epoch: 140/150 | Train Time: 0.966s | Train Loss: 1.359717 |
2020-05-16 13:29:53,305 - root - INFO - | Epoch: 141/150 | Train Time: 0.861s | Train Loss: 1.360254 |
2020-05-16 13:29:54,203 - root - INFO - | Epoch: 142/150 | Train Time: 0.897s | Train Loss: 1.352707 |
2020-05-16 13:29:55,170 - root - INFO - | Epoch: 143/150 | Train Time: 0.966s | Train Loss: 1.350088 |
2020-05-16 13:29:56,150 - root - INFO - | Epoch: 144/150 | Train Time: 0.980s | Train Loss: 1.347361 |
2020-05-16 13:29:57,139 - root - INFO - | Epoch: 145/150 | Train Time: 0.988s | Train Loss: 1.346849 |
2020-05-16 13:29:58,061 - root - INFO - | Epoch: 146/150 | Train Time: 0.922s | Train Loss: 1.344905 |
2020-05-16 13:29:58,963 - root - INFO - | Epoch: 147/150 | Train Time: 0.901s | Train Loss: 1.342095 |
2020-05-16 13:29:59,889 - root - INFO - | Epoch: 148/150 | Train Time: 0.926s | Train Loss: 1.340549 |
2020-05-16 13:30:00,822 - root - INFO - | Epoch: 149/150 | Train Time: 0.932s | Train Loss: 1.347587 |
2020-05-16 13:30:01,760 - root - INFO - | Epoch: 150/150 | Train Time: 0.938s | Train Loss: 1.337553 |
2020-05-16 13:30:01,761 - root - INFO - Training Time: 156.993s
2020-05-16 13:30:01,761 - root - INFO - Finished training.
2020-05-16 13:30:01,763 - root - INFO - Starting testing...
2020-05-16 13:30:02,815 - root - INFO - Test Loss: 2.813728
2020-05-16 13:30:02,816 - root - INFO - Test AUC: 87.94%
2020-05-16 13:30:02,816 - root - INFO - Test Time: 1.036s
2020-05-16 13:30:02,816 - root - INFO - Finished testing.
