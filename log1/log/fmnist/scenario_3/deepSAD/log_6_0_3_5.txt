2020-05-20 05:21:24,032 - root - INFO - Log file is ../log/fmnist/scenario_3/deepSAD/log_6_0_3_5.txt
2020-05-20 05:21:24,033 - root - INFO - Data path is ../data
2020-05-20 05:21:24,033 - root - INFO - Export path is ../log/fmnist/scenario_3/deepSAD
2020-05-20 05:21:24,033 - root - INFO - Dataset: fmnist
2020-05-20 05:21:24,033 - root - INFO - Normal class: 6
2020-05-20 05:21:24,033 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-20 05:21:24,033 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-20 05:21:24,033 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-20 05:21:24,033 - root - INFO - Scenario Running: 3
2020-05-20 05:21:24,033 - root - INFO - Train only the network: True
2020-05-20 05:21:24,033 - root - INFO - Output and AE dimensions: 128
2020-05-20 05:21:24,034 - root - INFO - Number of known anomaly classes: 3
2020-05-20 05:21:24,034 - root - INFO - Network: fmnist_LeNet
2020-05-20 05:21:24,034 - root - INFO - Eta-parameter: 1.00
2020-05-20 05:21:24,041 - root - INFO - Set seed to 5.
2020-05-20 05:21:24,077 - root - INFO - Computation device: cuda
2020-05-20 05:21:24,077 - root - INFO - Number of threads: 0
2020-05-20 05:21:24,078 - root - INFO - Number of dataloader workers: 6
2020-05-20 05:21:24,188 - root - INFO - Known anomaly classes: (4, 5, 7)
2020-05-20 05:21:27,270 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-20 05:21:27,271 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-20 05:21:27,271 - root - INFO - Pretraining: True
2020-05-20 05:21:27,271 - root - INFO - Training optimizer: adam
2020-05-20 05:21:27,271 - root - INFO - Training learning rate: 0.0001
2020-05-20 05:21:27,271 - root - INFO - Training epochs: 150
2020-05-20 05:21:27,271 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-20 05:21:27,271 - root - INFO - Training batch size: 200
2020-05-20 05:21:27,271 - root - INFO - Training weight decay: 5e-07
2020-05-20 05:21:27,274 - root - INFO - Starting training...
2020-05-20 05:21:30,041 - root - INFO - | Epoch: 001/150 | Train Time: 2.768s | Train Loss: 2.111169 |
2020-05-20 05:21:30,964 - root - INFO - | Epoch: 002/150 | Train Time: 0.922s | Train Loss: 0.638736 |
2020-05-20 05:21:31,899 - root - INFO - | Epoch: 003/150 | Train Time: 0.935s | Train Loss: 0.423697 |
2020-05-20 05:21:32,804 - root - INFO - | Epoch: 004/150 | Train Time: 0.905s | Train Loss: 0.351665 |
2020-05-20 05:21:33,793 - root - INFO - | Epoch: 005/150 | Train Time: 0.988s | Train Loss: 0.307957 |
2020-05-20 05:21:34,754 - root - INFO - | Epoch: 006/150 | Train Time: 0.961s | Train Loss: 0.278055 |
2020-05-20 05:21:35,749 - root - INFO - | Epoch: 007/150 | Train Time: 0.994s | Train Loss: 0.257084 |
2020-05-20 05:21:36,637 - root - INFO - | Epoch: 008/150 | Train Time: 0.887s | Train Loss: 0.239524 |
2020-05-20 05:21:37,611 - root - INFO - | Epoch: 009/150 | Train Time: 0.974s | Train Loss: 0.227329 |
2020-05-20 05:21:38,717 - root - INFO - | Epoch: 010/150 | Train Time: 1.105s | Train Loss: 0.217708 |
2020-05-20 05:21:39,730 - root - INFO - | Epoch: 011/150 | Train Time: 1.012s | Train Loss: 0.209782 |
2020-05-20 05:21:40,716 - root - INFO - | Epoch: 012/150 | Train Time: 0.985s | Train Loss: 0.201249 |
2020-05-20 05:21:41,678 - root - INFO - | Epoch: 013/150 | Train Time: 0.961s | Train Loss: 0.197050 |
2020-05-20 05:21:42,508 - root - INFO - | Epoch: 014/150 | Train Time: 0.830s | Train Loss: 0.190888 |
2020-05-20 05:21:43,436 - root - INFO - | Epoch: 015/150 | Train Time: 0.928s | Train Loss: 0.184393 |
2020-05-20 05:21:44,324 - root - INFO - | Epoch: 016/150 | Train Time: 0.888s | Train Loss: 0.178127 |
2020-05-20 05:21:45,366 - root - INFO - | Epoch: 017/150 | Train Time: 1.041s | Train Loss: 0.175767 |
2020-05-20 05:21:46,239 - root - INFO - | Epoch: 018/150 | Train Time: 0.872s | Train Loss: 0.172073 |
2020-05-20 05:21:47,168 - root - INFO - | Epoch: 019/150 | Train Time: 0.929s | Train Loss: 0.168947 |
2020-05-20 05:21:48,145 - root - INFO - | Epoch: 020/150 | Train Time: 0.976s | Train Loss: 0.164807 |
2020-05-20 05:21:49,127 - root - INFO - | Epoch: 021/150 | Train Time: 0.982s | Train Loss: 0.160550 |
2020-05-20 05:21:50,101 - root - INFO - | Epoch: 022/150 | Train Time: 0.974s | Train Loss: 0.161744 |
2020-05-20 05:21:51,065 - root - INFO - | Epoch: 023/150 | Train Time: 0.964s | Train Loss: 0.156438 |
2020-05-20 05:21:51,991 - root - INFO - | Epoch: 024/150 | Train Time: 0.925s | Train Loss: 0.154772 |
2020-05-20 05:21:52,947 - root - INFO - | Epoch: 025/150 | Train Time: 0.956s | Train Loss: 0.151873 |
2020-05-20 05:21:53,936 - root - INFO - | Epoch: 026/150 | Train Time: 0.988s | Train Loss: 0.148248 |
2020-05-20 05:21:54,988 - root - INFO - | Epoch: 027/150 | Train Time: 1.051s | Train Loss: 0.146187 |
2020-05-20 05:21:56,086 - root - INFO - | Epoch: 028/150 | Train Time: 1.097s | Train Loss: 0.144597 |
2020-05-20 05:21:57,044 - root - INFO - | Epoch: 029/150 | Train Time: 0.957s | Train Loss: 0.141914 |
2020-05-20 05:21:57,989 - root - INFO - | Epoch: 030/150 | Train Time: 0.945s | Train Loss: 0.140778 |
2020-05-20 05:21:58,899 - root - INFO - | Epoch: 031/150 | Train Time: 0.909s | Train Loss: 0.140325 |
2020-05-20 05:21:59,875 - root - INFO - | Epoch: 032/150 | Train Time: 0.975s | Train Loss: 0.137940 |
2020-05-20 05:22:00,779 - root - INFO - | Epoch: 033/150 | Train Time: 0.904s | Train Loss: 0.134837 |
2020-05-20 05:22:01,763 - root - INFO - | Epoch: 034/150 | Train Time: 0.983s | Train Loss: 0.132761 |
2020-05-20 05:22:02,740 - root - INFO - | Epoch: 035/150 | Train Time: 0.976s | Train Loss: 0.131132 |
2020-05-20 05:22:03,711 - root - INFO - | Epoch: 036/150 | Train Time: 0.971s | Train Loss: 0.128080 |
2020-05-20 05:22:04,626 - root - INFO - | Epoch: 037/150 | Train Time: 0.914s | Train Loss: 0.126632 |
2020-05-20 05:22:05,507 - root - INFO - | Epoch: 038/150 | Train Time: 0.881s | Train Loss: 0.127970 |
2020-05-20 05:22:06,533 - root - INFO - | Epoch: 039/150 | Train Time: 1.025s | Train Loss: 0.126098 |
2020-05-20 05:22:08,315 - root - INFO - | Epoch: 040/150 | Train Time: 1.782s | Train Loss: 0.123843 |
2020-05-20 05:22:09,631 - root - INFO - | Epoch: 041/150 | Train Time: 1.315s | Train Loss: 0.122631 |
2020-05-20 05:22:10,701 - root - INFO - | Epoch: 042/150 | Train Time: 1.070s | Train Loss: 0.121005 |
2020-05-20 05:22:11,714 - root - INFO - | Epoch: 043/150 | Train Time: 1.012s | Train Loss: 0.119910 |
2020-05-20 05:22:12,734 - root - INFO - | Epoch: 044/150 | Train Time: 1.020s | Train Loss: 0.119051 |
2020-05-20 05:22:13,798 - root - INFO - | Epoch: 045/150 | Train Time: 1.064s | Train Loss: 0.118027 |
2020-05-20 05:22:14,777 - root - INFO - | Epoch: 046/150 | Train Time: 0.978s | Train Loss: 0.117710 |
2020-05-20 05:22:15,797 - root - INFO - | Epoch: 047/150 | Train Time: 1.019s | Train Loss: 0.116144 |
2020-05-20 05:22:16,704 - root - INFO - | Epoch: 048/150 | Train Time: 0.907s | Train Loss: 0.113023 |
2020-05-20 05:22:17,671 - root - INFO - | Epoch: 049/150 | Train Time: 0.967s | Train Loss: 0.112820 |
2020-05-20 05:22:18,634 - root - INFO - | Epoch: 050/150 | Train Time: 0.962s | Train Loss: 0.109163 |
2020-05-20 05:22:18,634 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-20 05:22:19,523 - root - INFO - | Epoch: 051/150 | Train Time: 0.889s | Train Loss: 0.109336 |
2020-05-20 05:22:20,420 - root - INFO - | Epoch: 052/150 | Train Time: 0.896s | Train Loss: 0.107385 |
2020-05-20 05:22:21,335 - root - INFO - | Epoch: 053/150 | Train Time: 0.914s | Train Loss: 0.106441 |
2020-05-20 05:22:22,267 - root - INFO - | Epoch: 054/150 | Train Time: 0.931s | Train Loss: 0.107599 |
2020-05-20 05:22:23,221 - root - INFO - | Epoch: 055/150 | Train Time: 0.954s | Train Loss: 0.106465 |
2020-05-20 05:22:24,104 - root - INFO - | Epoch: 056/150 | Train Time: 0.882s | Train Loss: 0.106089 |
2020-05-20 05:22:25,154 - root - INFO - | Epoch: 057/150 | Train Time: 1.049s | Train Loss: 0.107318 |
2020-05-20 05:22:26,144 - root - INFO - | Epoch: 058/150 | Train Time: 0.989s | Train Loss: 0.106875 |
2020-05-20 05:22:27,100 - root - INFO - | Epoch: 059/150 | Train Time: 0.955s | Train Loss: 0.106615 |
2020-05-20 05:22:28,115 - root - INFO - | Epoch: 060/150 | Train Time: 1.014s | Train Loss: 0.106658 |
2020-05-20 05:22:29,131 - root - INFO - | Epoch: 061/150 | Train Time: 1.015s | Train Loss: 0.105072 |
2020-05-20 05:22:30,205 - root - INFO - | Epoch: 062/150 | Train Time: 1.073s | Train Loss: 0.106497 |
2020-05-20 05:22:31,216 - root - INFO - | Epoch: 063/150 | Train Time: 1.011s | Train Loss: 0.106137 |
2020-05-20 05:22:32,104 - root - INFO - | Epoch: 064/150 | Train Time: 0.887s | Train Loss: 0.107498 |
2020-05-20 05:22:33,063 - root - INFO - | Epoch: 065/150 | Train Time: 0.958s | Train Loss: 0.105440 |
2020-05-20 05:22:34,057 - root - INFO - | Epoch: 066/150 | Train Time: 0.994s | Train Loss: 0.104348 |
2020-05-20 05:22:35,123 - root - INFO - | Epoch: 067/150 | Train Time: 1.065s | Train Loss: 0.104690 |
2020-05-20 05:22:36,121 - root - INFO - | Epoch: 068/150 | Train Time: 0.997s | Train Loss: 0.106521 |
2020-05-20 05:22:37,150 - root - INFO - | Epoch: 069/150 | Train Time: 1.028s | Train Loss: 0.106478 |
2020-05-20 05:22:38,162 - root - INFO - | Epoch: 070/150 | Train Time: 1.011s | Train Loss: 0.105149 |
2020-05-20 05:22:39,217 - root - INFO - | Epoch: 071/150 | Train Time: 1.054s | Train Loss: 0.106470 |
2020-05-20 05:22:40,200 - root - INFO - | Epoch: 072/150 | Train Time: 0.983s | Train Loss: 0.104263 |
2020-05-20 05:22:41,199 - root - INFO - | Epoch: 073/150 | Train Time: 0.998s | Train Loss: 0.104900 |
2020-05-20 05:22:42,179 - root - INFO - | Epoch: 074/150 | Train Time: 0.980s | Train Loss: 0.104548 |
2020-05-20 05:22:43,143 - root - INFO - | Epoch: 075/150 | Train Time: 0.963s | Train Loss: 0.104501 |
2020-05-20 05:22:44,105 - root - INFO - | Epoch: 076/150 | Train Time: 0.961s | Train Loss: 0.106092 |
2020-05-20 05:22:45,113 - root - INFO - | Epoch: 077/150 | Train Time: 1.008s | Train Loss: 0.105204 |
2020-05-20 05:22:46,106 - root - INFO - | Epoch: 078/150 | Train Time: 0.992s | Train Loss: 0.103827 |
2020-05-20 05:22:47,113 - root - INFO - | Epoch: 079/150 | Train Time: 1.007s | Train Loss: 0.104110 |
2020-05-20 05:22:48,135 - root - INFO - | Epoch: 080/150 | Train Time: 1.021s | Train Loss: 0.103024 |
2020-05-20 05:22:49,213 - root - INFO - | Epoch: 081/150 | Train Time: 1.077s | Train Loss: 0.104150 |
2020-05-20 05:22:50,304 - root - INFO - | Epoch: 082/150 | Train Time: 1.091s | Train Loss: 0.103153 |
2020-05-20 05:22:51,245 - root - INFO - | Epoch: 083/150 | Train Time: 0.940s | Train Loss: 0.103094 |
2020-05-20 05:22:52,275 - root - INFO - | Epoch: 084/150 | Train Time: 1.029s | Train Loss: 0.101881 |
2020-05-20 05:22:53,165 - root - INFO - | Epoch: 085/150 | Train Time: 0.889s | Train Loss: 0.102790 |
2020-05-20 05:22:54,108 - root - INFO - | Epoch: 086/150 | Train Time: 0.943s | Train Loss: 0.102007 |
2020-05-20 05:22:55,088 - root - INFO - | Epoch: 087/150 | Train Time: 0.979s | Train Loss: 0.103555 |
2020-05-20 05:22:56,130 - root - INFO - | Epoch: 088/150 | Train Time: 1.041s | Train Loss: 0.103084 |
2020-05-20 05:22:57,058 - root - INFO - | Epoch: 089/150 | Train Time: 0.928s | Train Loss: 0.102343 |
2020-05-20 05:22:58,006 - root - INFO - | Epoch: 090/150 | Train Time: 0.948s | Train Loss: 0.103066 |
2020-05-20 05:22:59,085 - root - INFO - | Epoch: 091/150 | Train Time: 1.078s | Train Loss: 0.102651 |
2020-05-20 05:23:00,087 - root - INFO - | Epoch: 092/150 | Train Time: 1.001s | Train Loss: 0.101711 |
2020-05-20 05:23:01,116 - root - INFO - | Epoch: 093/150 | Train Time: 1.028s | Train Loss: 0.101851 |
2020-05-20 05:23:02,144 - root - INFO - | Epoch: 094/150 | Train Time: 1.027s | Train Loss: 0.101115 |
2020-05-20 05:23:03,101 - root - INFO - | Epoch: 095/150 | Train Time: 0.956s | Train Loss: 0.101205 |
2020-05-20 05:23:04,064 - root - INFO - | Epoch: 096/150 | Train Time: 0.963s | Train Loss: 0.101328 |
2020-05-20 05:23:05,077 - root - INFO - | Epoch: 097/150 | Train Time: 1.012s | Train Loss: 0.100589 |
2020-05-20 05:23:06,184 - root - INFO - | Epoch: 098/150 | Train Time: 1.106s | Train Loss: 0.100965 |
2020-05-20 05:23:07,248 - root - INFO - | Epoch: 099/150 | Train Time: 1.063s | Train Loss: 0.100720 |
2020-05-20 05:23:08,239 - root - INFO - | Epoch: 100/150 | Train Time: 0.991s | Train Loss: 0.100509 |
2020-05-20 05:23:09,217 - root - INFO - | Epoch: 101/150 | Train Time: 0.977s | Train Loss: 0.100923 |
2020-05-20 05:23:10,193 - root - INFO - | Epoch: 102/150 | Train Time: 0.976s | Train Loss: 0.100292 |
2020-05-20 05:23:11,122 - root - INFO - | Epoch: 103/150 | Train Time: 0.929s | Train Loss: 0.099703 |
2020-05-20 05:23:12,057 - root - INFO - | Epoch: 104/150 | Train Time: 0.934s | Train Loss: 0.099300 |
2020-05-20 05:23:12,907 - root - INFO - | Epoch: 105/150 | Train Time: 0.849s | Train Loss: 0.099230 |
2020-05-20 05:23:13,831 - root - INFO - | Epoch: 106/150 | Train Time: 0.923s | Train Loss: 0.099035 |
2020-05-20 05:23:14,755 - root - INFO - | Epoch: 107/150 | Train Time: 0.924s | Train Loss: 0.099207 |
2020-05-20 05:23:15,617 - root - INFO - | Epoch: 108/150 | Train Time: 0.861s | Train Loss: 0.100288 |
2020-05-20 05:23:16,581 - root - INFO - | Epoch: 109/150 | Train Time: 0.963s | Train Loss: 0.100354 |
2020-05-20 05:23:17,508 - root - INFO - | Epoch: 110/150 | Train Time: 0.926s | Train Loss: 0.099414 |
2020-05-20 05:23:18,490 - root - INFO - | Epoch: 111/150 | Train Time: 0.982s | Train Loss: 0.099205 |
2020-05-20 05:23:19,518 - root - INFO - | Epoch: 112/150 | Train Time: 1.028s | Train Loss: 0.098347 |
2020-05-20 05:23:20,502 - root - INFO - | Epoch: 113/150 | Train Time: 0.983s | Train Loss: 0.098693 |
2020-05-20 05:23:21,445 - root - INFO - | Epoch: 114/150 | Train Time: 0.943s | Train Loss: 0.098705 |
2020-05-20 05:23:22,340 - root - INFO - | Epoch: 115/150 | Train Time: 0.895s | Train Loss: 0.097697 |
2020-05-20 05:23:23,247 - root - INFO - | Epoch: 116/150 | Train Time: 0.906s | Train Loss: 0.098251 |
2020-05-20 05:23:24,210 - root - INFO - | Epoch: 117/150 | Train Time: 0.963s | Train Loss: 0.097962 |
2020-05-20 05:23:25,159 - root - INFO - | Epoch: 118/150 | Train Time: 0.948s | Train Loss: 0.098592 |
2020-05-20 05:23:26,060 - root - INFO - | Epoch: 119/150 | Train Time: 0.901s | Train Loss: 0.097295 |
2020-05-20 05:23:26,947 - root - INFO - | Epoch: 120/150 | Train Time: 0.886s | Train Loss: 0.096888 |
2020-05-20 05:23:27,792 - root - INFO - | Epoch: 121/150 | Train Time: 0.844s | Train Loss: 0.096397 |
2020-05-20 05:23:28,749 - root - INFO - | Epoch: 122/150 | Train Time: 0.957s | Train Loss: 0.097976 |
2020-05-20 05:23:29,606 - root - INFO - | Epoch: 123/150 | Train Time: 0.857s | Train Loss: 0.096291 |
2020-05-20 05:23:30,446 - root - INFO - | Epoch: 124/150 | Train Time: 0.839s | Train Loss: 0.096333 |
2020-05-20 05:23:31,418 - root - INFO - | Epoch: 125/150 | Train Time: 0.972s | Train Loss: 0.096434 |
2020-05-20 05:23:32,348 - root - INFO - | Epoch: 126/150 | Train Time: 0.929s | Train Loss: 0.097280 |
2020-05-20 05:23:33,335 - root - INFO - | Epoch: 127/150 | Train Time: 0.987s | Train Loss: 0.095868 |
2020-05-20 05:23:34,324 - root - INFO - | Epoch: 128/150 | Train Time: 0.988s | Train Loss: 0.095905 |
2020-05-20 05:23:35,300 - root - INFO - | Epoch: 129/150 | Train Time: 0.975s | Train Loss: 0.095473 |
2020-05-20 05:23:36,261 - root - INFO - | Epoch: 130/150 | Train Time: 0.961s | Train Loss: 0.095408 |
2020-05-20 05:23:37,170 - root - INFO - | Epoch: 131/150 | Train Time: 0.908s | Train Loss: 0.096548 |
2020-05-20 05:23:38,022 - root - INFO - | Epoch: 132/150 | Train Time: 0.850s | Train Loss: 0.096368 |
2020-05-20 05:23:38,898 - root - INFO - | Epoch: 133/150 | Train Time: 0.876s | Train Loss: 0.095440 |
2020-05-20 05:23:39,724 - root - INFO - | Epoch: 134/150 | Train Time: 0.825s | Train Loss: 0.095682 |
2020-05-20 05:23:40,615 - root - INFO - | Epoch: 135/150 | Train Time: 0.891s | Train Loss: 0.094085 |
2020-05-20 05:23:41,611 - root - INFO - | Epoch: 136/150 | Train Time: 0.995s | Train Loss: 0.094981 |
2020-05-20 05:23:42,552 - root - INFO - | Epoch: 137/150 | Train Time: 0.941s | Train Loss: 0.094163 |
2020-05-20 05:23:43,484 - root - INFO - | Epoch: 138/150 | Train Time: 0.932s | Train Loss: 0.094251 |
2020-05-20 05:23:44,415 - root - INFO - | Epoch: 139/150 | Train Time: 0.931s | Train Loss: 0.093897 |
2020-05-20 05:23:45,386 - root - INFO - | Epoch: 140/150 | Train Time: 0.970s | Train Loss: 0.093965 |
2020-05-20 05:23:46,426 - root - INFO - | Epoch: 141/150 | Train Time: 1.040s | Train Loss: 0.093510 |
2020-05-20 05:23:47,337 - root - INFO - | Epoch: 142/150 | Train Time: 0.909s | Train Loss: 0.093302 |
2020-05-20 05:23:48,169 - root - INFO - | Epoch: 143/150 | Train Time: 0.832s | Train Loss: 0.093841 |
2020-05-20 05:23:49,081 - root - INFO - | Epoch: 144/150 | Train Time: 0.911s | Train Loss: 0.093178 |
2020-05-20 05:23:50,035 - root - INFO - | Epoch: 145/150 | Train Time: 0.954s | Train Loss: 0.093770 |
2020-05-20 05:23:50,994 - root - INFO - | Epoch: 146/150 | Train Time: 0.958s | Train Loss: 0.093089 |
2020-05-20 05:23:51,995 - root - INFO - | Epoch: 147/150 | Train Time: 1.001s | Train Loss: 0.093282 |
2020-05-20 05:23:53,107 - root - INFO - | Epoch: 148/150 | Train Time: 1.111s | Train Loss: 0.093474 |
2020-05-20 05:23:54,088 - root - INFO - | Epoch: 149/150 | Train Time: 0.980s | Train Loss: 0.092630 |
2020-05-20 05:23:55,090 - root - INFO - | Epoch: 150/150 | Train Time: 1.001s | Train Loss: 0.092658 |
2020-05-20 05:23:55,090 - root - INFO - Training Time: 147.816s
2020-05-20 05:23:55,090 - root - INFO - Finished training.
2020-05-20 05:23:55,091 - root - INFO - Starting testing...
2020-05-20 05:23:56,113 - root - INFO - Test Loss: 0.368955
2020-05-20 05:23:56,113 - root - INFO - Test AUC: 79.19%
2020-05-20 05:23:56,113 - root - INFO - Test Time: 1.006s
2020-05-20 05:23:56,113 - root - INFO - Finished testing.
2020-05-20 13:13:51,127 - root - INFO - Log file is ../log/fmnist/scenario_3/deepSAD/log_6_0_3_5.txt
2020-05-20 13:13:51,127 - root - INFO - Data path is ../data
2020-05-20 13:13:51,127 - root - INFO - Export path is ../log/fmnist/scenario_3/deepSAD
2020-05-20 13:13:51,127 - root - INFO - Dataset: fmnist
2020-05-20 13:13:51,127 - root - INFO - Normal class: 6
2020-05-20 13:13:51,127 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-20 13:13:51,127 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-20 13:13:51,127 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-20 13:13:51,127 - root - INFO - Scenario Running: 3
2020-05-20 13:13:51,127 - root - INFO - Train only the network: True
2020-05-20 13:13:51,128 - root - INFO - Output and AE dimensions: 128
2020-05-20 13:13:51,128 - root - INFO - Number of known anomaly classes: 3
2020-05-20 13:13:51,128 - root - INFO - Network: fmnist_LeNet
2020-05-20 13:13:51,128 - root - INFO - Eta-parameter: 1.00
2020-05-20 13:13:51,135 - root - INFO - Set seed to 5.
2020-05-20 13:13:51,161 - root - INFO - Computation device: cuda
2020-05-20 13:13:51,161 - root - INFO - Number of threads: 0
2020-05-20 13:13:51,161 - root - INFO - Number of dataloader workers: 6
2020-05-20 13:13:51,240 - root - INFO - Known anomaly classes: (4, 5, 7)
2020-05-20 13:13:54,693 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-20 13:13:54,694 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-20 13:13:54,694 - root - INFO - Pretraining: True
2020-05-20 13:13:54,694 - root - INFO - Training optimizer: adam
2020-05-20 13:13:54,694 - root - INFO - Training learning rate: 0.0001
2020-05-20 13:13:54,694 - root - INFO - Training epochs: 150
2020-05-20 13:13:54,695 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-20 13:13:54,695 - root - INFO - Training batch size: 200
2020-05-20 13:13:54,695 - root - INFO - Training weight decay: 5e-07
2020-05-20 13:13:54,712 - root - INFO - Starting training...
2020-05-20 13:13:57,646 - root - INFO - | Epoch: 001/150 | Train Time: 2.934s | Train Loss: 2.111169 |
2020-05-20 13:13:58,561 - root - INFO - | Epoch: 002/150 | Train Time: 0.914s | Train Loss: 0.638736 |
2020-05-20 13:13:59,481 - root - INFO - | Epoch: 003/150 | Train Time: 0.919s | Train Loss: 0.423697 |
2020-05-20 13:14:00,342 - root - INFO - | Epoch: 004/150 | Train Time: 0.861s | Train Loss: 0.351665 |
2020-05-20 13:14:01,194 - root - INFO - | Epoch: 005/150 | Train Time: 0.852s | Train Loss: 0.307957 |
2020-05-20 13:14:02,056 - root - INFO - | Epoch: 006/150 | Train Time: 0.861s | Train Loss: 0.278055 |
2020-05-20 13:14:03,091 - root - INFO - | Epoch: 007/150 | Train Time: 1.034s | Train Loss: 0.257084 |
2020-05-20 13:14:04,119 - root - INFO - | Epoch: 008/150 | Train Time: 1.027s | Train Loss: 0.239524 |
2020-05-20 13:14:05,108 - root - INFO - | Epoch: 009/150 | Train Time: 0.988s | Train Loss: 0.227329 |
2020-05-20 13:14:06,105 - root - INFO - | Epoch: 010/150 | Train Time: 0.997s | Train Loss: 0.217708 |
2020-05-20 13:14:07,002 - root - INFO - | Epoch: 011/150 | Train Time: 0.896s | Train Loss: 0.209782 |
2020-05-20 13:14:07,990 - root - INFO - | Epoch: 012/150 | Train Time: 0.988s | Train Loss: 0.201249 |
2020-05-20 13:14:08,967 - root - INFO - | Epoch: 013/150 | Train Time: 0.977s | Train Loss: 0.197050 |
2020-05-20 13:14:10,002 - root - INFO - | Epoch: 014/150 | Train Time: 1.033s | Train Loss: 0.190888 |
2020-05-20 13:14:10,901 - root - INFO - | Epoch: 015/150 | Train Time: 0.899s | Train Loss: 0.184393 |
2020-05-20 13:14:11,918 - root - INFO - | Epoch: 016/150 | Train Time: 1.016s | Train Loss: 0.178127 |
2020-05-20 13:14:12,778 - root - INFO - | Epoch: 017/150 | Train Time: 0.860s | Train Loss: 0.175767 |
2020-05-20 13:14:13,745 - root - INFO - | Epoch: 018/150 | Train Time: 0.967s | Train Loss: 0.172073 |
2020-05-20 13:14:14,642 - root - INFO - | Epoch: 019/150 | Train Time: 0.896s | Train Loss: 0.168947 |
2020-05-20 13:14:15,608 - root - INFO - | Epoch: 020/150 | Train Time: 0.965s | Train Loss: 0.164807 |
2020-05-20 13:14:16,568 - root - INFO - | Epoch: 021/150 | Train Time: 0.959s | Train Loss: 0.160550 |
2020-05-20 13:14:17,529 - root - INFO - | Epoch: 022/150 | Train Time: 0.960s | Train Loss: 0.161744 |
2020-05-20 13:14:18,424 - root - INFO - | Epoch: 023/150 | Train Time: 0.894s | Train Loss: 0.156438 |
2020-05-20 13:14:19,419 - root - INFO - | Epoch: 024/150 | Train Time: 0.994s | Train Loss: 0.154772 |
2020-05-20 13:14:20,429 - root - INFO - | Epoch: 025/150 | Train Time: 1.009s | Train Loss: 0.151873 |
2020-05-20 13:14:21,405 - root - INFO - | Epoch: 026/150 | Train Time: 0.976s | Train Loss: 0.148248 |
2020-05-20 13:14:22,350 - root - INFO - | Epoch: 027/150 | Train Time: 0.944s | Train Loss: 0.146187 |
2020-05-20 13:14:23,399 - root - INFO - | Epoch: 028/150 | Train Time: 1.049s | Train Loss: 0.144597 |
2020-05-20 13:14:24,342 - root - INFO - | Epoch: 029/150 | Train Time: 0.942s | Train Loss: 0.141914 |
2020-05-20 13:14:25,234 - root - INFO - | Epoch: 030/150 | Train Time: 0.891s | Train Loss: 0.140778 |
2020-05-20 13:14:26,128 - root - INFO - | Epoch: 031/150 | Train Time: 0.893s | Train Loss: 0.140325 |
2020-05-20 13:14:26,955 - root - INFO - | Epoch: 032/150 | Train Time: 0.827s | Train Loss: 0.137940 |
2020-05-20 13:14:27,876 - root - INFO - | Epoch: 033/150 | Train Time: 0.921s | Train Loss: 0.134837 |
2020-05-20 13:14:28,773 - root - INFO - | Epoch: 034/150 | Train Time: 0.897s | Train Loss: 0.132761 |
2020-05-20 13:14:29,683 - root - INFO - | Epoch: 035/150 | Train Time: 0.909s | Train Loss: 0.131132 |
2020-05-20 13:14:30,527 - root - INFO - | Epoch: 036/150 | Train Time: 0.844s | Train Loss: 0.128080 |
2020-05-20 13:14:31,420 - root - INFO - | Epoch: 037/150 | Train Time: 0.893s | Train Loss: 0.126632 |
2020-05-20 13:14:32,304 - root - INFO - | Epoch: 038/150 | Train Time: 0.882s | Train Loss: 0.127970 |
2020-05-20 13:14:33,222 - root - INFO - | Epoch: 039/150 | Train Time: 0.917s | Train Loss: 0.126098 |
2020-05-20 13:14:34,227 - root - INFO - | Epoch: 040/150 | Train Time: 1.004s | Train Loss: 0.123843 |
2020-05-20 13:14:35,160 - root - INFO - | Epoch: 041/150 | Train Time: 0.933s | Train Loss: 0.122631 |
2020-05-20 13:14:35,984 - root - INFO - | Epoch: 042/150 | Train Time: 0.824s | Train Loss: 0.121005 |
2020-05-20 13:14:36,799 - root - INFO - | Epoch: 043/150 | Train Time: 0.815s | Train Loss: 0.119910 |
2020-05-20 13:14:37,632 - root - INFO - | Epoch: 044/150 | Train Time: 0.832s | Train Loss: 0.119051 |
2020-05-20 13:14:38,509 - root - INFO - | Epoch: 045/150 | Train Time: 0.877s | Train Loss: 0.118027 |
2020-05-20 13:14:39,511 - root - INFO - | Epoch: 046/150 | Train Time: 1.001s | Train Loss: 0.117710 |
2020-05-20 13:14:40,489 - root - INFO - | Epoch: 047/150 | Train Time: 0.978s | Train Loss: 0.116144 |
2020-05-20 13:14:41,312 - root - INFO - | Epoch: 048/150 | Train Time: 0.822s | Train Loss: 0.113023 |
2020-05-20 13:14:42,061 - root - INFO - | Epoch: 049/150 | Train Time: 0.749s | Train Loss: 0.112820 |
2020-05-20 13:14:42,956 - root - INFO - | Epoch: 050/150 | Train Time: 0.894s | Train Loss: 0.109163 |
2020-05-20 13:14:42,956 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-20 13:14:43,891 - root - INFO - | Epoch: 051/150 | Train Time: 0.934s | Train Loss: 0.109336 |
2020-05-20 13:14:44,842 - root - INFO - | Epoch: 052/150 | Train Time: 0.950s | Train Loss: 0.107385 |
2020-05-20 13:14:45,693 - root - INFO - | Epoch: 053/150 | Train Time: 0.851s | Train Loss: 0.106441 |
2020-05-20 13:14:46,529 - root - INFO - | Epoch: 054/150 | Train Time: 0.836s | Train Loss: 0.107599 |
2020-05-20 13:14:47,367 - root - INFO - | Epoch: 055/150 | Train Time: 0.838s | Train Loss: 0.106465 |
2020-05-20 13:14:48,374 - root - INFO - | Epoch: 056/150 | Train Time: 1.006s | Train Loss: 0.106089 |
2020-05-20 13:14:49,212 - root - INFO - | Epoch: 057/150 | Train Time: 0.837s | Train Loss: 0.107318 |
2020-05-20 13:14:50,144 - root - INFO - | Epoch: 058/150 | Train Time: 0.931s | Train Loss: 0.106875 |
2020-05-20 13:14:51,042 - root - INFO - | Epoch: 059/150 | Train Time: 0.897s | Train Loss: 0.106615 |
2020-05-20 13:14:51,889 - root - INFO - | Epoch: 060/150 | Train Time: 0.846s | Train Loss: 0.106658 |
2020-05-20 13:14:52,770 - root - INFO - | Epoch: 061/150 | Train Time: 0.881s | Train Loss: 0.105072 |
2020-05-20 13:14:53,695 - root - INFO - | Epoch: 062/150 | Train Time: 0.924s | Train Loss: 0.106497 |
2020-05-20 13:14:54,539 - root - INFO - | Epoch: 063/150 | Train Time: 0.844s | Train Loss: 0.106137 |
2020-05-20 13:14:55,494 - root - INFO - | Epoch: 064/150 | Train Time: 0.954s | Train Loss: 0.107498 |
2020-05-20 13:14:56,341 - root - INFO - | Epoch: 065/150 | Train Time: 0.847s | Train Loss: 0.105440 |
2020-05-20 13:14:57,186 - root - INFO - | Epoch: 066/150 | Train Time: 0.844s | Train Loss: 0.104348 |
2020-05-20 13:14:58,026 - root - INFO - | Epoch: 067/150 | Train Time: 0.840s | Train Loss: 0.104690 |
2020-05-20 13:14:58,896 - root - INFO - | Epoch: 068/150 | Train Time: 0.869s | Train Loss: 0.106521 |
2020-05-20 13:14:59,822 - root - INFO - | Epoch: 069/150 | Train Time: 0.925s | Train Loss: 0.106478 |
2020-05-20 13:15:00,783 - root - INFO - | Epoch: 070/150 | Train Time: 0.961s | Train Loss: 0.105149 |
2020-05-20 13:15:01,824 - root - INFO - | Epoch: 071/150 | Train Time: 1.040s | Train Loss: 0.106470 |
2020-05-20 13:15:02,841 - root - INFO - | Epoch: 072/150 | Train Time: 1.016s | Train Loss: 0.104263 |
2020-05-20 13:15:03,684 - root - INFO - | Epoch: 073/150 | Train Time: 0.843s | Train Loss: 0.104900 |
2020-05-20 13:15:04,678 - root - INFO - | Epoch: 074/150 | Train Time: 0.994s | Train Loss: 0.104548 |
2020-05-20 13:15:05,752 - root - INFO - | Epoch: 075/150 | Train Time: 1.072s | Train Loss: 0.104501 |
2020-05-20 13:15:06,666 - root - INFO - | Epoch: 076/150 | Train Time: 0.913s | Train Loss: 0.106092 |
2020-05-20 13:15:07,637 - root - INFO - | Epoch: 077/150 | Train Time: 0.970s | Train Loss: 0.105204 |
2020-05-20 13:15:08,692 - root - INFO - | Epoch: 078/150 | Train Time: 1.055s | Train Loss: 0.103827 |
2020-05-20 13:15:09,672 - root - INFO - | Epoch: 079/150 | Train Time: 0.980s | Train Loss: 0.104110 |
2020-05-20 13:15:10,637 - root - INFO - | Epoch: 080/150 | Train Time: 0.965s | Train Loss: 0.103024 |
2020-05-20 13:15:11,498 - root - INFO - | Epoch: 081/150 | Train Time: 0.860s | Train Loss: 0.104150 |
2020-05-20 13:15:12,476 - root - INFO - | Epoch: 082/150 | Train Time: 0.977s | Train Loss: 0.103153 |
2020-05-20 13:15:13,561 - root - INFO - | Epoch: 083/150 | Train Time: 1.084s | Train Loss: 0.103094 |
2020-05-20 13:15:14,563 - root - INFO - | Epoch: 084/150 | Train Time: 1.001s | Train Loss: 0.101881 |
2020-05-20 13:15:15,389 - root - INFO - | Epoch: 085/150 | Train Time: 0.826s | Train Loss: 0.102790 |
2020-05-20 13:15:16,273 - root - INFO - | Epoch: 086/150 | Train Time: 0.883s | Train Loss: 0.102007 |
2020-05-20 13:15:17,154 - root - INFO - | Epoch: 087/150 | Train Time: 0.880s | Train Loss: 0.103555 |
2020-05-20 13:15:18,055 - root - INFO - | Epoch: 088/150 | Train Time: 0.900s | Train Loss: 0.103084 |
2020-05-20 13:15:18,931 - root - INFO - | Epoch: 089/150 | Train Time: 0.875s | Train Loss: 0.102343 |
2020-05-20 13:15:19,949 - root - INFO - | Epoch: 090/150 | Train Time: 1.018s | Train Loss: 0.103066 |
2020-05-20 13:15:20,892 - root - INFO - | Epoch: 091/150 | Train Time: 0.943s | Train Loss: 0.102651 |
2020-05-20 13:15:21,836 - root - INFO - | Epoch: 092/150 | Train Time: 0.943s | Train Loss: 0.101711 |
2020-05-20 13:15:22,734 - root - INFO - | Epoch: 093/150 | Train Time: 0.897s | Train Loss: 0.101851 |
2020-05-20 13:15:23,661 - root - INFO - | Epoch: 094/150 | Train Time: 0.926s | Train Loss: 0.101115 |
2020-05-20 13:15:24,618 - root - INFO - | Epoch: 095/150 | Train Time: 0.957s | Train Loss: 0.101205 |
2020-05-20 13:15:25,574 - root - INFO - | Epoch: 096/150 | Train Time: 0.956s | Train Loss: 0.101328 |
2020-05-20 13:15:26,617 - root - INFO - | Epoch: 097/150 | Train Time: 1.041s | Train Loss: 0.100589 |
2020-05-20 13:15:27,428 - root - INFO - | Epoch: 098/150 | Train Time: 0.811s | Train Loss: 0.100965 |
2020-05-20 13:15:28,397 - root - INFO - | Epoch: 099/150 | Train Time: 0.969s | Train Loss: 0.100720 |
2020-05-20 13:15:29,339 - root - INFO - | Epoch: 100/150 | Train Time: 0.941s | Train Loss: 0.100509 |
2020-05-20 13:15:30,213 - root - INFO - | Epoch: 101/150 | Train Time: 0.874s | Train Loss: 0.100923 |
2020-05-20 13:15:31,211 - root - INFO - | Epoch: 102/150 | Train Time: 0.998s | Train Loss: 0.100292 |
2020-05-20 13:15:32,036 - root - INFO - | Epoch: 103/150 | Train Time: 0.825s | Train Loss: 0.099703 |
2020-05-20 13:15:32,944 - root - INFO - | Epoch: 104/150 | Train Time: 0.907s | Train Loss: 0.099300 |
2020-05-20 13:15:33,844 - root - INFO - | Epoch: 105/150 | Train Time: 0.899s | Train Loss: 0.099230 |
2020-05-20 13:15:34,714 - root - INFO - | Epoch: 106/150 | Train Time: 0.870s | Train Loss: 0.099035 |
2020-05-20 13:15:35,595 - root - INFO - | Epoch: 107/150 | Train Time: 0.880s | Train Loss: 0.099207 |
2020-05-20 13:15:36,580 - root - INFO - | Epoch: 108/150 | Train Time: 0.984s | Train Loss: 0.100288 |
2020-05-20 13:15:37,565 - root - INFO - | Epoch: 109/150 | Train Time: 0.984s | Train Loss: 0.100354 |
2020-05-20 13:15:38,505 - root - INFO - | Epoch: 110/150 | Train Time: 0.939s | Train Loss: 0.099414 |
2020-05-20 13:15:39,427 - root - INFO - | Epoch: 111/150 | Train Time: 0.922s | Train Loss: 0.099205 |
2020-05-20 13:15:40,356 - root - INFO - | Epoch: 112/150 | Train Time: 0.928s | Train Loss: 0.098347 |
2020-05-20 13:15:41,366 - root - INFO - | Epoch: 113/150 | Train Time: 1.009s | Train Loss: 0.098693 |
2020-05-20 13:15:42,369 - root - INFO - | Epoch: 114/150 | Train Time: 1.003s | Train Loss: 0.098705 |
2020-05-20 13:15:43,295 - root - INFO - | Epoch: 115/150 | Train Time: 0.925s | Train Loss: 0.097697 |
2020-05-20 13:15:44,148 - root - INFO - | Epoch: 116/150 | Train Time: 0.853s | Train Loss: 0.098251 |
2020-05-20 13:15:45,094 - root - INFO - | Epoch: 117/150 | Train Time: 0.945s | Train Loss: 0.097962 |
2020-05-20 13:15:46,029 - root - INFO - | Epoch: 118/150 | Train Time: 0.935s | Train Loss: 0.098592 |
2020-05-20 13:15:46,825 - root - INFO - | Epoch: 119/150 | Train Time: 0.796s | Train Loss: 0.097295 |
2020-05-20 13:15:47,766 - root - INFO - | Epoch: 120/150 | Train Time: 0.940s | Train Loss: 0.096888 |
2020-05-20 13:15:48,863 - root - INFO - | Epoch: 121/150 | Train Time: 1.096s | Train Loss: 0.096397 |
2020-05-20 13:15:49,758 - root - INFO - | Epoch: 122/150 | Train Time: 0.894s | Train Loss: 0.097976 |
2020-05-20 13:15:50,656 - root - INFO - | Epoch: 123/150 | Train Time: 0.898s | Train Loss: 0.096291 |
2020-05-20 13:15:51,533 - root - INFO - | Epoch: 124/150 | Train Time: 0.876s | Train Loss: 0.096333 |
2020-05-20 13:15:52,496 - root - INFO - | Epoch: 125/150 | Train Time: 0.962s | Train Loss: 0.096434 |
2020-05-20 13:15:53,407 - root - INFO - | Epoch: 126/150 | Train Time: 0.911s | Train Loss: 0.097280 |
2020-05-20 13:15:54,330 - root - INFO - | Epoch: 127/150 | Train Time: 0.923s | Train Loss: 0.095868 |
2020-05-20 13:15:55,301 - root - INFO - | Epoch: 128/150 | Train Time: 0.971s | Train Loss: 0.095905 |
2020-05-20 13:15:56,205 - root - INFO - | Epoch: 129/150 | Train Time: 0.903s | Train Loss: 0.095473 |
2020-05-20 13:15:57,162 - root - INFO - | Epoch: 130/150 | Train Time: 0.956s | Train Loss: 0.095408 |
2020-05-20 13:15:58,117 - root - INFO - | Epoch: 131/150 | Train Time: 0.954s | Train Loss: 0.096548 |
2020-05-20 13:15:59,020 - root - INFO - | Epoch: 132/150 | Train Time: 0.903s | Train Loss: 0.096368 |
2020-05-20 13:15:59,879 - root - INFO - | Epoch: 133/150 | Train Time: 0.858s | Train Loss: 0.095440 |
2020-05-20 13:16:00,792 - root - INFO - | Epoch: 134/150 | Train Time: 0.913s | Train Loss: 0.095682 |
2020-05-20 13:16:01,769 - root - INFO - | Epoch: 135/150 | Train Time: 0.977s | Train Loss: 0.094085 |
2020-05-20 13:16:02,774 - root - INFO - | Epoch: 136/150 | Train Time: 1.004s | Train Loss: 0.094981 |
2020-05-20 13:16:03,802 - root - INFO - | Epoch: 137/150 | Train Time: 1.027s | Train Loss: 0.094163 |
2020-05-20 13:16:04,785 - root - INFO - | Epoch: 138/150 | Train Time: 0.982s | Train Loss: 0.094251 |
2020-05-20 13:16:05,726 - root - INFO - | Epoch: 139/150 | Train Time: 0.940s | Train Loss: 0.093897 |
2020-05-20 13:16:06,659 - root - INFO - | Epoch: 140/150 | Train Time: 0.932s | Train Loss: 0.093965 |
2020-05-20 13:16:07,503 - root - INFO - | Epoch: 141/150 | Train Time: 0.844s | Train Loss: 0.093510 |
2020-05-20 13:16:08,325 - root - INFO - | Epoch: 142/150 | Train Time: 0.822s | Train Loss: 0.093302 |
2020-05-20 13:16:09,219 - root - INFO - | Epoch: 143/150 | Train Time: 0.893s | Train Loss: 0.093841 |
2020-05-20 13:16:10,046 - root - INFO - | Epoch: 144/150 | Train Time: 0.826s | Train Loss: 0.093178 |
2020-05-20 13:16:10,787 - root - INFO - | Epoch: 145/150 | Train Time: 0.741s | Train Loss: 0.093770 |
2020-05-20 13:16:11,693 - root - INFO - | Epoch: 146/150 | Train Time: 0.905s | Train Loss: 0.093089 |
2020-05-20 13:16:12,548 - root - INFO - | Epoch: 147/150 | Train Time: 0.854s | Train Loss: 0.093282 |
2020-05-20 13:16:13,421 - root - INFO - | Epoch: 148/150 | Train Time: 0.872s | Train Loss: 0.093474 |
2020-05-20 13:16:14,346 - root - INFO - | Epoch: 149/150 | Train Time: 0.924s | Train Loss: 0.092630 |
2020-05-20 13:16:15,396 - root - INFO - | Epoch: 150/150 | Train Time: 1.050s | Train Loss: 0.092658 |
2020-05-20 13:16:15,396 - root - INFO - Training Time: 140.684s
2020-05-20 13:16:15,396 - root - INFO - Finished training.
2020-05-20 13:16:15,397 - root - INFO - Starting testing...
2020-05-20 13:16:16,397 - root - INFO - Test Loss: 0.368955
2020-05-20 13:16:16,398 - root - INFO - Test AUC: 79.19%
2020-05-20 13:16:16,398 - root - INFO - Test Time: 0.983s
2020-05-20 13:16:16,398 - root - INFO - Finished testing.
