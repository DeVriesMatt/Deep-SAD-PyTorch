2020-05-20 16:37:51,108 - root - INFO - Log file is ../log/fmnist/scenario_4/deepSAD//log_8_2_1000.txt
2020-05-20 16:37:51,108 - root - INFO - Data path is ../data
2020-05-20 16:37:51,108 - root - INFO - Export path is ../log/fmnist/scenario_4/deepSAD/
2020-05-20 16:37:51,108 - root - INFO - Dataset: fmnist
2020-05-20 16:37:51,108 - root - INFO - Normal class: 8
2020-05-20 16:37:51,108 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-20 16:37:51,108 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-20 16:37:51,109 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-20 16:37:51,109 - root - INFO - Scenario Running: 4
2020-05-20 16:37:51,109 - root - INFO - Train only the network: True
2020-05-20 16:37:51,109 - root - INFO - Output and AE dimensions: 128
2020-05-20 16:37:51,109 - root - INFO - Known anomaly class: 2
2020-05-20 16:37:51,109 - root - INFO - Network: fmnist_LeNet
2020-05-20 16:37:51,109 - root - INFO - Eta-parameter: 100.00
2020-05-20 16:37:51,116 - root - INFO - Set seed to 0.
2020-05-20 16:37:51,155 - root - INFO - Computation device: cuda
2020-05-20 16:37:51,155 - root - INFO - Number of threads: 0
2020-05-20 16:37:51,155 - root - INFO - Number of dataloader workers: 6
2020-05-20 16:37:57,682 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-20 16:37:57,683 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-20 16:37:57,683 - root - INFO - Pretraining: True
2020-05-20 16:37:57,683 - root - INFO - Training optimizer: adam
2020-05-20 16:37:57,683 - root - INFO - Training learning rate: 0.0001
2020-05-20 16:37:57,684 - root - INFO - Training epochs: 150
2020-05-20 16:37:57,684 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-20 16:37:57,684 - root - INFO - Training batch size: 200
2020-05-20 16:37:57,684 - root - INFO - Training weight decay: 5e-07
2020-05-20 16:37:57,686 - root - INFO - Starting training...
2020-05-20 16:38:03,422 - root - INFO - | Epoch: 001/150 | Train Time: 5.735s | Train Loss: 3.170174 |
2020-05-20 16:38:05,260 - root - INFO - | Epoch: 002/150 | Train Time: 1.836s | Train Loss: 1.680014 |
2020-05-20 16:38:06,932 - root - INFO - | Epoch: 003/150 | Train Time: 1.672s | Train Loss: 1.386714 |
2020-05-20 16:38:08,852 - root - INFO - | Epoch: 004/150 | Train Time: 1.920s | Train Loss: 1.279934 |
2020-05-20 16:38:10,711 - root - INFO - | Epoch: 005/150 | Train Time: 1.858s | Train Loss: 1.217482 |
2020-05-20 16:38:12,527 - root - INFO - | Epoch: 006/150 | Train Time: 1.816s | Train Loss: 1.128861 |
2020-05-20 16:38:14,401 - root - INFO - | Epoch: 007/150 | Train Time: 1.873s | Train Loss: 1.089452 |
2020-05-20 16:38:16,348 - root - INFO - | Epoch: 008/150 | Train Time: 1.946s | Train Loss: 1.029094 |
2020-05-20 16:38:18,062 - root - INFO - | Epoch: 009/150 | Train Time: 1.714s | Train Loss: 0.988610 |
2020-05-20 16:38:19,938 - root - INFO - | Epoch: 010/150 | Train Time: 1.875s | Train Loss: 0.976930 |
2020-05-20 16:38:21,904 - root - INFO - | Epoch: 011/150 | Train Time: 1.965s | Train Loss: 0.963072 |
2020-05-20 16:38:23,594 - root - INFO - | Epoch: 012/150 | Train Time: 1.690s | Train Loss: 0.935317 |
2020-05-20 16:38:25,288 - root - INFO - | Epoch: 013/150 | Train Time: 1.693s | Train Loss: 0.875309 |
2020-05-20 16:38:27,457 - root - INFO - | Epoch: 014/150 | Train Time: 2.169s | Train Loss: 0.849530 |
2020-05-20 16:38:29,467 - root - INFO - | Epoch: 015/150 | Train Time: 2.009s | Train Loss: 0.850052 |
2020-05-20 16:38:31,238 - root - INFO - | Epoch: 016/150 | Train Time: 1.770s | Train Loss: 0.816057 |
2020-05-20 16:38:32,996 - root - INFO - | Epoch: 017/150 | Train Time: 1.757s | Train Loss: 0.800919 |
2020-05-20 16:38:34,705 - root - INFO - | Epoch: 018/150 | Train Time: 1.708s | Train Loss: 0.767397 |
2020-05-20 16:38:36,953 - root - INFO - | Epoch: 019/150 | Train Time: 2.248s | Train Loss: 0.762110 |
2020-05-20 16:38:38,863 - root - INFO - | Epoch: 020/150 | Train Time: 1.910s | Train Loss: 0.733355 |
2020-05-20 16:38:40,862 - root - INFO - | Epoch: 021/150 | Train Time: 1.998s | Train Loss: 0.709817 |
2020-05-20 16:38:42,194 - root - INFO - | Epoch: 022/150 | Train Time: 1.332s | Train Loss: 0.681488 |
2020-05-20 16:38:43,987 - root - INFO - | Epoch: 023/150 | Train Time: 1.793s | Train Loss: 0.665937 |
2020-05-20 16:38:45,717 - root - INFO - | Epoch: 024/150 | Train Time: 1.729s | Train Loss: 0.655932 |
2020-05-20 16:38:47,951 - root - INFO - | Epoch: 025/150 | Train Time: 2.234s | Train Loss: 0.651461 |
2020-05-20 16:38:49,702 - root - INFO - | Epoch: 026/150 | Train Time: 1.750s | Train Loss: 0.612009 |
2020-05-20 16:38:51,757 - root - INFO - | Epoch: 027/150 | Train Time: 2.054s | Train Loss: 0.633356 |
2020-05-20 16:38:53,439 - root - INFO - | Epoch: 028/150 | Train Time: 1.681s | Train Loss: 0.621456 |
2020-05-20 16:38:55,252 - root - INFO - | Epoch: 029/150 | Train Time: 1.812s | Train Loss: 0.595965 |
2020-05-20 16:38:57,229 - root - INFO - | Epoch: 030/150 | Train Time: 1.977s | Train Loss: 0.568737 |
2020-05-20 16:38:59,397 - root - INFO - | Epoch: 031/150 | Train Time: 2.167s | Train Loss: 0.563557 |
2020-05-20 16:39:01,165 - root - INFO - | Epoch: 032/150 | Train Time: 1.767s | Train Loss: 0.542073 |
2020-05-20 16:39:03,102 - root - INFO - | Epoch: 033/150 | Train Time: 1.937s | Train Loss: 0.542519 |
2020-05-20 16:39:04,892 - root - INFO - | Epoch: 034/150 | Train Time: 1.786s | Train Loss: 0.542020 |
2020-05-20 16:39:06,589 - root - INFO - | Epoch: 035/150 | Train Time: 1.697s | Train Loss: 0.497721 |
2020-05-20 16:39:08,384 - root - INFO - | Epoch: 036/150 | Train Time: 1.794s | Train Loss: 0.492799 |
2020-05-20 16:39:10,483 - root - INFO - | Epoch: 037/150 | Train Time: 2.099s | Train Loss: 0.488930 |
2020-05-20 16:39:12,624 - root - INFO - | Epoch: 038/150 | Train Time: 2.140s | Train Loss: 0.472091 |
2020-05-20 16:39:14,764 - root - INFO - | Epoch: 039/150 | Train Time: 2.140s | Train Loss: 0.472817 |
2020-05-20 16:39:16,708 - root - INFO - | Epoch: 040/150 | Train Time: 1.943s | Train Loss: 0.487251 |
2020-05-20 16:39:18,523 - root - INFO - | Epoch: 041/150 | Train Time: 1.814s | Train Loss: 0.431096 |
2020-05-20 16:39:20,112 - root - INFO - | Epoch: 042/150 | Train Time: 1.589s | Train Loss: 0.437647 |
2020-05-20 16:39:22,235 - root - INFO - | Epoch: 043/150 | Train Time: 2.122s | Train Loss: 0.430788 |
2020-05-20 16:39:24,115 - root - INFO - | Epoch: 044/150 | Train Time: 1.880s | Train Loss: 0.402834 |
2020-05-20 16:39:26,104 - root - INFO - | Epoch: 045/150 | Train Time: 1.988s | Train Loss: 0.423113 |
2020-05-20 16:39:28,115 - root - INFO - | Epoch: 046/150 | Train Time: 2.010s | Train Loss: 0.409129 |
2020-05-20 16:39:29,866 - root - INFO - | Epoch: 047/150 | Train Time: 1.751s | Train Loss: 0.405190 |
2020-05-20 16:39:31,519 - root - INFO - | Epoch: 048/150 | Train Time: 1.653s | Train Loss: 0.387406 |
2020-05-20 16:39:33,471 - root - INFO - | Epoch: 049/150 | Train Time: 1.951s | Train Loss: 0.369944 |
2020-05-20 16:39:35,246 - root - INFO - | Epoch: 050/150 | Train Time: 1.774s | Train Loss: 0.361568 |
2020-05-20 16:39:35,246 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-20 16:39:36,731 - root - INFO - | Epoch: 051/150 | Train Time: 1.485s | Train Loss: 0.342986 |
2020-05-20 16:39:38,494 - root - INFO - | Epoch: 052/150 | Train Time: 1.762s | Train Loss: 0.333732 |
2020-05-20 16:39:39,973 - root - INFO - | Epoch: 053/150 | Train Time: 1.479s | Train Loss: 0.335429 |
2020-05-20 16:39:41,713 - root - INFO - | Epoch: 054/150 | Train Time: 1.739s | Train Loss: 0.333287 |
2020-05-20 16:39:43,676 - root - INFO - | Epoch: 055/150 | Train Time: 1.963s | Train Loss: 0.339903 |
2020-05-20 16:39:45,714 - root - INFO - | Epoch: 056/150 | Train Time: 2.037s | Train Loss: 0.350785 |
2020-05-20 16:39:47,496 - root - INFO - | Epoch: 057/150 | Train Time: 1.781s | Train Loss: 0.338138 |
2020-05-20 16:39:49,675 - root - INFO - | Epoch: 058/150 | Train Time: 2.179s | Train Loss: 0.342173 |
2020-05-20 16:39:51,481 - root - INFO - | Epoch: 059/150 | Train Time: 1.805s | Train Loss: 0.335413 |
2020-05-20 16:39:53,402 - root - INFO - | Epoch: 060/150 | Train Time: 1.921s | Train Loss: 0.333102 |
2020-05-20 16:39:54,970 - root - INFO - | Epoch: 061/150 | Train Time: 1.567s | Train Loss: 0.341041 |
2020-05-20 16:39:56,559 - root - INFO - | Epoch: 062/150 | Train Time: 1.588s | Train Loss: 0.328767 |
2020-05-20 16:39:58,700 - root - INFO - | Epoch: 063/150 | Train Time: 2.141s | Train Loss: 0.338710 |
2020-05-20 16:40:00,491 - root - INFO - | Epoch: 064/150 | Train Time: 1.790s | Train Loss: 0.327143 |
2020-05-20 16:40:02,077 - root - INFO - | Epoch: 065/150 | Train Time: 1.586s | Train Loss: 0.330308 |
2020-05-20 16:40:03,723 - root - INFO - | Epoch: 066/150 | Train Time: 1.645s | Train Loss: 0.333577 |
2020-05-20 16:40:05,405 - root - INFO - | Epoch: 067/150 | Train Time: 1.682s | Train Loss: 0.327049 |
2020-05-20 16:40:07,313 - root - INFO - | Epoch: 068/150 | Train Time: 1.907s | Train Loss: 0.335425 |
2020-05-20 16:40:08,687 - root - INFO - | Epoch: 069/150 | Train Time: 1.373s | Train Loss: 0.345857 |
2020-05-20 16:40:10,715 - root - INFO - | Epoch: 070/150 | Train Time: 2.027s | Train Loss: 0.326966 |
2020-05-20 16:40:12,510 - root - INFO - | Epoch: 071/150 | Train Time: 1.794s | Train Loss: 0.324672 |
2020-05-20 16:40:14,203 - root - INFO - | Epoch: 072/150 | Train Time: 1.692s | Train Loss: 0.326315 |
2020-05-20 16:40:16,077 - root - INFO - | Epoch: 073/150 | Train Time: 1.873s | Train Loss: 0.328290 |
2020-05-20 16:40:17,819 - root - INFO - | Epoch: 074/150 | Train Time: 1.742s | Train Loss: 0.323191 |
2020-05-20 16:40:19,751 - root - INFO - | Epoch: 075/150 | Train Time: 1.932s | Train Loss: 0.330032 |
2020-05-20 16:40:21,453 - root - INFO - | Epoch: 076/150 | Train Time: 1.701s | Train Loss: 0.319810 |
2020-05-20 16:40:23,217 - root - INFO - | Epoch: 077/150 | Train Time: 1.763s | Train Loss: 0.315894 |
2020-05-20 16:40:25,221 - root - INFO - | Epoch: 078/150 | Train Time: 2.004s | Train Loss: 0.327675 |
2020-05-20 16:40:26,951 - root - INFO - | Epoch: 079/150 | Train Time: 1.729s | Train Loss: 0.320746 |
2020-05-20 16:40:28,366 - root - INFO - | Epoch: 080/150 | Train Time: 1.415s | Train Loss: 0.316291 |
2020-05-20 16:40:30,000 - root - INFO - | Epoch: 081/150 | Train Time: 1.634s | Train Loss: 0.335710 |
2020-05-20 16:40:31,464 - root - INFO - | Epoch: 082/150 | Train Time: 1.463s | Train Loss: 0.317450 |
2020-05-20 16:40:33,177 - root - INFO - | Epoch: 083/150 | Train Time: 1.712s | Train Loss: 0.313494 |
2020-05-20 16:40:35,006 - root - INFO - | Epoch: 084/150 | Train Time: 1.828s | Train Loss: 0.311496 |
2020-05-20 16:40:37,008 - root - INFO - | Epoch: 085/150 | Train Time: 2.002s | Train Loss: 0.310442 |
2020-05-20 16:40:39,187 - root - INFO - | Epoch: 086/150 | Train Time: 2.178s | Train Loss: 0.324566 |
2020-05-20 16:40:40,879 - root - INFO - | Epoch: 087/150 | Train Time: 1.692s | Train Loss: 0.311239 |
2020-05-20 16:40:42,504 - root - INFO - | Epoch: 088/150 | Train Time: 1.624s | Train Loss: 0.318604 |
2020-05-20 16:40:44,226 - root - INFO - | Epoch: 089/150 | Train Time: 1.721s | Train Loss: 0.319429 |
2020-05-20 16:40:45,782 - root - INFO - | Epoch: 090/150 | Train Time: 1.555s | Train Loss: 0.306001 |
2020-05-20 16:40:47,586 - root - INFO - | Epoch: 091/150 | Train Time: 1.803s | Train Loss: 0.317978 |
2020-05-20 16:40:49,647 - root - INFO - | Epoch: 092/150 | Train Time: 2.061s | Train Loss: 0.302577 |
2020-05-20 16:40:51,155 - root - INFO - | Epoch: 093/150 | Train Time: 1.507s | Train Loss: 0.314403 |
2020-05-20 16:40:52,595 - root - INFO - | Epoch: 094/150 | Train Time: 1.440s | Train Loss: 0.307183 |
2020-05-20 16:40:54,512 - root - INFO - | Epoch: 095/150 | Train Time: 1.916s | Train Loss: 0.315747 |
2020-05-20 16:40:56,320 - root - INFO - | Epoch: 096/150 | Train Time: 1.807s | Train Loss: 0.311694 |
2020-05-20 16:40:57,680 - root - INFO - | Epoch: 097/150 | Train Time: 1.360s | Train Loss: 0.300624 |
2020-05-20 16:40:59,493 - root - INFO - | Epoch: 098/150 | Train Time: 1.812s | Train Loss: 0.302147 |
2020-05-20 16:41:01,231 - root - INFO - | Epoch: 099/150 | Train Time: 1.738s | Train Loss: 0.296331 |
2020-05-20 16:41:03,413 - root - INFO - | Epoch: 100/150 | Train Time: 2.182s | Train Loss: 0.315072 |
2020-05-20 16:41:05,181 - root - INFO - | Epoch: 101/150 | Train Time: 1.767s | Train Loss: 0.296415 |
2020-05-20 16:41:07,021 - root - INFO - | Epoch: 102/150 | Train Time: 1.840s | Train Loss: 0.296772 |
2020-05-20 16:41:08,597 - root - INFO - | Epoch: 103/150 | Train Time: 1.575s | Train Loss: 0.293617 |
2020-05-20 16:41:10,554 - root - INFO - | Epoch: 104/150 | Train Time: 1.957s | Train Loss: 0.296882 |
2020-05-20 16:41:12,394 - root - INFO - | Epoch: 105/150 | Train Time: 1.840s | Train Loss: 0.311373 |
2020-05-20 16:41:13,940 - root - INFO - | Epoch: 106/150 | Train Time: 1.545s | Train Loss: 0.295771 |
2020-05-20 16:41:16,076 - root - INFO - | Epoch: 107/150 | Train Time: 2.136s | Train Loss: 0.311257 |
2020-05-20 16:41:17,822 - root - INFO - | Epoch: 108/150 | Train Time: 1.746s | Train Loss: 0.295146 |
2020-05-20 16:41:19,671 - root - INFO - | Epoch: 109/150 | Train Time: 1.849s | Train Loss: 0.295413 |
2020-05-20 16:41:21,687 - root - INFO - | Epoch: 110/150 | Train Time: 2.015s | Train Loss: 0.290205 |
2020-05-20 16:41:23,553 - root - INFO - | Epoch: 111/150 | Train Time: 1.865s | Train Loss: 0.290702 |
2020-05-20 16:41:25,508 - root - INFO - | Epoch: 112/150 | Train Time: 1.955s | Train Loss: 0.292935 |
2020-05-20 16:41:27,660 - root - INFO - | Epoch: 113/150 | Train Time: 2.151s | Train Loss: 0.298288 |
2020-05-20 16:41:29,147 - root - INFO - | Epoch: 114/150 | Train Time: 1.486s | Train Loss: 0.280707 |
2020-05-20 16:41:30,494 - root - INFO - | Epoch: 115/150 | Train Time: 1.346s | Train Loss: 0.289803 |
2020-05-20 16:41:32,184 - root - INFO - | Epoch: 116/150 | Train Time: 1.689s | Train Loss: 0.292784 |
2020-05-20 16:41:33,789 - root - INFO - | Epoch: 117/150 | Train Time: 1.605s | Train Loss: 0.283354 |
2020-05-20 16:41:35,640 - root - INFO - | Epoch: 118/150 | Train Time: 1.850s | Train Loss: 0.280568 |
2020-05-20 16:41:37,422 - root - INFO - | Epoch: 119/150 | Train Time: 1.782s | Train Loss: 0.297598 |
2020-05-20 16:41:39,194 - root - INFO - | Epoch: 120/150 | Train Time: 1.771s | Train Loss: 0.295083 |
2020-05-20 16:41:40,472 - root - INFO - | Epoch: 121/150 | Train Time: 1.277s | Train Loss: 0.282960 |
2020-05-20 16:41:41,776 - root - INFO - | Epoch: 122/150 | Train Time: 1.304s | Train Loss: 0.289281 |
2020-05-20 16:41:43,262 - root - INFO - | Epoch: 123/150 | Train Time: 1.485s | Train Loss: 0.289849 |
2020-05-20 16:41:44,628 - root - INFO - | Epoch: 124/150 | Train Time: 1.365s | Train Loss: 0.277067 |
2020-05-20 16:41:45,862 - root - INFO - | Epoch: 125/150 | Train Time: 1.234s | Train Loss: 0.294355 |
2020-05-20 16:41:47,378 - root - INFO - | Epoch: 126/150 | Train Time: 1.515s | Train Loss: 0.272936 |
2020-05-20 16:41:48,919 - root - INFO - | Epoch: 127/150 | Train Time: 1.540s | Train Loss: 0.279343 |
2020-05-20 16:41:50,466 - root - INFO - | Epoch: 128/150 | Train Time: 1.546s | Train Loss: 0.294462 |
2020-05-20 16:41:51,989 - root - INFO - | Epoch: 129/150 | Train Time: 1.522s | Train Loss: 0.295213 |
2020-05-20 16:41:53,772 - root - INFO - | Epoch: 130/150 | Train Time: 1.782s | Train Loss: 0.274874 |
2020-05-20 16:41:55,502 - root - INFO - | Epoch: 131/150 | Train Time: 1.730s | Train Loss: 0.277674 |
2020-05-20 16:41:56,986 - root - INFO - | Epoch: 132/150 | Train Time: 1.483s | Train Loss: 0.279231 |
2020-05-20 16:41:58,753 - root - INFO - | Epoch: 133/150 | Train Time: 1.767s | Train Loss: 0.273207 |
2020-05-20 16:42:00,027 - root - INFO - | Epoch: 134/150 | Train Time: 1.273s | Train Loss: 0.282751 |
2020-05-20 16:42:01,319 - root - INFO - | Epoch: 135/150 | Train Time: 1.292s | Train Loss: 0.260503 |
2020-05-20 16:42:03,030 - root - INFO - | Epoch: 136/150 | Train Time: 1.710s | Train Loss: 0.275191 |
2020-05-20 16:42:04,867 - root - INFO - | Epoch: 137/150 | Train Time: 1.837s | Train Loss: 0.276463 |
2020-05-20 16:42:06,632 - root - INFO - | Epoch: 138/150 | Train Time: 1.765s | Train Loss: 0.266970 |
2020-05-20 16:42:08,184 - root - INFO - | Epoch: 139/150 | Train Time: 1.552s | Train Loss: 0.287978 |
2020-05-20 16:42:09,982 - root - INFO - | Epoch: 140/150 | Train Time: 1.797s | Train Loss: 0.264677 |
2020-05-20 16:42:11,701 - root - INFO - | Epoch: 141/150 | Train Time: 1.718s | Train Loss: 0.278082 |
2020-05-20 16:42:13,482 - root - INFO - | Epoch: 142/150 | Train Time: 1.780s | Train Loss: 0.277248 |
2020-05-20 16:42:15,531 - root - INFO - | Epoch: 143/150 | Train Time: 2.048s | Train Loss: 0.264585 |
2020-05-20 16:42:17,721 - root - INFO - | Epoch: 144/150 | Train Time: 2.190s | Train Loss: 0.265660 |
2020-05-20 16:42:19,412 - root - INFO - | Epoch: 145/150 | Train Time: 1.690s | Train Loss: 0.276228 |
2020-05-20 16:42:21,237 - root - INFO - | Epoch: 146/150 | Train Time: 1.825s | Train Loss: 0.256375 |
2020-05-20 16:42:23,394 - root - INFO - | Epoch: 147/150 | Train Time: 2.157s | Train Loss: 0.260977 |
2020-05-20 16:42:25,278 - root - INFO - | Epoch: 148/150 | Train Time: 1.884s | Train Loss: 0.262233 |
2020-05-20 16:42:27,220 - root - INFO - | Epoch: 149/150 | Train Time: 1.941s | Train Loss: 0.263645 |
2020-05-20 16:42:29,157 - root - INFO - | Epoch: 150/150 | Train Time: 1.936s | Train Loss: 0.269928 |
2020-05-20 16:42:29,157 - root - INFO - Training Time: 271.471s
2020-05-20 16:42:29,157 - root - INFO - Finished training.
2020-05-20 16:42:29,158 - root - INFO - Starting testing...
2020-05-20 16:42:31,164 - root - INFO - Test Loss: 4.253422
2020-05-20 16:42:31,164 - root - INFO - Test AUC: 78.21%
2020-05-20 16:42:31,164 - root - INFO - Test Time: 1.994s
2020-05-20 16:42:31,164 - root - INFO - Finished testing.
