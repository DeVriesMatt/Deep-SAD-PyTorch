2020-05-20 20:50:46,185 - root - INFO - Log file is ../log/fmnist/scenario_4/deepSAD//log_9_6_001.txt
2020-05-20 20:50:46,185 - root - INFO - Data path is ../data
2020-05-20 20:50:46,185 - root - INFO - Export path is ../log/fmnist/scenario_4/deepSAD/
2020-05-20 20:50:46,185 - root - INFO - Dataset: fmnist
2020-05-20 20:50:46,185 - root - INFO - Normal class: 9
2020-05-20 20:50:46,185 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-20 20:50:46,185 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-20 20:50:46,185 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-20 20:50:46,185 - root - INFO - Scenario Running: 4
2020-05-20 20:50:46,185 - root - INFO - Train only the network: True
2020-05-20 20:50:46,185 - root - INFO - Output and AE dimensions: 128
2020-05-20 20:50:46,185 - root - INFO - Known anomaly class: 6
2020-05-20 20:50:46,186 - root - INFO - Network: fmnist_LeNet
2020-05-20 20:50:46,186 - root - INFO - Eta-parameter: 0.01
2020-05-20 20:50:46,206 - root - INFO - Set seed to 0.
2020-05-20 20:50:46,232 - root - INFO - Computation device: cuda
2020-05-20 20:50:46,233 - root - INFO - Number of threads: 0
2020-05-20 20:50:46,233 - root - INFO - Number of dataloader workers: 6
2020-05-20 20:50:51,127 - root - INFO - Loading model from ../log/fmnist/scenario_1/deepSAD/model_0_1_1_0.tar.
2020-05-20 20:50:51,127 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-20 20:50:51,127 - root - INFO - Pretraining: True
2020-05-20 20:50:51,127 - root - INFO - Training optimizer: adam
2020-05-20 20:50:51,128 - root - INFO - Training learning rate: 0.0001
2020-05-20 20:50:51,128 - root - INFO - Training epochs: 150
2020-05-20 20:50:51,128 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-20 20:50:51,128 - root - INFO - Training batch size: 200
2020-05-20 20:50:51,128 - root - INFO - Training weight decay: 5e-07
2020-05-20 20:50:51,147 - root - INFO - Starting training...
2020-05-20 20:50:56,699 - root - INFO - | Epoch: 001/150 | Train Time: 5.552s | Train Loss: 2.301680 |
2020-05-20 20:50:58,755 - root - INFO - | Epoch: 002/150 | Train Time: 2.056s | Train Loss: 0.645666 |
2020-05-20 20:51:00,716 - root - INFO - | Epoch: 003/150 | Train Time: 1.960s | Train Loss: 0.407509 |
2020-05-20 20:51:02,676 - root - INFO - | Epoch: 004/150 | Train Time: 1.960s | Train Loss: 0.287413 |
2020-05-20 20:51:04,282 - root - INFO - | Epoch: 005/150 | Train Time: 1.606s | Train Loss: 0.235807 |
2020-05-20 20:51:05,958 - root - INFO - | Epoch: 006/150 | Train Time: 1.675s | Train Loss: 0.191573 |
2020-05-20 20:51:07,579 - root - INFO - | Epoch: 007/150 | Train Time: 1.620s | Train Loss: 0.162496 |
2020-05-20 20:51:09,585 - root - INFO - | Epoch: 008/150 | Train Time: 2.006s | Train Loss: 0.138449 |
2020-05-20 20:51:11,112 - root - INFO - | Epoch: 009/150 | Train Time: 1.527s | Train Loss: 0.124469 |
2020-05-20 20:51:12,737 - root - INFO - | Epoch: 010/150 | Train Time: 1.624s | Train Loss: 0.111816 |
2020-05-20 20:51:14,205 - root - INFO - | Epoch: 011/150 | Train Time: 1.467s | Train Loss: 0.104679 |
2020-05-20 20:51:15,768 - root - INFO - | Epoch: 012/150 | Train Time: 1.563s | Train Loss: 0.093790 |
2020-05-20 20:51:17,294 - root - INFO - | Epoch: 013/150 | Train Time: 1.525s | Train Loss: 0.084748 |
2020-05-20 20:51:18,837 - root - INFO - | Epoch: 014/150 | Train Time: 1.540s | Train Loss: 0.079302 |
2020-05-20 20:51:20,594 - root - INFO - | Epoch: 015/150 | Train Time: 1.757s | Train Loss: 0.072495 |
2020-05-20 20:51:22,071 - root - INFO - | Epoch: 016/150 | Train Time: 1.476s | Train Loss: 0.066296 |
2020-05-20 20:51:23,553 - root - INFO - | Epoch: 017/150 | Train Time: 1.481s | Train Loss: 0.062867 |
2020-05-20 20:51:24,793 - root - INFO - | Epoch: 018/150 | Train Time: 1.240s | Train Loss: 0.059699 |
2020-05-20 20:51:26,059 - root - INFO - | Epoch: 019/150 | Train Time: 1.265s | Train Loss: 0.057432 |
2020-05-20 20:51:27,467 - root - INFO - | Epoch: 020/150 | Train Time: 1.408s | Train Loss: 0.053484 |
2020-05-20 20:51:28,848 - root - INFO - | Epoch: 021/150 | Train Time: 1.381s | Train Loss: 0.050647 |
2020-05-20 20:51:30,086 - root - INFO - | Epoch: 022/150 | Train Time: 1.237s | Train Loss: 0.047628 |
2020-05-20 20:51:31,638 - root - INFO - | Epoch: 023/150 | Train Time: 1.552s | Train Loss: 0.047191 |
2020-05-20 20:51:33,450 - root - INFO - | Epoch: 024/150 | Train Time: 1.811s | Train Loss: 0.044785 |
2020-05-20 20:51:35,288 - root - INFO - | Epoch: 025/150 | Train Time: 1.837s | Train Loss: 0.042293 |
2020-05-20 20:51:36,839 - root - INFO - | Epoch: 026/150 | Train Time: 1.551s | Train Loss: 0.039518 |
2020-05-20 20:51:38,482 - root - INFO - | Epoch: 027/150 | Train Time: 1.643s | Train Loss: 0.041187 |
2020-05-20 20:51:40,255 - root - INFO - | Epoch: 028/150 | Train Time: 1.772s | Train Loss: 0.039480 |
2020-05-20 20:51:42,065 - root - INFO - | Epoch: 029/150 | Train Time: 1.810s | Train Loss: 0.037138 |
2020-05-20 20:51:44,059 - root - INFO - | Epoch: 030/150 | Train Time: 1.993s | Train Loss: 0.036203 |
2020-05-20 20:51:45,950 - root - INFO - | Epoch: 031/150 | Train Time: 1.890s | Train Loss: 0.037262 |
2020-05-20 20:51:47,661 - root - INFO - | Epoch: 032/150 | Train Time: 1.710s | Train Loss: 0.034534 |
2020-05-20 20:51:49,610 - root - INFO - | Epoch: 033/150 | Train Time: 1.949s | Train Loss: 0.037299 |
2020-05-20 20:51:51,413 - root - INFO - | Epoch: 034/150 | Train Time: 1.803s | Train Loss: 0.034434 |
2020-05-20 20:51:53,008 - root - INFO - | Epoch: 035/150 | Train Time: 1.595s | Train Loss: 0.029864 |
2020-05-20 20:51:55,043 - root - INFO - | Epoch: 036/150 | Train Time: 2.034s | Train Loss: 0.031652 |
2020-05-20 20:51:57,166 - root - INFO - | Epoch: 037/150 | Train Time: 2.123s | Train Loss: 0.030121 |
2020-05-20 20:51:59,243 - root - INFO - | Epoch: 038/150 | Train Time: 2.076s | Train Loss: 0.029733 |
2020-05-20 20:52:01,104 - root - INFO - | Epoch: 039/150 | Train Time: 1.861s | Train Loss: 0.029396 |
2020-05-20 20:52:02,679 - root - INFO - | Epoch: 040/150 | Train Time: 1.575s | Train Loss: 0.030471 |
2020-05-20 20:52:04,566 - root - INFO - | Epoch: 041/150 | Train Time: 1.886s | Train Loss: 0.027039 |
2020-05-20 20:52:06,679 - root - INFO - | Epoch: 042/150 | Train Time: 2.112s | Train Loss: 0.026954 |
2020-05-20 20:52:08,224 - root - INFO - | Epoch: 043/150 | Train Time: 1.544s | Train Loss: 0.027640 |
2020-05-20 20:52:09,847 - root - INFO - | Epoch: 044/150 | Train Time: 1.623s | Train Loss: 0.026474 |
2020-05-20 20:52:11,648 - root - INFO - | Epoch: 045/150 | Train Time: 1.800s | Train Loss: 0.026994 |
2020-05-20 20:52:13,468 - root - INFO - | Epoch: 046/150 | Train Time: 1.819s | Train Loss: 0.025631 |
2020-05-20 20:52:15,020 - root - INFO - | Epoch: 047/150 | Train Time: 1.551s | Train Loss: 0.025086 |
2020-05-20 20:52:16,636 - root - INFO - | Epoch: 048/150 | Train Time: 1.616s | Train Loss: 0.025168 |
2020-05-20 20:52:18,438 - root - INFO - | Epoch: 049/150 | Train Time: 1.801s | Train Loss: 0.024786 |
2020-05-20 20:52:19,872 - root - INFO - | Epoch: 050/150 | Train Time: 1.434s | Train Loss: 0.023978 |
2020-05-20 20:52:19,873 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-20 20:52:21,091 - root - INFO - | Epoch: 051/150 | Train Time: 1.218s | Train Loss: 0.023204 |
2020-05-20 20:52:23,113 - root - INFO - | Epoch: 052/150 | Train Time: 2.022s | Train Loss: 0.022670 |
2020-05-20 20:52:25,232 - root - INFO - | Epoch: 053/150 | Train Time: 2.119s | Train Loss: 0.022682 |
2020-05-20 20:52:27,218 - root - INFO - | Epoch: 054/150 | Train Time: 1.985s | Train Loss: 0.023056 |
2020-05-20 20:52:29,261 - root - INFO - | Epoch: 055/150 | Train Time: 2.042s | Train Loss: 0.023902 |
2020-05-20 20:52:30,743 - root - INFO - | Epoch: 056/150 | Train Time: 1.482s | Train Loss: 0.024211 |
2020-05-20 20:52:32,527 - root - INFO - | Epoch: 057/150 | Train Time: 1.784s | Train Loss: 0.022060 |
2020-05-20 20:52:34,725 - root - INFO - | Epoch: 058/150 | Train Time: 2.198s | Train Loss: 0.022754 |
2020-05-20 20:52:36,369 - root - INFO - | Epoch: 059/150 | Train Time: 1.643s | Train Loss: 0.023162 |
2020-05-20 20:52:38,058 - root - INFO - | Epoch: 060/150 | Train Time: 1.688s | Train Loss: 0.021528 |
2020-05-20 20:52:39,939 - root - INFO - | Epoch: 061/150 | Train Time: 1.881s | Train Loss: 0.022760 |
2020-05-20 20:52:41,642 - root - INFO - | Epoch: 062/150 | Train Time: 1.702s | Train Loss: 0.022556 |
2020-05-20 20:52:43,492 - root - INFO - | Epoch: 063/150 | Train Time: 1.849s | Train Loss: 0.022970 |
2020-05-20 20:52:45,434 - root - INFO - | Epoch: 064/150 | Train Time: 1.942s | Train Loss: 0.024198 |
2020-05-20 20:52:47,280 - root - INFO - | Epoch: 065/150 | Train Time: 1.845s | Train Loss: 0.022456 |
2020-05-20 20:52:49,115 - root - INFO - | Epoch: 066/150 | Train Time: 1.835s | Train Loss: 0.023723 |
2020-05-20 20:52:51,152 - root - INFO - | Epoch: 067/150 | Train Time: 2.036s | Train Loss: 0.024549 |
2020-05-20 20:52:52,902 - root - INFO - | Epoch: 068/150 | Train Time: 1.749s | Train Loss: 0.023474 |
2020-05-20 20:52:54,716 - root - INFO - | Epoch: 069/150 | Train Time: 1.814s | Train Loss: 0.025658 |
2020-05-20 20:52:56,271 - root - INFO - | Epoch: 070/150 | Train Time: 1.554s | Train Loss: 0.022020 |
2020-05-20 20:52:58,315 - root - INFO - | Epoch: 071/150 | Train Time: 2.044s | Train Loss: 0.021972 |
2020-05-20 20:52:59,878 - root - INFO - | Epoch: 072/150 | Train Time: 1.562s | Train Loss: 0.024354 |
2020-05-20 20:53:01,336 - root - INFO - | Epoch: 073/150 | Train Time: 1.458s | Train Loss: 0.022510 |
2020-05-20 20:53:02,921 - root - INFO - | Epoch: 074/150 | Train Time: 1.584s | Train Loss: 0.022053 |
2020-05-20 20:53:04,999 - root - INFO - | Epoch: 075/150 | Train Time: 2.077s | Train Loss: 0.022096 |
2020-05-20 20:53:06,741 - root - INFO - | Epoch: 076/150 | Train Time: 1.742s | Train Loss: 0.019913 |
2020-05-20 20:53:08,251 - root - INFO - | Epoch: 077/150 | Train Time: 1.510s | Train Loss: 0.021930 |
2020-05-20 20:53:09,951 - root - INFO - | Epoch: 078/150 | Train Time: 1.700s | Train Loss: 0.022981 |
2020-05-20 20:53:11,825 - root - INFO - | Epoch: 079/150 | Train Time: 1.873s | Train Loss: 0.022191 |
2020-05-20 20:53:14,012 - root - INFO - | Epoch: 080/150 | Train Time: 2.186s | Train Loss: 0.021693 |
2020-05-20 20:53:16,206 - root - INFO - | Epoch: 081/150 | Train Time: 2.194s | Train Loss: 0.022003 |
2020-05-20 20:53:18,084 - root - INFO - | Epoch: 082/150 | Train Time: 1.878s | Train Loss: 0.022088 |
2020-05-20 20:53:20,340 - root - INFO - | Epoch: 083/150 | Train Time: 2.255s | Train Loss: 0.021102 |
2020-05-20 20:53:22,023 - root - INFO - | Epoch: 084/150 | Train Time: 1.683s | Train Loss: 0.021014 |
2020-05-20 20:53:23,582 - root - INFO - | Epoch: 085/150 | Train Time: 1.559s | Train Loss: 0.021152 |
2020-05-20 20:53:25,334 - root - INFO - | Epoch: 086/150 | Train Time: 1.751s | Train Loss: 0.022454 |
2020-05-20 20:53:26,983 - root - INFO - | Epoch: 087/150 | Train Time: 1.649s | Train Loss: 0.022816 |
2020-05-20 20:53:28,720 - root - INFO - | Epoch: 088/150 | Train Time: 1.737s | Train Loss: 0.022069 |
2020-05-20 20:53:30,075 - root - INFO - | Epoch: 089/150 | Train Time: 1.354s | Train Loss: 0.021738 |
2020-05-20 20:53:31,531 - root - INFO - | Epoch: 090/150 | Train Time: 1.455s | Train Loss: 0.022121 |
2020-05-20 20:53:32,961 - root - INFO - | Epoch: 091/150 | Train Time: 1.430s | Train Loss: 0.022438 |
2020-05-20 20:53:34,457 - root - INFO - | Epoch: 092/150 | Train Time: 1.495s | Train Loss: 0.021678 |
2020-05-20 20:53:35,972 - root - INFO - | Epoch: 093/150 | Train Time: 1.515s | Train Loss: 0.022290 |
2020-05-20 20:53:37,408 - root - INFO - | Epoch: 094/150 | Train Time: 1.436s | Train Loss: 0.020149 |
2020-05-20 20:53:38,787 - root - INFO - | Epoch: 095/150 | Train Time: 1.378s | Train Loss: 0.020371 |
2020-05-20 20:53:39,978 - root - INFO - | Epoch: 096/150 | Train Time: 1.191s | Train Loss: 0.024292 |
2020-05-20 20:53:41,556 - root - INFO - | Epoch: 097/150 | Train Time: 1.577s | Train Loss: 0.020506 |
2020-05-20 20:53:42,994 - root - INFO - | Epoch: 098/150 | Train Time: 1.438s | Train Loss: 0.020572 |
2020-05-20 20:53:44,549 - root - INFO - | Epoch: 099/150 | Train Time: 1.554s | Train Loss: 0.020152 |
2020-05-20 20:53:46,095 - root - INFO - | Epoch: 100/150 | Train Time: 1.546s | Train Loss: 0.021431 |
2020-05-20 20:53:47,592 - root - INFO - | Epoch: 101/150 | Train Time: 1.496s | Train Loss: 0.023133 |
2020-05-20 20:53:48,982 - root - INFO - | Epoch: 102/150 | Train Time: 1.389s | Train Loss: 0.021232 |
2020-05-20 20:53:50,465 - root - INFO - | Epoch: 103/150 | Train Time: 1.482s | Train Loss: 0.020655 |
2020-05-20 20:53:52,108 - root - INFO - | Epoch: 104/150 | Train Time: 1.643s | Train Loss: 0.020703 |
2020-05-20 20:53:53,969 - root - INFO - | Epoch: 105/150 | Train Time: 1.861s | Train Loss: 0.021258 |
2020-05-20 20:53:55,494 - root - INFO - | Epoch: 106/150 | Train Time: 1.524s | Train Loss: 0.020698 |
2020-05-20 20:53:57,472 - root - INFO - | Epoch: 107/150 | Train Time: 1.978s | Train Loss: 0.020878 |
2020-05-20 20:53:59,394 - root - INFO - | Epoch: 108/150 | Train Time: 1.922s | Train Loss: 0.021450 |
2020-05-20 20:54:01,352 - root - INFO - | Epoch: 109/150 | Train Time: 1.957s | Train Loss: 0.020457 |
2020-05-20 20:54:03,101 - root - INFO - | Epoch: 110/150 | Train Time: 1.749s | Train Loss: 0.021646 |
2020-05-20 20:54:04,619 - root - INFO - | Epoch: 111/150 | Train Time: 1.517s | Train Loss: 0.019573 |
2020-05-20 20:54:06,618 - root - INFO - | Epoch: 112/150 | Train Time: 1.999s | Train Loss: 0.019508 |
2020-05-20 20:54:08,833 - root - INFO - | Epoch: 113/150 | Train Time: 2.214s | Train Loss: 0.020440 |
2020-05-20 20:54:10,933 - root - INFO - | Epoch: 114/150 | Train Time: 2.100s | Train Loss: 0.020605 |
2020-05-20 20:54:12,800 - root - INFO - | Epoch: 115/150 | Train Time: 1.866s | Train Loss: 0.020717 |
2020-05-20 20:54:14,516 - root - INFO - | Epoch: 116/150 | Train Time: 1.716s | Train Loss: 0.020260 |
2020-05-20 20:54:16,573 - root - INFO - | Epoch: 117/150 | Train Time: 2.056s | Train Loss: 0.018643 |
2020-05-20 20:54:18,572 - root - INFO - | Epoch: 118/150 | Train Time: 1.999s | Train Loss: 0.019841 |
2020-05-20 20:54:20,564 - root - INFO - | Epoch: 119/150 | Train Time: 1.991s | Train Loss: 0.020065 |
2020-05-20 20:54:22,717 - root - INFO - | Epoch: 120/150 | Train Time: 2.153s | Train Loss: 0.022312 |
2020-05-20 20:54:24,466 - root - INFO - | Epoch: 121/150 | Train Time: 1.748s | Train Loss: 0.020674 |
2020-05-20 20:54:26,330 - root - INFO - | Epoch: 122/150 | Train Time: 1.863s | Train Loss: 0.020649 |
2020-05-20 20:54:28,267 - root - INFO - | Epoch: 123/150 | Train Time: 1.937s | Train Loss: 0.020610 |
2020-05-20 20:54:30,610 - root - INFO - | Epoch: 124/150 | Train Time: 2.342s | Train Loss: 0.018450 |
2020-05-20 20:54:32,447 - root - INFO - | Epoch: 125/150 | Train Time: 1.836s | Train Loss: 0.024090 |
2020-05-20 20:54:34,073 - root - INFO - | Epoch: 126/150 | Train Time: 1.626s | Train Loss: 0.018621 |
2020-05-20 20:54:35,679 - root - INFO - | Epoch: 127/150 | Train Time: 1.606s | Train Loss: 0.018377 |
2020-05-20 20:54:37,300 - root - INFO - | Epoch: 128/150 | Train Time: 1.620s | Train Loss: 0.018696 |
2020-05-20 20:54:39,103 - root - INFO - | Epoch: 129/150 | Train Time: 1.803s | Train Loss: 0.020103 |
2020-05-20 20:54:40,708 - root - INFO - | Epoch: 130/150 | Train Time: 1.604s | Train Loss: 0.018847 |
2020-05-20 20:54:42,685 - root - INFO - | Epoch: 131/150 | Train Time: 1.977s | Train Loss: 0.018526 |
2020-05-20 20:54:44,343 - root - INFO - | Epoch: 132/150 | Train Time: 1.657s | Train Loss: 0.019270 |
2020-05-20 20:54:45,717 - root - INFO - | Epoch: 133/150 | Train Time: 1.373s | Train Loss: 0.018561 |
2020-05-20 20:54:47,697 - root - INFO - | Epoch: 134/150 | Train Time: 1.979s | Train Loss: 0.020854 |
2020-05-20 20:54:49,199 - root - INFO - | Epoch: 135/150 | Train Time: 1.502s | Train Loss: 0.020058 |
2020-05-20 20:54:51,173 - root - INFO - | Epoch: 136/150 | Train Time: 1.973s | Train Loss: 0.018144 |
2020-05-20 20:54:53,055 - root - INFO - | Epoch: 137/150 | Train Time: 1.882s | Train Loss: 0.018996 |
2020-05-20 20:54:54,872 - root - INFO - | Epoch: 138/150 | Train Time: 1.817s | Train Loss: 0.019254 |
2020-05-20 20:54:56,628 - root - INFO - | Epoch: 139/150 | Train Time: 1.756s | Train Loss: 0.020347 |
2020-05-20 20:54:58,687 - root - INFO - | Epoch: 140/150 | Train Time: 2.058s | Train Loss: 0.018676 |
2020-05-20 20:55:00,241 - root - INFO - | Epoch: 141/150 | Train Time: 1.553s | Train Loss: 0.017060 |
2020-05-20 20:55:02,258 - root - INFO - | Epoch: 142/150 | Train Time: 2.017s | Train Loss: 0.018976 |
2020-05-20 20:55:03,759 - root - INFO - | Epoch: 143/150 | Train Time: 1.501s | Train Loss: 0.020905 |
2020-05-20 20:55:05,578 - root - INFO - | Epoch: 144/150 | Train Time: 1.818s | Train Loss: 0.017224 |
2020-05-20 20:55:07,412 - root - INFO - | Epoch: 145/150 | Train Time: 1.834s | Train Loss: 0.018664 |
2020-05-20 20:55:09,333 - root - INFO - | Epoch: 146/150 | Train Time: 1.920s | Train Loss: 0.019254 |
2020-05-20 20:55:11,155 - root - INFO - | Epoch: 147/150 | Train Time: 1.822s | Train Loss: 0.017349 |
2020-05-20 20:55:13,175 - root - INFO - | Epoch: 148/150 | Train Time: 2.019s | Train Loss: 0.017739 |
2020-05-20 20:55:14,813 - root - INFO - | Epoch: 149/150 | Train Time: 1.637s | Train Loss: 0.016997 |
2020-05-20 20:55:16,883 - root - INFO - | Epoch: 150/150 | Train Time: 2.070s | Train Loss: 0.019810 |
2020-05-20 20:55:16,884 - root - INFO - Training Time: 265.737s
2020-05-20 20:55:16,884 - root - INFO - Finished training.
2020-05-20 20:55:16,885 - root - INFO - Starting testing...
2020-05-20 20:55:18,656 - root - INFO - Test Loss: 0.080327
2020-05-20 20:55:18,656 - root - INFO - Test AUC: 97.06%
2020-05-20 20:55:18,656 - root - INFO - Test Time: 1.755s
2020-05-20 20:55:18,656 - root - INFO - Finished testing.
