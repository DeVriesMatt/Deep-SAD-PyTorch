2020-05-21 03:41:29,111 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_4_5_16.txt
2020-05-21 03:41:29,111 - root - INFO - Data path is ../data
2020-05-21 03:41:29,111 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 03:41:29,112 - root - INFO - Dataset: fmnist
2020-05-21 03:41:29,112 - root - INFO - Normal class: 4
2020-05-21 03:41:29,112 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 03:41:29,112 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 03:41:29,112 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 03:41:29,112 - root - INFO - Scenario Running: 5
2020-05-21 03:41:29,112 - root - INFO - Train only the network: True
2020-05-21 03:41:29,112 - root - INFO - Output and AE dimensions: 16
2020-05-21 03:41:29,112 - root - INFO - Known anomaly class: 5
2020-05-21 03:41:29,112 - root - INFO - Network: fmnist_LeNet
2020-05-21 03:41:29,112 - root - INFO - Eta-parameter: 1.00
2020-05-21 03:41:29,155 - root - INFO - Set seed to 0.
2020-05-21 03:41:29,221 - root - INFO - Computation device: cuda
2020-05-21 03:41:29,231 - root - INFO - Number of threads: 0
2020-05-21 03:41:29,231 - root - INFO - Number of dataloader workers: 6
2020-05-21 03:41:36,920 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_16.tar.
2020-05-21 03:41:36,929 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 03:41:36,929 - root - INFO - Pretraining: True
2020-05-21 03:41:36,929 - root - INFO - Training optimizer: adam
2020-05-21 03:41:36,929 - root - INFO - Training learning rate: 0.0001
2020-05-21 03:41:36,929 - root - INFO - Training epochs: 150
2020-05-21 03:41:36,929 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 03:41:36,929 - root - INFO - Training batch size: 200
2020-05-21 03:41:36,930 - root - INFO - Training weight decay: 5e-07
2020-05-21 03:41:36,932 - root - INFO - Starting training...
2020-05-21 03:41:41,201 - root - INFO - | Epoch: 001/150 | Train Time: 4.269s | Train Loss: 0.185076 |
2020-05-21 03:41:42,671 - root - INFO - | Epoch: 002/150 | Train Time: 1.470s | Train Loss: 0.097884 |
2020-05-21 03:41:44,013 - root - INFO - | Epoch: 003/150 | Train Time: 1.341s | Train Loss: 0.083784 |
2020-05-21 03:41:45,230 - root - INFO - | Epoch: 004/150 | Train Time: 1.217s | Train Loss: 0.076613 |
2020-05-21 03:41:46,241 - root - INFO - | Epoch: 005/150 | Train Time: 1.010s | Train Loss: 0.072622 |
2020-05-21 03:41:47,266 - root - INFO - | Epoch: 006/150 | Train Time: 1.024s | Train Loss: 0.068248 |
2020-05-21 03:41:48,376 - root - INFO - | Epoch: 007/150 | Train Time: 1.109s | Train Loss: 0.063808 |
2020-05-21 03:41:49,545 - root - INFO - | Epoch: 008/150 | Train Time: 1.169s | Train Loss: 0.061475 |
2020-05-21 03:41:50,927 - root - INFO - | Epoch: 009/150 | Train Time: 1.381s | Train Loss: 0.059531 |
2020-05-21 03:41:51,979 - root - INFO - | Epoch: 010/150 | Train Time: 1.052s | Train Loss: 0.055551 |
2020-05-21 03:41:52,870 - root - INFO - | Epoch: 011/150 | Train Time: 0.890s | Train Loss: 0.057727 |
2020-05-21 03:41:53,625 - root - INFO - | Epoch: 012/150 | Train Time: 0.755s | Train Loss: 0.052214 |
2020-05-21 03:41:54,536 - root - INFO - | Epoch: 013/150 | Train Time: 0.911s | Train Loss: 0.052637 |
2020-05-21 03:41:55,358 - root - INFO - | Epoch: 014/150 | Train Time: 0.822s | Train Loss: 0.051290 |
2020-05-21 03:41:56,248 - root - INFO - | Epoch: 015/150 | Train Time: 0.889s | Train Loss: 0.051063 |
2020-05-21 03:41:57,171 - root - INFO - | Epoch: 016/150 | Train Time: 0.923s | Train Loss: 0.048995 |
2020-05-21 03:41:58,041 - root - INFO - | Epoch: 017/150 | Train Time: 0.869s | Train Loss: 0.047788 |
2020-05-21 03:41:58,898 - root - INFO - | Epoch: 018/150 | Train Time: 0.856s | Train Loss: 0.047535 |
2020-05-21 03:41:59,838 - root - INFO - | Epoch: 019/150 | Train Time: 0.939s | Train Loss: 0.045045 |
2020-05-21 03:42:00,873 - root - INFO - | Epoch: 020/150 | Train Time: 1.034s | Train Loss: 0.045642 |
2020-05-21 03:42:02,247 - root - INFO - | Epoch: 021/150 | Train Time: 1.374s | Train Loss: 0.042476 |
2020-05-21 03:42:03,077 - root - INFO - | Epoch: 022/150 | Train Time: 0.829s | Train Loss: 0.043313 |
2020-05-21 03:42:04,116 - root - INFO - | Epoch: 023/150 | Train Time: 1.038s | Train Loss: 0.042343 |
2020-05-21 03:42:05,427 - root - INFO - | Epoch: 024/150 | Train Time: 1.311s | Train Loss: 0.040016 |
2020-05-21 03:42:06,737 - root - INFO - | Epoch: 025/150 | Train Time: 1.310s | Train Loss: 0.039547 |
2020-05-21 03:42:07,860 - root - INFO - | Epoch: 026/150 | Train Time: 1.123s | Train Loss: 0.038001 |
2020-05-21 03:42:09,111 - root - INFO - | Epoch: 027/150 | Train Time: 1.250s | Train Loss: 0.037283 |
2020-05-21 03:42:10,749 - root - INFO - | Epoch: 028/150 | Train Time: 1.637s | Train Loss: 0.035912 |
2020-05-21 03:42:11,986 - root - INFO - | Epoch: 029/150 | Train Time: 1.237s | Train Loss: 0.037422 |
2020-05-21 03:42:13,444 - root - INFO - | Epoch: 030/150 | Train Time: 1.456s | Train Loss: 0.034150 |
2020-05-21 03:42:15,010 - root - INFO - | Epoch: 031/150 | Train Time: 1.566s | Train Loss: 0.032467 |
2020-05-21 03:42:16,432 - root - INFO - | Epoch: 032/150 | Train Time: 1.421s | Train Loss: 0.031757 |
2020-05-21 03:42:17,885 - root - INFO - | Epoch: 033/150 | Train Time: 1.453s | Train Loss: 0.031231 |
2020-05-21 03:42:19,447 - root - INFO - | Epoch: 034/150 | Train Time: 1.562s | Train Loss: 0.029694 |
2020-05-21 03:42:21,723 - root - INFO - | Epoch: 035/150 | Train Time: 2.275s | Train Loss: 0.028965 |
2020-05-21 03:42:23,333 - root - INFO - | Epoch: 036/150 | Train Time: 1.610s | Train Loss: 0.030234 |
2020-05-21 03:42:24,804 - root - INFO - | Epoch: 037/150 | Train Time: 1.471s | Train Loss: 0.030834 |
2020-05-21 03:42:26,381 - root - INFO - | Epoch: 038/150 | Train Time: 1.576s | Train Loss: 0.027084 |
2020-05-21 03:42:28,052 - root - INFO - | Epoch: 039/150 | Train Time: 1.669s | Train Loss: 0.025582 |
2020-05-21 03:42:29,710 - root - INFO - | Epoch: 040/150 | Train Time: 1.658s | Train Loss: 0.023980 |
2020-05-21 03:42:31,147 - root - INFO - | Epoch: 041/150 | Train Time: 1.436s | Train Loss: 0.024975 |
2020-05-21 03:42:32,737 - root - INFO - | Epoch: 042/150 | Train Time: 1.589s | Train Loss: 0.024563 |
2020-05-21 03:42:34,431 - root - INFO - | Epoch: 043/150 | Train Time: 1.694s | Train Loss: 0.023293 |
2020-05-21 03:42:35,729 - root - INFO - | Epoch: 044/150 | Train Time: 1.297s | Train Loss: 0.021444 |
2020-05-21 03:42:37,326 - root - INFO - | Epoch: 045/150 | Train Time: 1.596s | Train Loss: 0.021488 |
2020-05-21 03:42:39,408 - root - INFO - | Epoch: 046/150 | Train Time: 2.081s | Train Loss: 0.020754 |
2020-05-21 03:42:41,421 - root - INFO - | Epoch: 047/150 | Train Time: 2.013s | Train Loss: 0.021313 |
2020-05-21 03:42:42,993 - root - INFO - | Epoch: 048/150 | Train Time: 1.572s | Train Loss: 0.020130 |
2020-05-21 03:42:44,706 - root - INFO - | Epoch: 049/150 | Train Time: 1.712s | Train Loss: 0.019176 |
2020-05-21 03:42:46,553 - root - INFO - | Epoch: 050/150 | Train Time: 1.847s | Train Loss: 0.017238 |
2020-05-21 03:42:46,554 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 03:42:48,520 - root - INFO - | Epoch: 051/150 | Train Time: 1.966s | Train Loss: 0.018083 |
2020-05-21 03:42:50,244 - root - INFO - | Epoch: 052/150 | Train Time: 1.723s | Train Loss: 0.017025 |
2020-05-21 03:42:52,015 - root - INFO - | Epoch: 053/150 | Train Time: 1.770s | Train Loss: 0.016064 |
2020-05-21 03:42:53,809 - root - INFO - | Epoch: 054/150 | Train Time: 1.794s | Train Loss: 0.016928 |
2020-05-21 03:42:55,697 - root - INFO - | Epoch: 055/150 | Train Time: 1.887s | Train Loss: 0.017136 |
2020-05-21 03:42:57,110 - root - INFO - | Epoch: 056/150 | Train Time: 1.412s | Train Loss: 0.017245 |
2020-05-21 03:42:59,109 - root - INFO - | Epoch: 057/150 | Train Time: 1.998s | Train Loss: 0.017916 |
2020-05-21 03:43:01,331 - root - INFO - | Epoch: 058/150 | Train Time: 2.222s | Train Loss: 0.016520 |
2020-05-21 03:43:03,119 - root - INFO - | Epoch: 059/150 | Train Time: 1.787s | Train Loss: 0.017356 |
2020-05-21 03:43:04,755 - root - INFO - | Epoch: 060/150 | Train Time: 1.635s | Train Loss: 0.018052 |
2020-05-21 03:43:06,513 - root - INFO - | Epoch: 061/150 | Train Time: 1.758s | Train Loss: 0.016463 |
2020-05-21 03:43:08,242 - root - INFO - | Epoch: 062/150 | Train Time: 1.728s | Train Loss: 0.017094 |
2020-05-21 03:43:09,948 - root - INFO - | Epoch: 063/150 | Train Time: 1.705s | Train Loss: 0.016702 |
2020-05-21 03:43:11,638 - root - INFO - | Epoch: 064/150 | Train Time: 1.689s | Train Loss: 0.016845 |
2020-05-21 03:43:13,230 - root - INFO - | Epoch: 065/150 | Train Time: 1.592s | Train Loss: 0.016825 |
2020-05-21 03:43:14,655 - root - INFO - | Epoch: 066/150 | Train Time: 1.424s | Train Loss: 0.017187 |
2020-05-21 03:43:16,308 - root - INFO - | Epoch: 067/150 | Train Time: 1.653s | Train Loss: 0.016090 |
2020-05-21 03:43:17,903 - root - INFO - | Epoch: 068/150 | Train Time: 1.594s | Train Loss: 0.016854 |
2020-05-21 03:43:19,583 - root - INFO - | Epoch: 069/150 | Train Time: 1.679s | Train Loss: 0.016476 |
2020-05-21 03:43:21,320 - root - INFO - | Epoch: 070/150 | Train Time: 1.736s | Train Loss: 0.016130 |
2020-05-21 03:43:23,213 - root - INFO - | Epoch: 071/150 | Train Time: 1.893s | Train Loss: 0.016945 |
2020-05-21 03:43:25,192 - root - INFO - | Epoch: 072/150 | Train Time: 1.979s | Train Loss: 0.015504 |
2020-05-21 03:43:27,112 - root - INFO - | Epoch: 073/150 | Train Time: 1.919s | Train Loss: 0.016420 |
2020-05-21 03:43:28,803 - root - INFO - | Epoch: 074/150 | Train Time: 1.690s | Train Loss: 0.016826 |
2020-05-21 03:43:30,037 - root - INFO - | Epoch: 075/150 | Train Time: 1.234s | Train Loss: 0.017008 |
2020-05-21 03:43:31,225 - root - INFO - | Epoch: 076/150 | Train Time: 1.187s | Train Loss: 0.016318 |
2020-05-21 03:43:32,749 - root - INFO - | Epoch: 077/150 | Train Time: 1.524s | Train Loss: 0.016322 |
2020-05-21 03:43:34,602 - root - INFO - | Epoch: 078/150 | Train Time: 1.852s | Train Loss: 0.014990 |
2020-05-21 03:43:36,849 - root - INFO - | Epoch: 079/150 | Train Time: 2.247s | Train Loss: 0.016899 |
2020-05-21 03:43:38,514 - root - INFO - | Epoch: 080/150 | Train Time: 1.663s | Train Loss: 0.015694 |
2020-05-21 03:43:40,339 - root - INFO - | Epoch: 081/150 | Train Time: 1.825s | Train Loss: 0.016292 |
2020-05-21 03:43:42,294 - root - INFO - | Epoch: 082/150 | Train Time: 1.954s | Train Loss: 0.015864 |
2020-05-21 03:43:44,333 - root - INFO - | Epoch: 083/150 | Train Time: 2.039s | Train Loss: 0.015757 |
2020-05-21 03:43:46,464 - root - INFO - | Epoch: 084/150 | Train Time: 2.131s | Train Loss: 0.015692 |
2020-05-21 03:43:47,922 - root - INFO - | Epoch: 085/150 | Train Time: 1.457s | Train Loss: 0.015002 |
2020-05-21 03:43:49,787 - root - INFO - | Epoch: 086/150 | Train Time: 1.864s | Train Loss: 0.014452 |
2020-05-21 03:43:51,156 - root - INFO - | Epoch: 087/150 | Train Time: 1.369s | Train Loss: 0.016247 |
2020-05-21 03:43:52,766 - root - INFO - | Epoch: 088/150 | Train Time: 1.610s | Train Loss: 0.016046 |
2020-05-21 03:43:54,531 - root - INFO - | Epoch: 089/150 | Train Time: 1.764s | Train Loss: 0.015543 |
2020-05-21 03:43:56,221 - root - INFO - | Epoch: 090/150 | Train Time: 1.689s | Train Loss: 0.015404 |
2020-05-21 03:43:57,983 - root - INFO - | Epoch: 091/150 | Train Time: 1.762s | Train Loss: 0.015829 |
2020-05-21 03:44:00,048 - root - INFO - | Epoch: 092/150 | Train Time: 2.064s | Train Loss: 0.016997 |
2020-05-21 03:44:01,539 - root - INFO - | Epoch: 093/150 | Train Time: 1.491s | Train Loss: 0.015460 |
2020-05-21 03:44:03,382 - root - INFO - | Epoch: 094/150 | Train Time: 1.843s | Train Loss: 0.016011 |
2020-05-21 03:44:05,217 - root - INFO - | Epoch: 095/150 | Train Time: 1.835s | Train Loss: 0.016620 |
2020-05-21 03:44:07,053 - root - INFO - | Epoch: 096/150 | Train Time: 1.835s | Train Loss: 0.015420 |
2020-05-21 03:44:08,887 - root - INFO - | Epoch: 097/150 | Train Time: 1.834s | Train Loss: 0.015082 |
2020-05-21 03:44:11,065 - root - INFO - | Epoch: 098/150 | Train Time: 2.178s | Train Loss: 0.015327 |
2020-05-21 03:44:13,051 - root - INFO - | Epoch: 099/150 | Train Time: 1.985s | Train Loss: 0.014783 |
2020-05-21 03:44:15,060 - root - INFO - | Epoch: 100/150 | Train Time: 2.009s | Train Loss: 0.015527 |
2020-05-21 03:44:16,600 - root - INFO - | Epoch: 101/150 | Train Time: 1.539s | Train Loss: 0.015397 |
2020-05-21 03:44:18,276 - root - INFO - | Epoch: 102/150 | Train Time: 1.676s | Train Loss: 0.014200 |
2020-05-21 03:44:20,104 - root - INFO - | Epoch: 103/150 | Train Time: 1.827s | Train Loss: 0.014359 |
2020-05-21 03:44:21,909 - root - INFO - | Epoch: 104/150 | Train Time: 1.805s | Train Loss: 0.013786 |
2020-05-21 03:44:23,525 - root - INFO - | Epoch: 105/150 | Train Time: 1.615s | Train Loss: 0.015280 |
2020-05-21 03:44:25,302 - root - INFO - | Epoch: 106/150 | Train Time: 1.776s | Train Loss: 0.015139 |
2020-05-21 03:44:26,808 - root - INFO - | Epoch: 107/150 | Train Time: 1.506s | Train Loss: 0.014571 |
2020-05-21 03:44:28,445 - root - INFO - | Epoch: 108/150 | Train Time: 1.636s | Train Loss: 0.014286 |
2020-05-21 03:44:30,436 - root - INFO - | Epoch: 109/150 | Train Time: 1.991s | Train Loss: 0.013606 |
2020-05-21 03:44:31,808 - root - INFO - | Epoch: 110/150 | Train Time: 1.372s | Train Loss: 0.016795 |
2020-05-21 03:44:33,585 - root - INFO - | Epoch: 111/150 | Train Time: 1.776s | Train Loss: 0.013413 |
2020-05-21 03:44:35,122 - root - INFO - | Epoch: 112/150 | Train Time: 1.537s | Train Loss: 0.015164 |
2020-05-21 03:44:36,838 - root - INFO - | Epoch: 113/150 | Train Time: 1.715s | Train Loss: 0.015298 |
2020-05-21 03:44:38,800 - root - INFO - | Epoch: 114/150 | Train Time: 1.961s | Train Loss: 0.013613 |
2020-05-21 03:44:40,545 - root - INFO - | Epoch: 115/150 | Train Time: 1.744s | Train Loss: 0.015193 |
2020-05-21 03:44:42,327 - root - INFO - | Epoch: 116/150 | Train Time: 1.782s | Train Loss: 0.013626 |
2020-05-21 03:44:43,904 - root - INFO - | Epoch: 117/150 | Train Time: 1.576s | Train Loss: 0.014239 |
2020-05-21 03:44:45,841 - root - INFO - | Epoch: 118/150 | Train Time: 1.937s | Train Loss: 0.014199 |
2020-05-21 03:44:47,641 - root - INFO - | Epoch: 119/150 | Train Time: 1.800s | Train Loss: 0.013976 |
2020-05-21 03:44:49,610 - root - INFO - | Epoch: 120/150 | Train Time: 1.968s | Train Loss: 0.014389 |
2020-05-21 03:44:51,708 - root - INFO - | Epoch: 121/150 | Train Time: 2.098s | Train Loss: 0.014293 |
2020-05-21 03:44:53,656 - root - INFO - | Epoch: 122/150 | Train Time: 1.948s | Train Loss: 0.013947 |
2020-05-21 03:44:55,358 - root - INFO - | Epoch: 123/150 | Train Time: 1.701s | Train Loss: 0.013495 |
2020-05-21 03:44:57,034 - root - INFO - | Epoch: 124/150 | Train Time: 1.676s | Train Loss: 0.013529 |
2020-05-21 03:44:58,738 - root - INFO - | Epoch: 125/150 | Train Time: 1.703s | Train Loss: 0.014409 |
2020-05-21 03:45:00,746 - root - INFO - | Epoch: 126/150 | Train Time: 2.008s | Train Loss: 0.013835 |
2020-05-21 03:45:02,630 - root - INFO - | Epoch: 127/150 | Train Time: 1.883s | Train Loss: 0.013320 |
2020-05-21 03:45:04,657 - root - INFO - | Epoch: 128/150 | Train Time: 2.026s | Train Loss: 0.013382 |
2020-05-21 03:45:06,216 - root - INFO - | Epoch: 129/150 | Train Time: 1.558s | Train Loss: 0.013660 |
2020-05-21 03:45:08,219 - root - INFO - | Epoch: 130/150 | Train Time: 2.003s | Train Loss: 0.013787 |
2020-05-21 03:45:10,198 - root - INFO - | Epoch: 131/150 | Train Time: 1.978s | Train Loss: 0.012717 |
2020-05-21 03:45:11,997 - root - INFO - | Epoch: 132/150 | Train Time: 1.799s | Train Loss: 0.013605 |
2020-05-21 03:45:14,145 - root - INFO - | Epoch: 133/150 | Train Time: 2.147s | Train Loss: 0.014072 |
2020-05-21 03:45:15,893 - root - INFO - | Epoch: 134/150 | Train Time: 1.748s | Train Loss: 0.014037 |
2020-05-21 03:45:17,964 - root - INFO - | Epoch: 135/150 | Train Time: 2.070s | Train Loss: 0.012581 |
2020-05-21 03:45:19,902 - root - INFO - | Epoch: 136/150 | Train Time: 1.937s | Train Loss: 0.012554 |
2020-05-21 03:45:21,557 - root - INFO - | Epoch: 137/150 | Train Time: 1.655s | Train Loss: 0.013155 |
2020-05-21 03:45:23,422 - root - INFO - | Epoch: 138/150 | Train Time: 1.864s | Train Loss: 0.014143 |
2020-05-21 03:45:25,359 - root - INFO - | Epoch: 139/150 | Train Time: 1.937s | Train Loss: 0.012782 |
2020-05-21 03:45:27,689 - root - INFO - | Epoch: 140/150 | Train Time: 2.329s | Train Loss: 0.013558 |
2020-05-21 03:45:29,777 - root - INFO - | Epoch: 141/150 | Train Time: 2.087s | Train Loss: 0.013612 |
2020-05-21 03:45:31,414 - root - INFO - | Epoch: 142/150 | Train Time: 1.636s | Train Loss: 0.012541 |
2020-05-21 03:45:33,378 - root - INFO - | Epoch: 143/150 | Train Time: 1.964s | Train Loss: 0.014527 |
2020-05-21 03:45:35,074 - root - INFO - | Epoch: 144/150 | Train Time: 1.695s | Train Loss: 0.013283 |
2020-05-21 03:45:36,628 - root - INFO - | Epoch: 145/150 | Train Time: 1.553s | Train Loss: 0.012359 |
2020-05-21 03:45:38,450 - root - INFO - | Epoch: 146/150 | Train Time: 1.822s | Train Loss: 0.013794 |
2020-05-21 03:45:39,847 - root - INFO - | Epoch: 147/150 | Train Time: 1.397s | Train Loss: 0.013536 |
2020-05-21 03:45:41,419 - root - INFO - | Epoch: 148/150 | Train Time: 1.571s | Train Loss: 0.012734 |
2020-05-21 03:45:43,106 - root - INFO - | Epoch: 149/150 | Train Time: 1.686s | Train Loss: 0.013554 |
2020-05-21 03:45:44,860 - root - INFO - | Epoch: 150/150 | Train Time: 1.753s | Train Loss: 0.012538 |
2020-05-21 03:45:44,860 - root - INFO - Training Time: 247.928s
2020-05-21 03:45:44,860 - root - INFO - Finished training.
2020-05-21 03:45:44,861 - root - INFO - Starting testing...
2020-05-21 03:45:46,623 - root - INFO - Test Loss: 0.812789
2020-05-21 03:45:46,624 - root - INFO - Test AUC: 82.19%
2020-05-21 03:45:46,624 - root - INFO - Test Time: 1.733s
2020-05-21 03:45:46,624 - root - INFO - Finished testing.
