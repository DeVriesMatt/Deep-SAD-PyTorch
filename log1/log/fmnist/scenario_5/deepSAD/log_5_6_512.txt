2020-05-21 07:46:35,706 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_5_6_512.txt
2020-05-21 07:46:35,706 - root - INFO - Data path is ../data
2020-05-21 07:46:35,706 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 07:46:35,706 - root - INFO - Dataset: fmnist
2020-05-21 07:46:35,706 - root - INFO - Normal class: 5
2020-05-21 07:46:35,706 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 07:46:35,706 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 07:46:35,706 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 07:46:35,706 - root - INFO - Scenario Running: 5
2020-05-21 07:46:35,706 - root - INFO - Train only the network: True
2020-05-21 07:46:35,706 - root - INFO - Output and AE dimensions: 512
2020-05-21 07:46:35,706 - root - INFO - Known anomaly class: 6
2020-05-21 07:46:35,707 - root - INFO - Network: fmnist_LeNet
2020-05-21 07:46:35,707 - root - INFO - Eta-parameter: 1.00
2020-05-21 07:46:35,721 - root - INFO - Set seed to 0.
2020-05-21 07:46:35,744 - root - INFO - Computation device: cuda
2020-05-21 07:46:35,744 - root - INFO - Number of threads: 0
2020-05-21 07:46:35,744 - root - INFO - Number of dataloader workers: 6
2020-05-21 07:46:40,284 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_512.tar.
2020-05-21 07:46:40,285 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 07:46:40,285 - root - INFO - Pretraining: True
2020-05-21 07:46:40,286 - root - INFO - Training optimizer: adam
2020-05-21 07:46:40,286 - root - INFO - Training learning rate: 0.0001
2020-05-21 07:46:40,286 - root - INFO - Training epochs: 150
2020-05-21 07:46:40,286 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 07:46:40,286 - root - INFO - Training batch size: 200
2020-05-21 07:46:40,286 - root - INFO - Training weight decay: 5e-07
2020-05-21 07:46:40,288 - root - INFO - Starting training...
2020-05-21 07:46:43,547 - root - INFO - | Epoch: 001/150 | Train Time: 3.258s | Train Loss: 0.900229 |
2020-05-21 07:46:44,358 - root - INFO - | Epoch: 002/150 | Train Time: 0.811s | Train Loss: 0.452158 |
2020-05-21 07:46:45,762 - root - INFO - | Epoch: 003/150 | Train Time: 1.403s | Train Loss: 0.347532 |
2020-05-21 07:46:47,048 - root - INFO - | Epoch: 004/150 | Train Time: 1.285s | Train Loss: 0.297546 |
2020-05-21 07:46:48,224 - root - INFO - | Epoch: 005/150 | Train Time: 1.175s | Train Loss: 0.279242 |
2020-05-21 07:46:49,622 - root - INFO - | Epoch: 006/150 | Train Time: 1.398s | Train Loss: 0.253172 |
2020-05-21 07:46:50,765 - root - INFO - | Epoch: 007/150 | Train Time: 1.143s | Train Loss: 0.225300 |
2020-05-21 07:46:52,096 - root - INFO - | Epoch: 008/150 | Train Time: 1.330s | Train Loss: 0.211848 |
2020-05-21 07:46:53,335 - root - INFO - | Epoch: 009/150 | Train Time: 1.238s | Train Loss: 0.210010 |
2020-05-21 07:46:54,698 - root - INFO - | Epoch: 010/150 | Train Time: 1.362s | Train Loss: 0.196691 |
2020-05-21 07:46:55,987 - root - INFO - | Epoch: 011/150 | Train Time: 1.289s | Train Loss: 0.192674 |
2020-05-21 07:46:57,222 - root - INFO - | Epoch: 012/150 | Train Time: 1.235s | Train Loss: 0.185848 |
2020-05-21 07:46:58,505 - root - INFO - | Epoch: 013/150 | Train Time: 1.282s | Train Loss: 0.177426 |
2020-05-21 07:47:00,292 - root - INFO - | Epoch: 014/150 | Train Time: 1.786s | Train Loss: 0.169669 |
2020-05-21 07:47:01,880 - root - INFO - | Epoch: 015/150 | Train Time: 1.588s | Train Loss: 0.161585 |
2020-05-21 07:47:03,339 - root - INFO - | Epoch: 016/150 | Train Time: 1.458s | Train Loss: 0.161424 |
2020-05-21 07:47:05,492 - root - INFO - | Epoch: 017/150 | Train Time: 2.153s | Train Loss: 0.163561 |
2020-05-21 07:47:07,351 - root - INFO - | Epoch: 018/150 | Train Time: 1.858s | Train Loss: 0.154029 |
2020-05-21 07:47:08,898 - root - INFO - | Epoch: 019/150 | Train Time: 1.547s | Train Loss: 0.146748 |
2020-05-21 07:47:10,944 - root - INFO - | Epoch: 020/150 | Train Time: 2.045s | Train Loss: 0.151905 |
2020-05-21 07:47:12,950 - root - INFO - | Epoch: 021/150 | Train Time: 2.005s | Train Loss: 0.151498 |
2020-05-21 07:47:14,665 - root - INFO - | Epoch: 022/150 | Train Time: 1.715s | Train Loss: 0.142451 |
2020-05-21 07:47:16,199 - root - INFO - | Epoch: 023/150 | Train Time: 1.533s | Train Loss: 0.135905 |
2020-05-21 07:47:17,717 - root - INFO - | Epoch: 024/150 | Train Time: 1.518s | Train Loss: 0.139970 |
2020-05-21 07:47:19,236 - root - INFO - | Epoch: 025/150 | Train Time: 1.518s | Train Loss: 0.133329 |
2020-05-21 07:47:20,889 - root - INFO - | Epoch: 026/150 | Train Time: 1.653s | Train Loss: 0.133899 |
2020-05-21 07:47:22,465 - root - INFO - | Epoch: 027/150 | Train Time: 1.576s | Train Loss: 0.138414 |
2020-05-21 07:47:24,149 - root - INFO - | Epoch: 028/150 | Train Time: 1.683s | Train Loss: 0.130637 |
2020-05-21 07:47:25,467 - root - INFO - | Epoch: 029/150 | Train Time: 1.318s | Train Loss: 0.134583 |
2020-05-21 07:47:27,232 - root - INFO - | Epoch: 030/150 | Train Time: 1.764s | Train Loss: 0.129492 |
2020-05-21 07:47:28,743 - root - INFO - | Epoch: 031/150 | Train Time: 1.510s | Train Loss: 0.132124 |
2020-05-21 07:47:30,556 - root - INFO - | Epoch: 032/150 | Train Time: 1.813s | Train Loss: 0.127226 |
2020-05-21 07:47:32,064 - root - INFO - | Epoch: 033/150 | Train Time: 1.507s | Train Loss: 0.123579 |
2020-05-21 07:47:33,802 - root - INFO - | Epoch: 034/150 | Train Time: 1.738s | Train Loss: 0.123273 |
2020-05-21 07:47:35,474 - root - INFO - | Epoch: 035/150 | Train Time: 1.671s | Train Loss: 0.122377 |
2020-05-21 07:47:37,161 - root - INFO - | Epoch: 036/150 | Train Time: 1.687s | Train Loss: 0.119812 |
2020-05-21 07:47:38,700 - root - INFO - | Epoch: 037/150 | Train Time: 1.539s | Train Loss: 0.116473 |
2020-05-21 07:47:40,178 - root - INFO - | Epoch: 038/150 | Train Time: 1.478s | Train Loss: 0.120347 |
2020-05-21 07:47:41,851 - root - INFO - | Epoch: 039/150 | Train Time: 1.672s | Train Loss: 0.116089 |
2020-05-21 07:47:43,685 - root - INFO - | Epoch: 040/150 | Train Time: 1.833s | Train Loss: 0.115585 |
2020-05-21 07:47:45,246 - root - INFO - | Epoch: 041/150 | Train Time: 1.561s | Train Loss: 0.117146 |
2020-05-21 07:47:46,687 - root - INFO - | Epoch: 042/150 | Train Time: 1.440s | Train Loss: 0.109494 |
2020-05-21 07:47:48,405 - root - INFO - | Epoch: 043/150 | Train Time: 1.718s | Train Loss: 0.113551 |
2020-05-21 07:47:50,128 - root - INFO - | Epoch: 044/150 | Train Time: 1.722s | Train Loss: 0.106493 |
2020-05-21 07:47:51,632 - root - INFO - | Epoch: 045/150 | Train Time: 1.503s | Train Loss: 0.112739 |
2020-05-21 07:47:53,308 - root - INFO - | Epoch: 046/150 | Train Time: 1.676s | Train Loss: 0.114107 |
2020-05-21 07:47:55,147 - root - INFO - | Epoch: 047/150 | Train Time: 1.838s | Train Loss: 0.113112 |
2020-05-21 07:47:56,947 - root - INFO - | Epoch: 048/150 | Train Time: 1.799s | Train Loss: 0.110988 |
2020-05-21 07:47:58,630 - root - INFO - | Epoch: 049/150 | Train Time: 1.683s | Train Loss: 0.108483 |
2020-05-21 07:48:00,119 - root - INFO - | Epoch: 050/150 | Train Time: 1.489s | Train Loss: 0.102088 |
2020-05-21 07:48:00,120 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 07:48:01,714 - root - INFO - | Epoch: 051/150 | Train Time: 1.594s | Train Loss: 0.095680 |
2020-05-21 07:48:03,334 - root - INFO - | Epoch: 052/150 | Train Time: 1.619s | Train Loss: 0.095377 |
2020-05-21 07:48:04,569 - root - INFO - | Epoch: 053/150 | Train Time: 1.235s | Train Loss: 0.094689 |
2020-05-21 07:48:06,137 - root - INFO - | Epoch: 054/150 | Train Time: 1.567s | Train Loss: 0.097740 |
2020-05-21 07:48:08,584 - root - INFO - | Epoch: 055/150 | Train Time: 2.447s | Train Loss: 0.099603 |
2020-05-21 07:48:10,082 - root - INFO - | Epoch: 056/150 | Train Time: 1.497s | Train Loss: 0.097947 |
2020-05-21 07:48:11,528 - root - INFO - | Epoch: 057/150 | Train Time: 1.446s | Train Loss: 0.097286 |
2020-05-21 07:48:13,136 - root - INFO - | Epoch: 058/150 | Train Time: 1.607s | Train Loss: 0.098256 |
2020-05-21 07:48:15,096 - root - INFO - | Epoch: 059/150 | Train Time: 1.959s | Train Loss: 0.100265 |
2020-05-21 07:48:16,544 - root - INFO - | Epoch: 060/150 | Train Time: 1.448s | Train Loss: 0.097729 |
2020-05-21 07:48:18,043 - root - INFO - | Epoch: 061/150 | Train Time: 1.498s | Train Loss: 0.098657 |
2020-05-21 07:48:19,679 - root - INFO - | Epoch: 062/150 | Train Time: 1.636s | Train Loss: 0.099379 |
2020-05-21 07:48:21,375 - root - INFO - | Epoch: 063/150 | Train Time: 1.695s | Train Loss: 0.098902 |
2020-05-21 07:48:22,776 - root - INFO - | Epoch: 064/150 | Train Time: 1.401s | Train Loss: 0.096282 |
2020-05-21 07:48:24,286 - root - INFO - | Epoch: 065/150 | Train Time: 1.509s | Train Loss: 0.096805 |
2020-05-21 07:48:25,548 - root - INFO - | Epoch: 066/150 | Train Time: 1.262s | Train Loss: 0.095539 |
2020-05-21 07:48:27,325 - root - INFO - | Epoch: 067/150 | Train Time: 1.776s | Train Loss: 0.093540 |
2020-05-21 07:48:28,951 - root - INFO - | Epoch: 068/150 | Train Time: 1.626s | Train Loss: 0.097065 |
2020-05-21 07:48:30,842 - root - INFO - | Epoch: 069/150 | Train Time: 1.890s | Train Loss: 0.095779 |
2020-05-21 07:48:32,637 - root - INFO - | Epoch: 070/150 | Train Time: 1.795s | Train Loss: 0.095151 |
2020-05-21 07:48:34,312 - root - INFO - | Epoch: 071/150 | Train Time: 1.674s | Train Loss: 0.095138 |
2020-05-21 07:48:36,090 - root - INFO - | Epoch: 072/150 | Train Time: 1.778s | Train Loss: 0.098877 |
2020-05-21 07:48:38,012 - root - INFO - | Epoch: 073/150 | Train Time: 1.921s | Train Loss: 0.099045 |
2020-05-21 07:48:39,578 - root - INFO - | Epoch: 074/150 | Train Time: 1.566s | Train Loss: 0.094753 |
2020-05-21 07:48:41,367 - root - INFO - | Epoch: 075/150 | Train Time: 1.788s | Train Loss: 0.094307 |
2020-05-21 07:48:43,208 - root - INFO - | Epoch: 076/150 | Train Time: 1.840s | Train Loss: 0.099445 |
2020-05-21 07:48:45,104 - root - INFO - | Epoch: 077/150 | Train Time: 1.895s | Train Loss: 0.093532 |
2020-05-21 07:48:46,774 - root - INFO - | Epoch: 078/150 | Train Time: 1.669s | Train Loss: 0.093504 |
2020-05-21 07:48:48,047 - root - INFO - | Epoch: 079/150 | Train Time: 1.273s | Train Loss: 0.094491 |
2020-05-21 07:48:49,694 - root - INFO - | Epoch: 080/150 | Train Time: 1.646s | Train Loss: 0.099649 |
2020-05-21 07:48:51,112 - root - INFO - | Epoch: 081/150 | Train Time: 1.417s | Train Loss: 0.095331 |
2020-05-21 07:48:52,708 - root - INFO - | Epoch: 082/150 | Train Time: 1.595s | Train Loss: 0.097278 |
2020-05-21 07:48:54,605 - root - INFO - | Epoch: 083/150 | Train Time: 1.897s | Train Loss: 0.095227 |
2020-05-21 07:48:56,018 - root - INFO - | Epoch: 084/150 | Train Time: 1.412s | Train Loss: 0.094386 |
2020-05-21 07:48:57,588 - root - INFO - | Epoch: 085/150 | Train Time: 1.569s | Train Loss: 0.096618 |
2020-05-21 07:48:59,254 - root - INFO - | Epoch: 086/150 | Train Time: 1.666s | Train Loss: 0.092933 |
2020-05-21 07:49:00,795 - root - INFO - | Epoch: 087/150 | Train Time: 1.540s | Train Loss: 0.096271 |
2020-05-21 07:49:02,521 - root - INFO - | Epoch: 088/150 | Train Time: 1.726s | Train Loss: 0.095566 |
2020-05-21 07:49:04,492 - root - INFO - | Epoch: 089/150 | Train Time: 1.970s | Train Loss: 0.092192 |
2020-05-21 07:49:05,806 - root - INFO - | Epoch: 090/150 | Train Time: 1.313s | Train Loss: 0.095897 |
2020-05-21 07:49:07,137 - root - INFO - | Epoch: 091/150 | Train Time: 1.330s | Train Loss: 0.096343 |
2020-05-21 07:49:08,894 - root - INFO - | Epoch: 092/150 | Train Time: 1.757s | Train Loss: 0.098676 |
2020-05-21 07:49:10,340 - root - INFO - | Epoch: 093/150 | Train Time: 1.445s | Train Loss: 0.093176 |
2020-05-21 07:49:11,796 - root - INFO - | Epoch: 094/150 | Train Time: 1.456s | Train Loss: 0.092641 |
2020-05-21 07:49:13,512 - root - INFO - | Epoch: 095/150 | Train Time: 1.715s | Train Loss: 0.093994 |
2020-05-21 07:49:15,353 - root - INFO - | Epoch: 096/150 | Train Time: 1.841s | Train Loss: 0.091422 |
2020-05-21 07:49:17,115 - root - INFO - | Epoch: 097/150 | Train Time: 1.761s | Train Loss: 0.096055 |
2020-05-21 07:49:18,765 - root - INFO - | Epoch: 098/150 | Train Time: 1.650s | Train Loss: 0.097297 |
2020-05-21 07:49:20,448 - root - INFO - | Epoch: 099/150 | Train Time: 1.682s | Train Loss: 0.093192 |
2020-05-21 07:49:21,960 - root - INFO - | Epoch: 100/150 | Train Time: 1.510s | Train Loss: 0.093230 |
2020-05-21 07:49:23,274 - root - INFO - | Epoch: 101/150 | Train Time: 1.313s | Train Loss: 0.093714 |
2020-05-21 07:49:25,012 - root - INFO - | Epoch: 102/150 | Train Time: 1.737s | Train Loss: 0.089791 |
2020-05-21 07:49:26,636 - root - INFO - | Epoch: 103/150 | Train Time: 1.624s | Train Loss: 0.093633 |
2020-05-21 07:49:28,133 - root - INFO - | Epoch: 104/150 | Train Time: 1.497s | Train Loss: 0.091769 |
2020-05-21 07:49:29,919 - root - INFO - | Epoch: 105/150 | Train Time: 1.785s | Train Loss: 0.093142 |
2020-05-21 07:49:31,576 - root - INFO - | Epoch: 106/150 | Train Time: 1.656s | Train Loss: 0.095855 |
2020-05-21 07:49:32,868 - root - INFO - | Epoch: 107/150 | Train Time: 1.291s | Train Loss: 0.091449 |
2020-05-21 07:49:34,317 - root - INFO - | Epoch: 108/150 | Train Time: 1.449s | Train Loss: 0.090656 |
2020-05-21 07:49:35,836 - root - INFO - | Epoch: 109/150 | Train Time: 1.518s | Train Loss: 0.090523 |
2020-05-21 07:49:37,231 - root - INFO - | Epoch: 110/150 | Train Time: 1.395s | Train Loss: 0.090504 |
2020-05-21 07:49:38,663 - root - INFO - | Epoch: 111/150 | Train Time: 1.432s | Train Loss: 0.089548 |
2020-05-21 07:49:40,031 - root - INFO - | Epoch: 112/150 | Train Time: 1.367s | Train Loss: 0.092600 |
2020-05-21 07:49:41,703 - root - INFO - | Epoch: 113/150 | Train Time: 1.671s | Train Loss: 0.088694 |
2020-05-21 07:49:43,284 - root - INFO - | Epoch: 114/150 | Train Time: 1.581s | Train Loss: 0.091196 |
2020-05-21 07:49:44,515 - root - INFO - | Epoch: 115/150 | Train Time: 1.231s | Train Loss: 0.095450 |
2020-05-21 07:49:46,287 - root - INFO - | Epoch: 116/150 | Train Time: 1.771s | Train Loss: 0.088975 |
2020-05-21 07:49:47,797 - root - INFO - | Epoch: 117/150 | Train Time: 1.510s | Train Loss: 0.092178 |
2020-05-21 07:49:49,378 - root - INFO - | Epoch: 118/150 | Train Time: 1.581s | Train Loss: 0.089728 |
2020-05-21 07:49:51,221 - root - INFO - | Epoch: 119/150 | Train Time: 1.842s | Train Loss: 0.094343 |
2020-05-21 07:49:53,094 - root - INFO - | Epoch: 120/150 | Train Time: 1.872s | Train Loss: 0.090001 |
2020-05-21 07:49:55,018 - root - INFO - | Epoch: 121/150 | Train Time: 1.924s | Train Loss: 0.088310 |
2020-05-21 07:49:56,535 - root - INFO - | Epoch: 122/150 | Train Time: 1.517s | Train Loss: 0.089832 |
2020-05-21 07:49:58,341 - root - INFO - | Epoch: 123/150 | Train Time: 1.806s | Train Loss: 0.089667 |
2020-05-21 07:49:59,687 - root - INFO - | Epoch: 124/150 | Train Time: 1.346s | Train Loss: 0.090756 |
2020-05-21 07:50:01,252 - root - INFO - | Epoch: 125/150 | Train Time: 1.564s | Train Loss: 0.094150 |
2020-05-21 07:50:02,904 - root - INFO - | Epoch: 126/150 | Train Time: 1.651s | Train Loss: 0.092805 |
2020-05-21 07:50:04,304 - root - INFO - | Epoch: 127/150 | Train Time: 1.400s | Train Loss: 0.093536 |
2020-05-21 07:50:05,748 - root - INFO - | Epoch: 128/150 | Train Time: 1.443s | Train Loss: 0.087340 |
2020-05-21 07:50:07,173 - root - INFO - | Epoch: 129/150 | Train Time: 1.424s | Train Loss: 0.088953 |
2020-05-21 07:50:08,893 - root - INFO - | Epoch: 130/150 | Train Time: 1.720s | Train Loss: 0.087664 |
2020-05-21 07:50:11,348 - root - INFO - | Epoch: 131/150 | Train Time: 2.455s | Train Loss: 0.092149 |
2020-05-21 07:50:12,975 - root - INFO - | Epoch: 132/150 | Train Time: 1.625s | Train Loss: 0.089919 |
2020-05-21 07:50:14,766 - root - INFO - | Epoch: 133/150 | Train Time: 1.791s | Train Loss: 0.093982 |
2020-05-21 07:50:16,304 - root - INFO - | Epoch: 134/150 | Train Time: 1.538s | Train Loss: 0.090120 |
2020-05-21 07:50:17,594 - root - INFO - | Epoch: 135/150 | Train Time: 1.289s | Train Loss: 0.088829 |
2020-05-21 07:50:19,335 - root - INFO - | Epoch: 136/150 | Train Time: 1.741s | Train Loss: 0.087268 |
2020-05-21 07:50:20,825 - root - INFO - | Epoch: 137/150 | Train Time: 1.489s | Train Loss: 0.089373 |
2020-05-21 07:50:22,309 - root - INFO - | Epoch: 138/150 | Train Time: 1.484s | Train Loss: 0.090745 |
2020-05-21 07:50:23,775 - root - INFO - | Epoch: 139/150 | Train Time: 1.466s | Train Loss: 0.090259 |
2020-05-21 07:50:25,263 - root - INFO - | Epoch: 140/150 | Train Time: 1.486s | Train Loss: 0.092029 |
2020-05-21 07:50:26,435 - root - INFO - | Epoch: 141/150 | Train Time: 1.171s | Train Loss: 0.089061 |
2020-05-21 07:50:27,666 - root - INFO - | Epoch: 142/150 | Train Time: 1.231s | Train Loss: 0.090337 |
2020-05-21 07:50:28,837 - root - INFO - | Epoch: 143/150 | Train Time: 1.171s | Train Loss: 0.084818 |
2020-05-21 07:50:30,435 - root - INFO - | Epoch: 144/150 | Train Time: 1.598s | Train Loss: 0.088605 |
2020-05-21 07:50:31,926 - root - INFO - | Epoch: 145/150 | Train Time: 1.490s | Train Loss: 0.087526 |
2020-05-21 07:50:33,693 - root - INFO - | Epoch: 146/150 | Train Time: 1.767s | Train Loss: 0.089103 |
2020-05-21 07:50:35,386 - root - INFO - | Epoch: 147/150 | Train Time: 1.693s | Train Loss: 0.089906 |
2020-05-21 07:50:37,035 - root - INFO - | Epoch: 148/150 | Train Time: 1.649s | Train Loss: 0.084571 |
2020-05-21 07:50:38,744 - root - INFO - | Epoch: 149/150 | Train Time: 1.709s | Train Loss: 0.087158 |
2020-05-21 07:50:40,330 - root - INFO - | Epoch: 150/150 | Train Time: 1.585s | Train Loss: 0.086180 |
2020-05-21 07:50:40,330 - root - INFO - Training Time: 240.041s
2020-05-21 07:50:40,330 - root - INFO - Finished training.
2020-05-21 07:50:40,331 - root - INFO - Starting testing...
2020-05-21 07:50:42,173 - root - INFO - Test Loss: 0.400094
2020-05-21 07:50:42,173 - root - INFO - Test AUC: 86.39%
2020-05-21 07:50:42,173 - root - INFO - Test Time: 1.818s
2020-05-21 07:50:42,173 - root - INFO - Finished testing.
