2020-05-21 08:27:59,276 - root - INFO - Log file is ../log/fmnist/scenario_5/deepSAD/log_5_8_512.txt
2020-05-21 08:27:59,277 - root - INFO - Data path is ../data
2020-05-21 08:27:59,277 - root - INFO - Export path is ../log/fmnist/scenario_5/deepSAD
2020-05-21 08:27:59,277 - root - INFO - Dataset: fmnist
2020-05-21 08:27:59,277 - root - INFO - Normal class: 5
2020-05-21 08:27:59,277 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-21 08:27:59,277 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-21 08:27:59,277 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-21 08:27:59,277 - root - INFO - Scenario Running: 5
2020-05-21 08:27:59,277 - root - INFO - Train only the network: True
2020-05-21 08:27:59,277 - root - INFO - Output and AE dimensions: 512
2020-05-21 08:27:59,278 - root - INFO - Known anomaly class: 8
2020-05-21 08:27:59,278 - root - INFO - Network: fmnist_LeNet
2020-05-21 08:27:59,278 - root - INFO - Eta-parameter: 1.00
2020-05-21 08:27:59,288 - root - INFO - Set seed to 0.
2020-05-21 08:27:59,362 - root - INFO - Computation device: cuda
2020-05-21 08:27:59,362 - root - INFO - Number of threads: 0
2020-05-21 08:27:59,363 - root - INFO - Number of dataloader workers: 6
2020-05-21 08:28:05,117 - root - INFO - Loading model from ../log/fmnist/scenario_5/deepSAD/model_0_1_512.tar.
2020-05-21 08:28:05,117 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-21 08:28:05,118 - root - INFO - Pretraining: True
2020-05-21 08:28:05,118 - root - INFO - Training optimizer: adam
2020-05-21 08:28:05,118 - root - INFO - Training learning rate: 0.0001
2020-05-21 08:28:05,118 - root - INFO - Training epochs: 150
2020-05-21 08:28:05,118 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-21 08:28:05,118 - root - INFO - Training batch size: 200
2020-05-21 08:28:05,118 - root - INFO - Training weight decay: 5e-07
2020-05-21 08:28:05,123 - root - INFO - Starting training...
2020-05-21 08:28:08,786 - root - INFO - | Epoch: 001/150 | Train Time: 3.663s | Train Loss: 1.031638 |
2020-05-21 08:28:10,110 - root - INFO - | Epoch: 002/150 | Train Time: 1.323s | Train Loss: 0.462034 |
2020-05-21 08:28:11,591 - root - INFO - | Epoch: 003/150 | Train Time: 1.480s | Train Loss: 0.339700 |
2020-05-21 08:28:13,325 - root - INFO - | Epoch: 004/150 | Train Time: 1.734s | Train Loss: 0.277846 |
2020-05-21 08:28:14,924 - root - INFO - | Epoch: 005/150 | Train Time: 1.598s | Train Loss: 0.244639 |
2020-05-21 08:28:16,750 - root - INFO - | Epoch: 006/150 | Train Time: 1.825s | Train Loss: 0.222971 |
2020-05-21 08:28:18,263 - root - INFO - | Epoch: 007/150 | Train Time: 1.513s | Train Loss: 0.199092 |
2020-05-21 08:28:20,117 - root - INFO - | Epoch: 008/150 | Train Time: 1.853s | Train Loss: 0.192288 |
2020-05-21 08:28:21,611 - root - INFO - | Epoch: 009/150 | Train Time: 1.493s | Train Loss: 0.178424 |
2020-05-21 08:28:23,523 - root - INFO - | Epoch: 010/150 | Train Time: 1.912s | Train Loss: 0.167006 |
2020-05-21 08:28:25,172 - root - INFO - | Epoch: 011/150 | Train Time: 1.649s | Train Loss: 0.157460 |
2020-05-21 08:28:27,161 - root - INFO - | Epoch: 012/150 | Train Time: 1.989s | Train Loss: 0.156152 |
2020-05-21 08:28:28,878 - root - INFO - | Epoch: 013/150 | Train Time: 1.717s | Train Loss: 0.153411 |
2020-05-21 08:28:30,650 - root - INFO - | Epoch: 014/150 | Train Time: 1.772s | Train Loss: 0.144718 |
2020-05-21 08:28:32,243 - root - INFO - | Epoch: 015/150 | Train Time: 1.592s | Train Loss: 0.132002 |
2020-05-21 08:28:33,859 - root - INFO - | Epoch: 016/150 | Train Time: 1.615s | Train Loss: 0.134200 |
2020-05-21 08:28:35,600 - root - INFO - | Epoch: 017/150 | Train Time: 1.740s | Train Loss: 0.130827 |
2020-05-21 08:28:37,274 - root - INFO - | Epoch: 018/150 | Train Time: 1.674s | Train Loss: 0.125589 |
2020-05-21 08:28:38,613 - root - INFO - | Epoch: 019/150 | Train Time: 1.338s | Train Loss: 0.121529 |
2020-05-21 08:28:39,946 - root - INFO - | Epoch: 020/150 | Train Time: 1.332s | Train Loss: 0.125434 |
2020-05-21 08:28:41,372 - root - INFO - | Epoch: 021/150 | Train Time: 1.426s | Train Loss: 0.123341 |
2020-05-21 08:28:42,870 - root - INFO - | Epoch: 022/150 | Train Time: 1.497s | Train Loss: 0.114583 |
2020-05-21 08:28:44,246 - root - INFO - | Epoch: 023/150 | Train Time: 1.376s | Train Loss: 0.112199 |
2020-05-21 08:28:45,463 - root - INFO - | Epoch: 024/150 | Train Time: 1.216s | Train Loss: 0.111604 |
2020-05-21 08:28:46,590 - root - INFO - | Epoch: 025/150 | Train Time: 1.127s | Train Loss: 0.107167 |
2020-05-21 08:28:47,807 - root - INFO - | Epoch: 026/150 | Train Time: 1.216s | Train Loss: 0.106396 |
2020-05-21 08:28:49,163 - root - INFO - | Epoch: 027/150 | Train Time: 1.356s | Train Loss: 0.113839 |
2020-05-21 08:28:50,438 - root - INFO - | Epoch: 028/150 | Train Time: 1.274s | Train Loss: 0.106648 |
2020-05-21 08:28:51,582 - root - INFO - | Epoch: 029/150 | Train Time: 1.143s | Train Loss: 0.102257 |
2020-05-21 08:28:52,528 - root - INFO - | Epoch: 030/150 | Train Time: 0.946s | Train Loss: 0.102834 |
2020-05-21 08:28:53,250 - root - INFO - | Epoch: 031/150 | Train Time: 0.722s | Train Loss: 0.107087 |
2020-05-21 08:28:54,607 - root - INFO - | Epoch: 032/150 | Train Time: 1.357s | Train Loss: 0.102913 |
2020-05-21 08:28:55,667 - root - INFO - | Epoch: 033/150 | Train Time: 1.059s | Train Loss: 0.105148 |
2020-05-21 08:28:56,931 - root - INFO - | Epoch: 034/150 | Train Time: 1.263s | Train Loss: 0.096033 |
2020-05-21 08:28:58,156 - root - INFO - | Epoch: 035/150 | Train Time: 1.225s | Train Loss: 0.099149 |
2020-05-21 08:28:59,598 - root - INFO - | Epoch: 036/150 | Train Time: 1.441s | Train Loss: 0.095550 |
2020-05-21 08:29:00,763 - root - INFO - | Epoch: 037/150 | Train Time: 1.165s | Train Loss: 0.093603 |
2020-05-21 08:29:02,031 - root - INFO - | Epoch: 038/150 | Train Time: 1.267s | Train Loss: 0.097663 |
2020-05-21 08:29:03,206 - root - INFO - | Epoch: 039/150 | Train Time: 1.174s | Train Loss: 0.093607 |
2020-05-21 08:29:04,329 - root - INFO - | Epoch: 040/150 | Train Time: 1.122s | Train Loss: 0.096428 |
2020-05-21 08:29:05,484 - root - INFO - | Epoch: 041/150 | Train Time: 1.154s | Train Loss: 0.092611 |
2020-05-21 08:29:06,698 - root - INFO - | Epoch: 042/150 | Train Time: 1.214s | Train Loss: 0.088189 |
2020-05-21 08:29:07,929 - root - INFO - | Epoch: 043/150 | Train Time: 1.231s | Train Loss: 0.091615 |
2020-05-21 08:29:09,307 - root - INFO - | Epoch: 044/150 | Train Time: 1.377s | Train Loss: 0.089347 |
2020-05-21 08:29:10,650 - root - INFO - | Epoch: 045/150 | Train Time: 1.343s | Train Loss: 0.087317 |
2020-05-21 08:29:12,136 - root - INFO - | Epoch: 046/150 | Train Time: 1.485s | Train Loss: 0.093043 |
2020-05-21 08:29:13,600 - root - INFO - | Epoch: 047/150 | Train Time: 1.464s | Train Loss: 0.092662 |
2020-05-21 08:29:14,993 - root - INFO - | Epoch: 048/150 | Train Time: 1.392s | Train Loss: 0.089757 |
2020-05-21 08:29:16,573 - root - INFO - | Epoch: 049/150 | Train Time: 1.580s | Train Loss: 0.087675 |
2020-05-21 08:29:18,062 - root - INFO - | Epoch: 050/150 | Train Time: 1.489s | Train Loss: 0.080028 |
2020-05-21 08:29:18,063 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-21 08:29:19,761 - root - INFO - | Epoch: 051/150 | Train Time: 1.697s | Train Loss: 0.078180 |
2020-05-21 08:29:21,199 - root - INFO - | Epoch: 052/150 | Train Time: 1.438s | Train Loss: 0.077542 |
2020-05-21 08:29:22,804 - root - INFO - | Epoch: 053/150 | Train Time: 1.604s | Train Loss: 0.080568 |
2020-05-21 08:29:24,543 - root - INFO - | Epoch: 054/150 | Train Time: 1.739s | Train Loss: 0.078875 |
2020-05-21 08:29:25,799 - root - INFO - | Epoch: 055/150 | Train Time: 1.255s | Train Loss: 0.081356 |
2020-05-21 08:29:27,413 - root - INFO - | Epoch: 056/150 | Train Time: 1.613s | Train Loss: 0.080362 |
2020-05-21 08:29:29,063 - root - INFO - | Epoch: 057/150 | Train Time: 1.650s | Train Loss: 0.077670 |
2020-05-21 08:29:30,633 - root - INFO - | Epoch: 058/150 | Train Time: 1.569s | Train Loss: 0.083947 |
2020-05-21 08:29:31,996 - root - INFO - | Epoch: 059/150 | Train Time: 1.363s | Train Loss: 0.081847 |
2020-05-21 08:29:33,562 - root - INFO - | Epoch: 060/150 | Train Time: 1.566s | Train Loss: 0.080709 |
2020-05-21 08:29:35,299 - root - INFO - | Epoch: 061/150 | Train Time: 1.736s | Train Loss: 0.080105 |
2020-05-21 08:29:37,083 - root - INFO - | Epoch: 062/150 | Train Time: 1.784s | Train Loss: 0.079708 |
2020-05-21 08:29:38,422 - root - INFO - | Epoch: 063/150 | Train Time: 1.338s | Train Loss: 0.077246 |
2020-05-21 08:29:40,009 - root - INFO - | Epoch: 064/150 | Train Time: 1.586s | Train Loss: 0.079507 |
2020-05-21 08:29:41,470 - root - INFO - | Epoch: 065/150 | Train Time: 1.460s | Train Loss: 0.080073 |
2020-05-21 08:29:43,110 - root - INFO - | Epoch: 066/150 | Train Time: 1.640s | Train Loss: 0.079320 |
2020-05-21 08:29:44,630 - root - INFO - | Epoch: 067/150 | Train Time: 1.519s | Train Loss: 0.077799 |
2020-05-21 08:29:46,300 - root - INFO - | Epoch: 068/150 | Train Time: 1.670s | Train Loss: 0.078276 |
2020-05-21 08:29:47,818 - root - INFO - | Epoch: 069/150 | Train Time: 1.517s | Train Loss: 0.081409 |
2020-05-21 08:29:49,626 - root - INFO - | Epoch: 070/150 | Train Time: 1.807s | Train Loss: 0.078067 |
2020-05-21 08:29:51,026 - root - INFO - | Epoch: 071/150 | Train Time: 1.400s | Train Loss: 0.079563 |
2020-05-21 08:29:52,482 - root - INFO - | Epoch: 072/150 | Train Time: 1.455s | Train Loss: 0.079903 |
2020-05-21 08:29:54,151 - root - INFO - | Epoch: 073/150 | Train Time: 1.669s | Train Loss: 0.082514 |
2020-05-21 08:29:55,785 - root - INFO - | Epoch: 074/150 | Train Time: 1.633s | Train Loss: 0.077400 |
2020-05-21 08:29:57,185 - root - INFO - | Epoch: 075/150 | Train Time: 1.400s | Train Loss: 0.077993 |
2020-05-21 08:29:58,521 - root - INFO - | Epoch: 076/150 | Train Time: 1.335s | Train Loss: 0.080159 |
2020-05-21 08:29:59,957 - root - INFO - | Epoch: 077/150 | Train Time: 1.435s | Train Loss: 0.078409 |
2020-05-21 08:30:01,242 - root - INFO - | Epoch: 078/150 | Train Time: 1.285s | Train Loss: 0.078352 |
2020-05-21 08:30:02,840 - root - INFO - | Epoch: 079/150 | Train Time: 1.597s | Train Loss: 0.075853 |
2020-05-21 08:30:04,732 - root - INFO - | Epoch: 080/150 | Train Time: 1.891s | Train Loss: 0.083538 |
2020-05-21 08:30:06,369 - root - INFO - | Epoch: 081/150 | Train Time: 1.636s | Train Loss: 0.078056 |
2020-05-21 08:30:08,033 - root - INFO - | Epoch: 082/150 | Train Time: 1.664s | Train Loss: 0.079642 |
2020-05-21 08:30:09,908 - root - INFO - | Epoch: 083/150 | Train Time: 1.875s | Train Loss: 0.078840 |
2020-05-21 08:30:11,555 - root - INFO - | Epoch: 084/150 | Train Time: 1.646s | Train Loss: 0.077399 |
2020-05-21 08:30:13,171 - root - INFO - | Epoch: 085/150 | Train Time: 1.615s | Train Loss: 0.077753 |
2020-05-21 08:30:14,547 - root - INFO - | Epoch: 086/150 | Train Time: 1.376s | Train Loss: 0.076240 |
2020-05-21 08:30:16,451 - root - INFO - | Epoch: 087/150 | Train Time: 1.904s | Train Loss: 0.081676 |
2020-05-21 08:30:17,707 - root - INFO - | Epoch: 088/150 | Train Time: 1.255s | Train Loss: 0.078013 |
2020-05-21 08:30:19,309 - root - INFO - | Epoch: 089/150 | Train Time: 1.601s | Train Loss: 0.077888 |
2020-05-21 08:30:20,239 - root - INFO - | Epoch: 090/150 | Train Time: 0.930s | Train Loss: 0.076767 |
2020-05-21 08:30:21,301 - root - INFO - | Epoch: 091/150 | Train Time: 1.061s | Train Loss: 0.077571 |
2020-05-21 08:30:22,666 - root - INFO - | Epoch: 092/150 | Train Time: 1.364s | Train Loss: 0.082617 |
2020-05-21 08:30:23,798 - root - INFO - | Epoch: 093/150 | Train Time: 1.132s | Train Loss: 0.077606 |
2020-05-21 08:30:25,255 - root - INFO - | Epoch: 094/150 | Train Time: 1.456s | Train Loss: 0.076577 |
2020-05-21 08:30:26,882 - root - INFO - | Epoch: 095/150 | Train Time: 1.626s | Train Loss: 0.076954 |
2020-05-21 08:30:28,399 - root - INFO - | Epoch: 096/150 | Train Time: 1.517s | Train Loss: 0.076034 |
2020-05-21 08:30:29,887 - root - INFO - | Epoch: 097/150 | Train Time: 1.487s | Train Loss: 0.080221 |
2020-05-21 08:30:31,452 - root - INFO - | Epoch: 098/150 | Train Time: 1.565s | Train Loss: 0.078925 |
2020-05-21 08:30:33,066 - root - INFO - | Epoch: 099/150 | Train Time: 1.614s | Train Loss: 0.078220 |
2020-05-21 08:30:34,402 - root - INFO - | Epoch: 100/150 | Train Time: 1.335s | Train Loss: 0.079818 |
2020-05-21 08:30:35,901 - root - INFO - | Epoch: 101/150 | Train Time: 1.498s | Train Loss: 0.078366 |
2020-05-21 08:30:37,374 - root - INFO - | Epoch: 102/150 | Train Time: 1.472s | Train Loss: 0.075984 |
2020-05-21 08:30:39,032 - root - INFO - | Epoch: 103/150 | Train Time: 1.658s | Train Loss: 0.074684 |
2020-05-21 08:30:40,656 - root - INFO - | Epoch: 104/150 | Train Time: 1.624s | Train Loss: 0.077070 |
2020-05-21 08:30:42,250 - root - INFO - | Epoch: 105/150 | Train Time: 1.594s | Train Loss: 0.074718 |
2020-05-21 08:30:44,119 - root - INFO - | Epoch: 106/150 | Train Time: 1.868s | Train Loss: 0.081302 |
2020-05-21 08:30:46,231 - root - INFO - | Epoch: 107/150 | Train Time: 2.111s | Train Loss: 0.076216 |
2020-05-21 08:30:47,826 - root - INFO - | Epoch: 108/150 | Train Time: 1.595s | Train Loss: 0.075803 |
2020-05-21 08:30:49,038 - root - INFO - | Epoch: 109/150 | Train Time: 1.212s | Train Loss: 0.074691 |
2020-05-21 08:30:50,595 - root - INFO - | Epoch: 110/150 | Train Time: 1.556s | Train Loss: 0.075144 |
2020-05-21 08:30:52,138 - root - INFO - | Epoch: 111/150 | Train Time: 1.543s | Train Loss: 0.073663 |
2020-05-21 08:30:53,606 - root - INFO - | Epoch: 112/150 | Train Time: 1.467s | Train Loss: 0.077267 |
2020-05-21 08:30:55,486 - root - INFO - | Epoch: 113/150 | Train Time: 1.880s | Train Loss: 0.076280 |
2020-05-21 08:30:57,300 - root - INFO - | Epoch: 114/150 | Train Time: 1.813s | Train Loss: 0.077181 |
2020-05-21 08:30:58,762 - root - INFO - | Epoch: 115/150 | Train Time: 1.461s | Train Loss: 0.079937 |
2020-05-21 08:31:00,049 - root - INFO - | Epoch: 116/150 | Train Time: 1.286s | Train Loss: 0.073026 |
2020-05-21 08:31:01,611 - root - INFO - | Epoch: 117/150 | Train Time: 1.561s | Train Loss: 0.078457 |
2020-05-21 08:31:02,821 - root - INFO - | Epoch: 118/150 | Train Time: 1.210s | Train Loss: 0.076181 |
2020-05-21 08:31:04,031 - root - INFO - | Epoch: 119/150 | Train Time: 1.209s | Train Loss: 0.077246 |
2020-05-21 08:31:05,454 - root - INFO - | Epoch: 120/150 | Train Time: 1.422s | Train Loss: 0.074751 |
2020-05-21 08:31:06,810 - root - INFO - | Epoch: 121/150 | Train Time: 1.356s | Train Loss: 0.073663 |
2020-05-21 08:31:08,362 - root - INFO - | Epoch: 122/150 | Train Time: 1.552s | Train Loss: 0.075512 |
2020-05-21 08:31:09,896 - root - INFO - | Epoch: 123/150 | Train Time: 1.533s | Train Loss: 0.076011 |
2020-05-21 08:31:11,612 - root - INFO - | Epoch: 124/150 | Train Time: 1.716s | Train Loss: 0.075841 |
2020-05-21 08:31:13,152 - root - INFO - | Epoch: 125/150 | Train Time: 1.539s | Train Loss: 0.080133 |
2020-05-21 08:31:14,823 - root - INFO - | Epoch: 126/150 | Train Time: 1.671s | Train Loss: 0.078371 |
2020-05-21 08:31:16,268 - root - INFO - | Epoch: 127/150 | Train Time: 1.444s | Train Loss: 0.074970 |
2020-05-21 08:31:17,796 - root - INFO - | Epoch: 128/150 | Train Time: 1.527s | Train Loss: 0.071864 |
2020-05-21 08:31:19,083 - root - INFO - | Epoch: 129/150 | Train Time: 1.286s | Train Loss: 0.075018 |
2020-05-21 08:31:20,854 - root - INFO - | Epoch: 130/150 | Train Time: 1.771s | Train Loss: 0.073351 |
2020-05-21 08:31:22,272 - root - INFO - | Epoch: 131/150 | Train Time: 1.418s | Train Loss: 0.076005 |
2020-05-21 08:31:23,123 - root - INFO - | Epoch: 132/150 | Train Time: 0.851s | Train Loss: 0.073787 |
2020-05-21 08:31:24,350 - root - INFO - | Epoch: 133/150 | Train Time: 1.227s | Train Loss: 0.076063 |
2020-05-21 08:31:25,864 - root - INFO - | Epoch: 134/150 | Train Time: 1.513s | Train Loss: 0.071996 |
2020-05-21 08:31:26,852 - root - INFO - | Epoch: 135/150 | Train Time: 0.988s | Train Loss: 0.075228 |
2020-05-21 08:31:27,854 - root - INFO - | Epoch: 136/150 | Train Time: 1.001s | Train Loss: 0.071359 |
2020-05-21 08:31:29,017 - root - INFO - | Epoch: 137/150 | Train Time: 1.163s | Train Loss: 0.077143 |
2020-05-21 08:31:30,584 - root - INFO - | Epoch: 138/150 | Train Time: 1.566s | Train Loss: 0.076665 |
2020-05-21 08:31:32,190 - root - INFO - | Epoch: 139/150 | Train Time: 1.606s | Train Loss: 0.074306 |
2020-05-21 08:31:33,796 - root - INFO - | Epoch: 140/150 | Train Time: 1.605s | Train Loss: 0.077446 |
2020-05-21 08:31:35,420 - root - INFO - | Epoch: 141/150 | Train Time: 1.623s | Train Loss: 0.075428 |
2020-05-21 08:31:37,090 - root - INFO - | Epoch: 142/150 | Train Time: 1.670s | Train Loss: 0.074723 |
2020-05-21 08:31:38,606 - root - INFO - | Epoch: 143/150 | Train Time: 1.515s | Train Loss: 0.070876 |
2020-05-21 08:31:40,040 - root - INFO - | Epoch: 144/150 | Train Time: 1.434s | Train Loss: 0.074220 |
2020-05-21 08:31:41,997 - root - INFO - | Epoch: 145/150 | Train Time: 1.956s | Train Loss: 0.073426 |
2020-05-21 08:31:43,878 - root - INFO - | Epoch: 146/150 | Train Time: 1.880s | Train Loss: 0.073524 |
2020-05-21 08:31:45,458 - root - INFO - | Epoch: 147/150 | Train Time: 1.580s | Train Loss: 0.075992 |
2020-05-21 08:31:46,922 - root - INFO - | Epoch: 148/150 | Train Time: 1.463s | Train Loss: 0.071952 |
2020-05-21 08:31:48,297 - root - INFO - | Epoch: 149/150 | Train Time: 1.375s | Train Loss: 0.073003 |
2020-05-21 08:31:49,569 - root - INFO - | Epoch: 150/150 | Train Time: 1.271s | Train Loss: 0.073058 |
2020-05-21 08:31:49,570 - root - INFO - Training Time: 224.447s
2020-05-21 08:31:49,570 - root - INFO - Finished training.
2020-05-21 08:31:49,571 - root - INFO - Starting testing...
2020-05-21 08:31:50,899 - root - INFO - Test Loss: 0.276802
2020-05-21 08:31:50,900 - root - INFO - Test AUC: 77.05%
2020-05-21 08:31:50,900 - root - INFO - Test Time: 1.316s
2020-05-21 08:31:50,900 - root - INFO - Finished testing.
