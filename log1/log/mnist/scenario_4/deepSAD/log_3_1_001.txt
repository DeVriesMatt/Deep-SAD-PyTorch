2020-05-15 16:19:39,073 - root - INFO - Log file is ../log/mnist/scenario_4/deepSAD//log_3_1_001.txt
2020-05-15 16:19:39,073 - root - INFO - Data path is ../data
2020-05-15 16:19:39,073 - root - INFO - Export path is ../log/mnist/scenario_4/deepSAD/
2020-05-15 16:19:39,073 - root - INFO - Dataset: mnist
2020-05-15 16:19:39,073 - root - INFO - Normal class: 3
2020-05-15 16:19:39,074 - root - INFO - Ratio of labeled normal train samples: 0.00
2020-05-15 16:19:39,074 - root - INFO - Ratio of labeled anomalous samples: 0.05
2020-05-15 16:19:39,074 - root - INFO - Pollution ratio of unlabeled train data: 0.10
2020-05-15 16:19:39,074 - root - INFO - Scenario Running: 4
2020-05-15 16:19:39,074 - root - INFO - Train only the network: True
2020-05-15 16:19:39,074 - root - INFO - Output and AE dimensions: 128
2020-05-15 16:19:39,074 - root - INFO - Known anomaly class: 1
2020-05-15 16:19:39,074 - root - INFO - Network: mnist_LeNet
2020-05-15 16:19:39,074 - root - INFO - Eta-parameter: 0.01
2020-05-15 16:19:39,097 - root - INFO - Set seed to 0.
2020-05-15 16:19:39,116 - root - INFO - Computation device: cuda
2020-05-15 16:19:39,117 - root - INFO - Number of threads: 0
2020-05-15 16:19:39,117 - root - INFO - Number of dataloader workers: 6
2020-05-15 16:19:42,840 - root - INFO - Loading model from ../log/mnist/model_0_1_16.tar.
2020-05-15 16:19:42,841 - root - INFO - Pretrain skipped... Load weights from pretrained AE
2020-05-15 16:19:42,841 - root - INFO - Training optimizer: adam
2020-05-15 16:19:42,841 - root - INFO - Training learning rate: 0.0001
2020-05-15 16:19:42,841 - root - INFO - Training epochs: 150
2020-05-15 16:19:42,841 - root - INFO - Training learning rate scheduler milestones: (50,)
2020-05-15 16:19:42,841 - root - INFO - Training batch size: 200
2020-05-15 16:19:42,841 - root - INFO - Training weight decay: 5e-07
2020-05-15 16:19:42,842 - root - INFO - Starting training...
2020-05-15 16:19:46,996 - root - INFO - | Epoch: 001/150 | Train Time: 4.138s | Train Loss: 0.101633 |
2020-05-15 16:19:48,684 - root - INFO - | Epoch: 002/150 | Train Time: 1.688s | Train Loss: 0.065003 |
2020-05-15 16:19:50,289 - root - INFO - | Epoch: 003/150 | Train Time: 1.604s | Train Loss: 0.051310 |
2020-05-15 16:19:52,020 - root - INFO - | Epoch: 004/150 | Train Time: 1.731s | Train Loss: 0.043196 |
2020-05-15 16:19:53,848 - root - INFO - | Epoch: 005/150 | Train Time: 1.828s | Train Loss: 0.038001 |
2020-05-15 16:19:55,555 - root - INFO - | Epoch: 006/150 | Train Time: 1.707s | Train Loss: 0.034257 |
2020-05-15 16:19:57,450 - root - INFO - | Epoch: 007/150 | Train Time: 1.895s | Train Loss: 0.031415 |
2020-05-15 16:19:59,038 - root - INFO - | Epoch: 008/150 | Train Time: 1.587s | Train Loss: 0.029124 |
2020-05-15 16:20:00,617 - root - INFO - | Epoch: 009/150 | Train Time: 1.579s | Train Loss: 0.027238 |
2020-05-15 16:20:02,225 - root - INFO - | Epoch: 010/150 | Train Time: 1.607s | Train Loss: 0.025582 |
2020-05-15 16:20:03,720 - root - INFO - | Epoch: 011/150 | Train Time: 1.494s | Train Loss: 0.024356 |
2020-05-15 16:20:05,366 - root - INFO - | Epoch: 012/150 | Train Time: 1.646s | Train Loss: 0.023246 |
2020-05-15 16:20:06,979 - root - INFO - | Epoch: 013/150 | Train Time: 1.612s | Train Loss: 0.022200 |
2020-05-15 16:20:08,852 - root - INFO - | Epoch: 014/150 | Train Time: 1.873s | Train Loss: 0.021221 |
2020-05-15 16:20:10,475 - root - INFO - | Epoch: 015/150 | Train Time: 1.622s | Train Loss: 0.020638 |
2020-05-15 16:20:11,808 - root - INFO - | Epoch: 016/150 | Train Time: 1.333s | Train Loss: 0.019803 |
2020-05-15 16:20:13,443 - root - INFO - | Epoch: 017/150 | Train Time: 1.635s | Train Loss: 0.019168 |
2020-05-15 16:20:14,760 - root - INFO - | Epoch: 018/150 | Train Time: 1.309s | Train Loss: 0.018621 |
2020-05-15 16:20:16,025 - root - INFO - | Epoch: 019/150 | Train Time: 1.264s | Train Loss: 0.018027 |
2020-05-15 16:20:17,401 - root - INFO - | Epoch: 020/150 | Train Time: 1.375s | Train Loss: 0.017527 |
2020-05-15 16:20:19,233 - root - INFO - | Epoch: 021/150 | Train Time: 1.831s | Train Loss: 0.017068 |
2020-05-15 16:20:20,867 - root - INFO - | Epoch: 022/150 | Train Time: 1.634s | Train Loss: 0.016813 |
2020-05-15 16:20:22,357 - root - INFO - | Epoch: 023/150 | Train Time: 1.489s | Train Loss: 0.016365 |
2020-05-15 16:20:23,995 - root - INFO - | Epoch: 024/150 | Train Time: 1.637s | Train Loss: 0.015958 |
2020-05-15 16:20:25,506 - root - INFO - | Epoch: 025/150 | Train Time: 1.510s | Train Loss: 0.015609 |
2020-05-15 16:20:27,377 - root - INFO - | Epoch: 026/150 | Train Time: 1.871s | Train Loss: 0.015268 |
2020-05-15 16:20:29,284 - root - INFO - | Epoch: 027/150 | Train Time: 1.906s | Train Loss: 0.015074 |
2020-05-15 16:20:30,860 - root - INFO - | Epoch: 028/150 | Train Time: 1.575s | Train Loss: 0.014736 |
2020-05-15 16:20:32,532 - root - INFO - | Epoch: 029/150 | Train Time: 1.672s | Train Loss: 0.014497 |
2020-05-15 16:20:34,358 - root - INFO - | Epoch: 030/150 | Train Time: 1.825s | Train Loss: 0.014262 |
2020-05-15 16:20:35,894 - root - INFO - | Epoch: 031/150 | Train Time: 1.535s | Train Loss: 0.014022 |
2020-05-15 16:20:37,864 - root - INFO - | Epoch: 032/150 | Train Time: 1.970s | Train Loss: 0.013691 |
2020-05-15 16:20:39,932 - root - INFO - | Epoch: 033/150 | Train Time: 2.067s | Train Loss: 0.013546 |
2020-05-15 16:20:41,508 - root - INFO - | Epoch: 034/150 | Train Time: 1.575s | Train Loss: 0.013316 |
2020-05-15 16:20:43,146 - root - INFO - | Epoch: 035/150 | Train Time: 1.638s | Train Loss: 0.013091 |
2020-05-15 16:20:44,967 - root - INFO - | Epoch: 036/150 | Train Time: 1.820s | Train Loss: 0.012925 |
2020-05-15 16:20:46,422 - root - INFO - | Epoch: 037/150 | Train Time: 1.455s | Train Loss: 0.012860 |
2020-05-15 16:20:48,211 - root - INFO - | Epoch: 038/150 | Train Time: 1.788s | Train Loss: 0.012585 |
2020-05-15 16:20:49,850 - root - INFO - | Epoch: 039/150 | Train Time: 1.638s | Train Loss: 0.012411 |
2020-05-15 16:20:51,773 - root - INFO - | Epoch: 040/150 | Train Time: 1.923s | Train Loss: 0.012269 |
2020-05-15 16:20:53,363 - root - INFO - | Epoch: 041/150 | Train Time: 1.589s | Train Loss: 0.012074 |
2020-05-15 16:20:55,224 - root - INFO - | Epoch: 042/150 | Train Time: 1.860s | Train Loss: 0.011968 |
2020-05-15 16:20:56,971 - root - INFO - | Epoch: 043/150 | Train Time: 1.747s | Train Loss: 0.011874 |
2020-05-15 16:20:58,814 - root - INFO - | Epoch: 044/150 | Train Time: 1.843s | Train Loss: 0.011719 |
2020-05-15 16:21:00,823 - root - INFO - | Epoch: 045/150 | Train Time: 2.008s | Train Loss: 0.011551 |
2020-05-15 16:21:02,536 - root - INFO - | Epoch: 046/150 | Train Time: 1.713s | Train Loss: 0.011546 |
2020-05-15 16:21:04,344 - root - INFO - | Epoch: 047/150 | Train Time: 1.807s | Train Loss: 0.011267 |
2020-05-15 16:21:06,107 - root - INFO - | Epoch: 048/150 | Train Time: 1.762s | Train Loss: 0.011209 |
2020-05-15 16:21:07,790 - root - INFO - | Epoch: 049/150 | Train Time: 1.683s | Train Loss: 0.010969 |
2020-05-15 16:21:09,788 - root - INFO - | Epoch: 050/150 | Train Time: 1.996s | Train Loss: 0.010804 |
2020-05-15 16:21:09,788 - root - INFO -   LR scheduler: new learning rate is 1e-05
2020-05-15 16:21:11,816 - root - INFO - | Epoch: 051/150 | Train Time: 2.028s | Train Loss: 0.010867 |
2020-05-15 16:21:13,469 - root - INFO - | Epoch: 052/150 | Train Time: 1.653s | Train Loss: 0.010871 |
2020-05-15 16:21:15,241 - root - INFO - | Epoch: 053/150 | Train Time: 1.771s | Train Loss: 0.010778 |
2020-05-15 16:21:16,553 - root - INFO - | Epoch: 054/150 | Train Time: 1.312s | Train Loss: 0.010807 |
2020-05-15 16:21:17,904 - root - INFO - | Epoch: 055/150 | Train Time: 1.350s | Train Loss: 0.010706 |
2020-05-15 16:21:19,215 - root - INFO - | Epoch: 056/150 | Train Time: 1.311s | Train Loss: 0.010834 |
2020-05-15 16:21:20,886 - root - INFO - | Epoch: 057/150 | Train Time: 1.669s | Train Loss: 0.010775 |
2020-05-15 16:21:22,571 - root - INFO - | Epoch: 058/150 | Train Time: 1.685s | Train Loss: 0.010751 |
2020-05-15 16:21:24,083 - root - INFO - | Epoch: 059/150 | Train Time: 1.512s | Train Loss: 0.010698 |
2020-05-15 16:21:25,514 - root - INFO - | Epoch: 060/150 | Train Time: 1.430s | Train Loss: 0.010715 |
2020-05-15 16:21:27,249 - root - INFO - | Epoch: 061/150 | Train Time: 1.735s | Train Loss: 0.010713 |
2020-05-15 16:21:29,011 - root - INFO - | Epoch: 062/150 | Train Time: 1.761s | Train Loss: 0.010646 |
2020-05-15 16:21:30,674 - root - INFO - | Epoch: 063/150 | Train Time: 1.663s | Train Loss: 0.010770 |
2020-05-15 16:21:32,591 - root - INFO - | Epoch: 064/150 | Train Time: 1.917s | Train Loss: 0.010746 |
2020-05-15 16:21:34,482 - root - INFO - | Epoch: 065/150 | Train Time: 1.891s | Train Loss: 0.010640 |
2020-05-15 16:21:36,441 - root - INFO - | Epoch: 066/150 | Train Time: 1.958s | Train Loss: 0.010646 |
2020-05-15 16:21:38,113 - root - INFO - | Epoch: 067/150 | Train Time: 1.671s | Train Loss: 0.010696 |
2020-05-15 16:21:39,778 - root - INFO - | Epoch: 068/150 | Train Time: 1.665s | Train Loss: 0.010661 |
2020-05-15 16:21:41,418 - root - INFO - | Epoch: 069/150 | Train Time: 1.639s | Train Loss: 0.010606 |
2020-05-15 16:21:43,328 - root - INFO - | Epoch: 070/150 | Train Time: 1.910s | Train Loss: 0.010566 |
2020-05-15 16:21:45,175 - root - INFO - | Epoch: 071/150 | Train Time: 1.846s | Train Loss: 0.010563 |
2020-05-15 16:21:46,705 - root - INFO - | Epoch: 072/150 | Train Time: 1.529s | Train Loss: 0.010558 |
2020-05-15 16:21:48,452 - root - INFO - | Epoch: 073/150 | Train Time: 1.746s | Train Loss: 0.010592 |
2020-05-15 16:21:50,235 - root - INFO - | Epoch: 074/150 | Train Time: 1.782s | Train Loss: 0.010550 |
2020-05-15 16:21:52,329 - root - INFO - | Epoch: 075/150 | Train Time: 2.094s | Train Loss: 0.010568 |
2020-05-15 16:21:54,177 - root - INFO - | Epoch: 076/150 | Train Time: 1.847s | Train Loss: 0.010508 |
2020-05-15 16:21:55,918 - root - INFO - | Epoch: 077/150 | Train Time: 1.740s | Train Loss: 0.010450 |
2020-05-15 16:21:57,932 - root - INFO - | Epoch: 078/150 | Train Time: 2.014s | Train Loss: 0.010510 |
2020-05-15 16:21:59,753 - root - INFO - | Epoch: 079/150 | Train Time: 1.821s | Train Loss: 0.010509 |
2020-05-15 16:22:01,646 - root - INFO - | Epoch: 080/150 | Train Time: 1.891s | Train Loss: 0.010425 |
2020-05-15 16:22:03,262 - root - INFO - | Epoch: 081/150 | Train Time: 1.615s | Train Loss: 0.010458 |
2020-05-15 16:22:05,226 - root - INFO - | Epoch: 082/150 | Train Time: 1.964s | Train Loss: 0.010422 |
2020-05-15 16:22:07,025 - root - INFO - | Epoch: 083/150 | Train Time: 1.798s | Train Loss: 0.010438 |
2020-05-15 16:22:08,625 - root - INFO - | Epoch: 084/150 | Train Time: 1.599s | Train Loss: 0.010448 |
2020-05-15 16:22:10,244 - root - INFO - | Epoch: 085/150 | Train Time: 1.619s | Train Loss: 0.010414 |
2020-05-15 16:22:12,035 - root - INFO - | Epoch: 086/150 | Train Time: 1.790s | Train Loss: 0.010341 |
2020-05-15 16:22:13,770 - root - INFO - | Epoch: 087/150 | Train Time: 1.734s | Train Loss: 0.010404 |
2020-05-15 16:22:15,665 - root - INFO - | Epoch: 088/150 | Train Time: 1.895s | Train Loss: 0.010356 |
2020-05-15 16:22:17,357 - root - INFO - | Epoch: 089/150 | Train Time: 1.692s | Train Loss: 0.010307 |
2020-05-15 16:22:19,101 - root - INFO - | Epoch: 090/150 | Train Time: 1.743s | Train Loss: 0.010311 |
2020-05-15 16:22:20,913 - root - INFO - | Epoch: 091/150 | Train Time: 1.811s | Train Loss: 0.010305 |
2020-05-15 16:22:22,815 - root - INFO - | Epoch: 092/150 | Train Time: 1.902s | Train Loss: 0.010302 |
2020-05-15 16:22:24,654 - root - INFO - | Epoch: 093/150 | Train Time: 1.838s | Train Loss: 0.010238 |
2020-05-15 16:22:26,601 - root - INFO - | Epoch: 094/150 | Train Time: 1.947s | Train Loss: 0.010285 |
2020-05-15 16:22:28,590 - root - INFO - | Epoch: 095/150 | Train Time: 1.989s | Train Loss: 0.010283 |
2020-05-15 16:22:30,247 - root - INFO - | Epoch: 096/150 | Train Time: 1.657s | Train Loss: 0.010330 |
2020-05-15 16:22:31,578 - root - INFO - | Epoch: 097/150 | Train Time: 1.330s | Train Loss: 0.010248 |
2020-05-15 16:22:32,899 - root - INFO - | Epoch: 098/150 | Train Time: 1.321s | Train Loss: 0.010305 |
2020-05-15 16:22:34,294 - root - INFO - | Epoch: 099/150 | Train Time: 1.394s | Train Loss: 0.010208 |
2020-05-15 16:22:35,660 - root - INFO - | Epoch: 100/150 | Train Time: 1.365s | Train Loss: 0.010224 |
2020-05-15 16:22:37,254 - root - INFO - | Epoch: 101/150 | Train Time: 1.594s | Train Loss: 0.010167 |
2020-05-15 16:22:38,891 - root - INFO - | Epoch: 102/150 | Train Time: 1.636s | Train Loss: 0.010250 |
2020-05-15 16:22:40,206 - root - INFO - | Epoch: 103/150 | Train Time: 1.315s | Train Loss: 0.010062 |
2020-05-15 16:22:41,398 - root - INFO - | Epoch: 104/150 | Train Time: 1.189s | Train Loss: 0.010098 |
2020-05-15 16:22:42,905 - root - INFO - | Epoch: 105/150 | Train Time: 1.506s | Train Loss: 0.010177 |
2020-05-15 16:22:44,929 - root - INFO - | Epoch: 106/150 | Train Time: 2.024s | Train Loss: 0.009990 |
2020-05-15 16:22:46,729 - root - INFO - | Epoch: 107/150 | Train Time: 1.799s | Train Loss: 0.010041 |
2020-05-15 16:22:48,524 - root - INFO - | Epoch: 108/150 | Train Time: 1.794s | Train Loss: 0.010132 |
2020-05-15 16:22:50,227 - root - INFO - | Epoch: 109/150 | Train Time: 1.702s | Train Loss: 0.009994 |
2020-05-15 16:22:51,922 - root - INFO - | Epoch: 110/150 | Train Time: 1.695s | Train Loss: 0.010138 |
2020-05-15 16:22:53,679 - root - INFO - | Epoch: 111/150 | Train Time: 1.756s | Train Loss: 0.009962 |
2020-05-15 16:22:55,539 - root - INFO - | Epoch: 112/150 | Train Time: 1.859s | Train Loss: 0.010027 |
2020-05-15 16:22:57,502 - root - INFO - | Epoch: 113/150 | Train Time: 1.962s | Train Loss: 0.010065 |
2020-05-15 16:22:59,301 - root - INFO - | Epoch: 114/150 | Train Time: 1.798s | Train Loss: 0.010027 |
2020-05-15 16:23:01,171 - root - INFO - | Epoch: 115/150 | Train Time: 1.870s | Train Loss: 0.010012 |
2020-05-15 16:23:02,851 - root - INFO - | Epoch: 116/150 | Train Time: 1.679s | Train Loss: 0.010004 |
2020-05-15 16:23:04,747 - root - INFO - | Epoch: 117/150 | Train Time: 1.895s | Train Loss: 0.009947 |
2020-05-15 16:23:06,502 - root - INFO - | Epoch: 118/150 | Train Time: 1.755s | Train Loss: 0.009945 |
2020-05-15 16:23:08,182 - root - INFO - | Epoch: 119/150 | Train Time: 1.679s | Train Loss: 0.009877 |
2020-05-15 16:23:10,152 - root - INFO - | Epoch: 120/150 | Train Time: 1.969s | Train Loss: 0.009924 |
2020-05-15 16:23:11,590 - root - INFO - | Epoch: 121/150 | Train Time: 1.438s | Train Loss: 0.009814 |
2020-05-15 16:23:13,450 - root - INFO - | Epoch: 122/150 | Train Time: 1.860s | Train Loss: 0.009874 |
2020-05-15 16:23:15,314 - root - INFO - | Epoch: 123/150 | Train Time: 1.863s | Train Loss: 0.009912 |
2020-05-15 16:23:16,731 - root - INFO - | Epoch: 124/150 | Train Time: 1.416s | Train Loss: 0.009850 |
2020-05-15 16:23:18,504 - root - INFO - | Epoch: 125/150 | Train Time: 1.772s | Train Loss: 0.009860 |
2020-05-15 16:23:20,216 - root - INFO - | Epoch: 126/150 | Train Time: 1.712s | Train Loss: 0.009866 |
2020-05-15 16:23:21,985 - root - INFO - | Epoch: 127/150 | Train Time: 1.768s | Train Loss: 0.009795 |
2020-05-15 16:23:23,752 - root - INFO - | Epoch: 128/150 | Train Time: 1.767s | Train Loss: 0.009816 |
2020-05-15 16:23:25,607 - root - INFO - | Epoch: 129/150 | Train Time: 1.854s | Train Loss: 0.009784 |
2020-05-15 16:23:27,280 - root - INFO - | Epoch: 130/150 | Train Time: 1.673s | Train Loss: 0.009804 |
2020-05-15 16:23:28,957 - root - INFO - | Epoch: 131/150 | Train Time: 1.676s | Train Loss: 0.009751 |
2020-05-15 16:23:30,520 - root - INFO - | Epoch: 132/150 | Train Time: 1.563s | Train Loss: 0.009766 |
2020-05-15 16:23:32,125 - root - INFO - | Epoch: 133/150 | Train Time: 1.604s | Train Loss: 0.009798 |
2020-05-15 16:23:33,503 - root - INFO - | Epoch: 134/150 | Train Time: 1.377s | Train Loss: 0.009842 |
2020-05-15 16:23:34,920 - root - INFO - | Epoch: 135/150 | Train Time: 1.417s | Train Loss: 0.009697 |
2020-05-15 16:23:36,272 - root - INFO - | Epoch: 136/150 | Train Time: 1.351s | Train Loss: 0.009753 |
2020-05-15 16:23:37,756 - root - INFO - | Epoch: 137/150 | Train Time: 1.472s | Train Loss: 0.009826 |
2020-05-15 16:23:39,265 - root - INFO - | Epoch: 138/150 | Train Time: 1.508s | Train Loss: 0.009653 |
2020-05-15 16:23:40,925 - root - INFO - | Epoch: 139/150 | Train Time: 1.659s | Train Loss: 0.009701 |
2020-05-15 16:23:42,597 - root - INFO - | Epoch: 140/150 | Train Time: 1.672s | Train Loss: 0.009656 |
2020-05-15 16:23:43,883 - root - INFO - | Epoch: 141/150 | Train Time: 1.285s | Train Loss: 0.009681 |
2020-05-15 16:23:45,452 - root - INFO - | Epoch: 142/150 | Train Time: 1.569s | Train Loss: 0.009618 |
2020-05-15 16:23:47,155 - root - INFO - | Epoch: 143/150 | Train Time: 1.703s | Train Loss: 0.009567 |
2020-05-15 16:23:48,879 - root - INFO - | Epoch: 144/150 | Train Time: 1.723s | Train Loss: 0.009719 |
2020-05-15 16:23:50,664 - root - INFO - | Epoch: 145/150 | Train Time: 1.785s | Train Loss: 0.009679 |
2020-05-15 16:23:52,443 - root - INFO - | Epoch: 146/150 | Train Time: 1.778s | Train Loss: 0.009559 |
2020-05-15 16:23:54,136 - root - INFO - | Epoch: 147/150 | Train Time: 1.693s | Train Loss: 0.009643 |
2020-05-15 16:23:56,005 - root - INFO - | Epoch: 148/150 | Train Time: 1.869s | Train Loss: 0.009625 |
2020-05-15 16:23:57,732 - root - INFO - | Epoch: 149/150 | Train Time: 1.726s | Train Loss: 0.009514 |
2020-05-15 16:23:59,510 - root - INFO - | Epoch: 150/150 | Train Time: 1.778s | Train Loss: 0.009421 |
2020-05-15 16:23:59,511 - root - INFO - Training Time: 256.668s
2020-05-15 16:23:59,511 - root - INFO - Finished training.
2020-05-15 16:23:59,513 - root - INFO - Starting testing...
2020-05-15 16:24:01,502 - root - INFO - Test Loss: 0.026124
2020-05-15 16:24:01,502 - root - INFO - Test AUC: 87.12%
2020-05-15 16:24:01,502 - root - INFO - Test Time: 1.976s
2020-05-15 16:24:01,502 - root - INFO - Finished testing.
